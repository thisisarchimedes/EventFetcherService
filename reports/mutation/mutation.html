<!DOCTYPE html>
  <html>
  <head>
    <meta charset="utf-8">
    <script>
      var MutationTestElements=function(E){"use strict";var Wo=Object.defineProperty;var Zo=(E,M,z)=>M in E?Wo(E,M,{enumerable:!0,configurable:!0,writable:!0,value:z}):E[M]=z;var x=(E,M,z)=>(Zo(E,typeof M!="symbol"?M+"":M,z),z),Dr=(E,M,z)=>{if(!M.has(E))throw TypeError("Cannot "+z)};var N=(E,M,z)=>(Dr(E,M,"read from private field"),z?z.call(E):M.get(E)),Re=(E,M,z)=>{if(M.has(E))throw TypeError("Cannot add the same private member more than once");M instanceof WeakSet?M.add(E):M.set(E,z)},Br=(E,M,z,qe)=>(Dr(E,M,"write to private field"),qe?qe.call(E,z):M.set(E,z),z);var Nr=(E,M,z)=>(Dr(E,M,"access private method"),z);/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var Li,Pe,Fe,dt,Lr,ze,Oe,pt;const M=globalThis,z=M.ShadowRoot&&(M.ShadyCSS===void 0||M.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,qe=Symbol(),Ur=new WeakMap;let Hi=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==qe)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(z&&e===void 0){const n=t!==void 0&&t.length===1;n&&(e=Ur.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&Ur.set(t,e))}return e}toString(){return this.cssText}};const V=r=>new Hi(typeof r=="string"?r:r+"",void 0,qe),Ki=(r,e)=>{if(z)r.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const n=document.createElement("style"),i=M.litNonce;i!==void 0&&n.setAttribute("nonce",i),n.textContent=t.cssText,r.appendChild(n)}},Hr=z?r=>r:r=>r instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return V(t)})(r):r;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:qi,defineProperty:Vi,getOwnPropertyDescriptor:Wi,getOwnPropertyNames:Zi,getOwnPropertySymbols:Gi,getPrototypeOf:Yi}=Object,ue=globalThis,Kr=ue.trustedTypes,Ji=Kr?Kr.emptyScript:"",Kt=ue.reactiveElementPolyfillSupport,Ve=(r,e)=>r,mt={toAttribute(r,e){switch(e){case Boolean:r=r?Ji:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,e){let t=r;switch(e){case Boolean:t=r!==null;break;case Number:t=r===null?null:Number(r);break;case Object:case Array:try{t=JSON.parse(r)}catch{t=null}}return t}},qt=(r,e)=>!qi(r,e),qr={attribute:!0,type:String,converter:mt,reflect:!1,hasChanged:qt};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),ue.litPropertyMetadata??(ue.litPropertyMetadata=new WeakMap);let je=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=qr){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){const n=Symbol(),i=this.getPropertyDescriptor(e,n,t);i!==void 0&&Vi(this.prototype,e,i)}}static getPropertyDescriptor(e,t,n){const{get:i,set:s}=Wi(this.prototype,e)??{get(){return this[t]},set(a){this[t]=a}};return{get(){return i==null?void 0:i.call(this)},set(a){const o=i==null?void 0:i.call(this);s.call(this,a),this.requestUpdate(e,o,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??qr}static _$Ei(){if(this.hasOwnProperty(Ve("elementProperties")))return;const e=Yi(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Ve("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Ve("properties"))){const t=this.properties,n=[...Zi(t),...Gi(t)];for(const i of n)this.createProperty(i,t[i])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[n,i]of t)this.elementProperties.set(n,i)}this._$Eh=new Map;for(const[t,n]of this.elementProperties){const i=this._$Eu(t,n);i!==void 0&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const i of n)t.unshift(Hr(i))}else e!==void 0&&t.push(Hr(e));return t}static _$Eu(e,t){const n=t.attribute;return n===!1?void 0:typeof n=="string"?n:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$Eg=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$ES??(this._$ES=[])).push(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$ES)==null||t.splice(this._$ES.indexOf(e)>>>0,1)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const n of t.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Ki(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$ES)==null||e.forEach(t=>{var n;return(n=t.hostConnected)==null?void 0:n.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$ES)==null||e.forEach(t=>{var n;return(n=t.hostDisconnected)==null?void 0:n.call(t)})}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$EO(e,t){var s;const n=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,n);if(i!==void 0&&n.reflect===!0){const a=(((s=n.converter)==null?void 0:s.toAttribute)!==void 0?n.converter:mt).toAttribute(t,n.type);this._$Em=e,a==null?this.removeAttribute(i):this.setAttribute(i,a),this._$Em=null}}_$AK(e,t){var s;const n=this.constructor,i=n._$Eh.get(e);if(i!==void 0&&this._$Em!==i){const a=n.getPropertyOptions(i),o=typeof a.converter=="function"?{fromAttribute:a.converter}:((s=a.converter)==null?void 0:s.fromAttribute)!==void 0?a.converter:mt;this._$Em=i,this[i]=o.fromAttribute(t,a.type),this._$Em=null}}requestUpdate(e,t,n,i=!1,s){if(e!==void 0){if(n??(n=this.constructor.getPropertyOptions(e)),!(n.hasChanged??qt)(i?s:this[e],t))return;this.C(e,t,n)}this.isUpdatePending===!1&&(this._$Eg=this._$EP())}C(e,t,n){this._$AL.has(e)||this._$AL.set(e,t),n.reflect===!0&&this._$Em!==e&&(this._$Ej??(this._$Ej=new Set)).add(e)}async _$EP(){this.isUpdatePending=!0;try{await this._$Eg}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var n;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this._$Ep){for(const[s,a]of this._$Ep)this[s]=a;this._$Ep=void 0}const i=this.constructor.elementProperties;if(i.size>0)for(const[s,a]of i)a.wrapped!==!0||this._$AL.has(s)||this[s]===void 0||this.C(s,this[s],a)}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(n=this._$ES)==null||n.forEach(i=>{var s;return(s=i.hostUpdate)==null?void 0:s.call(i)}),this.update(t)):this._$ET()}catch(i){throw e=!1,this._$ET(),i}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$ES)==null||t.forEach(n=>{var i;return(i=n.hostUpdated)==null?void 0:i.call(n)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$ET(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Eg}shouldUpdate(e){return!0}update(e){this._$Ej&&(this._$Ej=this._$Ej.forEach(t=>this._$EO(t,this[t]))),this._$ET()}updated(e){}firstUpdated(e){}};je.elementStyles=[],je.shadowRootOptions={mode:"open"},je[Ve("elementProperties")]=new Map,je[Ve("finalized")]=new Map,Kt==null||Kt({ReactiveElement:je}),(ue.reactiveElementVersions??(ue.reactiveElementVersions=[])).push("2.0.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const We=globalThis,bt=We.trustedTypes,Vr=bt?bt.createPolicy("lit-html",{createHTML:r=>r}):void 0,Vt="$lit$",ne=`lit$${(Math.random()+"").slice(9)}$`,Wt="?"+ne,Qi=`<${Wt}>`,ve=document,Ze=()=>ve.createComment(""),Ge=r=>r===null||typeof r!="object"&&typeof r!="function",Wr=Array.isArray,Zr=r=>Wr(r)||typeof(r==null?void 0:r[Symbol.iterator])=="function",Zt=`[ 	
\f\r]`,Ye=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Gr=/-->/g,Yr=/>/g,ye=RegExp(`>|${Zt}(?:([^\\s"'>=/]+)(${Zt}*=${Zt}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Jr=/'/g,Qr=/"/g,Xr=/^(?:script|style|textarea|title)$/i,en=r=>(e,...t)=>({_$litType$:r,strings:e,values:t}),v=en(1),U=en(2),ie=Symbol.for("lit-noChange"),k=Symbol.for("lit-nothing"),tn=new WeakMap,we=ve.createTreeWalker(ve,129);function rn(r,e){if(!Array.isArray(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return Vr!==void 0?Vr.createHTML(e):e}const nn=(r,e)=>{const t=r.length-1,n=[];let i,s=e===2?"<svg>":"",a=Ye;for(let o=0;o<t;o++){const l=r[o];let c,g,d=-1,m=0;for(;m<l.length&&(a.lastIndex=m,g=a.exec(l),g!==null);)m=a.lastIndex,a===Ye?g[1]==="!--"?a=Gr:g[1]!==void 0?a=Yr:g[2]!==void 0?(Xr.test(g[2])&&(i=RegExp("</"+g[2],"g")),a=ye):g[3]!==void 0&&(a=ye):a===ye?g[0]===">"?(a=i??Ye,d=-1):g[1]===void 0?d=-2:(d=a.lastIndex-g[2].length,c=g[1],a=g[3]===void 0?ye:g[3]==='"'?Qr:Jr):a===Qr||a===Jr?a=ye:a===Gr||a===Yr?a=Ye:(a=ye,i=void 0);const y=a===ye&&r[o+1].startsWith("/>")?" ":"";s+=a===Ye?l+Qi:d>=0?(n.push(c),l.slice(0,d)+Vt+l.slice(d)+ne+y):l+ne+(d===-2?o:y)}return[rn(r,s+(r[t]||"<?>")+(e===2?"</svg>":"")),n]};class Je{constructor({strings:e,_$litType$:t},n){let i;this.parts=[];let s=0,a=0;const o=e.length-1,l=this.parts,[c,g]=nn(e,t);if(this.el=Je.createElement(c,n),we.currentNode=this.el.content,t===2){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(i=we.nextNode())!==null&&l.length<o;){if(i.nodeType===1){if(i.hasAttributes())for(const d of i.getAttributeNames())if(d.endsWith(Vt)){const m=g[a++],y=i.getAttribute(d).split(ne),$=/([.?@])?(.*)/.exec(m);l.push({type:1,index:s,name:$[2],strings:y,ctor:$[1]==="."?an:$[1]==="?"?on:$[1]==="@"?ln:Qe}),i.removeAttribute(d)}else d.startsWith(ne)&&(l.push({type:6,index:s}),i.removeAttribute(d));if(Xr.test(i.tagName)){const d=i.textContent.split(ne),m=d.length-1;if(m>0){i.textContent=bt?bt.emptyScript:"";for(let y=0;y<m;y++)i.append(d[y],Ze()),we.nextNode(),l.push({type:2,index:++s});i.append(d[m],Ze())}}}else if(i.nodeType===8)if(i.data===Wt)l.push({type:2,index:s});else{let d=-1;for(;(d=i.data.indexOf(ne,d+1))!==-1;)l.push({type:7,index:s}),d+=ne.length-1}s++}}static createElement(e,t){const n=ve.createElement("template");return n.innerHTML=e,n}}function xe(r,e,t=r,n){var a,o;if(e===ie)return e;let i=n!==void 0?(a=t._$Co)==null?void 0:a[n]:t._$Cl;const s=Ge(e)?void 0:e._$litDirective$;return(i==null?void 0:i.constructor)!==s&&((o=i==null?void 0:i._$AO)==null||o.call(i,!1),s===void 0?i=void 0:(i=new s(r),i._$AT(r,t,n)),n!==void 0?(t._$Co??(t._$Co=[]))[n]=i:t._$Cl=i),i!==void 0&&(e=xe(r,i._$AS(r,e.values),i,n)),e}class sn{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:n}=this._$AD,i=((e==null?void 0:e.creationScope)??ve).importNode(t,!0);we.currentNode=i;let s=we.nextNode(),a=0,o=0,l=n[0];for(;l!==void 0;){if(a===l.index){let c;l.type===2?c=new Ie(s,s.nextSibling,this,e):l.type===1?c=new l.ctor(s,l.name,l.strings,this,e):l.type===6&&(c=new cn(s,this,e)),this._$AV.push(c),l=n[++o]}a!==(l==null?void 0:l.index)&&(s=we.nextNode(),a++)}return we.currentNode=ve,i}p(e){let t=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}}class Ie{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,n,i){this.type=2,this._$AH=k,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=i,this._$Cv=(i==null?void 0:i.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=xe(this,e,t),Ge(e)?e===k||e==null||e===""?(this._$AH!==k&&this._$AR(),this._$AH=k):e!==this._$AH&&e!==ie&&this._(e):e._$litType$!==void 0?this.g(e):e.nodeType!==void 0?this.$(e):Zr(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==k&&Ge(this._$AH)?this._$AA.nextSibling.data=e:this.$(ve.createTextNode(e)),this._$AH=e}g(e){var s;const{values:t,_$litType$:n}=e,i=typeof n=="number"?this._$AC(e):(n.el===void 0&&(n.el=Je.createElement(rn(n.h,n.h[0]),this.options)),n);if(((s=this._$AH)==null?void 0:s._$AD)===i)this._$AH.p(t);else{const a=new sn(i,this),o=a.u(this.options);a.p(t),this.$(o),this._$AH=a}}_$AC(e){let t=tn.get(e.strings);return t===void 0&&tn.set(e.strings,t=new Je(e)),t}T(e){Wr(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,i=0;for(const s of e)i===t.length?t.push(n=new Ie(this.k(Ze()),this.k(Ze()),this,this.options)):n=t[i],n._$AI(s),i++;i<t.length&&(this._$AR(n&&n._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){var n;for((n=this._$AP)==null?void 0:n.call(this,!1,!0,t);e&&e!==this._$AB;){const i=e.nextSibling;e.remove(),e=i}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}}class Qe{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,n,i,s){this.type=1,this._$AH=k,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=s,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=k}_$AI(e,t=this,n,i){const s=this.strings;let a=!1;if(s===void 0)e=xe(this,e,t,0),a=!Ge(e)||e!==this._$AH&&e!==ie,a&&(this._$AH=e);else{const o=e;let l,c;for(e=s[0],l=0;l<s.length-1;l++)c=xe(this,o[n+l],t,l),c===ie&&(c=this._$AH[l]),a||(a=!Ge(c)||c!==this._$AH[l]),c===k?e=k:e!==k&&(e+=(c??"")+s[l+1]),this._$AH[l]=c}a&&!i&&this.O(e)}O(e){e===k?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class an extends Qe{constructor(){super(...arguments),this.type=3}O(e){this.element[this.name]=e===k?void 0:e}}class on extends Qe{constructor(){super(...arguments),this.type=4}O(e){this.element.toggleAttribute(this.name,!!e&&e!==k)}}class ln extends Qe{constructor(e,t,n,i,s){super(e,t,n,i,s),this.type=5}_$AI(e,t=this){if((e=xe(this,e,t,0)??k)===ie)return;const n=this._$AH,i=e===k&&n!==k||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,s=e!==k&&(n===k||i);i&&this.element.removeEventListener(this.name,this,n),s&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class cn{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){xe(this,e)}}const Xi={j:Vt,P:ne,A:Wt,C:1,M:nn,L:sn,R:Zr,V:xe,D:Ie,I:Qe,H:on,N:ln,U:an,B:cn},Gt=We.litHtmlPolyfillSupport;Gt==null||Gt(Je,Ie),(We.litHtmlVersions??(We.litHtmlVersions=[])).push("3.1.0");const es=(r,e,t)=>{const n=(t==null?void 0:t.renderBefore)??e;let i=n._$litPart$;if(i===void 0){const s=(t==null?void 0:t.renderBefore)??null;n._$litPart$=i=new Ie(e.insertBefore(Ze(),s),s,void 0,t??{})}return i._$AI(r),i};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let G=class extends je{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=es(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return ie}};G._$litElement$=!0,G.finalized=!0,(Li=globalThis.litElementHydrateSupport)==null||Li.call(globalThis,{LitElement:G});const Yt=globalThis.litElementPolyfillSupport;Yt==null||Yt({LitElement:G}),(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.0.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const L=r=>(e,t)=>{t!==void 0?t.addInitializer(()=>{customElements.define(r,e)}):customElements.define(r,e)};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ts={attribute:!0,type:String,converter:mt,reflect:!1,hasChanged:qt},rs=(r=ts,e,t)=>{const{kind:n,metadata:i}=t;let s=globalThis.litPropertyMetadata.get(i);if(s===void 0&&globalThis.litPropertyMetadata.set(i,s=new Map),s.set(t.name,r),n==="accessor"){const{name:a}=t;return{set(o){const l=e.get.call(this);e.set.call(this,o),this.requestUpdate(a,l,r)},init(o){return o!==void 0&&this.C(a,void 0,r),o}}}if(n==="setter"){const{name:a}=t;return function(o){const l=this[a];e.call(this,o),this.requestUpdate(a,l,r)}}throw Error("Unsupported decorator location: "+n)};function S(r){return(e,t)=>typeof t=="object"?rs(r,e,t):((n,i,s)=>{const a=i.hasOwnProperty(s);return i.constructor.createProperty(s,a?{...n,wrapped:!0}:n),a?Object.getOwnPropertyDescriptor(i,s):void 0})(r,e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Y(r){return S({...r,state:!0,attribute:!1})}function ns(r,e){return r.reduce((t,n)=>{const i=e(n);return Object.prototype.hasOwnProperty.call(t,i)||(t[i]=[]),t[i].push(n),t},{})}const is="/";function un(r,e,t){const n=Object.keys(r),i=ss(n),s=Object.create(null);return n.forEach(a=>{const o=dn(a.startsWith(e)?a.substr(e.length):a);s[dn(a.substr(i.length))]=t(r[a],o)}),s}function dn(r){return r.split(/\/|\\/).filter(Boolean).join("/")}function ss(r){const e=r.map(n=>n.split(/\/|\\/).slice(0,-1));if(r.length)return e.reduce(t).join(is);return"";function t(n,i){for(let s=0;s<n.length;s++)if(n[s]!==i[s])return n.splice(0,s);return n}}function as(r,e){const t=n=>n.file?`1${n.name}`:`0${n.name}`;return t(r).localeCompare(t(e))}var Q;(function(r){r[r.maxAsciiCharacter=127]="maxAsciiCharacter",r[r.lineFeed=10]="lineFeed",r[r.carriageReturn=13]="carriageReturn",r[r.lineSeparator=8232]="lineSeparator",r[r.paragraphSeparator=8233]="paragraphSeparator"})(Q||(Q={}));function os(r){return r===Q.lineFeed||r===Q.carriageReturn||r===Q.lineSeparator||r===Q.paragraphSeparator}function ls(r){const e=[];let t=0,n=0;function i(s){e.push(n),n=s}for(i(0);t<r.length;){const s=r.charCodeAt(t);switch(t++,s){case Q.carriageReturn:r.charCodeAt(t)===Q.lineFeed&&t++,i(t);break;case Q.lineFeed:i(t);break;default:s>Q.maxAsciiCharacter&&os(s)&&i(t);break}}return e.push(n),e}function Jt(r){if(r===void 0)throw new Error("mutant.sourceFile was not defined")}class cs{constructor(e){x(this,"coveredBy");x(this,"description");x(this,"duration");x(this,"id");x(this,"killedBy");x(this,"location");x(this,"mutatorName");x(this,"replacement");x(this,"static");x(this,"status");x(this,"statusReason");x(this,"testsCompleted");Re(this,Pe,new Map);Re(this,Fe,new Map);this.coveredBy=e.coveredBy,this.description=e.description,this.duration=e.duration,this.id=e.id,this.killedBy=e.killedBy,this.location=e.location,this.mutatorName=e.mutatorName,this.replacement=e.replacement,this.static=e.static,this.status=e.status,this.statusReason=e.statusReason,this.testsCompleted=e.testsCompleted}get coveredByTests(){if(N(this,Pe).size)return Array.from(N(this,Pe).values())}set coveredByTests(e){Br(this,Pe,new Map(e.map(t=>[t.id,t])))}get killedByTests(){if(N(this,Fe).size)return Array.from(N(this,Fe).values())}set killedByTests(e){Br(this,Fe,new Map(e.map(t=>[t.id,t])))}addCoveredBy(e){N(this,Pe).set(e.id,e)}addKilledBy(e){N(this,Fe).set(e.id,e)}getMutatedLines(){return Jt(this.sourceFile),this.sourceFile.getMutationLines(this)}getOriginalLines(){return Jt(this.sourceFile),this.sourceFile.getLines(this.location)}get fileName(){return Jt(this.sourceFile),this.sourceFile.name}update(){var e,t;(t=(e=this.sourceFile)==null?void 0:e.result)!=null&&t.file&&this.sourceFile.result.updateAllMetrics()}}Pe=new WeakMap,Fe=new WeakMap;function pn(r){if(r===void 0)throw new Error("sourceFile.source is undefined")}class hn{constructor(){x(this,"lineMap")}getLineMap(){return pn(this.source),this.lineMap??(this.lineMap=ls(this.source))}getLines(e){pn(this.source);const t=this.getLineMap();return this.source.substring(t[e.start.line],t[(e.end??e.start).line+1])}}class us extends hn{constructor(t,n){super();x(this,"name");x(this,"language");x(this,"source");x(this,"mutants");x(this,"result");this.name=n,this.language=t.language,this.source=t.source,this.mutants=t.mutants.map(i=>{const s=new cs(i);return s.sourceFile=this,s})}getMutationLines(t){const n=this.getLineMap(),i=n[t.location.start.line],s=n[t.location.end.line],a=n[t.location.end.line+1];return`${this.source.substr(i,t.location.start.column-1)}${t.replacement??t.description??t.mutatorName}${this.source.substring(s+t.location.end.column-1,a)}`}}class fn{constructor(e,t,n,i){Re(this,dt);x(this,"parent");x(this,"name");x(this,"file");x(this,"childResults");x(this,"metrics");this.name=e,this.childResults=t,this.metrics=n,this.file=i}updateParent(e){this.parent=e,this.childResults.forEach(t=>t.updateParent(this))}updateAllMetrics(){if(this.parent!==void 0){this.parent.updateAllMetrics();return}this.updateMetrics()}updateMetrics(){if(this.file===void 0){this.childResults.forEach(t=>{t.updateMetrics()});const e=Nr(this,dt,Lr).call(this,this.childResults);if(e.length===0)return;e[0].tests?this.metrics=Xt(e):this.metrics=vt(e);return}this.file.tests?this.metrics=Xt([this.file]):this.metrics=vt([this.file])}}dt=new WeakSet,Lr=function(e){const t=[];return e.length===0||e.forEach(n=>{if(n.file){t.push(n.file);return}t.push(...Nr(this,dt,Lr).call(this,n.childResults))}),t};function gn(r){if(r===void 0)throw new Error("test.sourceFile was not defined")}function ds(r){if(r===void 0)throw new Error("test.location was not defined")}var B;(function(r){r.Killing="Killing",r.Covering="Covering",r.NotCovering="NotCovering"})(B||(B={}));class ps{constructor(e){x(this,"id");x(this,"name");x(this,"location");Re(this,ze,new Map);Re(this,Oe,new Map);Object.entries(e).forEach(([t,n])=>{this[t]=n})}get killedMutants(){if(N(this,ze).size)return Array.from(N(this,ze).values())}get coveredMutants(){if(N(this,Oe).size)return Array.from(N(this,Oe).values())}addCovered(e){N(this,Oe).set(e.id,e)}addKilled(e){N(this,ze).set(e.id,e)}getLines(){return gn(this.sourceFile),ds(this.location),this.sourceFile.getLines(this.location)}get fileName(){return gn(this.sourceFile),this.sourceFile.name}get status(){return N(this,ze).size?B.Killing:N(this,Oe).size?B.Covering:B.NotCovering}update(){var e,t;(t=(e=this.sourceFile)==null?void 0:e.result)!=null&&t.file&&this.sourceFile.result.updateAllMetrics()}}ze=new WeakMap,Oe=new WeakMap;class hs extends hn{constructor(t,n){super();x(this,"name");x(this,"tests");x(this,"source");x(this,"result");this.name=n,this.source=t.source,this.tests=t.tests.map(i=>{const s=new ps(i);return s.sourceFile=this,s})}}const mn=NaN,bn="All files",fs="All tests";function gs(r){const{files:e,testFiles:t,projectRoot:n=""}=r,i=un(e,n,(s,a)=>new us(s,a));if(t&&Object.keys(t).length){const s=un(t,n,(a,o)=>new hs(a,o));return bs(Object.values(i).flatMap(a=>a.mutants),Object.values(s).flatMap(a=>a.tests)),{systemUnderTestMetrics:Qt(bn,i,vt),testMetrics:Qt(fs,s,Xt)}}return{systemUnderTestMetrics:Qt(bn,i,vt),testMetrics:void 0}}function Qt(r,e,t){const n=Object.keys(e);return n.length===1&&n[0]===""?yn(r,e[n[0]],t):vn(r,e,t)}function vn(r,e,t){const n=t(Object.values(e)),i=ms(e,t);return new fn(r,i,n)}function yn(r,e,t){return new fn(r,[],t([e]),e)}function ms(r,e){const t=ns(Object.entries(r),n=>n[0].split("/")[0]);return Object.keys(t).map(n=>{if(t[n].length>1||t[n][0][0]!==n){const i={};return t[n].forEach(s=>i[s[0].substr(n.length+1)]=s[1]),vn(n,i,e)}else{const[i,s]=t[n][0];return yn(i,s,e)}}).sort(as)}function bs(r,e){const t=new Map(e.map(n=>[n.id,n]));for(const n of r){const i=n.coveredBy??[];for(const a of i){const o=t.get(a);o&&(n.addCoveredBy(o),o.addCovered(n))}const s=n.killedBy??[];for(const a of s){const o=t.get(a);o&&(n.addKilledBy(o),o.addKilled(n))}}}function Xt(r){const e=r.flatMap(n=>n.tests),t=n=>e.filter(i=>i.status===n).length;return{total:e.length,killing:t(B.Killing),covering:t(B.Covering),notCovering:t(B.NotCovering)}}function vt(r){const e=r.flatMap(R=>R.mutants),t=R=>e.filter(j=>j.status===R).length,n=t("Pending"),i=t("Killed"),s=t("Timeout"),a=t("Survived"),o=t("NoCoverage"),l=t("RuntimeError"),c=t("CompileError"),g=t("Ignored"),d=s+i,m=a+o,y=d+a,$=m+d,_=l+c;return{pending:n,killed:i,timeout:s,survived:a,noCoverage:o,runtimeErrors:l,compileErrors:c,ignored:g,totalDetected:d,totalUndetected:m,totalCovered:y,totalValid:$,totalInvalid:_,mutationScore:$>0?d/$*100:mn,totalMutants:$+_+g+n,mutationScoreBasedOnCoveredCode:$>0?d/y*100||0:mn}}const vs=`/*! tailwindcss v3.3.5 | MIT License | https://tailwindcss.com*/*,:after,:before{border-color:rgb(var(--mut-gray-200,228 228 231)/1);border-style:solid;border-width:0;box-sizing:border-box}:after,:before{--tw-content:""}html{-webkit-text-size-adjust:100%;font-feature-settings:normal;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-variation-settings:normal;line-height:1.5;-moz-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{font-feature-settings:inherit;color:inherit;font-family:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{color:rgb(var(--mut-gray-400,161 161 170)/1);opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}[multiple],[type=date],[type=datetime-local],[type=email],[type=month],[type=number],[type=password],[type=search],[type=tel],[type=text],[type=time],[type=url],[type=week],input:where(:not([type])),select,textarea{--tw-shadow:0 0 #0000;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;border-color:rgb(var(--mut-gray-500,113 113 122)/var(--tw-border-opacity,1));border-radius:0;border-width:1px;font-size:1rem;line-height:1.5rem;padding:.5rem .75rem}[multiple]:focus,[type=date]:focus,[type=datetime-local]:focus,[type=email]:focus,[type=month]:focus,[type=number]:focus,[type=password]:focus,[type=search]:focus,[type=tel]:focus,[type=text]:focus,[type=time]:focus,[type=url]:focus,[type=week]:focus,input:where(:not([type])):focus,select:focus,textarea:focus{--tw-ring-inset:var(--tw-empty, );--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:#2563eb;--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);border-color:#2563eb;box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow);outline:2px solid transparent;outline-offset:2px}input::placeholder,textarea::placeholder{color:rgb(var(--mut-gray-500,113 113 122)/var(--tw-text-opacity,1));opacity:1}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-date-and-time-value{min-height:1.5em;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit,::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-meridiem-field,::-webkit-datetime-edit-millisecond-field,::-webkit-datetime-edit-minute-field,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-second-field,::-webkit-datetime-edit-year-field{padding-bottom:0;padding-top:0}select{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='rgb(var(--mut-gray-500, 113 113 122) / var(--tw-stroke-opacity, 1))' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3E%3C/svg%3E");background-position:right .5rem center;background-repeat:no-repeat;background-size:1.5em 1.5em;padding-right:2.5rem;-webkit-print-color-adjust:exact;print-color-adjust:exact}[multiple],[size]:where(select:not([size="1"])){background-image:none;background-position:0 0;background-repeat:unset;background-size:initial;padding-right:.75rem;-webkit-print-color-adjust:unset;print-color-adjust:unset}[type=checkbox],[type=radio]{--tw-shadow:0 0 #0000;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;background-origin:border-box;border-color:rgb(var(--mut-gray-500,113 113 122)/var(--tw-border-opacity,1));border-width:1px;color:#2563eb;display:inline-block;flex-shrink:0;height:1rem;padding:0;-webkit-print-color-adjust:exact;print-color-adjust:exact;-webkit-user-select:none;user-select:none;vertical-align:middle;width:1rem}[type=checkbox]{border-radius:0}[type=radio]{border-radius:100%}[type=checkbox]:focus,[type=radio]:focus{--tw-ring-inset:var(--tw-empty, );--tw-ring-offset-width:2px;--tw-ring-offset-color:#fff;--tw-ring-color:#2563eb;--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow);outline:2px solid transparent;outline-offset:2px}[type=checkbox]:checked,[type=radio]:checked{background-color:currentColor;background-position:50%;background-repeat:no-repeat;background-size:100% 100%;border-color:transparent}[type=checkbox]:checked{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 16 16'%3E%3Cpath d='M12.207 4.793a1 1 0 0 1 0 1.414l-5 5a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L6.5 9.086l4.293-4.293a1 1 0 0 1 1.414 0z'/%3E%3C/svg%3E")}@media (forced-colors:active){[type=checkbox]:checked{-webkit-appearance:auto;-moz-appearance:auto;appearance:auto}}[type=radio]:checked{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 16 16'%3E%3Ccircle cx='8' cy='8' r='3'/%3E%3C/svg%3E")}@media (forced-colors:active){[type=radio]:checked{-webkit-appearance:auto;-moz-appearance:auto;appearance:auto}}[type=checkbox]:checked:focus,[type=checkbox]:checked:hover,[type=radio]:checked:focus,[type=radio]:checked:hover{background-color:currentColor;border-color:transparent}[type=checkbox]:indeterminate{background-color:currentColor;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 16 16'%3E%3Cpath stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 8h8'/%3E%3C/svg%3E");background-position:50%;background-repeat:no-repeat;background-size:100% 100%;border-color:transparent}@media (forced-colors:active){[type=checkbox]:indeterminate{-webkit-appearance:auto;-moz-appearance:auto;appearance:auto}}[type=checkbox]:indeterminate:focus,[type=checkbox]:indeterminate:hover{background-color:currentColor;border-color:transparent}[type=file]{background:unset;border-color:inherit;border-radius:0;border-width:0;font-size:unset;line-height:inherit;padding:0}[type=file]:focus{outline:1px solid ButtonText;outline:1px auto -webkit-focus-ring-color}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.container{margin-left:auto;margin-right:auto;width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}@media (min-width:2000px){.container{max-width:2000px}}.sr-only{clip:rect(0,0,0,0);border-width:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.pointer-events-none{pointer-events:none}.visible{visibility:visible}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.bottom-0{bottom:0}.left-0{left:0}.top-0{top:0}.top-offset{top:var(--top-offset,0)}.z-10{z-index:10}.z-20{z-index:20}.float-right{float:right}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-6{margin-left:1.5rem;margin-right:1.5rem}.my-3{margin-bottom:.75rem;margin-top:.75rem}.my-4{margin-bottom:1rem;margin-top:1rem}.-mb-px{margin-bottom:-1px}.mb-6{margin-bottom:1.5rem}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-4{margin-left:1rem}.mr-12{margin-right:3rem}.mr-2{margin-right:.5rem}.mr-3{margin-right:.75rem}.mr-4{margin-right:1rem}.mr-6{margin-right:1.5rem}.mr-auto{margin-right:auto}.ms-3{margin-inline-start:.75rem}.mt-2{margin-top:.5rem}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.h-2{height:.5rem}.h-3{height:.75rem}.h-4{height:1rem}.h-5{height:1.25rem}.h-8{height:2rem}.w-12{width:3rem}.w-24{width:6rem}.w-4{width:1rem}.w-5{width:1.25rem}.w-full{width:100%}.min-w-\\[24px\\]{min-width:24px}.max-w-6xl{max-width:72rem}.table-auto{table-layout:auto}.rotate-180{--tw-rotate:180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-help{cursor:help}.cursor-pointer{cursor:pointer}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-around{justify-content:space-around}.gap-4{gap:1rem}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(1rem*var(--tw-space-y-reverse));margin-top:calc(1rem*(1 - var(--tw-space-y-reverse)))}.divide-y>:not([hidden])~:not([hidden]){--tw-divide-y-reverse:0;border-bottom-width:calc(1px*var(--tw-divide-y-reverse));border-top-width:calc(1px*(1 - var(--tw-divide-y-reverse)))}.divide-gray-200>:not([hidden])~:not([hidden]){--tw-divide-opacity:1;border-color:rgb(var(--mut-gray-200,228 228 231)/var(--tw-divide-opacity))}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-t-3xl{border-top-left-radius:1.5rem;border-top-right-radius:1.5rem}.rounded-t-lg{border-top-left-radius:.5rem;border-top-right-radius:.5rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-none{border-style:none}.border-gray-200{--tw-border-opacity:1;border-color:rgb(var(--mut-gray-200,228 228 231)/var(--tw-border-opacity))}.border-gray-300{--tw-border-opacity:1;border-color:rgb(var(--mut-gray-300,212 212 216)/var(--tw-border-opacity))}.border-primary-600{--tw-border-opacity:1;border-color:rgb(var(--mut-primary-600,2 132 199)/var(--tw-border-opacity))}.border-transparent{border-color:transparent}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235/var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-100,244 244 245)/var(--tw-bg-opacity))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-200,228 228 231)/var(--tw-bg-opacity))}.bg-gray-200\\/60{background-color:rgb(var(--mut-gray-200,228 228 231)/.6)}.bg-gray-300{--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-300,212 212 216)/var(--tw-bg-opacity))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231/var(--tw-bg-opacity))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74/var(--tw-bg-opacity))}.bg-orange-100{--tw-bg-opacity:1;background-color:rgb(255 237 213/var(--tw-bg-opacity))}.bg-primary-100{--tw-bg-opacity:1;background-color:rgb(var(--mut-primary-100,224 242 254)/var(--tw-bg-opacity))}.bg-red-100{--tw-bg-opacity:1;background-color:rgb(254 226 226/var(--tw-bg-opacity))}.bg-red-600{--tw-bg-opacity:1;background-color:rgb(220 38 38/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(var(--mut-white,255 255 255)/var(--tw-bg-opacity))}.bg-yellow-100{--tw-bg-opacity:1;background-color:rgb(254 249 195/var(--tw-bg-opacity))}.bg-yellow-400{--tw-bg-opacity:1;background-color:rgb(250 204 21/var(--tw-bg-opacity))}.bg-yellow-600{--tw-bg-opacity:1;background-color:rgb(202 138 4/var(--tw-bg-opacity))}.p-1{padding:.25rem}.p-3{padding:.75rem}.p-4{padding:1rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-2\\.5{padding-left:.625rem;padding-right:.625rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0{padding-bottom:0;padding-top:0}.py-0\\.5{padding-bottom:.125rem;padding-top:.125rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-3{padding-bottom:.75rem;padding-top:.75rem}.py-4{padding-bottom:1rem;padding-top:1rem}.py-6{padding-bottom:1.5rem;padding-top:1.5rem}.pb-4{padding-bottom:1rem}.pl-1{padding-left:.25rem}.pr-2{padding-right:.5rem}.pt-6{padding-top:1.5rem}.text-left{text-align:left}.text-center{text-align:center}.align-middle{vertical-align:middle}.font-sans{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}.text-5xl{font-size:3rem;line-height:1}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.font-bold{font-weight:700}.font-light{font-weight:300}.font-medium{font-weight:500}.font-semibold{font-weight:600}.tracking-tight{letter-spacing:-.025em}.text-gray-200{--tw-text-opacity:1;color:rgb(var(--mut-gray-200,228 228 231)/var(--tw-text-opacity))}.text-gray-600{--tw-text-opacity:1;color:rgb(var(--mut-gray-600,82 82 91)/var(--tw-text-opacity))}.text-gray-700{--tw-text-opacity:1;color:rgb(var(--mut-gray-700,63 63 70)/var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgb(var(--mut-gray-800,39 39 42)/var(--tw-text-opacity))}.text-green-700{--tw-text-opacity:1;color:rgb(21 128 61/var(--tw-text-opacity))}.text-green-800{--tw-text-opacity:1;color:rgb(22 101 52/var(--tw-text-opacity))}.text-orange-800{--tw-text-opacity:1;color:rgb(154 52 18/var(--tw-text-opacity))}.text-primary-800{--tw-text-opacity:1;color:rgb(var(--mut-primary-800,7 89 133)/var(--tw-text-opacity))}.text-primary-on{--tw-text-opacity:1;color:rgb(var(--mut-primary-on,3 105 161)/var(--tw-text-opacity))}.text-red-700{--tw-text-opacity:1;color:rgb(185 28 28/var(--tw-text-opacity))}.text-red-800{--tw-text-opacity:1;color:rgb(153 27 27/var(--tw-text-opacity))}.text-yellow-600{--tw-text-opacity:1;color:rgb(202 138 4/var(--tw-text-opacity))}.text-yellow-800{--tw-text-opacity:1;color:rgb(133 77 14/var(--tw-text-opacity))}.underline{text-decoration-line:underline}.decoration-dotted{text-decoration-style:dotted}.opacity-0{opacity:0}.shadow{--tw-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color)}.shadow,.shadow-xl{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 8px 10px -6px rgba(0,0,0,.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color),0 8px 10px -6px var(--tw-shadow-color)}.\\!ring-offset-gray-200{--tw-ring-offset-color:rgb(var(--mut-gray-200,228 228 231)/1)!important}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-lg{--tw-backdrop-blur:blur(16px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition-all{transition-duration:.15s;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-colors{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.after\\:text-gray-800:after{--tw-text-opacity:1;color:rgb(var(--mut-gray-800,39 39 42)/var(--tw-text-opacity));content:var(--tw-content)}.after\\:content-\\[\\'\\/\\'\\]:after{--tw-content:"/";content:var(--tw-content)}.even\\:bg-gray-100:nth-child(2n),.odd\\:bg-gray-100:nth-child(odd){--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-100,244 244 245)/var(--tw-bg-opacity))}.hover\\:cursor-pointer:hover{cursor:pointer}.hover\\:border-gray-300:hover{--tw-border-opacity:1;border-color:rgb(var(--mut-gray-300,212 212 216)/var(--tw-border-opacity))}.hover\\:bg-gray-100:hover{--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-100,244 244 245)/var(--tw-bg-opacity))}.hover\\:bg-gray-200:hover{--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-200,228 228 231)/var(--tw-bg-opacity))}.hover\\:text-gray-700:hover{--tw-text-opacity:1;color:rgb(var(--mut-gray-700,63 63 70)/var(--tw-text-opacity))}.hover\\:text-gray-900:hover{--tw-text-opacity:1;color:rgb(var(--mut-gray-900,24 24 27)/var(--tw-text-opacity))}.hover\\:text-primary-on:hover{--tw-text-opacity:1;color:rgb(var(--mut-primary-on,3 105 161)/var(--tw-text-opacity))}.hover\\:underline:hover{text-decoration-line:underline}.focus\\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.focus\\:ring-primary-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(var(--mut-primary-500,14 165 233)/var(--tw-ring-opacity))}.active\\:bg-gray-200:active,.group:hover .group-hover\\:bg-gray-200{--tw-bg-opacity:1;background-color:rgb(var(--mut-gray-200,228 228 231)/var(--tw-bg-opacity))}.aria-selected\\:border-b-\\[3px\\][aria-selected=true]{border-bottom-width:3px}.aria-selected\\:border-primary-700[aria-selected=true]{--tw-border-opacity:1;border-color:rgb(var(--mut-primary-700,3 105 161)/var(--tw-border-opacity))}.aria-selected\\:text-primary-on[aria-selected=true]{--tw-text-opacity:1;color:rgb(var(--mut-primary-on,3 105 161)/var(--tw-text-opacity))}@media (prefers-reduced-motion:no-preference){.motion-safe\\:transition-\\[height\\,max-width\\]{transition-duration:.15s;transition-property:height,max-width;transition-timing-function:cubic-bezier(.4,0,.2,1)}.motion-safe\\:transition-max-width{transition-duration:.15s;transition-property:max-width;transition-timing-function:cubic-bezier(.4,0,.2,1)}.motion-safe\\:duration-200{transition-duration:.2s}}@media (min-width:768px){.md\\:ml-2{margin-left:.5rem}.md\\:after\\:pl-1:after{content:var(--tw-content);padding-left:.25rem}}@media (min-width:1536px){.\\32xl\\:w-28{width:7rem}}`,ys="code[class*=language-],pre[class*=language-]{color:var(--prism-maintext);direction:ltr;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre>code[class*=language-]{font-size:1em}pre[class*=language-]{border:1px solid var(--prism-border);border-radius:.25rem;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:var(--prism-background)}.token.cdata,.token.comment,.token.doctype,.token.italic,.token.prolog{font-style:italic}.token.bold,.token.function,.token.important{font-weight:700}.token.namespace{opacity:.7}.token.atrule{color:var(--prism-atrule)}.token.attr{color:var(--prism-attr)}.token.attr-name{color:var(--prism-attr-name)}.token.boolean{color:var(--prism-boolean)}.token.builtin{color:var(--prism-builtin)}.token.cdata{color:var(--prism-cdata)}.token.changed{color:var(--prism-changed)}.token.char{color:var(--prism-char)}.token.comment{color:var(--prism-comment)}.token.constant{color:var(--prism-constant)}.token.deleted{color:var(--prism-deleted)}.token.doctype{color:var(--prism-doctype)}.token.entity{color:var(--prism-entity);cursor:help}.token.function{color:var(--prism-function)}.token.function-variable{color:var(--prism-function-variable,var(--prism-function))}.token.inserted{color:var(--prism-inserted)}.token.keyword{color:var(--prism-keyword)}.token.number{color:var(--prism-number)}.token.operator{color:var(--prism-operator)}.token.prolog{color:var(--prism-prolog)}.token.property{color:var(--prism-property)}.token.punctuation{color:var(--prism-punctuation)}.token.regex{color:var(--prism-regex)}.token.selector{color:var(--prism-selector)}.token.string{color:var(--prism-string)}.token.symbol{color:var(--prism-symbol)}.token.tag{color:var(--prism-tag)}.token.url{color:var(--prism-url)}.token.variable{color:var(--prism-variable)}.token.placeholder{color:var(--prism-placeholder)}.token.statement{color:var(--prism-statement)}.token.attr-value{color:var(--prism-attr-value)}.token.control{color:var(--prism-control)}.token.directive{color:var(--prism-directive)}.token.unit{color:var(--prism-unit)}.token.important{color:var(--prism-important)}.token.class-name{color:var(--prism-class-name)}pre[class*=language-].line-numbers{counter-reset:linenumber;padding-left:3.8em;position:relative}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{border-right:1px solid #999;font-size:100%;left:-3.8em;letter-spacing:-1px;pointer-events:none;position:absolute;top:0;-webkit-user-select:none;user-select:none;width:3em}.line-numbers-rows>span{counter-increment:linenumber;display:block}.line-numbers-rows>span:before{color:#999;content:counter(linenumber);display:block;padding-right:.8em;text-align:right}",ws="";var wn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},xn={exports:{}};(function(r){var e=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var t=function(n){var i=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,s=0,a={},o={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function h(p){return p instanceof l?new l(p.type,h(p.content),p.alias):Array.isArray(p)?p.map(h):p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(h){return Object.prototype.toString.call(h).slice(8,-1)},objId:function(h){return h.__id||Object.defineProperty(h,"__id",{value:++s}),h.__id},clone:function h(p,b){b=b||{};var u,f;switch(o.util.type(p)){case"Object":if(f=o.util.objId(p),b[f])return b[f];u={},b[f]=u;for(var w in p)p.hasOwnProperty(w)&&(u[w]=h(p[w],b));return u;case"Array":return f=o.util.objId(p),b[f]?b[f]:(u=[],b[f]=u,p.forEach(function(C,A){u[A]=h(C,b)}),u);default:return p}},getLanguage:function(h){for(;h;){var p=i.exec(h.className);if(p)return p[1].toLowerCase();h=h.parentElement}return"none"},setLanguage:function(h,p){h.className=h.className.replace(RegExp(i,"gi"),""),h.classList.add("language-"+p)},currentScript:function(){if(typeof document>"u")return null;if("currentScript"in document&&1<2)return document.currentScript;try{throw new Error}catch(u){var h=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(u.stack)||[])[1];if(h){var p=document.getElementsByTagName("script");for(var b in p)if(p[b].src==h)return p[b]}return null}},isActive:function(h,p,b){for(var u="no-"+p;h;){var f=h.classList;if(f.contains(p))return!0;if(f.contains(u))return!1;h=h.parentElement}return!!b}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(h,p){var b=o.util.clone(o.languages[h]);for(var u in p)b[u]=p[u];return b},insertBefore:function(h,p,b,u){u=u||o.languages;var f=u[h],w={};for(var C in f)if(f.hasOwnProperty(C)){if(C==p)for(var A in b)b.hasOwnProperty(A)&&(w[A]=b[A]);b.hasOwnProperty(C)||(w[C]=f[C])}var O=u[h];return u[h]=w,o.languages.DFS(o.languages,function(I,te){te===O&&I!=h&&(this[I]=w)}),w},DFS:function h(p,b,u,f){f=f||{};var w=o.util.objId;for(var C in p)if(p.hasOwnProperty(C)){b.call(p,C,p[C],u||C);var A=p[C],O=o.util.type(A);O==="Object"&&!f[w(A)]?(f[w(A)]=!0,h(A,b,null,f)):O==="Array"&&!f[w(A)]&&(f[w(A)]=!0,h(A,b,C,f))}}},plugins:{},highlightAll:function(h,p){o.highlightAllUnder(document,h,p)},highlightAllUnder:function(h,p,b){var u={callback:b,container:h,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",u),u.elements=Array.prototype.slice.apply(u.container.querySelectorAll(u.selector)),o.hooks.run("before-all-elements-highlight",u);for(var f=0,w;w=u.elements[f++];)o.highlightElement(w,p===!0,u.callback)},highlightElement:function(h,p,b){var u=o.util.getLanguage(h),f=o.languages[u];o.util.setLanguage(h,u);var w=h.parentElement;w&&w.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(w,u);var C=h.textContent,A={element:h,language:u,grammar:f,code:C};function O(te){A.highlightedCode=te,o.hooks.run("before-insert",A),A.element.innerHTML=A.highlightedCode,o.hooks.run("after-highlight",A),o.hooks.run("complete",A),b&&b.call(A.element)}if(o.hooks.run("before-sanity-check",A),w=A.element.parentElement,w&&w.nodeName.toLowerCase()==="pre"&&!w.hasAttribute("tabindex")&&w.setAttribute("tabindex","0"),!A.code){o.hooks.run("complete",A),b&&b.call(A.element);return}if(o.hooks.run("before-highlight",A),!A.grammar){O(o.util.encode(A.code));return}if(p&&n.Worker){var I=new Worker(o.filename);I.onmessage=function(te){O(te.data)},I.postMessage(JSON.stringify({language:A.language,code:A.code,immediateClose:!0}))}else O(o.highlight(A.code,A.grammar,A.language))},highlight:function(h,p,b){var u={code:h,grammar:p,language:b};if(o.hooks.run("before-tokenize",u),!u.grammar)throw new Error('The language "'+u.language+'" has no grammar.');return u.tokens=o.tokenize(u.code,u.grammar),o.hooks.run("after-tokenize",u),l.stringify(o.util.encode(u.tokens),u.language)},tokenize:function(h,p){var b=p.rest;if(b){for(var u in b)p[u]=b[u];delete p.rest}var f=new d;return m(f,f.head,h),g(h,f,p,f.head,0),$(f)},hooks:{all:{},add:function(h,p){var b=o.hooks.all;b[h]=b[h]||[],b[h].push(p)},run:function(h,p){var b=o.hooks.all[h];if(!(!b||!b.length))for(var u=0,f;f=b[u++];)f(p)}},Token:l};n.Prism=o;function l(h,p,b,u){this.type=h,this.content=p,this.alias=b,this.length=(u||"").length|0}l.stringify=function h(p,b){if(typeof p=="string")return p;if(Array.isArray(p)){var u="";return p.forEach(function(O){u+=h(O,b)}),u}var f={type:p.type,content:h(p.content,b),tag:"span",classes:["token",p.type],attributes:{},language:b},w=p.alias;w&&(Array.isArray(w)?Array.prototype.push.apply(f.classes,w):f.classes.push(w)),o.hooks.run("wrap",f);var C="";for(var A in f.attributes)C+=" "+A+'="'+(f.attributes[A]||"").replace(/"/g,"&quot;")+'"';return"<"+f.tag+' class="'+f.classes.join(" ")+'"'+C+">"+f.content+"</"+f.tag+">"};function c(h,p,b,u){h.lastIndex=p;var f=h.exec(b);if(f&&u&&f[1]){var w=f[1].length;f.index+=w,f[0]=f[0].slice(w)}return f}function g(h,p,b,u,f,w){for(var C in b)if(!(!b.hasOwnProperty(C)||!b[C])){var A=b[C];A=Array.isArray(A)?A:[A];for(var O=0;O<A.length;++O){if(w&&w.cause==C+","+O)return;var I=A[O],te=I.inside,Ke=!!I.lookbehind,ht=!!I.greedy,Bt=I.alias;if(ht&&!I.pattern.global){var Nt=I.pattern.toString().match(/[imsuy]*$/)[0];I.pattern=RegExp(I.pattern.source,Nt+"g")}for(var ft=I.pattern||I,D=u.next,F=f;D!==p.tail&&!(w&&F>=w.reach);F+=D.value.length,D=D.next){var q=D.value;if(p.length>h.length)return;if(!(q instanceof l)){var re=1,W;if(ht){if(W=c(ft,F,h,Ke),!W||W.index>=h.length)break;var Lt=W.index,qo=W.index+W[0].length,be=F;for(be+=D.value.length;Lt>=be;)D=D.next,be+=D.value.length;if(be-=D.value.length,F=be,D.value instanceof l)continue;for(var gt=D;gt!==p.tail&&(be<qo||typeof gt.value=="string");gt=gt.next)re++,be+=gt.value.length;re--,q=h.slice(F,be),W.index-=F}else if(W=c(ft,0,q,Ke),!W)continue;var Lt=W.index,Ut=W[0],Rr=q.slice(0,Lt),Ui=q.slice(Lt+Ut.length),jr=F+q.length;w&&jr>w.reach&&(w.reach=jr);var Ht=D.prev;Rr&&(Ht=m(p,Ht,Rr),F+=Rr.length),y(p,Ht,re);var Vo=new l(C,te?o.tokenize(Ut,te):Ut,Bt,Ut);if(D=m(p,Ht,Vo),Ui&&m(p,D,Ui),re>1){var Ir={cause:C+","+O,reach:jr};g(h,p,b,D.prev,F,Ir),w&&Ir.reach>w.reach&&(w.reach=Ir.reach)}}}}}}function d(){var h={value:null,prev:null,next:null},p={value:null,prev:h,next:null};h.next=p,this.head=h,this.tail=p,this.length=0}function m(h,p,b){var u=p.next,f={value:b,prev:p,next:u};return p.next=f,u.prev=f,h.length++,f}function y(h,p,b){for(var u=p.next,f=0;f<b&&u!==h.tail;f++)u=u.next;p.next=u,u.prev=p,h.length-=f}function $(h){for(var p=[],b=h.head.next;b!==h.tail;)p.push(b.value),b=b.next;return p}if(!n.document)return n.addEventListener&&(o.disableWorkerMessageHandler||n.addEventListener("message",function(h){var p=JSON.parse(h.data),b=p.language,u=p.code,f=p.immediateClose;n.postMessage(o.highlight(u,o.languages[b],b)),f&&n.close()},!1)),o;var _=o.util.currentScript();_&&(o.filename=_.src,_.hasAttribute("data-manual")&&(o.manual=!0));function R(){o.manual||o.highlightAll()}if(!o.manual){var j=document.readyState;j==="loading"||j==="interactive"&&_&&_.defer?document.addEventListener("DOMContentLoaded",R):window.requestAnimationFrame?window.requestAnimationFrame(R):window.setTimeout(R,16)}return o}(e);r.exports&&(r.exports=t),typeof wn<"u"&&(wn.Prism=t)})(xn);var $n=xn.exports;(function(){if(typeof Prism>"u"||typeof document>"u")return;var r="line-numbers",e=/\n(?!$)/g,t=Prism.plugins.lineNumbers={getLine:function(a,o){if(!(a.tagName!=="PRE"||!a.classList.contains(r))){var l=a.querySelector(".line-numbers-rows");if(l){var c=parseInt(a.getAttribute("data-start"),10)||1,g=c+(l.children.length-1);o<c&&(o=c),o>g&&(o=g);var d=o-c;return l.children[d]}}},resize:function(a){n([a])},assumeViewportIndependence:!0};function n(a){if(a=a.filter(function(l){var c=i(l),g=c["white-space"];return g==="pre-wrap"||g==="pre-line"}),a.length!=0){var o=a.map(function(l){var c=l.querySelector("code"),g=l.querySelector(".line-numbers-rows");if(!(!c||!g)){var d=l.querySelector(".line-numbers-sizer"),m=c.textContent.split(e);d||(d=document.createElement("span"),d.className="line-numbers-sizer",c.appendChild(d)),d.innerHTML="0",d.style.display="block";var y=d.getBoundingClientRect().height;return d.innerHTML="",{element:l,lines:m,lineHeights:[],oneLinerHeight:y,sizer:d}}}).filter(Boolean);o.forEach(function(l){var c=l.sizer,g=l.lines,d=l.lineHeights,m=l.oneLinerHeight;d[g.length-1]=void 0,g.forEach(function(y,$){if(y&&y.length>1){var _=c.appendChild(document.createElement("span"));_.style.display="block",_.textContent=y}else d[$]=m})}),o.forEach(function(l){for(var c=l.sizer,g=l.lineHeights,d=0,m=0;m<g.length;m++)g[m]===void 0&&(g[m]=c.children[d++].getBoundingClientRect().height)}),o.forEach(function(l){var c=l.sizer,g=l.element.querySelector(".line-numbers-rows");c.style.display="none",c.innerHTML="",l.lineHeights.forEach(function(d,m){g.children[m].style.height=d+"px"})})}}function i(a){return a?window.getComputedStyle?getComputedStyle(a):a.currentStyle||null:null}var s=void 0;window.addEventListener("resize",function(){t.assumeViewportIndependence&&s===window.innerWidth||(s=window.innerWidth,n(Array.prototype.slice.call(document.querySelectorAll("pre."+r))))}),Prism.hooks.add("complete",function(a){if(a.code){var o=a.element,l=o.parentNode;if(!(!l||!/pre/i.test(l.nodeName))&&!o.querySelector(".line-numbers-rows")&&Prism.util.isActive(o,r)){o.classList.remove(r),l.classList.add(r);var c=a.code.match(e),g=c?c.length+1:1,d,m=new Array(g+1).join("<span></span>");d=document.createElement("span"),d.setAttribute("aria-hidden","true"),d.className="line-numbers-rows",d.innerHTML=m,l.hasAttribute("data-start")&&(l.style.counterReset="linenumber "+(parseInt(l.getAttribute("data-start"),10)-1)),a.element.appendChild(d),n([l]),Prism.hooks.run("line-numbers",a)}}}),Prism.hooks.add("line-numbers",function(a){a.plugins=a.plugins||{},a.plugins.lineNumbers=!0})})(),Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),Prism.languages.js=Prism.languages.javascript,function(r){r.languages.typescript=r.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),r.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete r.languages.typescript.parameter,delete r.languages.typescript["literal-property"];var e=r.languages.extend("typescript",{});delete e["class-name"],r.languages.typescript["class-name"].inside=e,r.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e}}}}),r.languages.ts=r.languages.typescript}(Prism),function(r){function e(F,q){return F.replace(/<<(\d+)>>/g,function(re,W){return"(?:"+q[+W]+")"})}function t(F,q,re){return RegExp(e(F,q),re||"")}function n(F,q){for(var re=0;re<q;re++)F=F.replace(/<<self>>/g,function(){return"(?:"+F+")"});return F.replace(/<<self>>/g,"[^\\s\\S]")}var i={type:"bool byte char decimal double dynamic float int long object sbyte short string uint ulong ushort var void",typeDeclaration:"class enum interface record struct",contextual:"add alias and ascending async await by descending from(?=\\s*(?:\\w|$)) get global group into init(?=\\s*;) join let nameof not notnull on or orderby partial remove select set unmanaged value when where with(?=\\s*{)",other:"abstract as base break case catch checked const continue default delegate do else event explicit extern finally fixed for foreach goto if implicit in internal is lock namespace new null operator out override params private protected public readonly ref return sealed sizeof stackalloc static switch this throw try typeof unchecked unsafe using virtual volatile while yield"};function s(F){return"\\b(?:"+F.trim().replace(/ /g,"|")+")\\b"}var a=s(i.typeDeclaration),o=RegExp(s(i.type+" "+i.typeDeclaration+" "+i.contextual+" "+i.other)),l=s(i.typeDeclaration+" "+i.contextual+" "+i.other),c=s(i.type+" "+i.typeDeclaration+" "+i.other),g=n(/<(?:[^<>;=+\-*/%&|^]|<<self>>)*>/.source,2),d=n(/\((?:[^()]|<<self>>)*\)/.source,2),m=/@?\b[A-Za-z_]\w*\b/.source,y=e(/<<0>>(?:\s*<<1>>)?/.source,[m,g]),$=e(/(?!<<0>>)<<1>>(?:\s*\.\s*<<1>>)*/.source,[l,y]),_=/\[\s*(?:,\s*)*\]/.source,R=e(/<<0>>(?:\s*(?:\?\s*)?<<1>>)*(?:\s*\?)?/.source,[$,_]),j=e(/[^,()<>[\];=+\-*/%&|^]|<<0>>|<<1>>|<<2>>/.source,[g,d,_]),h=e(/\(<<0>>+(?:,<<0>>+)+\)/.source,[j]),p=e(/(?:<<0>>|<<1>>)(?:\s*(?:\?\s*)?<<2>>)*(?:\s*\?)?/.source,[h,$,_]),b={keyword:o,punctuation:/[<>()?,.:[\]]/},u=/'(?:[^\r\n'\\]|\\.|\\[Uux][\da-fA-F]{1,8})'/.source,f=/"(?:\\.|[^\\"\r\n])*"/.source,w=/@"(?:""|\\[\s\S]|[^\\"])*"(?!")/.source;r.languages.csharp=r.languages.extend("clike",{string:[{pattern:t(/(^|[^$\\])<<0>>/.source,[w]),lookbehind:!0,greedy:!0},{pattern:t(/(^|[^@$\\])<<0>>/.source,[f]),lookbehind:!0,greedy:!0}],"class-name":[{pattern:t(/(\busing\s+static\s+)<<0>>(?=\s*;)/.source,[$]),lookbehind:!0,inside:b},{pattern:t(/(\busing\s+<<0>>\s*=\s*)<<1>>(?=\s*;)/.source,[m,p]),lookbehind:!0,inside:b},{pattern:t(/(\busing\s+)<<0>>(?=\s*=)/.source,[m]),lookbehind:!0},{pattern:t(/(\b<<0>>\s+)<<1>>/.source,[a,y]),lookbehind:!0,inside:b},{pattern:t(/(\bcatch\s*\(\s*)<<0>>/.source,[$]),lookbehind:!0,inside:b},{pattern:t(/(\bwhere\s+)<<0>>/.source,[m]),lookbehind:!0},{pattern:t(/(\b(?:is(?:\s+not)?|as)\s+)<<0>>/.source,[R]),lookbehind:!0,inside:b},{pattern:t(/\b<<0>>(?=\s+(?!<<1>>|with\s*\{)<<2>>(?:\s*[=,;:{)\]]|\s+(?:in|when)\b))/.source,[p,c,m]),inside:b}],keyword:o,number:/(?:\b0(?:x[\da-f_]*[\da-f]|b[01_]*[01])|(?:\B\.\d+(?:_+\d+)*|\b\d+(?:_+\d+)*(?:\.\d+(?:_+\d+)*)?)(?:e[-+]?\d+(?:_+\d+)*)?)(?:[dflmu]|lu|ul)?\b/i,operator:/>>=?|<<=?|[-=]>|([-+&|])\1|~|\?\?=?|[-+*/%&|^!=<>]=?/,punctuation:/\?\.?|::|[{}[\];(),.:]/}),r.languages.insertBefore("csharp","number",{range:{pattern:/\.\./,alias:"operator"}}),r.languages.insertBefore("csharp","punctuation",{"named-parameter":{pattern:t(/([(,]\s*)<<0>>(?=\s*:)/.source,[m]),lookbehind:!0,alias:"punctuation"}}),r.languages.insertBefore("csharp","class-name",{namespace:{pattern:t(/(\b(?:namespace|using)\s+)<<0>>(?:\s*\.\s*<<0>>)*(?=\s*[;{])/.source,[m]),lookbehind:!0,inside:{punctuation:/\./}},"type-expression":{pattern:t(/(\b(?:default|sizeof|typeof)\s*\(\s*(?!\s))(?:[^()\s]|\s(?!\s)|<<0>>)*(?=\s*\))/.source,[d]),lookbehind:!0,alias:"class-name",inside:b},"return-type":{pattern:t(/<<0>>(?=\s+(?:<<1>>\s*(?:=>|[({]|\.\s*this\s*\[)|this\s*\[))/.source,[p,$]),inside:b,alias:"class-name"},"constructor-invocation":{pattern:t(/(\bnew\s+)<<0>>(?=\s*[[({])/.source,[p]),lookbehind:!0,inside:b,alias:"class-name"},"generic-method":{pattern:t(/<<0>>\s*<<1>>(?=\s*\()/.source,[m,g]),inside:{function:t(/^<<0>>/.source,[m]),generic:{pattern:RegExp(g),alias:"class-name",inside:b}}},"type-list":{pattern:t(/\b((?:<<0>>\s+<<1>>|record\s+<<1>>\s*<<5>>|where\s+<<2>>)\s*:\s*)(?:<<3>>|<<4>>|<<1>>\s*<<5>>|<<6>>)(?:\s*,\s*(?:<<3>>|<<4>>|<<6>>))*(?=\s*(?:where|[{;]|=>|$))/.source,[a,y,m,p,o.source,d,/\bnew\s*\(\s*\)/.source]),lookbehind:!0,inside:{"record-arguments":{pattern:t(/(^(?!new\s*\()<<0>>\s*)<<1>>/.source,[y,d]),lookbehind:!0,greedy:!0,inside:r.languages.csharp},keyword:o,"class-name":{pattern:RegExp(p),greedy:!0,inside:b},punctuation:/[,()]/}},preprocessor:{pattern:/(^[\t ]*)#.*/m,lookbehind:!0,alias:"property",inside:{directive:{pattern:/(#)\b(?:define|elif|else|endif|endregion|error|if|line|nullable|pragma|region|undef|warning)\b/,lookbehind:!0,alias:"keyword"}}}});var C=f+"|"+u,A=e(/\/(?![*/])|\/\/[^\r\n]*[\r\n]|\/\*(?:[^*]|\*(?!\/))*\*\/|<<0>>/.source,[C]),O=n(e(/[^"'/()]|<<0>>|\(<<self>>*\)/.source,[A]),2),I=/\b(?:assembly|event|field|method|module|param|property|return|type)\b/.source,te=e(/<<0>>(?:\s*\(<<1>>*\))?/.source,[$,O]);r.languages.insertBefore("csharp","class-name",{attribute:{pattern:t(/((?:^|[^\s\w>)?])\s*\[\s*)(?:<<0>>\s*:\s*)?<<1>>(?:\s*,\s*<<1>>)*(?=\s*\])/.source,[I,te]),lookbehind:!0,greedy:!0,inside:{target:{pattern:t(/^<<0>>(?=\s*:)/.source,[I]),alias:"keyword"},"attribute-arguments":{pattern:t(/\(<<0>>*\)/.source,[O]),inside:r.languages.csharp},"class-name":{pattern:RegExp($),inside:{punctuation:/\./}},punctuation:/[:,]/}}});var Ke=/:[^}\r\n]+/.source,ht=n(e(/[^"'/()]|<<0>>|\(<<self>>*\)/.source,[A]),2),Bt=e(/\{(?!\{)(?:(?![}:])<<0>>)*<<1>>?\}/.source,[ht,Ke]),Nt=n(e(/[^"'/()]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|<<0>>|\(<<self>>*\)/.source,[C]),2),ft=e(/\{(?!\{)(?:(?![}:])<<0>>)*<<1>>?\}/.source,[Nt,Ke]);function D(F,q){return{interpolation:{pattern:t(/((?:^|[^{])(?:\{\{)*)<<0>>/.source,[F]),lookbehind:!0,inside:{"format-string":{pattern:t(/(^\{(?:(?![}:])<<0>>)*)<<1>>(?=\}$)/.source,[q,Ke]),lookbehind:!0,inside:{punctuation:/^:/}},punctuation:/^\{|\}$/,expression:{pattern:/[\s\S]+/,alias:"language-csharp",inside:r.languages.csharp}}},string:/[\s\S]+/}}r.languages.insertBefore("csharp","string",{"interpolation-string":[{pattern:t(/(^|[^\\])(?:\$@|@\$)"(?:""|\\[\s\S]|\{\{|<<0>>|[^\\{"])*"/.source,[Bt]),lookbehind:!0,greedy:!0,inside:D(Bt,ht)},{pattern:t(/(^|[^@\\])\$"(?:\\.|\{\{|<<0>>|[^\\"{])*"/.source,[ft]),lookbehind:!0,greedy:!0,inside:D(ft,Nt)}],char:{pattern:RegExp(u),greedy:!0}}),r.languages.dotnet=r.languages.cs=r.languages.csharp}(Prism),function(r){var e=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,t=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+t+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};r.languages.java=r.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+t+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+t+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:e,function:[r.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),r.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),r.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:e,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+t+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+t+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return e.source})),lookbehind:!0,inside:{punctuation:/\./}}})}(Prism),Prism.languages.scala=Prism.languages.extend("java",{"triple-quoted-string":{pattern:/"""[\s\S]*?"""/,greedy:!0,alias:"string"},string:{pattern:/("|')(?:\\.|(?!\1)[^\\\r\n])*\1/,greedy:!0},keyword:/<-|=>|\b(?:abstract|case|catch|class|def|derives|do|else|enum|extends|extension|final|finally|for|forSome|given|if|implicit|import|infix|inline|lazy|match|new|null|object|opaque|open|override|package|private|protected|return|sealed|self|super|this|throw|trait|transparent|try|type|using|val|var|while|with|yield)\b/,number:/\b0x(?:[\da-f]*\.)?[\da-f]+|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e\d+)?[dfl]?/i,builtin:/\b(?:Any|AnyRef|AnyVal|Boolean|Byte|Char|Double|Float|Int|Long|Nothing|Short|String|Unit)\b/,symbol:/'[^\d\s\\]\w*/}),Prism.languages.insertBefore("scala","triple-quoted-string",{"string-interpolation":{pattern:/\b[a-z]\w*(?:"""(?:[^$]|\$(?:[^{]|\{(?:[^{}]|\{[^{}]*\})*\}))*?"""|"(?:[^$"\r\n]|\$(?:[^{]|\{(?:[^{}]|\{[^{}]*\})*\}))*")/i,greedy:!0,inside:{id:{pattern:/^\w+/,greedy:!0,alias:"function"},escape:{pattern:/\\\$"|\$[$"]/,greedy:!0,alias:"symbol"},interpolation:{pattern:/\$(?:\w+|\{(?:[^{}]|\{[^{}]*\})*\})/,greedy:!0,inside:{punctuation:/^\$\{?|\}$/,expression:{pattern:/[\s\S]+/,inside:Prism.languages.scala}}},string:/[\s\S]+/}}}),delete Prism.languages.scala["class-name"],delete Prism.languages.scala.function,delete Prism.languages.scala.constant,function(r){var e=/(?:\r?\n|\r)[ \t]*\|.+\|(?:(?!\|).)*/.source;r.languages.gherkin={pystring:{pattern:/("""|''')[\s\S]+?\1/,alias:"string"},comment:{pattern:/(^[ \t]*)#.*/m,lookbehind:!0},tag:{pattern:/(^[ \t]*)@\S*/m,lookbehind:!0},feature:{pattern:/((?:^|\r?\n|\r)[ \t]*)(?:Ability|Ahoy matey!|Arwedd|Aspekt|Besigheid Behoefte|Business Need|Caracteristica|Característica|Egenskab|Egenskap|Eiginleiki|Feature|Fīča|Fitur|Fonctionnalité|Fonksyonalite|Funcionalidade|Funcionalitat|Functionalitate|Funcţionalitate|Funcționalitate|Functionaliteit|Fungsi|Funkcia|Funkcija|Funkcionalitāte|Funkcionalnost|Funkcja|Funksie|Funktionalität|Funktionalitéit|Funzionalità|Hwaet|Hwæt|Jellemző|Karakteristik|Lastnost|Mak|Mogucnost|laH|Mogućnost|Moznosti|Možnosti|OH HAI|Omadus|Ominaisuus|Osobina|Özellik|Potrzeba biznesowa|perbogh|poQbogh malja'|Požadavek|Požiadavka|Pretty much|Qap|Qu'meH 'ut|Savybė|Tính năng|Trajto|Vermoë|Vlastnosť|Właściwość|Značilnost|Δυνατότητα|Λειτουργία|Могућност|Мөмкинлек|Особина|Свойство|Үзенчәлеклелек|Функционал|Функционалност|Функция|Функціонал|תכונה|خاصية|خصوصیت|صلاحیت|کاروبار کی ضرورت|وِیژگی|रूप लेख|ਖਾਸੀਅਤ|ਨਕਸ਼ ਨੁਹਾਰ|ਮੁਹਾਂਦਰਾ|గుణము|ಹೆಚ್ಚಳ|ความต้องการทางธุรกิจ|ความสามารถ|โครงหลัก|기능|フィーチャ|功能|機能):(?:[^:\r\n]+(?:\r?\n|\r|$))*/,lookbehind:!0,inside:{important:{pattern:/(:)[^\r\n]+/,lookbehind:!0},keyword:/[^:\r\n]+:/}},scenario:{pattern:/(^[ \t]*)(?:Abstract Scenario|Abstrakt Scenario|Achtergrond|Aer|Ær|Agtergrond|All y'all|Antecedentes|Antecedents|Atburðarás|Atburðarásir|Awww, look mate|B4|Background|Baggrund|Bakgrund|Bakgrunn|Bakgrunnur|Beispiele|Beispiller|Bối cảnh|Cefndir|Cenario|Cenário|Cenario de Fundo|Cenário de Fundo|Cenarios|Cenários|Contesto|Context|Contexte|Contexto|Conto|Contoh|Contone|Dæmi|Dasar|Dead men tell no tales|Delineacao do Cenario|Delineação do Cenário|Dis is what went down|Dữ liệu|Dyagram Senaryo|Dyagram senaryo|Egzanp|Ejemplos|Eksempler|Ekzemploj|Enghreifftiau|Esbozo do escenario|Escenari|Escenario|Esempi|Esquema de l'escenari|Esquema del escenario|Esquema do Cenario|Esquema do Cenário|EXAMPLZ|Examples|Exempel|Exemple|Exemples|Exemplos|First off|Fono|Forgatókönyv|Forgatókönyv vázlat|Fundo|Geçmiş|Grundlage|Hannergrond|ghantoH|Háttér|Heave to|Istorik|Juhtumid|Keadaan|Khung kịch bản|Khung tình huống|Kịch bản|Koncept|Konsep skenario|Kontèks|Kontekst|Kontekstas|Konteksts|Kontext|Konturo de la scenaro|Latar Belakang|lut chovnatlh|lut|lutmey|Lýsing Atburðarásar|Lýsing Dæma|MISHUN SRSLY|MISHUN|Menggariskan Senario|mo'|Náčrt Scenára|Náčrt Scénáře|Náčrt Scenáru|Oris scenarija|Örnekler|Osnova|Osnova Scenára|Osnova scénáře|Osnutek|Ozadje|Paraugs|Pavyzdžiai|Példák|Piemēri|Plan du scénario|Plan du Scénario|Plan Senaryo|Plan senaryo|Plang vum Szenario|Pozadí|Pozadie|Pozadina|Príklady|Příklady|Primer|Primeri|Primjeri|Przykłady|Raamstsenaarium|Reckon it's like|Rerefons|Scenár|Scénář|Scenarie|Scenarij|Scenarijai|Scenarijaus šablonas|Scenariji|Scenārijs|Scenārijs pēc parauga|Scenarijus|Scenario|Scénario|Scenario Amlinellol|Scenario Outline|Scenario Template|Scenariomal|Scenariomall|Scenarios|Scenariu|Scenariusz|Scenaro|Schema dello scenario|Se ðe|Se the|Se þe|Senario|Senaryo Deskripsyon|Senaryo deskripsyon|Senaryo|Senaryo taslağı|Shiver me timbers|Situācija|Situai|Situasie Uiteensetting|Situasie|Skenario konsep|Skenario|Skica|Structura scenariu|Structură scenariu|Struktura scenarija|Stsenaarium|Swa hwaer swa|Swa|Swa hwær swa|Szablon scenariusza|Szenario|Szenariogrundriss|Tapaukset|Tapaus|Tapausaihio|Taust|Tausta|Template Keadaan|Template Senario|Template Situai|The thing of it is|Tình huống|Variantai|Voorbeelde|Voorbeelden|Wharrimean is|Yo-ho-ho|You'll wanna|Założenia|Παραδείγματα|Περιγραφή Σεναρίου|Σενάρια|Σενάριο|Υπόβαθρο|Кереш|Контекст|Концепт|Мисаллар|Мисоллар|Основа|Передумова|Позадина|Предистория|Предыстория|Приклади|Пример|Примери|Примеры|Рамка на сценарий|Скица|Структура сценарија|Структура сценария|Структура сценарію|Сценарий|Сценарий структураси|Сценарийның төзелеше|Сценарији|Сценарио|Сценарій|Тарих|Үрнәкләр|דוגמאות|רקע|תבנית תרחיש|תרחיש|الخلفية|الگوی سناریو|امثلة|پس منظر|زمینه|سناریو|سيناريو|سيناريو مخطط|مثالیں|منظر نامے کا خاکہ|منظرنامہ|نمونه ها|उदाहरण|परिदृश्य|परिदृश्य रूपरेखा|पृष्ठभूमि|ਉਦਾਹਰਨਾਂ|ਪਟਕਥਾ|ਪਟਕਥਾ ਢਾਂਚਾ|ਪਟਕਥਾ ਰੂਪ ਰੇਖਾ|ਪਿਛੋਕੜ|ఉదాహరణలు|కథనం|నేపథ్యం|సన్నివేశం|ಉದಾಹರಣೆಗಳು|ಕಥಾಸಾರಾಂಶ|ವಿವರಣೆ|ಹಿನ್ನೆಲೆ|โครงสร้างของเหตุการณ์|ชุดของตัวอย่าง|ชุดของเหตุการณ์|แนวคิด|สรุปเหตุการณ์|เหตุการณ์|배경|시나리오|시나리오 개요|예|サンプル|シナリオ|シナリオアウトライン|シナリオテンプレ|シナリオテンプレート|テンプレ|例|例子|剧本|剧本大纲|劇本|劇本大綱|场景|场景大纲|場景|場景大綱|背景):[^:\r\n]*/m,lookbehind:!0,inside:{important:{pattern:/(:)[^\r\n]*/,lookbehind:!0},keyword:/[^:\r\n]+:/}},"table-body":{pattern:RegExp("("+e+")(?:"+e+")+"),lookbehind:!0,inside:{outline:{pattern:/<[^>]+>/,alias:"variable"},td:{pattern:/\s*[^\s|][^|]*/,alias:"string"},punctuation:/\|/}},"table-head":{pattern:RegExp(e),inside:{th:{pattern:/\s*[^\s|][^|]*/,alias:"variable"},punctuation:/\|/}},atrule:{pattern:/(^[ \t]+)(?:'a|'ach|'ej|7|a|A také|A taktiež|A tiež|A zároveň|Aber|Ac|Adott|Akkor|Ak|Aleshores|Ale|Ali|Allora|Alors|Als|Ama|Amennyiben|Amikor|Ampak|an|AN|Ananging|And y'all|And|Angenommen|Anrhegedig a|An|Apabila|Atès|Atesa|Atunci|Avast!|Aye|A|awer|Bagi|Banjur|Bet|Biết|Blimey!|Buh|But at the end of the day I reckon|But y'all|But|BUT|Cal|Când|Cand|Cando|Ce|Cuando|Če|Ða ðe|Ða|Dadas|Dada|Dados|Dado|DaH ghu' bejlu'|dann|Dann|Dano|Dan|Dar|Dat fiind|Data|Date fiind|Date|Dati fiind|Dati|Daţi fiind|Dați fiind|DEN|Dato|De|Den youse gotta|Dengan|Diberi|Diyelim ki|Donada|Donat|Donitaĵo|Do|Dun|Duota|Ðurh|Eeldades|Ef|Eğer ki|Entao|Então|Entón|E|En|Entonces|Epi|És|Etant donnée|Etant donné|Et|Étant données|Étant donnée|Étant donné|Etant données|Etant donnés|Étant donnés|Fakat|Gangway!|Gdy|Gegeben seien|Gegeben sei|Gegeven|Gegewe|ghu' noblu'|Gitt|Given y'all|Given|Givet|Givun|Ha|Cho|I CAN HAZ|In|Ir|It's just unbelievable|I|Ja|Jeśli|Jeżeli|Kad|Kada|Kadar|Kai|Kaj|Když|Keď|Kemudian|Ketika|Khi|Kiedy|Ko|Kuid|Kui|Kun|Lan|latlh|Le sa a|Let go and haul|Le|Lè sa a|Lè|Logo|Lorsqu'<|Lorsque|mä|Maar|Mais|Mając|Ma|Majd|Maka|Manawa|Mas|Men|Menawa|Mutta|Nalika|Nalikaning|Nanging|Når|När|Nato|Nhưng|Niin|Njuk|O zaman|Och|Og|Oletetaan|Ond|Onda|Oraz|Pak|Pero|Però|Podano|Pokiaľ|Pokud|Potem|Potom|Privzeto|Pryd|Quan|Quand|Quando|qaSDI'|Så|Sed|Se|Siis|Sipoze ke|Sipoze Ke|Sipoze|Si|Şi|Și|Soit|Stel|Tada|Tad|Takrat|Tak|Tapi|Ter|Tetapi|Tha the|Tha|Then y'all|Then|Thì|Thurh|Toda|Too right|Un|Und|ugeholl|Và|vaj|Vendar|Ve|wann|Wanneer|WEN|Wenn|When y'all|When|Wtedy|Wun|Y'know|Yeah nah|Yna|Youse know like when|Youse know when youse got|Y|Za predpokladu|Za předpokladu|Zadan|Zadani|Zadano|Zadate|Zadato|Zakładając|Zaradi|Zatati|Þa þe|Þa|Þá|Þegar|Þurh|Αλλά|Δεδομένου|Και|Όταν|Τότε|А також|Агар|Але|Али|Аммо|А|Әгәр|Әйтик|Әмма|Бирок|Ва|Вә|Дадено|Дано|Допустим|Если|Задате|Задати|Задато|И|І|К тому же|Када|Кад|Когато|Когда|Коли|Ләкин|Лекин|Нәтиҗәдә|Нехай|Но|Онда|Припустимо, що|Припустимо|Пусть|Также|Та|Тогда|Тоді|То|Унда|Һәм|Якщо|אבל|אזי|אז|בהינתן|וגם|כאשר|آنگاه|اذاً|اگر|اما|اور|با فرض|بالفرض|بفرض|پھر|تب|ثم|جب|عندما|فرض کیا|لكن|لیکن|متى|هنگامی|و|अगर|और|कदा|किन्तु|चूंकि|जब|तथा|तदा|तब|परन्तु|पर|यदि|ਅਤੇ|ਜਦੋਂ|ਜਿਵੇਂ ਕਿ|ਜੇਕਰ|ਤਦ|ਪਰ|అప్పుడు|ఈ పరిస్థితిలో|కాని|చెప్పబడినది|మరియు|ಆದರೆ|ನಂತರ|ನೀಡಿದ|ಮತ್ತು|ಸ್ಥಿತಿಯನ್ನು|กำหนดให้|ดังนั้น|แต่|เมื่อ|และ|그러면<|그리고<|단<|만약<|만일<|먼저<|조건<|하지만<|かつ<|しかし<|ただし<|ならば<|もし<|並且<|但し<|但是<|假如<|假定<|假設<|假设<|前提<|同时<|同時<|并且<|当<|當<|而且<|那么<|那麼<)(?=[ \t])/m,lookbehind:!0},string:{pattern:/"(?:\\.|[^"\\\r\n])*"|'(?:\\.|[^'\\\r\n])*'/,inside:{outline:{pattern:/<[^>]+>/,alias:"variable"}}},outline:{pattern:/<[^>]+>/,alias:"variable"}}}(Prism),Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity,Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup,Prism.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(e,t){var n={};n["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[t]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var i={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};i["language-"+t]={pattern:/[\s\S]+/,inside:Prism.languages[t]};var s={};s[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return e}),"i"),lookbehind:!0,greedy:!0,inside:i},Prism.languages.insertBefore("markup","cdata",s)}}),Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(r,e){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[e,"language-"+e],inside:Prism.languages[e]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),Prism.languages.html=Prism.languages.markup,Prism.languages.mathml=Prism.languages.markup,Prism.languages.svg=Prism.languages.markup,Prism.languages.xml=Prism.languages.extend("markup",{}),Prism.languages.ssml=Prism.languages.xml,Prism.languages.atom=Prism.languages.xml,Prism.languages.rss=Prism.languages.xml,function(r){function e(t,n){return"___"+t.toUpperCase()+n+"___"}Object.defineProperties(r.languages["markup-templating"]={},{buildPlaceholders:{value:function(t,n,i,s){if(t.language===n){var a=t.tokenStack=[];t.code=t.code.replace(i,function(o){if(typeof s=="function"&&!s(o))return o;for(var l=a.length,c;t.code.indexOf(c=e(n,l))!==-1;)++l;return a[l]=o,c}),t.grammar=r.languages.markup}}},tokenizePlaceholders:{value:function(t,n){if(t.language!==n||!t.tokenStack)return;t.grammar=r.languages[n];var i=0,s=Object.keys(t.tokenStack);function a(o){for(var l=0;l<o.length&&!(i>=s.length);l++){var c=o[l];if(typeof c=="string"||c.content&&typeof c.content=="string"){var g=s[i],d=t.tokenStack[g],m=typeof c=="string"?c:c.content,y=e(n,g),$=m.indexOf(y);if($>-1){++i;var _=m.substring(0,$),R=new r.Token(n,r.tokenize(d,t.grammar),"language-"+n,d),j=m.substring($+y.length),h=[];_&&h.push.apply(h,a([_])),h.push(R),j&&h.push.apply(h,a([j])),typeof c=="string"?o.splice.apply(o,[l,1].concat(h)):c.content=h}}else c.content&&a(c.content)}return o}a(t.tokens)}}})}(Prism),function(r){var e=/\/\*[\s\S]*?\*\/|\/\/.*|#(?!\[).*/,t=[{pattern:/\b(?:false|true)\b/i,alias:"boolean"},{pattern:/(::\s*)\b[a-z_]\w*\b(?!\s*\()/i,greedy:!0,lookbehind:!0},{pattern:/(\b(?:case|const)\s+)\b[a-z_]\w*(?=\s*[;=])/i,greedy:!0,lookbehind:!0},/\b(?:null)\b/i,/\b[A-Z_][A-Z0-9_]*\b(?!\s*\()/],n=/\b0b[01]+(?:_[01]+)*\b|\b0o[0-7]+(?:_[0-7]+)*\b|\b0x[\da-f]+(?:_[\da-f]+)*\b|(?:\b\d+(?:_\d+)*\.?(?:\d+(?:_\d+)*)?|\B\.\d+)(?:e[+-]?\d+)?/i,i=/<?=>|\?\?=?|\.{3}|\??->|[!=]=?=?|::|\*\*=?|--|\+\+|&&|\|\||<<|>>|[?~]|[/^|%*&<>.+-]=?/,s=/[{}\[\](),:;]/;r.languages.php={delimiter:{pattern:/\?>$|^<\?(?:php(?=\s)|=)?/i,alias:"important"},comment:e,variable:/\$+(?:\w+\b|(?=\{))/,package:{pattern:/(namespace\s+|use\s+(?:function\s+)?)(?:\\?\b[a-z_]\w*)+\b(?!\\)/i,lookbehind:!0,inside:{punctuation:/\\/}},"class-name-definition":{pattern:/(\b(?:class|enum|interface|trait)\s+)\b[a-z_]\w*(?!\\)\b/i,lookbehind:!0,alias:"class-name"},"function-definition":{pattern:/(\bfunction\s+)[a-z_]\w*(?=\s*\()/i,lookbehind:!0,alias:"function"},keyword:[{pattern:/(\(\s*)\b(?:array|bool|boolean|float|int|integer|object|string)\b(?=\s*\))/i,alias:"type-casting",greedy:!0,lookbehind:!0},{pattern:/([(,?]\s*)\b(?:array(?!\s*\()|bool|callable|(?:false|null)(?=\s*\|)|float|int|iterable|mixed|object|self|static|string)\b(?=\s*\$)/i,alias:"type-hint",greedy:!0,lookbehind:!0},{pattern:/(\)\s*:\s*(?:\?\s*)?)\b(?:array(?!\s*\()|bool|callable|(?:false|null)(?=\s*\|)|float|int|iterable|mixed|never|object|self|static|string|void)\b/i,alias:"return-type",greedy:!0,lookbehind:!0},{pattern:/\b(?:array(?!\s*\()|bool|float|int|iterable|mixed|object|string|void)\b/i,alias:"type-declaration",greedy:!0},{pattern:/(\|\s*)(?:false|null)\b|\b(?:false|null)(?=\s*\|)/i,alias:"type-declaration",greedy:!0,lookbehind:!0},{pattern:/\b(?:parent|self|static)(?=\s*::)/i,alias:"static-context",greedy:!0},{pattern:/(\byield\s+)from\b/i,lookbehind:!0},/\bclass\b/i,{pattern:/((?:^|[^\s>:]|(?:^|[^-])>|(?:^|[^:]):)\s*)\b(?:abstract|and|array|as|break|callable|case|catch|clone|const|continue|declare|default|die|do|echo|else|elseif|empty|enddeclare|endfor|endforeach|endif|endswitch|endwhile|enum|eval|exit|extends|final|finally|fn|for|foreach|function|global|goto|if|implements|include|include_once|instanceof|insteadof|interface|isset|list|match|namespace|never|new|or|parent|print|private|protected|public|readonly|require|require_once|return|self|static|switch|throw|trait|try|unset|use|var|while|xor|yield|__halt_compiler)\b/i,lookbehind:!0}],"argument-name":{pattern:/([(,]\s*)\b[a-z_]\w*(?=\s*:(?!:))/i,lookbehind:!0},"class-name":[{pattern:/(\b(?:extends|implements|instanceof|new(?!\s+self|\s+static))\s+|\bcatch\s*\()\b[a-z_]\w*(?!\\)\b/i,greedy:!0,lookbehind:!0},{pattern:/(\|\s*)\b[a-z_]\w*(?!\\)\b/i,greedy:!0,lookbehind:!0},{pattern:/\b[a-z_]\w*(?!\\)\b(?=\s*\|)/i,greedy:!0},{pattern:/(\|\s*)(?:\\?\b[a-z_]\w*)+\b/i,alias:"class-name-fully-qualified",greedy:!0,lookbehind:!0,inside:{punctuation:/\\/}},{pattern:/(?:\\?\b[a-z_]\w*)+\b(?=\s*\|)/i,alias:"class-name-fully-qualified",greedy:!0,inside:{punctuation:/\\/}},{pattern:/(\b(?:extends|implements|instanceof|new(?!\s+self\b|\s+static\b))\s+|\bcatch\s*\()(?:\\?\b[a-z_]\w*)+\b(?!\\)/i,alias:"class-name-fully-qualified",greedy:!0,lookbehind:!0,inside:{punctuation:/\\/}},{pattern:/\b[a-z_]\w*(?=\s*\$)/i,alias:"type-declaration",greedy:!0},{pattern:/(?:\\?\b[a-z_]\w*)+(?=\s*\$)/i,alias:["class-name-fully-qualified","type-declaration"],greedy:!0,inside:{punctuation:/\\/}},{pattern:/\b[a-z_]\w*(?=\s*::)/i,alias:"static-context",greedy:!0},{pattern:/(?:\\?\b[a-z_]\w*)+(?=\s*::)/i,alias:["class-name-fully-qualified","static-context"],greedy:!0,inside:{punctuation:/\\/}},{pattern:/([(,?]\s*)[a-z_]\w*(?=\s*\$)/i,alias:"type-hint",greedy:!0,lookbehind:!0},{pattern:/([(,?]\s*)(?:\\?\b[a-z_]\w*)+(?=\s*\$)/i,alias:["class-name-fully-qualified","type-hint"],greedy:!0,lookbehind:!0,inside:{punctuation:/\\/}},{pattern:/(\)\s*:\s*(?:\?\s*)?)\b[a-z_]\w*(?!\\)\b/i,alias:"return-type",greedy:!0,lookbehind:!0},{pattern:/(\)\s*:\s*(?:\?\s*)?)(?:\\?\b[a-z_]\w*)+\b(?!\\)/i,alias:["class-name-fully-qualified","return-type"],greedy:!0,lookbehind:!0,inside:{punctuation:/\\/}}],constant:t,function:{pattern:/(^|[^\\\w])\\?[a-z_](?:[\w\\]*\w)?(?=\s*\()/i,lookbehind:!0,inside:{punctuation:/\\/}},property:{pattern:/(->\s*)\w+/,lookbehind:!0},number:n,operator:i,punctuation:s};var a={pattern:/\{\$(?:\{(?:\{[^{}]+\}|[^{}]+)\}|[^{}])+\}|(^|[^\\{])\$+(?:\w+(?:\[[^\r\n\[\]]+\]|->\w+)?)/,lookbehind:!0,inside:r.languages.php},o=[{pattern:/<<<'([^']+)'[\r\n](?:.*[\r\n])*?\1;/,alias:"nowdoc-string",greedy:!0,inside:{delimiter:{pattern:/^<<<'[^']+'|[a-z_]\w*;$/i,alias:"symbol",inside:{punctuation:/^<<<'?|[';]$/}}}},{pattern:/<<<(?:"([^"]+)"[\r\n](?:.*[\r\n])*?\1;|([a-z_]\w*)[\r\n](?:.*[\r\n])*?\2;)/i,alias:"heredoc-string",greedy:!0,inside:{delimiter:{pattern:/^<<<(?:"[^"]+"|[a-z_]\w*)|[a-z_]\w*;$/i,alias:"symbol",inside:{punctuation:/^<<<"?|[";]$/}},interpolation:a}},{pattern:/`(?:\\[\s\S]|[^\\`])*`/,alias:"backtick-quoted-string",greedy:!0},{pattern:/'(?:\\[\s\S]|[^\\'])*'/,alias:"single-quoted-string",greedy:!0},{pattern:/"(?:\\[\s\S]|[^\\"])*"/,alias:"double-quoted-string",greedy:!0,inside:{interpolation:a}}];r.languages.insertBefore("php","variable",{string:o,attribute:{pattern:/#\[(?:[^"'\/#]|\/(?![*/])|\/\/.*$|#(?!\[).*$|\/\*(?:[^*]|\*(?!\/))*\*\/|"(?:\\[\s\S]|[^\\"])*"|'(?:\\[\s\S]|[^\\'])*')+\](?=\s*[a-z$#])/im,greedy:!0,inside:{"attribute-content":{pattern:/^(#\[)[\s\S]+(?=\]$)/,lookbehind:!0,inside:{comment:e,string:o,"attribute-class-name":[{pattern:/([^:]|^)\b[a-z_]\w*(?!\\)\b/i,alias:"class-name",greedy:!0,lookbehind:!0},{pattern:/([^:]|^)(?:\\?\b[a-z_]\w*)+/i,alias:["class-name","class-name-fully-qualified"],greedy:!0,lookbehind:!0,inside:{punctuation:/\\/}}],constant:t,number:n,operator:i,punctuation:s}},delimiter:{pattern:/^#\[|\]$/,alias:"punctuation"}}}}),r.hooks.add("before-tokenize",function(l){if(/<\?/.test(l.code)){var c=/<\?(?:[^"'/#]|\/(?![*/])|("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|(?:\/\/|#(?!\[))(?:[^?\n\r]|\?(?!>))*(?=$|\?>|[\r\n])|#\[|\/\*(?:[^*]|\*(?!\/))*(?:\*\/|$))*?(?:\?>|$)/g;r.languages["markup-templating"].buildPlaceholders(l,"php",c)}}),r.hooks.add("after-tokenize",function(l){r.languages["markup-templating"].tokenizePlaceholders(l,"php")})}(Prism);const kn="(if|else if|await|then|catch|each|html|debug)";Prism.languages.svelte=Prism.languages.extend("markup",{each:{pattern:new RegExp("{[#/]each(?:(?:\\{(?:(?:\\{(?:[^{}])*\\})|(?:[^{}]))*\\})|(?:[^{}]))*}"),inside:{"language-javascript":[{pattern:/(as[\s\S]*)\([\s\S]*\)(?=\s*\})/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(as[\s]*)[\s\S]*(?=\s*)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(#each[\s]*)[\s\S]*(?=as)/,lookbehind:!0,inside:Prism.languages.javascript}],keyword:/[#/]each|as/,punctuation:/{|}/}},block:{pattern:new RegExp("{[#:/@]/s"+kn+"(?:(?:\\{(?:(?:\\{(?:[^{}])*\\})|(?:[^{}]))*\\})|(?:[^{}]))*}"),inside:{punctuation:/^{|}$/,keyword:[new RegExp("[#:/@]"+kn+"( )*"),/as/,/then/],"language-javascript":{pattern:/[\s\S]*/,inside:Prism.languages.javascript}}},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?:"[^"]*"|'[^']*'|{[\s\S]+?}(?=[\s/>])))|(?=[\s/>])))+)?\s*\/?>/i,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"language-javascript":{pattern:/\{(?:(?:\{(?:(?:\{(?:[^{}])*\})|(?:[^{}]))*\})|(?:[^{}]))*\}/,inside:Prism.languages.javascript},"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/i,inside:{punctuation:[/^=/,{pattern:/^(\s*)["']|["']$/,lookbehind:!0}],"language-javascript":{pattern:/{[\s\S]+}/,inside:Prism.languages.javascript}}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},"language-javascript":{pattern:/\{(?:(?:\{(?:(?:\{(?:[^{}])*\})|(?:[^{}]))*\})|(?:[^{}]))*\}/,lookbehind:!0,inside:Prism.languages.javascript}}),Prism.languages.svelte.tag.inside["attr-value"].inside.entity=Prism.languages.svelte.entity,Prism.hooks.add("wrap",r=>{r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(Prism.languages.svelte.tag,"addInlined",{value:function(e,t){const n={};n["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[t]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;const i={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};i["language-"+t]={pattern:/[\s\S]+/,inside:Prism.languages[t]};const s={};s[e]={pattern:RegExp(/(<__[\s\S]*?>)(?:<!\[CDATA\[[\s\S]*?\]\]>\s*|[\s\S])*?(?=<\/__>)/.source.replace(/__/g,e),"i"),lookbehind:!0,greedy:!0,inside:i},Prism.languages.insertBefore("svelte","cdata",s)}}),Prism.languages.svelte.tag.addInlined("style","css"),Prism.languages.svelte.tag.addInlined("script","javascript"),function(){typeof Prism>"u"||typeof document>"u"||!document.createRange||(Prism.plugins.KeepMarkup=!0,Prism.hooks.add("before-highlight",function(r){if(!r.element.children.length||!Prism.util.isActive(r.element,"keep-markup",!0))return;var e=Prism.util.isActive(r.element,"drop-tokens",!1);function t(o){return!(e&&o.nodeName.toLowerCase()==="span"&&o.classList.contains("token"))}var n=0,i=[];function s(o){if(!t(o)){a(o);return}var l={element:o,posOpen:n};i.push(l),a(o),l.posClose=n}function a(o){for(var l=0,c=o.childNodes.length;l<c;l++){var g=o.childNodes[l];g.nodeType===1?s(g):g.nodeType===3&&(n+=g.data.length)}}a(r.element),i.length&&(r.keepMarkup=i)}),Prism.hooks.add("after-highlight",function(r){if(r.keepMarkup&&r.keepMarkup.length){var e=function(t,n){for(var i=0,s=t.childNodes.length;i<s;i++){var a=t.childNodes[i];if(a.nodeType===1){if(!e(a,n))return!1}else a.nodeType===3&&(!n.nodeStart&&n.pos+a.data.length>n.node.posOpen&&(n.nodeStart=a,n.nodeStartPos=n.node.posOpen-n.pos),n.nodeStart&&n.pos+a.data.length>=n.node.posClose&&(n.nodeEnd=a,n.nodeEndPos=n.node.posClose-n.pos),n.pos+=a.data.length);if(n.nodeStart&&n.nodeEnd){var o=document.createRange();return o.setStart(n.nodeStart,n.nodeStartPos),o.setEnd(n.nodeEnd,n.nodeEndPos),n.node.element.innerHTML="",n.node.element.appendChild(o.extractContents()),o.insertNode(n.node.element),o.detach(),!1}}return!0};r.keepMarkup.forEach(function(t){e(r.element,{node:t,pos:0})}),r.highlightedCode=r.element.innerHTML}}))}();const H=V(vs),_n=V(ys),xs=V(ws);var er=function(r,e){return er=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},er(r,e)};function de(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");er(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function $s(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(g){try{c(n.next(g))}catch(d){a(d)}}function l(g){try{c(n.throw(g))}catch(d){a(d)}}function c(g){g.done?s(g.value):i(g.value).then(o,l)}c((n=n.apply(r,e||[])).next())})}function An(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(c){return function(g){return l([c,g])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(t=0)),t;)try{if(n=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(g){c=[6,g],i=0}finally{n=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function De(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function pe(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return s}function $e(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return r.concat(s||Array.prototype.slice.call(e))}function Be(r){return this instanceof Be?(this.v=r,this):new Be(r)}function ks(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(m){n[m]&&(i[m]=function(y){return new Promise(function($,_){s.push([m,y,$,_])>1||o(m,y)})})}function o(m,y){try{l(n[m](y))}catch($){d(s[0][3],$)}}function l(m){m.value instanceof Be?Promise.resolve(m.value.v).then(c,g):d(s[0][2],m)}function c(m){o("next",m)}function g(m){o("throw",m)}function d(m,y){m(y),s.shift(),s.length&&o(s[0][0],s[0][1])}}function _s(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof De=="function"?De(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(a){return new Promise(function(o,l){a=r[s](a),i(o,l,a.done,a.value)})}}function i(s,a,o,l){Promise.resolve(l).then(function(c){s({value:c,done:o})},a)}}typeof SuppressedError=="function"&&SuppressedError;function T(r){return typeof r=="function"}function Sn(r){var e=function(n){Error.call(n),n.stack=new Error().stack},t=r(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var tr=Sn(function(r){return function(t){r(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function yt(r,e){if(r){var t=r.indexOf(e);0<=t&&r.splice(t,1)}}var Ne=function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var e,t,n,i,s;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=De(a),l=o.next();!l.done;l=o.next()){var c=l.value;c.remove(this)}}catch(_){e={error:_}}finally{try{l&&!l.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var g=this.initialTeardown;if(T(g))try{g()}catch(_){s=_ instanceof tr?_.errors:[_]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var m=De(d),y=m.next();!y.done;y=m.next()){var $=y.value;try{Mn($)}catch(_){s=s??[],_ instanceof tr?s=$e($e([],pe(s)),pe(_.errors)):s.push(_)}}}catch(_){n={error:_}}finally{try{y&&!y.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}}if(s)throw new tr(s)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)Mn(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&yt(t,e)},r.prototype.remove=function(e){var t=this._finalizers;t&&yt(t,e),e instanceof r&&e._removeParent(this)},r.EMPTY=function(){var e=new r;return e.closed=!0,e}(),r}(),Cn=Ne.EMPTY;function En(r){return r instanceof Ne||r&&"closed"in r&&T(r.remove)&&T(r.add)&&T(r.unsubscribe)}function Mn(r){T(r)?r():r.unsubscribe()}var Tn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},rr={setTimeout:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var i=rr.delegate;return i!=null&&i.setTimeout?i.setTimeout.apply(i,$e([r,e],pe(t))):setTimeout.apply(void 0,$e([r,e],pe(t)))},clearTimeout:function(r){var e=rr.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(r)},delegate:void 0};function Pn(r){rr.setTimeout(function(){throw r})}function nr(){}function wt(r){r()}var ir=function(r){de(e,r);function e(t){var n=r.call(this)||this;return n.isStopped=!1,t?(n.destination=t,En(t)&&t.add(n)):n.destination=Es,n}return e.create=function(t,n,i){return new ar(t,n,i)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Ne),As=Function.prototype.bind;function sr(r,e){return As.call(r,e)}var Ss=function(){function r(e){this.partialObserver=e}return r.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){xt(n)}},r.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){xt(n)}else xt(e)},r.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){xt(t)}},r}(),ar=function(r){de(e,r);function e(t,n,i){var s=r.call(this)||this,a;if(T(t)||!t)a={next:t??void 0,error:n??void 0,complete:i??void 0};else{var o;s&&Tn.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=function(){return s.unsubscribe()},a={next:t.next&&sr(t.next,o),error:t.error&&sr(t.error,o),complete:t.complete&&sr(t.complete,o)}):a=t}return s.destination=new Ss(a),s}return e}(ir);function xt(r){Pn(r)}function Cs(r){throw r}var Es={closed:!0,next:nr,error:Cs,complete:nr},or=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function lr(r){return r}function Ms(r){return r.length===0?lr:r.length===1?r[0]:function(t){return r.reduce(function(n,i){return i(n)},t)}}var K=function(){function r(e){e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var i=this,s=Ps(e)?e:new ar(e,t,n);return wt(function(){var a=i,o=a.operator,l=a.source;s.add(o?o.call(s,l):l?i._subscribe(s):i._trySubscribe(s))}),s},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},r.prototype.forEach=function(e,t){var n=this;return t=Fn(t),new t(function(i,s){var a=new ar({next:function(o){try{e(o)}catch(l){s(l),a.unsubscribe()}},error:s,complete:i});n.subscribe(a)})},r.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},r.prototype[or]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ms(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=Fn(e),new e(function(n,i){var s;t.subscribe(function(a){return s=a},function(a){return i(a)},function(){return n(s)})})},r.create=function(e){return new r(e)},r}();function Fn(r){var e;return(e=r??Tn.Promise)!==null&&e!==void 0?e:Promise}function Ts(r){return r&&T(r.next)&&T(r.error)&&T(r.complete)}function Ps(r){return r&&r instanceof ir||Ts(r)&&En(r)}function Fs(r){return T(r==null?void 0:r.lift)}function Le(r){return function(e){if(Fs(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function ke(r,e,t,n,i){return new zs(r,e,t,n,i)}var zs=function(r){de(e,r);function e(t,n,i,s,a,o){var l=r.call(this,t)||this;return l.onFinalize=a,l.shouldUnsubscribe=o,l._next=n?function(c){try{n(c)}catch(g){t.error(g)}}:r.prototype._next,l._error=s?function(c){try{s(c)}catch(g){t.error(g)}finally{this.unsubscribe()}}:r.prototype._error,l._complete=i?function(){try{i()}catch(c){t.error(c)}finally{this.unsubscribe()}}:r.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(ir),Os=Sn(function(r){return function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),zn=function(r){de(e,r);function e(){var t=r.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var n=new On(this,this);return n.operator=t,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new Os},e.prototype.next=function(t){var n=this;wt(function(){var i,s;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var a=De(n.currentObservers),o=a.next();!o.done;o=a.next()){var l=o.value;l.next(t)}}catch(c){i={error:c}}finally{try{o&&!o.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}}})},e.prototype.error=function(t){var n=this;wt(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var i=n.observers;i.length;)i.shift().error(t)}})},e.prototype.complete=function(){var t=this;wt(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var n=this,i=this,s=i.hasError,a=i.isStopped,o=i.observers;return s||a?Cn:(this.currentObservers=null,o.push(t),new Ne(function(){n.currentObservers=null,yt(o,t)}))},e.prototype._checkFinalizedStatuses=function(t){var n=this,i=n.hasError,s=n.thrownError,a=n.isStopped;i?t.error(s):a&&t.complete()},e.prototype.asObservable=function(){var t=new K;return t.source=this,t},e.create=function(t,n){return new On(t,n)},e}(K),On=function(r){de(e,r);function e(t,n){var i=r.call(this)||this;return i.destination=t,i.source=n,i}return e.prototype.next=function(t){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,t)},e.prototype.error=function(t){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,t)},e.prototype.complete=function(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)},e.prototype._subscribe=function(t){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&i!==void 0?i:Cn},e}(zn),Rn={now:function(){return(Rn.delegate||Date).now()},delegate:void 0},Rs=function(r){de(e,r);function e(t,n){return r.call(this)||this}return e.prototype.schedule=function(t,n){return this},e}(Ne),$t={setInterval:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var i=$t.delegate;return i!=null&&i.setInterval?i.setInterval.apply(i,$e([r,e],pe(t))):setInterval.apply(void 0,$e([r,e],pe(t)))},clearInterval:function(r){var e=$t.delegate;return((e==null?void 0:e.clearInterval)||clearInterval)(r)},delegate:void 0},js=function(r){de(e,r);function e(t,n){var i=r.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.pending=!1,i}return e.prototype.schedule=function(t,n){var i;if(n===void 0&&(n=0),this.closed)return this;this.state=t;var s=this.id,a=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(a,s,n)),this.pending=!0,this.delay=n,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(a,this.id,n),this},e.prototype.requestAsyncId=function(t,n,i){return i===void 0&&(i=0),$t.setInterval(t.flush.bind(t,this),i)},e.prototype.recycleAsyncId=function(t,n,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return n;n!=null&&$t.clearInterval(n)},e.prototype.execute=function(t,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,n);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,n){var i=!1,s;try{this.work(t)}catch(a){i=!0,s=a||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),s},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,n=t.id,i=t.scheduler,s=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,yt(s,this),n!=null&&(this.id=this.recycleAsyncId(i,n,null)),this.delay=null,r.prototype.unsubscribe.call(this)}},e}(Rs),jn=function(){function r(e,t){t===void 0&&(t=r.now),this.schedulerActionCtor=e,this.now=t}return r.prototype.schedule=function(e,t,n){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},r.now=Rn.now,r}(),Is=function(r){de(e,r);function e(t,n){n===void 0&&(n=jn.now);var i=r.call(this,t,n)||this;return i.actions=[],i._active=!1,i}return e.prototype.flush=function(t){var n=this.actions;if(this._active){n.push(t);return}var i;this._active=!0;do if(i=t.execute(t.state,t.delay))break;while(t=n.shift());if(this._active=!1,i){for(;t=n.shift();)t.unsubscribe();throw i}},e}(jn),cr=new Is(js),Ds=cr,Bs=new K(function(r){return r.complete()});function In(r){return r&&T(r.schedule)}function Dn(r){return r[r.length-1]}function Bn(r){return In(Dn(r))?r.pop():void 0}function Ns(r,e){return typeof Dn(r)=="number"?r.pop():e}var ur=function(r){return r&&typeof r.length=="number"&&typeof r!="function"};function Nn(r){return T(r==null?void 0:r.then)}function Ln(r){return T(r[or])}function Un(r){return Symbol.asyncIterator&&T(r==null?void 0:r[Symbol.asyncIterator])}function Hn(r){return new TypeError("You provided "+(r!==null&&typeof r=="object"?"an invalid object":"'"+r+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Ls(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Kn=Ls();function qn(r){return T(r==null?void 0:r[Kn])}function Vn(r){return ks(this,arguments,function(){var t,n,i,s;return An(this,function(a){switch(a.label){case 0:t=r.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,Be(t.read())];case 3:return n=a.sent(),i=n.value,s=n.done,s?[4,Be(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,Be(i)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Wn(r){return T(r==null?void 0:r.getReader)}function he(r){if(r instanceof K)return r;if(r!=null){if(Ln(r))return Us(r);if(ur(r))return Hs(r);if(Nn(r))return Ks(r);if(Un(r))return Zn(r);if(qn(r))return qs(r);if(Wn(r))return Vs(r)}throw Hn(r)}function Us(r){return new K(function(e){var t=r[or]();if(T(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Hs(r){return new K(function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}function Ks(r){return new K(function(e){r.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,Pn)})}function qs(r){return new K(function(e){var t,n;try{for(var i=De(r),s=i.next();!s.done;s=i.next()){var a=s.value;if(e.next(a),e.closed)return}}catch(o){t={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}e.complete()})}function Zn(r){return new K(function(e){Ws(r,e).catch(function(t){return e.error(t)})})}function Vs(r){return Zn(Vn(r))}function Ws(r,e){var t,n,i,s;return $s(this,void 0,void 0,function(){var a,o;return An(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=_s(r),l.label=1;case 1:return[4,t.next()];case 2:if(n=l.sent(),!!n.done)return[3,4];if(a=n.value,e.next(a),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),i={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),n&&!n.done&&(s=t.return)?[4,s.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function fe(r,e,t,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var s=e.schedule(function(){t(),i?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(s),!i)return s}function Gn(r,e){return e===void 0&&(e=0),Le(function(t,n){t.subscribe(ke(n,function(i){return fe(n,r,function(){return n.next(i)},e)},function(){return fe(n,r,function(){return n.complete()},e)},function(i){return fe(n,r,function(){return n.error(i)},e)}))})}function Yn(r,e){return e===void 0&&(e=0),Le(function(t,n){n.add(r.schedule(function(){return t.subscribe(n)},e))})}function Zs(r,e){return he(r).pipe(Yn(e),Gn(e))}function Gs(r,e){return he(r).pipe(Yn(e),Gn(e))}function Ys(r,e){return new K(function(t){var n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}function Js(r,e){return new K(function(t){var n;return fe(t,e,function(){n=r[Kn](),fe(t,e,function(){var i,s,a;try{i=n.next(),s=i.value,a=i.done}catch(o){t.error(o);return}a?t.complete():t.next(s)},0,!0)}),function(){return T(n==null?void 0:n.return)&&n.return()}})}function Jn(r,e){if(!r)throw new Error("Iterable cannot be null");return new K(function(t){fe(t,e,function(){var n=r[Symbol.asyncIterator]();fe(t,e,function(){n.next().then(function(i){i.done?t.complete():t.next(i.value)})},0,!0)})})}function Qs(r,e){return Jn(Vn(r),e)}function Xs(r,e){if(r!=null){if(Ln(r))return Zs(r,e);if(ur(r))return Ys(r,e);if(Nn(r))return Gs(r,e);if(Un(r))return Jn(r,e);if(qn(r))return Js(r,e);if(Wn(r))return Qs(r,e)}throw Hn(r)}function Qn(r,e){return e?Xs(r,e):he(r)}function ea(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=Bn(r);return Qn(r,t)}function ta(r){return r instanceof Date&&!isNaN(r)}function dr(r,e){return Le(function(t,n){var i=0;t.subscribe(ke(n,function(s){n.next(r.call(e,s,i++))}))})}var ra=Array.isArray;function na(r,e){return ra(e)?r.apply(void 0,$e([],pe(e))):r(e)}function ia(r){return dr(function(e){return na(r,e)})}function sa(r,e,t,n,i,s,a,o){var l=[],c=0,g=0,d=!1,m=function(){d&&!l.length&&!c&&e.complete()},y=function(_){return c<n?$(_):l.push(_)},$=function(_){s&&e.next(_),c++;var R=!1;he(t(_,g++)).subscribe(ke(e,function(j){i==null||i(j),s?y(j):e.next(j)},function(){R=!0},void 0,function(){if(R)try{c--;for(var j=function(){var h=l.shift();a?fe(e,a,function(){return $(h)}):$(h)};l.length&&c<n;)j();m()}catch(h){e.error(h)}}))};return r.subscribe(ke(e,y,function(){d=!0,m()})),function(){o==null||o()}}function pr(r,e,t){return t===void 0&&(t=1/0),T(e)?pr(function(n,i){return dr(function(s,a){return e(n,s,i,a)})(he(r(n,i)))},t):(typeof e=="number"&&(t=e),Le(function(n,i){return sa(n,i,r,t)}))}function aa(r){return r===void 0&&(r=1/0),pr(lr,r)}var oa=["addListener","removeListener"],la=["addEventListener","removeEventListener"],ca=["on","off"];function Xe(r,e,t,n){if(T(t)&&(n=t,t=void 0),n)return Xe(r,e,t).pipe(ia(n));var i=pe(pa(r)?la.map(function(o){return function(l){return r[o](e,l,t)}}):ua(r)?oa.map(Xn(r,e)):da(r)?ca.map(Xn(r,e)):[],2),s=i[0],a=i[1];if(!s&&ur(r))return pr(function(o){return Xe(o,e,t)})(he(r));if(!s)throw new TypeError("Invalid event target");return new K(function(o){var l=function(){for(var c=[],g=0;g<arguments.length;g++)c[g]=arguments[g];return o.next(1<c.length?c:c[0])};return s(l),function(){return a(l)}})}function Xn(r,e){return function(t){return function(n){return r[t](e,n)}}}function ua(r){return T(r.addListener)&&T(r.removeListener)}function da(r){return T(r.on)&&T(r.off)}function pa(r){return T(r.addEventListener)&&T(r.removeEventListener)}function ha(r,e,t){r===void 0&&(r=0),t===void 0&&(t=Ds);var n=-1;return e!=null&&(In(e)?t=e:n=e),new K(function(i){var s=ta(r)?+r-t.now():r;s<0&&(s=0);var a=0;return t.schedule(function(){i.closed||(i.next(a++),0<=n?this.schedule(void 0,n):i.complete())},s)})}function fa(r,e){return r===void 0&&(r=0),e===void 0&&(e=cr),r<0&&(r=0),ha(r,r,e)}function ga(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=Bn(r),n=Ns(r,1/0),i=r;return i.length?i.length===1?he(i[0]):aa(n)(Qn(i,t)):Bs}function ma(r){return Le(function(e,t){var n=!1,i=null;e.subscribe(ke(t,function(s){n=!0,i=s})),he(r).subscribe(ke(t,function(){if(n){n=!1;var s=i;i=null,t.next(s)}},nr))})}function ba(r,e){return e===void 0&&(e=cr),ma(fa(r,e))}function va(r,e,t){var n=T(r)||e||t?{next:r,error:e,complete:t}:r;return n?Le(function(i,s){var a;(a=n.subscribe)===null||a===void 0||a.call(n);var o=!0;i.subscribe(ke(s,function(l){var c;(c=n.next)===null||c===void 0||c.call(n,l),s.next(l)},function(){var l;o=!1,(l=n.complete)===null||l===void 0||l.call(n),s.complete()},function(l){var c;o=!1,(c=n.error)===null||c===void 0||c.call(n,l),s.error(l)},function(){var l,c;o&&((l=n.unsubscribe)===null||l===void 0||l.call(n)),(c=n.finalize)===null||c===void 0||c.call(n)}))}):lr}const ya=ga(ea(1),Xe(window,"hashchange").pipe(va(r=>r.preventDefault()))).pipe(dr(()=>window.location.hash.substr(1).split("/").filter(Boolean).map(decodeURIComponent)));var X=(r=>(r.mutant="mutant",r.test="test",r))(X||{});const wa=`:host(:not([theme=dark])){--prism-maintext:#393a34;--prism-background:#f6f8fa;--prism-border:#ddd;--prism-cdata:#998;--prism-comment:var(--prism-cdata);--prism-doctype:var(--prism-cdata);--prism-prolog:var(--prism-cdata);--prism-attr-value:#e3116c;--prism-string:var(--prism-attr-value);--prism-boolean:#36acaa;--prism-entity:var(--prism-boolean);--prism-url:var(--prism-boolean);--prism-constant:var(--prism-boolean);--prism-inserted:var(--prism-boolean);--prism-number:var(--prism-boolean);--prism-property:var(--prism-boolean);--prism-regex:var(--prism-boolean);--prism-symbol:var(--prism-boolean);--prism-variable:var(--prism-boolean);--prism-atrule:#00a4db;--prism-attr-name:var(--prism-atrule);--prism-attr:var(--prism-atrule);--prism-operator:var(--prism-maintext);--prism-punctuation:var(--prism-maintext);--prism-deleted:#9a050f;--prism-function:var(--prism-deleted);--prism-function-variable:#6f42c1;--prism-selector:#00009f;--prism-tag:var(--prism-selector);--prism-keyword:var(--prism-selector)}:host([theme=dark]){--prism-maintext:#d3d0c8;--prism-background:#1d1f21;--prism-border:rgb(var(--mut-gray-200));--prism-cdata:#7c7c7c;--prism-comment:var(--prism-cdata);--prism-doctype:var(--prism-cdata);--prism-prolog:var(--prism-cdata);--prism-punctuation:#c5c8c6;--prism-tag:#96cbfe;--prism-property:var(--prism-tag);--prism-keyword:var(--prism-tag);--prism-class-name:#ffffb6;--prism-boolean:#9c9;--prism-constant:var(--prism-boolean);--prism-symbol:#f92672;--prism-deleted:var(--prism-symbol);--prism-number:#ff73fd;--prism-inserted:#a8ff60;--prism-selector:var(--prism-inserted);--prism-attr-name:var(--prism-inserted);--prism-string:var(--prism-inserted);--prism-char:var(--prism-inserted);--prism-builtin:var(--prism-inserted);--prism-variable:#c6c5fe;--prism-operator:#ededed;--prism-entity:#ffffb6;--prism-url:#96cbfe;--prism-attr-value:#f9ee98;--prism-atrule:var(--prism-attr-value);--prism-function:#dad085;--prism-regex:#e9c062;--prism-important:#fd971f}:host(:not([theme=dark])){--mut-file-ts-color:#498ba7;--mut-file-ts-test-color:#b7b73b;--mut-file-scala-color:#b8383d;--mut-file-java-color:#b8383d;--mut-file-js-color:#b7b73b;--mut-file-js-test-color:#cc6d2e;--mut-file-php-color:#9068b0;--mut-file-html-color:#498ba7;--mut-file-csharp-color:#498ba7;--mut-file-vue-color:#7fae42;--mut-file-gherkin-color:#00a818}:host([theme=dark]){--mut-file-ts-color:#519aba;--mut-file-ts-test-color:#cbcb41;--mut-file-scala-color:#cc3e44;--mut-file-java-color:#cc3e44;--mut-file-js-color:#cbcb41;--mut-file-js-test-color:#e37933;--mut-file-php-color:#a074c4;--mut-file-html-color:#519aba;--mut-file-csharp-color:#519aba;--mut-file-vue-color:#8dc149;--mut-file-gherkin-color:#10b828}:host(:not([theme=dark])){--mut-gray-bg:rgb(var(--mut-white,255 255 255)/1);--mut-octicon-icon-color:#498ba7;--mut-line-number:#6e7781;--mut-diff-add-bg:#e6ffec;--mut-diff-add-bg-line-number:#ccffd8;--mut-diff-add-line-number:#24292f;--mut-diff-del-bg:#ffebe9;--mut-diff-del-bg-line-number:#ffd7d5;--mut-diff-del-line-number:var(--mut-diff-add-line-number);--mut-badge-info-bg:#54c6ec;--mut-badge-info:#212529;--mut-code-lense:#919191;--mut-squiggly-Survived:url("data:image/svg+xml;charset=UTF8,<svg xmlns='http://www.w3.org/2000/svg' height='3' width='6'><g fill='%23ef4444'><path d='m5.5 0-3 3H1.1l3-3z'/><path d='m4 0 2 2V.6L5.4 0zM0 2l1 1h1.4L0 .6z'/></g></svg>");--mut-squiggly-NoCoverage:url("data:image/svg+xml;charset=UTF8,<svg xmlns='http://www.w3.org/2000/svg' height='3' width='6'><g fill='%23fb923c'><path d='m5.5 0-3 3H1.1l3-3z'/><path d='m4 0 2 2V.6L5.4 0zM0 2l1 1h1.4L0 .6z'/></g></svg>");--mut-body-bg:#fff}:host([theme=dark]){--mut-gray-50:24 24 27;--mut-gray-100:39 39 42;--mut-gray-200:63 63 70;--mut-gray-300:82 82 91;--mut-gray-400:113 113 122;--mut-gray-500:161 161 170;--mut-gray-600:212 212 216;--mut-gray-700:228 228 231;--mut-gray-800:244 244 245;--mut-gray-900:250 250 250;--mut-primary-100:7 89 133;--mut-primary-800:224 242 254;--mut-primary-900:240 249 255;--mut-primary-on:14 165 233;--mut-body-bg:#18181b;--mut-white:var(--mut-gray-50);--mut-octicon-icon-color:#519aba;--mut-line-number:#484f58;--mut-diff-add-bg:rgba(46,160,67,.15);--mut-diff-add-bg-line-number:rgba(63,185,80,.3);--mut-diff-add-line-number:#c9d1d9;--mut-diff-del-bg:rgba(248,81,73,.15);--mut-diff-del-bg-line-number:rgba(248,81,73,.3);--mut-diff-del-line-number:#c9d1d9;--mut-badge-info-bg:#17a3b8;--mut-badge-info:#fff;--mut-code-lense:#999;--mut-squiggly-Survived:url("data:image/svg+xml;charset=UTF8,<svg xmlns='http://www.w3.org/2000/svg' height='3' width='6'><g fill='%23ef4444'><path d='m5.5 0-3 3H1.1l3-3z'/><path d='m4 0 2 2V.6L5.4 0zM0 2l1 1h1.4L0 .6z'/></g></svg>");--mut-squiggly-NoCoverage:url("data:image/svg+xml;charset=UTF8,<svg xmlns='http://www.w3.org/2000/svg' height='3' width='6'><g fill='%23fb923c'><path d='m5.5 0-3 3H1.1l3-3z'/><path d='m4 0 2 2V.6L5.4 0zM0 2l1 1h1.4L0 .6z'/></g></svg>");color-scheme:dark}`;function se(r,e,t){return new CustomEvent(r,{detail:e,...t})}const kt=(r,e)=>v`<li title=${r||k} class="my-3 rounded bg-white px-2 py-3 shadow">${e}</li>`,_e=(r,e)=>v`<p title=${e||k}>${r}</p>`,ei=r=>v`<div class="mb-6 mr-6 mt-2 flex flex-col gap-4">${r}</div>`,P=(r,e)=>v`<span role="img" aria-label="${e}">${r}</span>`,xa=":host([mode=closed]){height:0}:host([mode=half]){height:120px}:host([mode=open]){height:50%}:host([mode=open]) .scrollable{height:100%;overflow-x:hidden;overflow-y:auto}";var ti=Object.defineProperty,$a=Object.getOwnPropertyDescriptor,ka=(r,e,t)=>e in r?ti(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,_t=(r,e,t,n)=>{for(var i=n>1?void 0:n?$a(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&ti(e,t,i),i},_a=(r,e,t)=>(ka(r,typeof e!="symbol"?e+"":e,t),t);const Aa=120;let Ue=class extends G{constructor(){super();x(this,"toggleReadMore",e=>{this.mode==="open"?this.mode="half":this.mode="open",e.preventDefault(),e.stopImmediatePropagation()});this.mode="closed",this.hasDetail=!1}get toggleMoreLabel(){switch(this.mode){case"half":return v`${P("🔼","up arrow")} More`;case"open":return v`${P("🔽","down arrow")} Less`;case"closed":return k}}render(){return v`<aside @click="${e=>e.stopPropagation()}">
      <div class="mx-6">
        <header class="w-full py-4">
          <h2>
            <slot name="header"></slot>
            ${et(this.hasDetail,v`<button data-testId="btnReadMoreToggle" class="ml-2 align-middle" @click="${this.toggleReadMore}"
                >${this.toggleMoreLabel}</button
              >`)}
          </h2>
        </header>
        <div class="scrollable container fixed motion-safe:transition-max-width">
          <slot name="summary"></slot>
          ${et(this.hasDetail&&this.mode==="open",v`<slot name="detail"></slot>`)}
        </div>
      </div>
    </aside>`}};_a(Ue,"styles",[V(xa),H]),_t([S({reflect:!0})],Ue.prototype,"mode",2),_t([S({reflect:!0,type:Boolean})],Ue.prototype,"hasDetail",2),_t([S()],Ue.prototype,"toggleMoreLabel",1),Ue=_t([L("mte-drawer")],Ue);function et(r,e){return r?typeof e=="function"?e():e:k}function tt(r,e){return r==null?k:e(r)}function Sa(r){switch(r){case"Killed":return"success";case"NoCoverage":return"caution";case"Survived":return"danger";case"Timeout":return"warning";case"Ignored":case"RuntimeError":case"Pending":case"CompileError":return"secondary"}}function Ca(r){switch(r){case B.Killing:return"success";case B.Covering:return"warning";case B.NotCovering:return"caution"}}function hr(r){switch(r){case B.Killing:return P("✅",r);case B.Covering:return P("☂",r);case B.NotCovering:return P("🌧",r)}}function ri(r){switch(r){case"Killed":return P("✅",r);case"NoCoverage":return P("🙈",r);case"Ignored":return P("🤥",r);case"Survived":return P("👽",r);case"Timeout":return P("⏰",r);case"Pending":return P("⌛",r);case"RuntimeError":case"CompileError":return P("💥",r)}}function fr(r){return r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function At(...r){const e=new URL(window.location.href);return new URL(`#${r.filter(Boolean).join("/")}`,e).href}function ni(r){return r.length>1?"s":""}function ii({fileName:r,location:e}){return r?`${r}${e?`:${e.start.line}:${e.start.column}`:""}`:""}function si(r){r&&!Ea(r)&&r.scrollIntoView({block:"center",behavior:"smooth"})}function Ea(r){const{top:e,bottom:t}=r.getBoundingClientRect();return e>=0&&t<=(window.innerHeight||document.documentElement.clientHeight)-Aa}function ai(){const r="test";try{return localStorage.setItem(r,r),localStorage.removeItem(r),!0}catch{return!1}}const oi=new zn;class ae extends G{constructor(){super(...arguments);Re(this,pt,new Ne)}shouldReactivate(){return!0}reactivate(){this.requestUpdate()}connectedCallback(){super.connectedCallback(),N(this,pt).add(oi.subscribe(()=>this.shouldReactivate()&&this.reactivate()))}disconnectedCallback(){super.disconnectedCallback(),N(this,pt).unsubscribe()}}pt=new WeakMap;var li=Object.defineProperty,Ma=Object.getOwnPropertyDescriptor,Ta=(r,e,t)=>e in r?li(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Z=(r,e,t,n)=>{for(var i=n>1?void 0:n?Ma(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&li(e,t,i),i},Pa=(r,e,t)=>(Ta(r,typeof e!="symbol"?e+"":e,t),t);const Fa=100;E.MutationTestReportAppComponent=class extends ae{constructor(){super();x(this,"mutants",new Map);x(this,"tests",new Map);x(this,"themeSwitch",t=>{this.theme=t.detail,ai()&&localStorage.setItem("mutation-testing-elements-theme",this.theme)});x(this,"subscriptions",[]);x(this,"source");x(this,"sseSubscriptions",new Set);x(this,"theMutant");x(this,"theTest");this.context={view:X.mutant,path:[]},this.path=[]}get themeBackgroundColor(){return getComputedStyle(this).getPropertyValue("--mut-body-bg")}get title(){return this.context.result?this.titlePostfix?`${this.context.result.name} - ${this.titlePostfix}`:this.context.result.name:""}firstUpdated(){(this.path.length===0||this.path[0]!==X.mutant&&this.path[0]!==X.test)&&window.location.replace(At(`${X.mutant}`))}async loadData(){if(this.src)try{const t=await fetch(this.src);this.report=await t.json()}catch(t){const n=String(t);this.errorMessage=n}}async willUpdate(t){this.report&&(this.theme||(this.theme=this.getTheme()),t.has("report")&&this.updateModel(this.report),(t.has("path")||t.has("report"))&&(this.updateContext(),this.updateTitle())),t.has("src")&&await this.loadData()}updated(t){t.has("theme")&&this.theme&&this.dispatchEvent(se("theme-changed",{theme:this.theme,themeBackgroundColor:this.themeBackgroundColor}))}getTheme(){var n;const t=ai()&&localStorage.getItem("mutation-testing-elements-theme");return t||(window.matchMedia&&((n=window.matchMedia("(prefers-color-scheme: dark)"))!=null&&n.matches)?"dark":"light")}updateModel(t){var i,s,a;this.rootModel=gs(t),n((o,l)=>{o.result=l,o.mutants.forEach(c=>this.mutants.set(c.id,c))})((i=this.rootModel)==null?void 0:i.systemUnderTestMetrics),n((o,l)=>{o.result=l,o.tests.forEach(c=>this.tests.set(c.id,c))})((s=this.rootModel)==null?void 0:s.testMetrics),this.rootModel.systemUnderTestMetrics.updateParent(),(a=this.rootModel.testMetrics)==null||a.updateParent();function n(o){return function l(c){c!=null&&c.file&&o(c.file,c),c==null||c.childResults.forEach(g=>{l(g)})}}}updateContext(){if(this.rootModel){const t=(i,s)=>s.reduce((a,o)=>a==null?void 0:a.childResults.find(l=>l.name===o),i),n=this.path.slice(1);this.path[0]===X.test&&this.rootModel.testMetrics?this.context={view:X.test,path:n,result:t(this.rootModel.testMetrics,this.path.slice(1))}:this.context={view:X.mutant,path:n,result:t(this.rootModel.systemUnderTestMetrics,this.path.slice(1))}}}updateTitle(){document.title=this.title}connectedCallback(){super.connectedCallback(),this.subscriptions.push(ya.subscribe(t=>this.path=t)),this.initializeSse()}initializeSse(){if(!this.sse)return;this.source=new EventSource(this.sse);const t=Xe(this.source,"mutant-tested").subscribe(i=>{const s=JSON.parse(i.data);if(!this.report)return;const a=this.mutants.get(s.id);if(a!==void 0){this.theMutant=a;for(const[o,l]of Object.entries(s))this.theMutant[o]=l;s.killedBy&&s.killedBy.forEach(o=>{const l=this.tests.get(o);l!==void 0&&(this.theTest=l,l.addKilled(this.theMutant),this.theMutant.addKilledBy(l))}),s.coveredBy&&s.coveredBy.forEach(o=>{const l=this.tests.get(o);l!==void 0&&(this.theTest=l,l.addCovered(this.theMutant),this.theMutant.addCoveredBy(l))})}}),n=Xe(this.source,"mutant-tested").pipe(ba(Fa)).subscribe(()=>{this.applyChanges()});this.sseSubscriptions.add(t),this.sseSubscriptions.add(n),this.source.addEventListener("finished",()=>{var i;(i=this.source)==null||i.close(),this.applyChanges(),this.sseSubscriptions.forEach(s=>s.unsubscribe())})}applyChanges(){var t,n;(t=this.theMutant)==null||t.update(),(n=this.theTest)==null||n.update(),oi.next()}disconnectedCallback(){super.disconnectedCallback(),this.subscriptions.forEach(t=>t.unsubscribe())}renderTitle(){return this.context.result?v`
        <h1 class="text-5xl font-bold tracking-tight">
          ${this.context.result.name}${this.titlePostfix?v`<small class="text-light-muted ml-4 font-light">${this.titlePostfix}</small>`:k}
        </h1>
      `:k}render(){var t,n,i,s,a;return this.context.result??this.errorMessage?v`
        <div class="container bg-white pb-4 font-sans text-gray-800 motion-safe:transition-max-width">
          <div class="space-y-4 transition-colors">
            ${this.renderErrorMessage()}
            <mte-theme-switch @theme-switch="${this.themeSwitch}" class="sticky top-offset z-20 float-right pt-6" .theme="${this.theme}">
            </mte-theme-switch>
            ${this.renderTitle()} ${this.renderTabs()}
            <mte-breadcrumb .view="${this.context.view}" .path="${this.context.path}"></mte-breadcrumb>
            <mte-result-status-bar
              .detected="${(t=this.rootModel)==null?void 0:t.systemUnderTestMetrics.metrics.totalDetected}"
              .noCoverage="${(n=this.rootModel)==null?void 0:n.systemUnderTestMetrics.metrics.noCoverage}"
              .pending="${(i=this.rootModel)==null?void 0:i.systemUnderTestMetrics.metrics.pending}"
              .survived="${(s=this.rootModel)==null?void 0:s.systemUnderTestMetrics.metrics.survived}"
              .total="${(a=this.rootModel)==null?void 0:a.systemUnderTestMetrics.metrics.totalValid}"
            ></mte-result-status-bar>
            ${this.context.view==="mutant"&&this.context.result?v`<mte-mutant-view
                  id="mte-mutant-view"
                  .result="${this.context.result}"
                  .thresholds="${this.report.thresholds}"
                  .path="${this.path}"
                ></mte-mutant-view>`:k}
            ${this.context.view==="test"&&this.context.result?v`<mte-test-view id="mte-test-view" .result="${this.context.result}" .path="${this.path}"></mte-test-view>`:k}
          </div>
        </div>
      `:v``}renderErrorMessage(){return this.errorMessage?v`<div class="my-4 rounded-lg bg-red-100 p-4 text-sm text-red-700" role="alert">${this.errorMessage}</div>`:k}renderTabs(){var t;if((t=this.rootModel)!=null&&t.testMetrics){const n=this.context.view==="mutant",i=this.context.view==="test";return v`
        <nav class="border-b border-gray-200 text-center text-sm font-medium  text-gray-600">
          <ul class="-mb-px flex flex-wrap" role="tablist">
            ${[{type:"mutant",isActive:n,text:"👽 Mutants"},{type:"test",isActive:i,text:"🧪 Tests"}].map(({type:s,isActive:a,text:o})=>v`<li class="mr-2" role="presentation">
                  <a
                    class="inline-block rounded-t-lg border-b-2 border-transparent p-4 transition-colors hover:border-gray-300 hover:bg-gray-200 hover:text-gray-700 aria-selected:border-b-[3px] aria-selected:border-primary-700  aria-selected:text-primary-on"
                    role="tab"
                    href="${At(s)}"
                    aria-selected="${a}"
                    aria-controls="mte-${s}-view"
                    >${o}</a
                  >
                </li>`)}
          </ul>
        </nav>
      `}else return k}},Pa(E.MutationTestReportAppComponent,"styles",[xs,V(wa),H]),Z([S({attribute:!1})],E.MutationTestReportAppComponent.prototype,"report",2),Z([S({attribute:!1})],E.MutationTestReportAppComponent.prototype,"rootModel",2),Z([S()],E.MutationTestReportAppComponent.prototype,"src",2),Z([S()],E.MutationTestReportAppComponent.prototype,"sse",2),Z([S({attribute:!1})],E.MutationTestReportAppComponent.prototype,"errorMessage",2),Z([S({attribute:!1})],E.MutationTestReportAppComponent.prototype,"context",2),Z([S()],E.MutationTestReportAppComponent.prototype,"path",2),Z([S({attribute:"title-postfix"})],E.MutationTestReportAppComponent.prototype,"titlePostfix",2),Z([S({reflect:!0})],E.MutationTestReportAppComponent.prototype,"theme",2),Z([S({attribute:!1})],E.MutationTestReportAppComponent.prototype,"themeBackgroundColor",1),Z([S()],E.MutationTestReportAppComponent.prototype,"title",1),E.MutationTestReportAppComponent=Z([L("mutation-test-report-app")],E.MutationTestReportAppComponent);/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{D:za}=Xi,Oa=r=>r.strings===void 0,ci=()=>document.createComment(""),rt=(r,e,t)=>{var s;const n=r._$AA.parentNode,i=e===void 0?r._$AB:e._$AA;if(t===void 0){const a=n.insertBefore(ci(),i),o=n.insertBefore(ci(),i);t=new za(a,o,r,r.options)}else{const a=t._$AB.nextSibling,o=t._$AM,l=o!==r;if(l){let c;(s=t._$AQ)==null||s.call(t,r),t._$AM=r,t._$AP!==void 0&&(c=r._$AU)!==o._$AU&&t._$AP(c)}if(a!==i||l){let c=t._$AA;for(;c!==a;){const g=c.nextSibling;n.insertBefore(c,i),c=g}}}return t},Ae=(r,e,t=r)=>(r._$AI(e,t),r),Ra={},ja=(r,e=Ra)=>r._$AH=e,Ia=r=>r._$AH,gr=r=>{var n;(n=r._$AP)==null||n.call(r,!1,!0);let e=r._$AA;const t=r._$AB.nextSibling;for(;e!==t;){const i=e.nextSibling;e.remove(),e=i}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const St={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},Ct=r=>(...e)=>({_$litDirective$:r,values:e});class Et{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,n){this._$Ct=e,this._$AM=t,this._$Ci=n}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const nt=(r,e)=>{var n;const t=r._$AN;if(t===void 0)return!1;for(const i of t)(n=i._$AO)==null||n.call(i,e,!1),nt(i,e);return!0},Mt=r=>{let e,t;do{if((e=r._$AM)===void 0)break;t=e._$AN,t.delete(r),r=e}while((t==null?void 0:t.size)===0)},ui=r=>{for(let e;e=r._$AM;r=e){let t=e._$AN;if(t===void 0)e._$AN=t=new Set;else if(t.has(r))break;t.add(r),Na(e)}};function Da(r){this._$AN!==void 0?(Mt(this),this._$AM=r,ui(this)):this._$AM=r}function Ba(r,e=!1,t=0){const n=this._$AH,i=this._$AN;if(i!==void 0&&i.size!==0)if(e)if(Array.isArray(n))for(let s=t;s<n.length;s++)nt(n[s],!1),Mt(n[s]);else n!=null&&(nt(n,!1),Mt(n));else nt(this,r)}const Na=r=>{r.type==St.CHILD&&(r._$AP??(r._$AP=Ba),r._$AQ??(r._$AQ=Da))};class La extends Et{constructor(){super(...arguments),this._$AN=void 0}_$AT(e,t,n){super._$AT(e,t,n),ui(this),this.isConnected=e._$AU}_$AO(e,t=!0){var n,i;e!==this.isConnected&&(this.isConnected=e,e?(n=this.reconnected)==null||n.call(this):(i=this.disconnected)==null||i.call(this)),t&&(nt(this,e),Mt(this))}setValue(e){if(Oa(this._$Ct))this._$Ct._$AI(e,this);else{const t=[...this._$Ct._$AH];t[this._$Ci]=e,this._$Ct._$AI(t,this,0)}}disconnected(){}reconnected(){}}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ua=()=>new Ha;class Ha{}const mr=new WeakMap,Ka=Ct(class extends La{render(r){return k}update(r,[e]){var n;const t=e!==this.G;return t&&this.G!==void 0&&this.ot(void 0),(t||this.rt!==this.lt)&&(this.G=e,this.ct=(n=r.options)==null?void 0:n.host,this.ot(this.lt=r.element)),k}ot(r){if(typeof this.G=="function"){const e=this.ct??globalThis;let t=mr.get(e);t===void 0&&(t=new WeakMap,mr.set(e,t)),t.get(this.G)!==void 0&&this.G.call(this.ct,void 0),t.set(this.G,r),r!==void 0&&this.G.call(this.ct,r)}else this.G.value=r}get rt(){var r,e;return typeof this.G=="function"?(r=mr.get(this.ct??globalThis))==null?void 0:r.get(this.G):(e=this.G)==null?void 0:e.value}disconnected(){this.rt===this.lt&&this.ot(void 0)}reconnected(){this.ot(this.lt)}});var J=(r=>(r.csharp="cs",r.java="java",r.javascript="javascript",r.html="html",r.php="php",r.scala="scala",r.typescript="typescript",r.vue="vue",r.gherkin="gherkin",r.svelte="svelte",r))(J||{});function qa(r){return r.substr(r.lastIndexOf(".")+1).toLocaleLowerCase()}function br(r){switch(qa(r)){case"cs":return"cs";case"html":return"html";case"java":return"java";case"js":case"cjs":case"mjs":return"javascript";case"ts":case"tsx":case"cts":case"mts":return"typescript";case"scala":return"scala";case"php":return"php";case"vue":return"vue";case"feature":return"gherkin";case"svelte":return"svelte";default:return}}function vr(r,e){const t=br(e)??"plain";let n=t;return t==="vue"&&(n="html"),$n.highlight(r,$n.languages[n],n)}function yr(r,e){let t=[];const n=[],i={column:0,line:1,offset:-1},s=[];let a=!1,o=0;for(;o<r.length;){switch(a&&!Tt(r[o])&&(c(),a=!1),r[o]){case"\r":i.offset++;break;case`
`:m(),i.offset++,i.line++,i.column=0,a=!0;break;case"<":{const u=$();u.isClosing?R(u):_(u);break}case"&":y(b());break;default:y(r[o]);break}o++}return m(),n;function l(...u){t.push(...u)}function c(){s.forEach(u=>l(d(u)))}function g(){s.forEach(u=>l(d({...u,isClosing:!0})))}function d({attributes:u,elementName:f,isClosing:w}){return w?`</${f}>`:`<${f}${Object.entries(u??{}).reduce((C,[A,O])=>O===void 0?`${C} ${A}`:`${C} ${A}="${O}"`,"")}>`}function m(){g(),n.push(t.join("")),t=[]}function y(u){if(i.column++,i.offset++,e)for(const f of e(i))f.isClosing?R(f):(l(d(f)),s.push(f));l(u)}function $(){o++;const u=r[o]==="/"?!0:void 0;u&&o++;const f=o;for(;!Tt(r[o])&&r[o]!==">";)o++;const w=r.substring(f,o),C=j();return{elementName:w,attributes:C,isClosing:u}}function _(u){s.push(u),l(d(u))}function R(u){let f;for(f=s.length-1;f>=0;f--){const w=s[f];if(u.elementName===w.elementName&&w.id===u.id){l(d(u)),s.splice(f,1);for(let C=f;C<s.length;C++)l(d(s[C]));break}l(d({...w,isClosing:!0}))}if(f===-1)throw new Error(`Cannot find corresponding opening tag for ${d(u)}`)}function j(){const u=Object.create(null);for(;o<r.length;){const f=r[o];if(f===">")return u;if(!Tt(f)){const{name:w,value:C}=h();u[w]=C}o++}throw new Error(`Missing closing tag near ${r.substr(o-10)}`)}function h(){const u=o;for(;r[o]!=="=";)o++;const f=r.substring(u,o);o++;const w=p();return{name:f,value:w}}function p(){r[o]==='"'&&o++;const u=o;for(;r[o]!=='"';)o++;return r.substring(u,o)}function b(){const u=o;for(;r[o]!==";";)o++;return r.substring(u,o+1)}}function Tt(r){return r===`
`||r===" "||r==="	"}function Va(r,e){let t=0,n=e.length-1;for(;r[t]===e[t]&&t<e.length;)t++;const i=r.length-e.length;for(;r[n+i]===e[n]&&n>t;)n--;n===t&&(Tt(e[t-1])||t--),n++;const s=e.substring(t,n);return["true","false"].forEach(a=>{s===a.substr(0,a.length-1)&&a.endsWith(e[n])&&n++,s===a.substr(1,a.length)&&a.startsWith(e[t-1])&&t--}),[t,n]}function Pt(r,e){return r.line>e.line||r.line===e.line&&r.column>=e.column}const Wa='#report-code-block{background:var(--prism-background);border:1px solid var(--prism-border);overflow-x:auto;overflow-y:visible}.line-numbers{counter-reset:mte-line-number}.line .line-number{color:var(--mut-line-number);counter-increment:mte-line-number;padding:0 10px 0 15px;text-align:right}.line .line-number:before{content:counter(mte-line-number)}.line-marker:before{content:" ";padding:0 5px}.mte-selected-Pending .mutant.Pending{border-bottom:2px solid;border-color:#a3a3a3;cursor:pointer}svg.mutant-dot.Pending{fill:#a3a3a3}.mte-selected-Killed .mutant.Killed{border-bottom:2px solid;border-color:#16a34a;cursor:pointer}svg.mutant-dot.Killed{fill:#16a34a}svg.mutant-dot.NoCoverage{fill:#f97316}svg.mutant-dot.Survived{fill:#ef4444}.mte-selected-Timeout .mutant.Timeout{border-bottom:2px solid;border-color:#fbbf24;cursor:pointer}svg.mutant-dot.Timeout{fill:#fbbf24}.mte-selected-CompileError .mutant.CompileError{border-bottom:2px solid;border-color:#a3a3a3;cursor:pointer}svg.mutant-dot.CompileError{fill:#a3a3a3}.mte-selected-RuntimeError .mutant.RuntimeError{border-bottom:2px solid;border-color:#a3a3a3;cursor:pointer}svg.mutant-dot.RuntimeError{fill:#a3a3a3}.mte-selected-Ignored .mutant.Ignored{border-bottom:2px solid;border-color:#a3a3a3;cursor:pointer}svg.mutant-dot.Ignored{fill:#a3a3a3}svg.mutant-dot.selected{fill:#38bdf8}.mte-selected-Survived .mutant.Survived{border-bottom-style:solid;border-image-outset:6px;border-image-repeat:repeat;border-image-slice:0 0 4 0;border-image-source:var(--mut-squiggly-Survived);border-image-width:4px;cursor:pointer}.mte-selected-Survived .mutant.Survived .mutant.NoCoverage,.mte-selected-Survived .mutant.Survived .mutant.Survived{border-bottom-style:none;border-image:none}.mte-selected-NoCoverage .mutant.NoCoverage{border-bottom-style:solid;border-image-outset:6px;border-image-repeat:repeat;border-image-slice:0 0 4 0;border-image-source:var(--mut-squiggly-NoCoverage);border-image-width:4px;cursor:pointer}.mte-selected-NoCoverage .mutant.NoCoverage .mutant.NoCoverage,.mte-selected-NoCoverage .mutant.NoCoverage .mutant.Survived{border-bottom-style:none;border-image:none}.mutant-dot{cursor:pointer}svg.mutant-dot{margin:2px}.diff-old{background-color:var(--mut-diff-del-bg)}.diff-focus{background-color:var(--mut-diff-add-bg-line-number)}.diff-old .line-number{background-color:var(--mut-diff-del-bg-line-number);color:var(--mut-diff-del-line-number)}.diff-old .line-marker:before{content:"-"}.diff-new{background-color:var(--mut-diff-add-bg)}.diff-new .empty-line-number{background-color:var(--mut-diff-add-bg-line-number);color:var(--mut-diff-add-line-number)}.diff-new .line-marker:before{content:"+"}';/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let wr=class extends Et{constructor(e){if(super(e),this.et=k,e.type!==St.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(e){if(e===k||e==null)return this.vt=void 0,this.et=e;if(e===ie)return e;if(typeof e!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(e===this.et)return this.vt;this.et=e;const t=[e];return t.raw=t,this.vt={_$litType$:this.constructor.resultType,strings:t,values:[]}}};wr.directiveName="unsafeHTML",wr.resultType=1;const Za=Ct(wr);function di(r,e){return r===k&&e===k?k:v`<span class="ml-1 flex flex-row items-center">${r}${e}</span>`}function pi(r,e){return v`<tr class="line"
    ><td class="line-number"></td><td class="line-marker"></td><td class="code flex"><span>${Za(r)}</span>${e}</td></tr
  >`}var hi=Object.defineProperty,Ga=Object.getOwnPropertyDescriptor,Ya=(r,e,t)=>e in r?hi(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Se=(r,e,t,n)=>{for(var i=n>1?void 0:n?Ga(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&hi(e,t,i),i},Ja=(r,e,t)=>(Ya(r,typeof e!="symbol"?e+"":e,t),t);const xr="diff-old",fi="diff-new";let oe=class extends ae{constructor(){super();x(this,"codeRef",Ua());x(this,"filtersChanged",e=>{this.selectedMutantStates=e.detail.concat(["Pending"])});x(this,"codeClicked",e=>{if(e.stopPropagation(),e.target instanceof Element){let t=e.target;const n=[];for(;t instanceof Element;t=t.parentElement){const s=t.getAttribute("mutant-id"),a=this.mutants.find(({id:o})=>o.toString()===s);a&&n.push(a)}const i=(this.selectedMutant?n.indexOf(this.selectedMutant):-1)+1;n[i]?(this.toggleMutant(n[i]),mi()):this.selectedMutant&&(this.toggleMutant(this.selectedMutant),mi())}});x(this,"nextMutant",()=>{const e=this.selectedMutant?(this.mutants.indexOf(this.selectedMutant)+1)%this.mutants.length:0;this.mutants[e]&&this.toggleMutant(this.mutants[e])});x(this,"previousMutant",()=>{const e=this.selectedMutant?(this.mutants.indexOf(this.selectedMutant)+this.mutants.length-1)%this.mutants.length:this.mutants.length-1;this.mutants[e]&&this.toggleMutant(this.mutants[e])});this.filters=[],this.selectedMutantStates=[],this.lines=[],this.mutants=[]}render(){const e=new Map;for(const n of this.mutants){let i=e.get(n.location.start.line);i||(i=[],e.set(n.location.start.line,i)),i.push(n)}const t=n=>this.renderMutantDots([...e.entries()].filter(([i])=>i>n).flatMap(([,i])=>i));return v`
      <mte-state-filter
        allow-toggle-all
        .filters="${this.filters}"
        @filters-changed="${this.filtersChanged}"
        @next=${this.nextMutant}
        @previous=${this.previousMutant}
      ></mte-state-filter>
      <pre
        @click="${this.codeClicked}"
        id="report-code-block"
        class="line-numbers ${this.selectedMutantStates.map(n=>`mte-selected-${n}`).join(" ")} flex rounded-md py-4"
      >
        <code ${Ka(this.codeRef)} class="flex language-${this.model.language}">
          <table>${this.lines.map((n,i)=>{const s=i+1,a=this.renderMutantDots(e.get(s)),o=this.lines.length===s?t(s):k;return pi(n,di(a,o))})}</table>
          </code>
          </pre>
    `}renderMutantDots(e){return e!=null&&e.length?e.map(t=>{var n;return U`<svg mutant-id="${t.id}" class="mutant-dot ${((n=this.selectedMutant)==null?void 0:n.id)===t.id?"selected":t.status}" height="10" width="12">
          <title>${gi(t)}</title>
          <circle cx="5" cy="5" r="5" />
          </svg>`}):k}toggleMutant(e){if(this.removeCurrentDiff(),this.selectedMutant===e){this.selectedMutant=void 0,this.dispatchEvent(se("mutant-selected",{selected:!1,mutant:e}));return}this.selectedMutant=e;const t=this.codeRef.value.querySelectorAll("tr.line");for(let s=e.location.start.line-1;s<e.location.end.line;s++)t.item(s).classList.add(xr);const n=this.highlightedReplacementRows(e),i=t.item(e.location.end.line-1);i.insertAdjacentHTML("afterend",n),si(i),this.dispatchEvent(se("mutant-selected",{selected:!0,mutant:e}))}removeCurrentDiff(){this.codeRef.value.querySelectorAll(`.${xr}`).forEach(n=>n.classList.remove(xr)),this.codeRef.value.querySelectorAll(`.${fi}`).forEach(n=>n.remove())}reactivate(){super.reactivate(),this.updateFileRepresentation()}update(e){e.has("model")&&this.model&&this.updateFileRepresentation(),(e.has("model")&&this.model||e.has("selectedMutantStates"))&&(this.mutants=this.model.mutants.filter(t=>this.selectedMutantStates.includes(t.status)).sort((t,n)=>Pt(t.location.start,n.location.start)?1:-1),this.selectedMutant&&!this.mutants.includes(this.selectedMutant)&&e.has("selectedMutantStates")&&this.selectedMutantsHaveChanged(e.get("selectedMutantStates")??[])&&this.toggleMutant(this.selectedMutant)),super.update(e)}updateFileRepresentation(){this.filters=["Killed","Survived","NoCoverage","Ignored","Timeout","CompileError","RuntimeError"].filter(i=>this.model.mutants.some(s=>s.status===i)).map(i=>({enabled:[...this.selectedMutantStates,"Survived","NoCoverage","Timeout"].includes(i),count:this.model.mutants.filter(s=>s.status===i).length,status:i,label:v`${ri(i)} ${i}`,context:Sa(i)}));const e=vr(this.model.source,this.model.name),t=new Set,n=new Set(this.model.mutants);this.lines=yr(e,function*(i){for(const s of t)Pt(i,s.location.end)&&(t.delete(s),yield{elementName:"span",id:s.id,isClosing:!0});for(const s of n)Pt(i,s.location.start)&&(t.add(s),n.delete(s),yield{elementName:"span",id:s.id,attributes:{class:fr(`mutant border-none ${s.status}`),title:fr(gi(s)),"mutant-id":fr(s.id.toString())}})})}selectedMutantsHaveChanged(e){return e.length!==this.selectedMutantStates.length?!0:!e.every((t,n)=>this.selectedMutantStates[n]===t)}highlightedReplacementRows(e){const t=e.getMutatedLines().trimEnd(),n=e.getOriginalLines().trimEnd(),[i,s]=Va(n,t),a=yr(vr(t,this.model.name),function*({offset:c}){c===i?yield{elementName:"span",id:"diff-focus",attributes:{class:"diff-focus"}}:c===s&&(yield{elementName:"span",id:"diff-focus",isClosing:!0})}),o=`<tr class="${fi}"><td class="empty-line-number"></td><td class="line-marker"></td><td class="code">`,l="</td></tr>";return a.map(c=>`${o}${c}${l}`).join("")}};Ja(oe,"styles",[_n,H,V(Wa)]),Se([Y()],oe.prototype,"filters",2),Se([S()],oe.prototype,"model",2),Se([Y()],oe.prototype,"selectedMutantStates",2),Se([Y()],oe.prototype,"selectedMutant",2),Se([Y()],oe.prototype,"lines",2),Se([Y()],oe.prototype,"mutants",2),oe=Se([L("mte-file")],oe);function gi(r){return`${r.mutatorName} ${r.status}`}function mi(){var r;(r=window.getSelection())==null||r.removeAllRanges()}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const bi=(r,e,t)=>{const n=new Map;for(let i=e;i<=t;i++)n.set(r[i],i);return n},Ft=Ct(class extends Et{constructor(r){if(super(r),r.type!==St.CHILD)throw Error("repeat() can only be used in text expressions")}ht(r,e,t){let n;t===void 0?t=e:e!==void 0&&(n=e);const i=[],s=[];let a=0;for(const o of r)i[a]=n?n(o,a):a,s[a]=t(o,a),a++;return{values:s,keys:i}}render(r,e,t){return this.ht(r,e,t).values}update(r,[e,t,n]){const i=Ia(r),{values:s,keys:a}=this.ht(e,t,n);if(!Array.isArray(i))return this.dt=a,s;const o=this.dt??(this.dt=[]),l=[];let c,g,d=0,m=i.length-1,y=0,$=s.length-1;for(;d<=m&&y<=$;)if(i[d]===null)d++;else if(i[m]===null)m--;else if(o[d]===a[y])l[y]=Ae(i[d],s[y]),d++,y++;else if(o[m]===a[$])l[$]=Ae(i[m],s[$]),m--,$--;else if(o[d]===a[$])l[$]=Ae(i[d],s[$]),rt(r,l[$+1],i[d]),d++,$--;else if(o[m]===a[y])l[y]=Ae(i[m],s[y]),rt(r,i[d],i[m]),m--,y++;else if(c===void 0&&(c=bi(a,y,$),g=bi(o,d,m)),c.has(o[d]))if(c.has(o[m])){const _=g.get(a[y]),R=_!==void 0?i[_]:null;if(R===null){const j=rt(r,i[d]);Ae(j,s[y]),l[y]=j}else l[y]=Ae(R,s[y]),rt(r,i[d],R),i[_]=null;y++}else gr(i[m]),m--;else gr(i[d]),d++;for(;y<=$;){const _=rt(r,l[$+1]);Ae(_,s[y]),l[y++]=_}for(;d<=m;){const _=i[d++];_!==null&&gr(_)}return this.dt=a,ja(r,l),ie}});var vi=Object.defineProperty,Qa=Object.getOwnPropertyDescriptor,Xa=(r,e,t)=>e in r?vi(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$r=(r,e,t,n)=>{for(var i=n>1?void 0:n?Qa(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&vi(e,t,i),i},eo=(r,e,t)=>(Xa(r,typeof e!="symbol"?e+"":e,t),t);let it=class extends G{get rootName(){switch(this.view){case X.mutant:return"All files";case X.test:return"All tests"}}render(){return v`<nav class="my-4 flex rounded-md border border-primary-600 bg-primary-100 p-3 text-gray-700" aria-label="Breadcrumb">
      <ol class="inline-flex items-center">
        ${this.path&&this.path.length>0?this.renderLink(this.rootName,[]):this.renderActiveItem(this.rootName)}
        ${this.renderBreadcrumbItems()}
      </ol>
    </nav> `}renderBreadcrumbItems(){if(this.path){const r=this.path;return Ft(r,e=>e,(e,t)=>t===r.length-1?this.renderActiveItem(e):this.renderLink(e,r.slice(0,t+1)))}}renderActiveItem(r){return v`<li aria-current="page">
      <span class="ml-1 text-sm font-medium text-gray-800">${r}</span>
    </li> `}renderLink(r,e){return v`<li class="after:text-gray-800 after:content-['/'] md:after:pl-1">
      <a
        href="${At(this.view,...e)}"
        class="ml-1 text-sm font-medium text-primary-800 underline hover:text-gray-900 hover:underline md:ml-2"
        >${r}</a
      >
    </li>`}};eo(it,"styles",[H]),$r([S()],it.prototype,"path",2),$r([S()],it.prototype,"view",2),it=$r([L("mte-breadcrumb")],it);const to=".step-button{--tw-bg-opacity:1;--tw-text-opacity:1;align-items:center;background-color:rgb(var(--mut-primary-600,2 132 199)/var(--tw-bg-opacity));border-radius:.375rem;color:rgb(var(--mut-white,255 255 255)/var(--tw-text-opacity));display:inline-flex;margin-right:.5rem;padding:.25rem;text-align:center}.step-button:hover{--tw-bg-opacity:1;background-color:rgb(var(--mut-primary-700,3 105 161)/var(--tw-bg-opacity))}.step-button:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);--tw-ring-opacity:1;--tw-ring-color:rgb(var(--mut-primary-500,14 165 233)/var(--tw-ring-opacity));box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000);outline:2px solid transparent;outline-offset:2px}";var yi=Object.defineProperty,ro=Object.getOwnPropertyDescriptor,no=(r,e,t)=>e in r?yi(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,wi=(r,e,t,n)=>{for(var i=n>1?void 0:n?ro(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&yi(e,t,i),i},io=(r,e,t)=>(no(r,typeof e!="symbol"?e+"":e,t),t);let zt=class extends ae{constructor(){super(...arguments);x(this,"next",e=>{e.stopPropagation(),this.dispatchEvent(se("next",void 0,{bubbles:!0,composed:!0}))});x(this,"previous",e=>{e.stopPropagation(),this.dispatchEvent(se("previous",void 0,{bubbles:!0,composed:!0}))})}updated(e){e.has("filters")&&this.dispatchFiltersChangedEvent()}checkboxChanged(e,t){e.enabled=t,this.dispatchFiltersChangedEvent()}dispatchFiltersChangedEvent(){this.dispatchEvent(se("filters-changed",this.filters.filter(({enabled:e})=>e).map(({status:e})=>e)))}render(){var e;return v`
      <div class="sticky top-offset z-10 flex flex-row bg-white py-6">
        <div class="mr-3">
          <button title="Previous" @click=${this.previous} type="button" class="step-button">
            <svg aria-hidden="true" class="h-4 w-4 rotate-180" fill="white" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
              <path
                fill-rule="evenodd"
                d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                clip-rule="evenodd"
              ></path>
            </svg>
            <span class="sr-only">Select previous mutant</span>
          </button>
          <button title="Next" @click=${this.next} type="button" class="step-button">
            <svg aria-hidden="true" class="h-4 w-4" fill="white" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
              <path
                fill-rule="evenodd"
                d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                clip-rule="evenodd"
              ></path>
            </svg>
            <span class="sr-only">Select next mutant</span>
          </button>
        </div>

        ${et((e=this.filters)==null?void 0:e.length,Ft(this.filters,t=>t.status,t=>v`
              <div class="mr-4 flex items-center" data-status="${t.status}">
                <input
                  ?checked="${t.enabled}"
                  id="filter-${t.status}"
                  aria-describedby="status-description"
                  type="checkbox"
                  value="${t.status}"
                  @input="${n=>this.checkboxChanged(t,n.target.checked)}"
                  class="h-5 w-5 rounded border-gray-300 bg-gray-100 text-primary-on !ring-offset-gray-200 focus:outline-none focus:ring-2 focus:ring-primary-500"
                />

                <label
                  for="filter-${t.status}"
                  class="${this.bgForContext(t.context)} mx-2 rounded px-2.5 py-0.5 text-sm font-medium hover:cursor-pointer"
                >
                  ${t.label} (${t.count})
                </label>
              </div>
            `))}
      </div>
    `}bgForContext(e){switch(e){case"success":return"bg-green-100 text-green-800";case"warning":return"bg-yellow-100 text-yellow-800";case"danger":return"bg-red-100 text-red-800";case"caution":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}}};io(zt,"styles",[H,V(to)]),wi([S({type:Array})],zt.prototype,"filters",2),zt=wi([L("mte-state-filter")],zt);const so='#darkTheme{position:absolute;right:100vw}#darkTheme+label{--i:0;--j:calc(1 - var(--i));grid-gap:.15em .06em;background:hsl(199,98%,calc(var(--j)*48%));border-radius:.75em;color:transparent;cursor:pointer;display:grid;height:1.5em;overflow:hidden;padding:.15em;transition:.3s;-webkit-user-select:none;user-select:none}#darkTheme+label:after,#darkTheme+label:before{content:"";height:1.2em;transition:inherit;width:1.2em}#darkTheme+label:before{--poly:polygon(44.133707561% 12.9616872277%,50% 0%,55.866292439% 12.9616872277%,59.7057141913% 13.7777815142%,63.4387981079% 14.9907340064%,67.0246437402% 16.5872553429%,79.3892626146% 9.5491502813%,76.5165042945% 23.4834957055%,79.1429735546% 26.4004853356%,81.450146298% 29.5760361869%,83.4127446571% 32.9753562598%,97.5528258148% 34.5491502813%,87.0383127723% 44.133707561%,87.4486075533% 48.0374016409%,87.4486075533% 51.9625983591%,87.0383127723% 55.866292439%,97.5528258148% 65.4508497187%,83.4127446571% 67.0246437402%,81.450146298% 70.4239638131%,79.1429735546% 73.5995146644%,76.5165042945% 76.5165042945%,79.3892626146% 90.4508497187%,67.0246437402% 83.4127446571%,63.4387981079% 85.0092659936%,59.7057141913% 86.2222184858%,55.866292439% 87.0383127723%,50% 100%,44.133707561% 87.0383127723%,40.2942858087% 86.2222184858%,36.561201892% 85.0092659936%,32.9753562598% 83.4127446571%,20.6107373854% 90.4508497187%,23.4834957055% 76.5165042945%,20.8570264454% 73.5995146644%,18.5498537021% 70.4239638131%,16.587255343% 67.0246437402%,2.4471741856% 65.4508497188%,12.9616872286% 55.8662924391%,12.5513924487% 51.9625983594%,12.5513924508% 48.0374016414%,12.961687236% 44.1337075622%,2.4471742159% 34.5491502859%,16.587255404% 32.9753562694%,18.5498538164% 29.5760362054%,20.8570266557% 26.4004853707%,23.4834960862% 23.4834957706%,20.6107385856% 9.5491504949%,32.97535832% 16.5872557238%,36.5612054098% 14.9907346728%,40.2942917387% 13.7777826649%);background:#ff0;-webkit-clip-path:var(--poly);clip-path:var(--poly);transform:translate(calc(var(--i)*(100% + .06em))) scale(calc(1 - var(--i)*.8));transform-origin:20% 20%}#darkTheme+label:after{background:radial-gradient(circle at 19% 19%,transparent 41%,#fff 43%);border-radius:50%;grid-column:2;transform:translatey(calc(var(--i)*(-130% - .15em)))}#darkTheme:checked+label{--i:1}.check-box-container{width:2.9em}';var xi=Object.defineProperty,ao=Object.getOwnPropertyDescriptor,oo=(r,e,t)=>e in r?xi(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$i=(r,e,t,n)=>{for(var i=n>1?void 0:n?ao(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&xi(e,t,i),i},lo=(r,e,t)=>(oo(r,typeof e!="symbol"?e+"":e,t),t);let Ot=class extends G{constructor(){super(...arguments);x(this,"dispatchThemeChangedEvent",t=>{const n=t.target.checked;this.dispatchEvent(se("theme-switch",n?"dark":"light"))})}render(){return v`
      <div class="check-box-container" @click="${t=>t.stopPropagation()}">
        <input type="checkbox" @click="${this.dispatchThemeChangedEvent}" ?checked="${this.theme=="dark"}" id="darkTheme" />
        <label for="darkTheme">Dark</label>
      </div>
    `}};lo(Ot,"styles",[H,V(so)]),$i([S()],Ot.prototype,"theme",2),Ot=$i([L("mte-theme-switch")],Ot);const ki=({hasDetail:r,mode:e},t)=>v`<mte-drawer
    class="container fixed bottom-0 z-10 overflow-hidden rounded-t-3xl bg-gray-200/60 shadow-xl backdrop-blur-lg motion-safe:transition-[height,max-width] motion-safe:duration-200"
    ?hasDetail=${r}
    .mode="${e}"
  >
    ${t}
  </mte-drawer>`;var _i=Object.defineProperty,co=Object.getOwnPropertyDescriptor,uo=(r,e,t)=>e in r?_i(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,kr=(r,e,t,n)=>{for(var i=n>1?void 0:n?co(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&_i(e,t,i),i},po=(r,e,t)=>(uo(r,typeof e!="symbol"?e+"":e,t),t);const Ai=r=>`${r.name}${r.sourceFile&&r.location?` (${ii(r)})`:""}`;let st=class extends ae{constructor(){super(),this.mode="closed"}render(){var r,e,t,n;return ki({hasDetail:!!((e=(r=this.mutant)==null?void 0:r.killedByTests)!=null&&e.length||(n=(t=this.mutant)==null?void 0:t.coveredByTests)!=null&&n.length),mode:this.mode},tt(this.mutant,i=>v`
          <span class="align-middle text-lg" slot="header"
            >${ri(i.status)} ${i.mutatorName} ${i.status}
            (${i.location.start.line}:${i.location.start.column})</span
          >
          <span slot="summary">${this.renderSummary()}</span>
          <span slot="detail" class="block">${this.renderDetail()}</span>
        `))}renderSummary(){var r,e,t,n,i,s,a,o;return ei(v`${(e=(r=this.mutant)==null?void 0:r.killedByTests)!=null&&e[0]?_e(v`${P("🎯","killed")} Killed by:
            ${(t=this.mutant.killedByTests)==null?void 0:t[0].name}${this.mutant.killedByTests.length>1?`(and ${this.mutant.killedByTests.length-1} more)`:""}`):k}
      ${et((n=this.mutant)==null?void 0:n.static,_e(v`${P("🗿","static")} Static mutant`))}
      ${tt((i=this.mutant)==null?void 0:i.coveredByTests,l=>{var c;return _e(v`${P("☂️","umbrella")} Covered by ${l.length}
          test${ni(l)}${((c=this.mutant)==null?void 0:c.status)==="Survived"?" (yet still survived)":""}`)})}
      ${et((a=(s=this.mutant)==null?void 0:s.statusReason)==null?void 0:a.trim(),_e(v`${P("🕵️","spy")} ${this.mutant.statusReason}`,`Reason for the ${this.mutant.status} status`))}
      ${tt((o=this.mutant)==null?void 0:o.description,l=>_e(v`${P("📖","book")} ${l}`))}`)}renderDetail(){var r,e,t,n;return v`<ul class="mb-6 mr-12">
      ${(e=(r=this.mutant)==null?void 0:r.killedByTests)==null?void 0:e.map(i=>kt("This mutant was killed by this test",v`${P("🎯","killed")} ${Ai(i)}`))}
      ${(n=(t=this.mutant)==null?void 0:t.coveredByTests)==null?void 0:n.filter(i=>{var s,a;return!((a=(s=this.mutant)==null?void 0:s.killedByTests)!=null&&a.includes(i))}).map(i=>kt("This mutant was covered by this test",v`${P("☂️","umbrella")} ${Ai(i)}`))}
    </ul>`}};po(st,"styles",[H]),kr([S()],st.prototype,"mutant",2),kr([S({reflect:!0})],st.prototype,"mode",2),st=kr([L("mte-drawer-mutant")],st);const ho="main{padding-bottom:120px}";var Si=Object.defineProperty,fo=Object.getOwnPropertyDescriptor,go=(r,e,t)=>e in r?Si(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,He=(r,e,t,n)=>{for(var i=n>1?void 0:n?fo(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Si(e,t,i),i},mo=(r,e,t)=>(go(r,typeof e!="symbol"?e+"":e,t),t);let ge=class extends ae{constructor(){super();x(this,"handleClick",()=>{this.drawerMode="closed"});x(this,"handleMutantSelected",e=>{this.selectedMutant=e.detail.mutant,this.drawerMode=e.detail.selected?"half":"closed"});this.drawerMode="closed"}updated(e){e.has("result")&&!this.result.file&&(this.drawerMode="closed")}render(){return v`
      <main @click="${this.handleClick}">
        <mte-metrics-table .columns="${bo}" .currentPath="${this.path}" .thresholds="${this.thresholds}" .model="${this.result}">
        </mte-metrics-table>
        ${this.result.file?v`<mte-file @mutant-selected="${this.handleMutantSelected}" .model="${this.result.file}"></mte-file>`:k}
      </main>
      <mte-drawer-mutant .mode="${this.drawerMode}" .mutant="${this.selectedMutant}"></mte-drawer-mutant>
    `}};mo(ge,"styles",[V(ho),H]),He([S()],ge.prototype,"drawerMode",2),He([S()],ge.prototype,"selectedMutant",2),He([S()],ge.prototype,"result",2),He([S({attribute:!1,reflect:!1})],ge.prototype,"thresholds",2),He([S({attribute:!1,reflect:!1})],ge.prototype,"path",2),ge=He([L("mte-mutant-view")],ge);const bo=[{key:"mutationScore",label:"Mutation score",tooltip:"The percentage of mutants that were detected. The higher, the better!",category:"percentage"},{key:"killed",label:"Killed",tooltip:"At least one test failed while these mutants were active. This is what you want!",category:"number"},{key:"survived",label:"Survived",tooltip:"All tests passed while these mutants were active. You're missing a test for them.",category:"number"},{key:"timeout",label:"Timeout",tooltip:"Running the tests while these mutants were active resulted in a timeout. For example, an infinite loop.",category:"number"},{key:"noCoverage",label:"No coverage",tooltip:"These mutants aren't covered by one of your tests and survived as a result.",category:"number"},{key:"ignored",label:"Ignored",tooltip:"These mutants weren't tested because they are ignored. Either by user action, or for another reason.",category:"number"},{key:"runtimeErrors",label:"Runtime errors",tooltip:"Running tests when these mutants are active resulted in an error (rather than a failed test). For example: an out of memory error.",category:"number"},{key:"compileErrors",label:"Compile errors",tooltip:"Mutants that caused a compile error.",category:"number"},{key:"totalDetected",label:"Detected",tooltip:"The number of mutants detected by your tests (killed + timeout).",category:"number",width:"large",isBold:!0},{key:"totalUndetected",label:"Undetected",tooltip:"The number of mutants that are not detected by your tests (survived + no coverage).",category:"number",width:"large",isBold:!0},{key:"totalMutants",label:"Total",tooltip:"All mutants (except runtimeErrors + compileErrors)",category:"number",width:"large",isBold:!0}],vo="main{padding-bottom:120px}";var Ci=Object.defineProperty,yo=Object.getOwnPropertyDescriptor,wo=(r,e,t)=>e in r?Ci(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,at=(r,e,t,n)=>{for(var i=n>1?void 0:n?yo(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Ci(e,t,i),i},xo=(r,e,t)=>(wo(r,typeof e!="symbol"?e+"":e,t),t);let Ce=class extends ae{constructor(){super();x(this,"handleClick",()=>{this.drawerMode="closed"});x(this,"handleTestSelected",e=>{this.selectedTest=e.detail.test,this.drawerMode=e.detail.selected?"half":"closed"});this.drawerMode="closed"}updated(e){e.has("result")&&!this.result.file&&(this.drawerMode="closed")}render(){return v`
      <main @click="${this.handleClick}">
        <mte-metrics-table .columns="${$o}" .currentPath="${this.path}" .model="${this.result}"> </mte-metrics-table>
        ${this.result.file?v`<mte-test-file @test-selected="${this.handleTestSelected}" .model="${this.result.file}"></mte-test-file>`:k}
      </main>
      <mte-drawer-test .mode="${this.drawerMode}" .test="${this.selectedTest}"></mte-drawer-test>
    `}};xo(Ce,"styles",[V(vo),H]),at([S()],Ce.prototype,"drawerMode",2),at([S()],Ce.prototype,"result",2),at([S({attribute:!1,reflect:!1})],Ce.prototype,"path",2),at([S()],Ce.prototype,"selectedTest",2),Ce=at([L("mte-test-view")],Ce);const $o=[{key:"killing",label:"Killing",tooltip:"These tests killed at least one mutant",width:"normal",category:"number"},{key:"covering",label:"Covering",tooltip:"These tests are covering at least one mutant, but not killing any of them.",width:"normal",category:"number"},{key:"notCovering",label:"Not Covering",tooltip:"These tests were not covering a mutant (and thus not killing any of them).",width:"normal",category:"number"},{key:"total",label:"Total tests",width:"large",category:"number",isBold:!0}];/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ei=Ct(class extends Et{constructor(r){var e;if(super(r),r.type!==St.ATTRIBUTE||r.name!=="class"||((e=r.strings)==null?void 0:e.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(r){return" "+Object.keys(r).filter(e=>r[e]).join(" ")+" "}update(r,[e]){var n,i;if(this.it===void 0){this.it=new Set,r.strings!==void 0&&(this.st=new Set(r.strings.join(" ").split(/\s/).filter(s=>s!=="")));for(const s in e)e[s]&&!((n=this.st)!=null&&n.has(s))&&this.it.add(s);return this.render(e)}const t=r.element.classList;for(const s of this.it)s in e||(t.remove(s),this.it.delete(s));for(const s in e){const a=!!e[s];a===this.it.has(s)||(i=this.st)!=null&&i.has(s)||(a?(t.add(s),this.it.add(s)):(t.remove(s),this.it.delete(s)))}return ie}});var Mi=Object.defineProperty,ko=Object.getOwnPropertyDescriptor,_o=(r,e,t)=>e in r?Mi(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ot=(r,e,t,n)=>{for(var i=n>1?void 0:n?ko(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Mi(e,t,i),i},Ao=(r,e,t)=>(_o(r,typeof e!="symbol"?e+"":e,t),t);let Ee=class extends ae{constructor(){super();x(this,"hasMultipleColspan",!1);this.currentPath=[],this.thresholds={high:80,low:60}}willUpdate(e){e.has("columns")&&(this.hasMultipleColspan=this.columns.some(t=>t.category==="percentage"))}render(){return v`${this.model?v`<div class="overflow-x-auto rounded-md border border-gray-200">
          <table class="w-full table-auto text-left text-sm">${this.renderTableHeadRow()}${this.renderTableBody(this.model)} </table>
        </div>`:k}`}renderTableHeadRow(){return v`<thead class="border-b border-gray-200 text-center text-sm">
      <tr>
        <th scope="col" class="px-4 py-4">
          <div class="flex items-center justify-around">
            <span>File / Directory</span
            ><a
              href="https://stryker-mutator.io/docs/mutation-testing-elements/mutant-states-and-metrics"
              target="_blank"
              class="info-icon float-right"
              title="What does this all mean?"
              >${P("ℹ","info icon")}</a
            >
          </div>
        </th>
        ${Ft(this.columns,e=>e.key,e=>this.renderTableHead(e))}
      </tr>
    </thead>`}renderTableHead(e){const t=`tooltip-${e.key.toString()}`,n=e.tooltip?v`<mte-tooltip title="${e.tooltip}" id="${t}">${e.label}</mte-tooltip>`:v`<span id="${t}">${e.label}</span>`;return e.category==="percentage"?v` <th colspan="2" class="px-2 even:bg-gray-100"> ${n} </th>`:v`<th class="w-24 px-2 even:bg-gray-100 2xl:w-28">
      <div class="inline-block">${n}</div>
    </th>`}renderTableBody(e){const t=()=>e.file?k:e.childResults.map(n=>{const i=[n.name];for(;!n.file&&n.childResults.length===1;)n=n.childResults[0],i.push(n.name);return this.renderRow(i.join("/"),n,...this.currentPath,...i)});return v`<tbody class="divide-y divide-gray-200">${this.renderRow(e.name,e)} ${t()}</tbody>`}renderRow(e,t,...n){return v`<tr title="${t.name}" class="group hover:bg-gray-200">
      <td class="font-semibold">
        <div class="flex items-center justify-start">
          <mte-file-icon file-name="${t.name}" ?file="${t.file}" class="mx-1"></mte-file-icon> ${n.length>0?v`<a class="mr-auto inline-block w-full py-4 pr-2 hover:text-primary-on hover:underline" href="${At(...n)}"
                >${e}</a
              >`:v`<span class="py-4">${t.name}</span>`}
        </div>
      </td>
      ${this.columns.map(i=>this.renderCell(i,t.metrics))}
    </tr>`}renderCell(e,t){const n=t[e.key],i=this.hasMultipleColspan?"odd:bg-gray-100":"even:bg-gray-100";if(e.category==="percentage"){const s=!isNaN(n),a=this.determineBgColoringClass(n),o=this.determineTextColoringClass(n),l=n.toFixed(2),c=`width: ${n}%`;return v`<td class="bg-gray-100 px-4 py-4 group-hover:bg-gray-200">
          ${s?v`<div class="h-3 w-full min-w-[24px] rounded-full bg-gray-300">
                <div
                  class="${a} h-3 rounded-full pl-1 transition-all"
                  role="progressbar"
                  aria-valuenow="${l}"
                  aria-valuemin="0"
                  aria-valuemax="100"
                  aria-describedby="tooltip-mutationScore"
                  title="${e.label}"
                  style="${c}"
                ></div>
              </div>`:v` <span class="text-light-muted font-bold">N/A</span> `}
        </td>
        <td class="${o} ${i} w-12 pr-2 text-center font-bold group-hover:bg-gray-200"
          >${s?v`<span class="transition-colors">${l}</span>`:k}</td
        >`}return v`<td
      class="${Ei({"font-bold":e.isBold??!1,[i]:!0})} py-4 text-center group-hover:bg-gray-200"
      aria-describedby="${`tooltip-${e.key.toString()}`}"
      >${n}</td
    >`}determineBgColoringClass(e){return!isNaN(e)&&this.thresholds?e<this.thresholds.low?"bg-red-600 text-gray-200":e<this.thresholds.high?"bg-yellow-400":"bg-green-600 text-gray-200":"bg-blue-600"}determineTextColoringClass(e){return!isNaN(e)&&this.thresholds?e<this.thresholds.low?"text-red-700":e<this.thresholds.high?"text-yellow-600":"text-green-700":""}};Ao(Ee,"styles",[H]),ot([S()],Ee.prototype,"model",2),ot([S()],Ee.prototype,"currentPath",2),ot([S({type:Array})],Ee.prototype,"columns",2),ot([S()],Ee.prototype,"thresholds",2),Ee=ot([L("mte-metrics-table")],Ee);const So='#report-code-block{background:var(--prism-background);border:1px solid var(--prism-border);overflow-x:auto;overflow-y:visible}.line-numbers{counter-reset:mte-line-number}.line .line-number{color:var(--mut-line-number);counter-increment:mte-line-number;padding:0 10px 0 15px;text-align:right}.line .line-number:before{content:counter(mte-line-number)}.line-marker:before{content:" ";padding:0 5px}svg.test-dot.Killing{fill:#15803d}svg.test-dot.Covering{fill:#fbbf24}svg.test-dot.NotCovering{fill:#f97316}svg.test-dot.selected{fill:#38bdf8}svg.test-dot{margin:2px}';var Ti=Object.defineProperty,Co=Object.getOwnPropertyDescriptor,Eo=(r,e,t)=>e in r?Ti(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Me=(r,e,t,n)=>{for(var i=n>1?void 0:n?Co(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Ti(e,t,i),i},Mo=(r,e,t)=>(Eo(r,typeof e!="symbol"?e+"":e,t),t);let le=class extends ae{constructor(){super();x(this,"filtersChanged",e=>{this.enabledStates=e.detail,this.selectedTest&&!this.enabledStates.includes(this.selectedTest.status)&&this.toggleTest(this.selectedTest)});x(this,"nextTest",()=>{const e=this.selectedTest?(this.tests.findIndex(({id:t})=>t===this.selectedTest.id)+1)%this.tests.length:0;this.selectTest(this.tests[e])});x(this,"previousTest",()=>{const e=this.selectedTest?(this.tests.findIndex(({id:t})=>t===this.selectedTest.id)+this.tests.length-1)%this.tests.length:this.tests.length-1;this.selectTest(this.tests[e])});this.filters=[],this.lines=[],this.enabledStates=[],this.tests=[]}toggleTest(e){this.selectedTest===e?(this.selectedTest=void 0,this.dispatchEvent(se("test-selected",{selected:!1,test:e}))):(this.selectedTest=e,this.dispatchEvent(se("test-selected",{selected:!0,test:e})),si(this.shadowRoot.querySelector(`[test-id="${e.id}"]`)))}selectTest(e){e&&this.toggleTest(e)}render(){return v`
      <mte-state-filter
        @next=${this.nextTest}
        @previous=${this.previousTest}
        .filters="${this.filters}"
        @filters-changed="${this.filtersChanged}"
      ></mte-state-filter>
      ${this.renderTestList()} ${this.renderCode()}
    `}renderTestList(){const e=this.tests.filter(t=>!t.location);return e.length?v`<ul class="max-w-6xl">
        ${Ft(e,t=>t.id,t=>v`<li class="my-3">
              <button
                class="w-full rounded p-3 text-left hover:bg-gray-100 active:bg-gray-200"
                type="button"
                data-active="${this.selectedTest===t}"
                test-id="${t.id}"
                @click=${n=>{n.stopPropagation(),this.toggleTest(t)}}
                >${hr(t.status)} ${t.name} [${t.status}]
              </button>
            </li>`)}
      </ul>`:k}renderCode(){var e;if((e=this.model)!=null&&e.source){const t=new Map;for(const i of this.tests)if(i.location){let s=t.get(i.location.start.line);s||(s=[],t.set(i.location.start.line,s)),s.push(i)}const n=i=>this.renderTestDots([...t.entries()].filter(([s])=>s>i).flatMap(([,s])=>s));return v`<pre id="report-code-block" class="line-numbers flex rounded-md p-1"><code class="flex language-${br(this.model.name)}">
      <table>
        ${this.lines.map((i,s)=>{const a=s+1,o=this.renderTestDots(t.get(a)),l=this.lines.length===a?n(a):k;return pi(i,di(o,l))})}</table></code></pre>`}return k}renderTestDots(e){return e!=null&&e.length?e.map(t=>U`<svg test-id="${t.id}" class="cursor-pointer test-dot ${this.selectedTest===t?"selected":t.status}" @click=${n=>{n.stopPropagation(),this.toggleTest(t)}} height="10" width="12">
          <title>${To(t)}</title>
          <circle cx="5" cy="5" r="5" />
          </svg>`):k}reactivate(){super.reactivate(),this.updateFileRepresentation()}willUpdate(e){e.has("model")&&this.updateFileRepresentation(),(e.has("model")||e.has("enabledStates"))&&this.model&&(this.tests=this.model.tests.filter(t=>this.enabledStates.includes(t.status)).sort((t,n)=>t.location&&n.location?Pt(t.location.start,n.location.start)?1:-1:this.model.tests.indexOf(t)-this.model.tests.indexOf(n))),super.update(e)}updateFileRepresentation(){if(!this.model)return;const e=this.model;this.filters=[B.Killing,B.Covering,B.NotCovering].filter(t=>e.tests.some(n=>n.status===t)).map(t=>({enabled:!0,count:e.tests.filter(n=>n.status===t).length,status:t,label:v`${hr(t)} ${t}`,context:Ca(t)})),this.model.source&&(this.lines=yr(vr(this.model.source,this.model.name)))}};Mo(le,"styles",[_n,H,V(So)]),Me([S()],le.prototype,"model",2),Me([Y()],le.prototype,"filters",2),Me([Y()],le.prototype,"lines",2),Me([Y()],le.prototype,"enabledStates",2),Me([Y()],le.prototype,"selectedTest",2),Me([Y()],le.prototype,"tests",2),le=Me([L("mte-test-file")],le);function To(r){return`${r.name} (${r.status})`}var Pi=Object.defineProperty,Po=Object.getOwnPropertyDescriptor,Fo=(r,e,t)=>e in r?Pi(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,_r=(r,e,t,n)=>{for(var i=n>1?void 0:n?Po(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Pi(e,t,i),i},zo=(r,e,t)=>(Fo(r,typeof e!="symbol"?e+"":e,t),t);const Ar=r=>v`<code>${r.getMutatedLines()}</code> (${ii(r)})`;let lt=class extends ae{constructor(){super(),this.mode="closed"}render(){var r,e,t,n;return ki({hasDetail:!!((e=(r=this.test)==null?void 0:r.killedMutants)!=null&&e.length||(n=(t=this.test)==null?void 0:t.coveredMutants)!=null&&n.length),mode:this.mode},tt(this.test,i=>v`
          <span class="align-middle text-lg" slot="header"
            >${hr(i.status)} ${i.name} [${i.status}]
            ${i.location?v`(${i.location.start.line}:${i.location.start.column})`:k}</span
          >
          <span slot="summary">${this.renderSummary()}</span>
          <span class="block" slot="detail">${this.renderDetail()}</span>
        `))}renderSummary(){var r,e,t,n;return ei(v`${(e=(r=this.test)==null?void 0:r.killedMutants)!=null&&e[0]?_e(v`${P("🎯","killed")} Killed:
            ${Ar((t=this.test.killedMutants)==null?void 0:t[0])}${this.test.killedMutants.length>1?v` (and ${this.test.killedMutants.length-1} more)`:""}`):k}
      ${tt((n=this.test)==null?void 0:n.coveredMutants,i=>{var s;return _e(v`${P("☂️","umbrella")} Covered ${i.length}
          mutant${ni(i)}${((s=this.test)==null?void 0:s.status)===B.Covering?" (yet didn't kill any of them)":""}`)})}`)}renderDetail(){var r,e,t,n;return v`<ul class="mb-6 mr-12">
      ${(e=(r=this.test)==null?void 0:r.killedMutants)==null?void 0:e.map(i=>kt("This test killed this mutant",v`${P("🎯","killed")} ${Ar(i)}`))}
      ${(n=(t=this.test)==null?void 0:t.coveredMutants)==null?void 0:n.filter(i=>{var s,a;return!((a=(s=this.test)==null?void 0:s.killedMutants)!=null&&a.includes(i))}).map(i=>kt("This test covered this mutant",v`${P("☂️","umbrella")} ${Ar(i)}`))}
    </ul>`}};zo(lt,"styles",[H]),_r([S()],lt.prototype,"test",2),_r([S({reflect:!0})],lt.prototype,"mode",2),lt=_r([L("mte-drawer-test")],lt);const Oo="svg.cs{fill:var(--mut-file-csharp-color)}svg.html{fill:var(--mut-file-html-color)}svg.java{fill:var(--mut-file-java-color)}svg.javascript{fill:var(--mut-file-js-color)}svg.scala{fill:var(--mut-file-scala-color)}svg.typescript{fill:var(--mut-file-ts-color)}svg.php{fill:var(--mut-file-php-color)}svg.vue{fill:var(--mut-file-vue-color)}svg.octicon{fill:var(--mut-octicon-icon-color)}svg.javascript.test,svg.typescript.test{fill:var(--mut-file-js-test-color)}svg.gherkin{fill:var(--mut-file-gherkin-color)}svg{vertical-align:middle;width:20px}";var Fi=Object.defineProperty,Ro=Object.getOwnPropertyDescriptor,jo=(r,e,t)=>e in r?Fi(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Sr=(r,e,t,n)=>{for(var i=n>1?void 0:n?Ro(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Fi(e,t,i),i},Io=(r,e,t)=>(jo(r,typeof e!="symbol"?e+"":e,t),t);let ct=class extends G{get language(){return br(this.fileName)}get isTestFile(){const r=this.fileName.substr(0,this.fileName.lastIndexOf(".")).toLowerCase();return r.endsWith("spec")||r.endsWith("test")}get cssClass(){var r;return Ei({[((r=this.language)==null?void 0:r.toString())??"unknown"]:this.isFile,test:this.isTestFile})}render(){if(!this.isFile)return U`<svg aria-label="directory" class="octicon octicon-file-directory" viewBox="0 0 14 16" version="1.1" width="14" height="16" role="img"><path fill-rule="evenodd" d="M 13,2 H 7 V 1 C 7,0.34 6.69,0 6,0 H 1 C 0.45,0 0,0.45 0,1 v 10 c 0,0.55 0.45,1 1,1 h 12 c 0.55,0 1,-0.45 1,-1 V 3 C 14,2.45 13.55,2 13,2 Z M 6,2 H 1 V 1 h 5 z" id="path2" /></svg>`;if(!this.language)return U`<svg aria-label="file" class="octicon octicon-file" viewBox="0 0 12 16" version="1.1" width="12" height="16" role="img"><path fill-rule="evenodd" d="M6 5H2V4h4v1zM2 8h7V7H2v1zm0 2h7V9H2v1zm0 2h7v-1H2v1zm10-7.5V14c0 .55-.45 1-1 1H1c-.55 0-1-.45-1-1V2c0-.55.45-1 1-1h7.5L12 4.5zM11 5L8 2H1v12h10V5z"></path></svg>`;switch(this.language){case J.csharp:return U`<svg class="${this.cssClass}" aria-label="cs" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><g><path d="M7.1 15.9c0-1.3.2-2.4.6-3.4.4-1 .9-1.8 1.6-2.5.7-.7 1.5-1.2 2.4-1.6s1.9-.5 2.9-.5 1.9.2 2.7.6c.8.4 1.5.9 2 1.4l-2.2 2.5c-.4-.3-.7-.6-1.1-.7-.4-.1-.8-.3-1.4-.3-.5 0-.9.1-1.3.3-.4.2-.8.5-1.1.9s-.5.8-.7 1.4c-.2.6-.3 1.2-.3 1.9 0 1.5.3 2.6 1 3.3.7.8 1.5 1.2 2.6 1.2.5 0 1-.1 1.4-.3.4-.2.8-.5 1.1-.9l2.2 2.5c-.7.8-1.4 1.3-2.2 1.7-.8.4-1.7.6-2.7.6s-2-.2-2.9-.5-1.7-.8-2.4-1.5-1.1-1.7-1.5-2.7c-.5-.9-.7-2.1-.7-3.4z"/><path d="M21.8 17.1h-1l-.4 2.4h-1.2l.4-2.4h-1.2V16h1.5l.2-1.6h-1.3v-1.1h1.5l.4-2.4h1.2l-.4 2.4h1l.4-2.4h1.2l-.4 2.4H25v1.1h-1.6l-.2 1.6h1.3v1.1h-1.6l-.4 2.4h-1.2c0 .1.5-2.4.5-2.4zm-.8-1h1l.2-1.6h-1l-.2 1.6z"/></g></svg>`;case J.html:return U`<svg class="${this.cssClass}" aria-label="html" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M8 15l6-5.6V12l-4.5 4 4.5 4v2.6L8 17v-2zm16 2.1l-6 5.6V20l4.6-4-4.6-4V9.3l6 5.6v2.2z"/></svg>`;case J.java:return U`<svg class="${this.cssClass}" aria-label="java" xmlns="http://www.w3.org/2000/svg" viewBox="-4 -4 20 20"><path class="cls-1" d="M6 0a6 6 0 1 0 6 6 6 6 0 0 0-6-6zm2.14 6.8a2.16 2.16 0 0 1-2.29 2.41 2.5 2.5 0 0 1-2-.87l.73-.92a1.52 1.52 0 0 0 1.23.59c.66 0 1.06-.42 1.06-1.32V2.8h1.26z"/></svg>`;case J.javascript:return U`<svg class="${this.cssClass}" aria-label="js" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path  d="M11.4 10h2.7v7.6c0 3.4-1.6 4.6-4.3 4.6-.6 0-1.5-.1-2-.3l.3-2.2c.4.2.9.3 1.4.3 1.1 0 1.9-.5 1.9-2.4V10zm5.1 9.2c.7.4 1.9.8 3 .8 1.3 0 1.9-.5 1.9-1.3s-.6-1.2-2-1.7c-2-.7-3.3-1.8-3.3-3.6 0-2.1 1.7-3.6 4.6-3.6 1.4 0 2.4.3 3.1.6l-.6 2.2c-.5-.2-1.3-.6-2.5-.6s-1.8.5-1.8 1.2c0 .8.7 1.1 2.2 1.7 2.1.8 3.1 1.9 3.1 3.6 0 2-1.6 3.7-4.9 3.7-1.4 0-2.7-.4-3.4-.7l.6-2.3z"/></svg>`;case J.typescript:return U`<svg class="${this.cssClass}" aria-label="ts" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M15.6 11.8h-3.4V22H9.7V11.8H6.3V10h9.2v1.8zm7.7 7.1c0-.5-.2-.8-.5-1.1-.3-.3-.9-.5-1.7-.8-1.4-.4-2.5-.9-3.3-1.5-.7-.6-1.1-1.3-1.1-2.3 0-1 .4-1.8 1.3-2.4.8-.6 1.9-.9 3.2-.9 1.3 0 2.4.4 3.2 1.1.8.7 1.2 1.6 1.2 2.6h-2.3c0-.6-.2-1-.6-1.4-.4-.3-.9-.5-1.6-.5-.6 0-1.1.1-1.5.4-.4.3-.5.7-.5 1.1 0 .4.2.7.6 1 .4.3 1 .5 2 .8 1.3.4 2.3.9 3 1.5.7.6 1 1.4 1 2.4s-.4 1.9-1.2 2.4c-.8.6-1.9.9-3.2.9-1.3 0-2.5-.3-3.4-1s-1.5-1.6-1.4-2.9h2.4c0 .7.2 1.2.7 1.6.4.3 1.1.5 1.8.5s1.2-.1 1.5-.4c.2-.3.4-.7.4-1.1z"/></svg>`;case J.scala:return U`<svg class="${this.cssClass}" aria-label="scala" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M21.6 7v4.2c-.1.1-.1.2-.2.2-.3.3-.7.5-1.1.6-.9.3-1.9.5-2.8.7-1.6.3-3.1.5-4.7.7-.8.1-1.6.2-2.4.4V9.6c.1-.1.2-.1.4-.1 1.2-.2 2.5-.4 3.8-.5 1.9-.3 3.8-.5 5.6-1.1.5-.2 1.1-.4 1.4-.9zm0 5.6v4.2l-.2.2c-.5.4-1.1.6-1.6.8-.8.2-1.6.4-2.4.5-1 .2-1.9.3-2.9.5-1.4.2-2.7.3-4.1.6v-4.2c.1-.1.2-.1.3-.1 1.7-.2 3.4-.5 5.1-.7 1.4-.2 2.9-.5 4.3-.9.6-.2 1.1-.4 1.5-.9zM10.5 25h-.1v-4.2c.1-.1.2-.1.3-.1 1.2-.2 2.3-.3 3.5-.5 2-.3 3.9-.5 5.8-1.1.6-.2 1.2-.4 1.6-.9v4.2c-.1.2-.3.3-.5.5-.6.3-1.2.5-1.9.7-1.2.3-2.5.5-3.7.7-1.3.2-2.6.4-3.9.5-.4 0-.7.1-1.1.2z"/></svg>`;case J.php:return U`<svg class="${this.cssClass}" aria-label="php" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M12.7 19.7c-.1-.6-.4-1.1-1-1.3-.2-.1-.5-.3-.7-.4-.3-.1-.6-.2-.8-.3-.2-.1-.4 0-.6.2-.1.2 0 .4.1.5.1.2.2.3.4.5.2.3.4.5.7.8.2.3.4.5.3.9-.1.7-.4 1.4-.9 1.9-.1.1-.2.1-.2.1-.3 0-.7-.2-.9-.4-.3-.3-.2-.6.1-.8.1 0 .2-.1.2-.2.2-.2.3-.4.2-.7-.1-.1-.1-.2-.2-.3-.4-.4-.9-.8-1.4-1.2-1.3-1-1.9-2.2-2-3.6-.1-1.6.3-3.1 1.1-4.5.3-.5.7-1 1.3-1.3.4-.2.8-.3 1.2-.4 1.1-.3 2.3-.5 3.5-.3 1 .2 1.8.7 2.1 1.7.2.7.3 1.3.2 2-.1 1.4-1.2 2.6-2.5 3-.6.2-.9.1-1.2-.4-.2-.3-.5-.7-.7-1.1V14c0-.1-.1-.1-.1-.2.1.6.2 1.2.5 1.7.2.3.4.5.8.5 1.3.1 2.3-.3 3.1-1.3.8-1.1 1-2.4.8-3.8 0-.3-.1-.5-.2-.8 0-.2 0-.3.2-.4.1 0 .2 0 .2-.1 1-.2 2.1-.3 3.1-.2 1.2.1 2.3.4 3.3 1.1 1.6 1 2.6 2.5 3.1 4.3.1.3.1.5.1.8 0 .2-.1.2-.3.1-.2-.1-.3-.3-.4-.4-.1-.1-.2-.3-.3-.4-.1-.1-.2-.1-.2 0s-.1.2-.1.3c-.3 1-.7 1.9-1.4 2.6-.1.1-.2.3-.2.4 0 .4-.1.8 0 1.2.1.8.2 1.7.3 2.5.1.5-.1.7-.5.9-.3.1-.6.2-1 .2h-1.6c0-.6 0-1.2-.5-1.5.1-.4.2-.8.3-1.3.1-.4 0-.7-.2-1-.2-.3-.5-.3-.8-.2-.8.5-1.6.5-2.5.2-.4-.1-.7-.1-.9.3-.2.4-.3.8-.3 1.2 0 .5.1 1.1.2 1.6 0 .3 0 .4-.3.5-.7.2-1.4.2-2 .1h-.1c0-.6 0-1.2-.7-1.5.4-.4.4-1.1.3-1.7zm-4.1-2.3c.1-.1.2-.2.2-.4.1-.3-.2-.8-.5-.9-.2-.1-.3 0-.4.1-.3.3-.5.6-.8.9 0 .1-.1.1-.1.2-.1.2 0 .4.2.4.1 0 .3 0 .4.1.4 0 .7-.1 1-.4zm0-3.3c0-.2-.2-.4-.4-.4s-.5.2-.4.5c0 .2.2.4.5.4.1-.1.3-.3.3-.5z"/></svg>`;case J.vue:return U`<svg class="${this.cssClass}" aria-label="vue" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 1000"><path d="M600 495.9l159.1-275.4h-84.4L600 349.7l-74.6-129.2h-84.5z"/><path d="M793.7 220.5L600 555.9 406.3 220.5H277l323 559 323-559z"/></svg>`;case J.gherkin:return U`<svg class="${this.cssClass}" aria-label="gherkin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M16.129,2a12.348,12.348,0,0,0-2.35,24.465V30c7.371-1.114,13.9-6.982,14.384-14.684a12.8,12.8,0,0,0-5.9-11.667c-.223-.132-.449-.262-.682-.377s-.481-.231-.729-.33c-.079-.033-.156-.063-.235-.094-.216-.08-.435-.17-.658-.236A12.188,12.188,0,0,0,16.129,2Z" style="fill:var(--mut-file-gherkin-color)"/><path d="M18.68,6.563a1.345,1.345,0,0,0-1.178.472,5.493,5.493,0,0,0-.518.9,2.9,2.9,0,0,0,.377,3.023A3.317,3.317,0,0,0,19.763,9,2.388,2.388,0,0,0,20,8,1.411,1.411,0,0,0,18.68,6.563Zm-5.488.071A1.441,1.441,0,0,0,11.85,8,2.388,2.388,0,0,0,12.085,9a3.427,3.427,0,0,0,2.473,1.96,3.141,3.141,0,0,0-.212-3.85,1.322,1.322,0,0,0-1.154-.472Zm-3.7,3.637a1.3,1.3,0,0,0-.73,2.338,5.663,5.663,0,0,0,.895.543,3.386,3.386,0,0,0,3.179-.307,3.492,3.492,0,0,0-2.049-2.338,2.69,2.69,0,0,0-1.06-.236,1.369,1.369,0,0,0-.236,0Zm11.611,4.582a3.44,3.44,0,0,0-1.955.567A3.492,3.492,0,0,0,21.2,17.758a2.69,2.69,0,0,0,1.06.236,1.329,1.329,0,0,0,.966-2.362,5.47,5.47,0,0,0-.895-.52,3.247,3.247,0,0,0-1.225-.26Zm-10.292.071a3.247,3.247,0,0,0-1.225.26,2.575,2.575,0,0,0-.895.543A1.34,1.34,0,0,0,9.73,18.065a2.426,2.426,0,0,0,1.06-.236,3.185,3.185,0,0,0,1.955-2.338,3.366,3.366,0,0,0-1.931-.567Zm3.815,2.314a3.317,3.317,0,0,0-2.4,1.96,2.286,2.286,0,0,0-.236.968,1.4,1.4,0,0,0,2.426.992,5.492,5.492,0,0,0,.518-.9,3.109,3.109,0,0,0-.306-3.023Zm2.8.071a3.141,3.141,0,0,0,.212,3.85,1.47,1.47,0,0,0,2.5-.9,2.388,2.388,0,0,0-.236-.992,3.427,3.427,0,0,0-2.473-1.96Z" style="fill:#fff"/></svg>`;case J.svelte:return U`<svg class="${this.cssClass}" aria-label="svelte" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path xmlns="http://www.w3.org/2000/svg" d="M26.47,5.7A8.973,8.973,0,0,0,14.677,3.246L7.96,7.4a7.461,7.461,0,0,0-3.481,5.009,7.686,7.686,0,0,0,.8,5.058,7.358,7.358,0,0,0-1.151,2.8,7.789,7.789,0,0,0,1.4,6.028,8.977,8.977,0,0,0,11.794,2.458L24.04,24.6a7.468,7.468,0,0,0,3.481-5.009,7.673,7.673,0,0,0-.8-5.062,7.348,7.348,0,0,0,1.152-2.8A7.785,7.785,0,0,0,26.47,5.7" style="fill:#ff3e00"/><path xmlns="http://www.w3.org/2000/svg" d="M14.022,26.64A5.413,5.413,0,0,1,8.3,24.581a4.678,4.678,0,0,1-.848-3.625,4.307,4.307,0,0,1,.159-.61l.127-.375.344.238a8.76,8.76,0,0,0,2.628,1.274l.245.073-.025.237a1.441,1.441,0,0,0,.271.968,1.63,1.63,0,0,0,1.743.636,1.512,1.512,0,0,0,.411-.175l6.7-4.154a1.366,1.366,0,0,0,.633-.909,1.407,1.407,0,0,0-.244-1.091,1.634,1.634,0,0,0-1.726-.622,1.509,1.509,0,0,0-.413.176l-2.572,1.584a4.934,4.934,0,0,1-1.364.582,5.415,5.415,0,0,1-5.727-2.06A4.678,4.678,0,0,1,7.811,13.1,4.507,4.507,0,0,1,9.9,10.09l6.708-4.154a4.932,4.932,0,0,1,1.364-.581A5.413,5.413,0,0,1,23.7,7.414a4.679,4.679,0,0,1,.848,3.625,4.272,4.272,0,0,1-.159.61l-.127.375-.344-.237a8.713,8.713,0,0,0-2.628-1.274l-.245-.074.025-.237a1.438,1.438,0,0,0-.272-.968,1.629,1.629,0,0,0-1.725-.622,1.484,1.484,0,0,0-.411.176l-6.722,4.14a1.353,1.353,0,0,0-.631.908,1.394,1.394,0,0,0,.244,1.092,1.634,1.634,0,0,0,1.726.621,1.538,1.538,0,0,0,.413-.175l2.562-1.585a4.9,4.9,0,0,1,1.364-.581,5.417,5.417,0,0,1,5.728,2.059,4.681,4.681,0,0,1,.843,3.625A4.5,4.5,0,0,1,22.1,21.905l-6.707,4.154a4.9,4.9,0,0,1-1.364.581" style="fill:#fff"/></svg>`}}};Io(ct,"styles",[V(Oo)]),Sr([S({attribute:"file-name"})],ct.prototype,"fileName",2),Sr([S({attribute:"file",type:Boolean})],ct.prototype,"isFile",2),ct=Sr([L("mte-file-icon")],ct);var zi=Object.defineProperty,Do=Object.getOwnPropertyDescriptor,Bo=(r,e,t)=>e in r?zi(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Oi=(r,e,t,n)=>{for(var i=n>1?void 0:n?Do(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&zi(e,t,i),i},No=(r,e,t)=>(Bo(r,typeof e!="symbol"?e+"":e,t),t);let Rt=class extends G{render(){return v`<span class="cursor-help underline decoration-dotted" title="${this.title}"><slot></slot></span>`}};No(Rt,"styles",[H]),Oi([S({attribute:!0})],Rt.prototype,"title",2),Rt=Oi([L("mte-tooltip")],Rt);var Ri=Object.defineProperty,Lo=Object.getOwnPropertyDescriptor,Uo=(r,e,t)=>e in r?Ri(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Te=(r,e,t,n)=>{for(var i=n>1?void 0:n?Lo(e,t):e,s=r.length-1,a;s>=0;s--)(a=r[s])&&(i=(n?a(e,t,i):a(i))||i);return n&&i&&Ri(e,t,i),i},Ho=(r,e,t)=>(Uo(r,typeof e!="symbol"?e+"":e,t),t),Cr=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)},ji=(r,e,t)=>(Cr(r,e,"read from private field"),t?t.call(r):e.get(r)),me=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},Ko=(r,e,t,n)=>(Cr(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),ee=(r,e,t)=>(Cr(r,e,"access private method"),t),ut,Er,Ii,Mr,Di,Tr,Bi,Pr,Ni,jt,Fr,It,zr,Dt,Or;let ce=class extends G{constructor(){super(),me(this,Er),me(this,Mr),me(this,Tr),me(this,Pr),me(this,jt),me(this,It),me(this,Dt),me(this,ut,void 0),this.detected=0,this.noCoverage=0,this.pending=0,this.survived=0,this.total=0,this.shouldBeSmall=!1}connectedCallback(){super.connectedCallback(),Ko(this,ut,new window.IntersectionObserver(([r])=>{r.isIntersecting?this.shouldBeSmall=!1:this.shouldBeSmall=!0,this.requestUpdate()})),ji(this,ut).observe(this)}disconnectedCallback(){var r;super.disconnectedCallback(),(r=ji(this,ut))==null||r.disconnect()}render(){return v`
      ${ee(this,Er,Ii).call(this)}
      <div class="my-4 rounded-md border border-gray-200 bg-white transition-all">
        <div class="relative">
          <div class="parts flex h-8 w-full overflow-hidden rounded bg-gray-200">${ee(this,Tr,Bi).call(this)}</div>
        </div>
      </div>
    `}};return ut=new WeakMap,Er=new WeakSet,Ii=function(){return v`<div
      class="${this.shouldBeSmall?"opacity-1":"opacity-0"} pointer-events-none fixed left-0 top-0 z-20 flex w-full justify-center transition-all"
    >
      <div class="container w-full bg-white py-2">
        <div class="flex h-2 overflow-hidden rounded bg-gray-200">${ee(this,jt,Fr).call(this).map(r=>ee(this,Mr,Di).call(this,r))}</div>
      </div>
    </div>`},Mr=new WeakSet,Di=function(r){return v`<div
      class="${ee(this,It,zr).call(this,r.type)} z-20 h-2 transition-all"
      style="width: ${ee(this,Dt,Or).call(this,r.amount)}%"
    ></div>`},Tr=new WeakSet,Bi=function(){return v`${ee(this,jt,Fr).call(this).map(r=>ee(this,Pr,Ni).call(this,r))}`},Pr=new WeakSet,Ni=function(r){return v`<div
      title="${r.tooltip}"
      style="width: ${ee(this,Dt,Or).call(this,r.amount)}%"
      class="${ee(this,It,zr).call(this,r.type)} ${r.amount===0?"opacity-0":""} relative flex h-8 items-center overflow-hidden transition-all"
    >
      <span class="ms-3 font-bold text-gray-800">${r.amount}</span>
    </div>`},jt=new WeakSet,Fr=function(){return[{type:"detected",amount:this.detected,tooltip:`killed + timeout (${this.detected})`},{type:"survived",amount:this.survived,tooltip:`survived (${this.survived})`},{type:"no coverage",amount:this.noCoverage,tooltip:`no coverage (${this.noCoverage})`},{type:"pending",amount:this.pending,tooltip:"pending"}]},It=new WeakSet,zr=function(r){switch(r){case"detected":return"bg-green-600";case"survived":return"bg-red-600";case"no coverage":return"bg-yellow-600";default:return"bg-gray-200"}},Dt=new WeakSet,Or=function(r){return this.total!==0?100*r/this.total:0},Ho(ce,"styles",[H]),Te([S({attribute:!1})],ce.prototype,"detected",2),Te([S({attribute:!1})],ce.prototype,"noCoverage",2),Te([S({attribute:!1})],ce.prototype,"pending",2),Te([S({attribute:!1})],ce.prototype,"survived",2),Te([S({attribute:!1})],ce.prototype,"total",2),Te([Y()],ce.prototype,"shouldBeSmall",2),ce=Te([L("mte-result-status-bar")],ce),Object.defineProperty(E,Symbol.toStringTag,{value:"Module"}),E}({});

    </script>
  </head>
  <body>
    <svg style="width: 80px; position:fixed; right:10px; bottom:10px; z-index:10" class="stryker-image" viewBox="0 0 1458 1458" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2"><path fill="none" d="M0 0h1458v1458H0z"/><clipPath id="a"><path d="M0 0h1458v1458H0z"/></clipPath><g clip-path="url(#a)"><path d="M1458 729c0 402.655-326.345 729-729 729S0 1131.655 0 729C0 326.445 326.345 0 729 0s729 326.345 729 729" fill="#e74c3c" fill-rule="nonzero"/><path d="M778.349 1456.15L576.6 1254.401l233-105 85-78.668v-64.332l-257-257-44-187-50-208 251.806-82.793L1076.6 389.401l380.14 379.15c-19.681 367.728-311.914 663.049-678.391 687.599z" fill-opacity=".3"/><path d="M753.4 329.503c41.79 0 74.579 7.83 97.925 25.444 23.571 18.015 41.69 43.956 55.167 77.097l11.662 28.679 165.733-58.183-14.137-32.13c-26.688-60.655-64.896-108.61-114.191-144.011-49.329-35.423-117.458-54.302-204.859-54.302-50.78 0-95.646 7.376-134.767 21.542-40.093 14.671-74.09 34.79-102.239 60.259-28.84 26.207-50.646 57.06-65.496 92.701-14.718 35.052-22.101 72.538-22.101 112.401 0 72.536 20.667 133.294 61.165 182.704 38.624 47.255 98.346 88.037 179.861 121.291 42.257 17.475 78.715 33.125 109.227 46.994 27.193 12.361 49.294 26.124 66.157 41.751 15.309 14.186 26.497 30.584 33.63 49.258 7.721 20.214 11.16 45.69 11.16 76.402 0 28.021-4.251 51.787-13.591 71.219-8.832 18.374-20.171 33.178-34.523 44.219-14.787 11.374-31.193 19.591-49.393 24.466-19.68 5.359-39.14 7.993-58.69 7.993-29.359 0-54.387-3.407-75.182-10.747-20.112-7.013-37.144-16.144-51.259-27.486-13.618-11.009-24.971-23.766-33.744-38.279-9.64-15.8-17.272-31.924-23.032-48.408l-10.965-31.376-161.669 60.585 10.734 30.124c10.191 28.601 24.197 56.228 42.059 82.748 18.208 27.144 41.322 51.369 69.525 72.745 27.695 21.075 60.904 38.218 99.481 51.041 37.777 12.664 82.004 19.159 132.552 19.159 49.998 0 95.818-8.321 137.611-24.622 42.228-16.471 78.436-38.992 108.835-67.291 30.719-28.597 54.631-62.103 71.834-100.642 17.263-38.56 25.923-79.392 25.923-122.248 0-54.339-8.368-100.37-24.208-138.32-16.29-38.759-38.252-71.661-65.948-98.797-26.965-26.418-58.269-48.835-93.858-67.175-33.655-17.241-69.196-33.11-106.593-47.533-35.934-13.429-65.822-26.601-89.948-39.525-22.153-11.868-40.009-24.21-53.547-37.309-11.429-11.13-19.83-23.678-24.718-37.664-5.413-15.49-7.98-33.423-7.98-53.577 0-40.883 11.293-71.522 37.086-90.539 28.443-20.825 64.985-30.658 109.311-30.658z" fill="#f1c40f" fill-rule="nonzero"/><path d="M720 0h18v113h-18zM1458 738v-18h-113v18h113zM720 1345h18v113h-18zM113 738v-18H0v18h113z"/></g></svg>
    <mutation-test-report-app titlePostfix="Stryker">
      Your browser doesn't support <a href="https://caniuse.com/#search=custom%20elements">custom elements</a>.
      Please use a latest version of an evergreen browser (Firefox, Chrome, Safari, Opera, Edge, etc).
    </mutation-test-report-app>
    <script>
      const app = document.querySelector('mutation-test-report-app');
      app.report = {"files":{"src/EventProcessorService.ts":{"language":"typescript","mutants":[{"id":"0","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:9940) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nError: Cannot read properties of undefined (reading 'flush')\n\n    1) should process PositionOpened event and push messages to SQS\n\nError: Cannot read properties of undefined (reading 'flush')\n\n    2) should process PositionClosed event and push messages to SQS\n\nError: Cannot read properties of undefined (reading 'flush')\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nError: Cannot read properties of undefined (reading 'flush')\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nError: Cannot read properties of undefined (reading 'flush')\n\n    5) should catch and report on Deposit event\n\nError: Cannot read properties of undefined (reading 'flush')\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (152ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (159ms)\n\n    ✔ should fetch RPC URL (142ms)\n\n    ✔ should fetch Alt RPC URL (142ms)\n\n    ✔ should fetch Events Fetch Page Size (154ms)\n\n    ✔ should fetch NewEventsQueueURL (153ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (250ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (340ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (921ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (493ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1106ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (80ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    7) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  31 passing (9s)\n\n  7 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  7) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected 'LeveragedPositionClosed' to equal 'Withdraw'\n      + expected - actual\n\n      -LeveragedPositionClosed\n      +Withdraw\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   84.47 |    44.24 |   93.89 |   84.77 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |    61.9 |    24.85 |   83.33 |   61.53 |                   \n\n  EventProcessorService.ts             |   45.83 |    15.38 |   72.72 |   45.74 | ...92,100,113-183 \n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n sandbox7748464/src/services/config    |    86.3 |    45.31 |    92.3 |   86.86 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   84.33 |    44.21 |      84 |   86.25 | ...,68-72,177-181 \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":30},"start":{"column":5,"line":23}}},{"id":"2","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:9946) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n    1) should process PositionOpened event and push messages to SQS\n\n    2) should process PositionClosed event and push messages to SQS\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n    5) should catch and report on Deposit event\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (158ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (166ms)\n\n    ✔ should fetch RPC URL (142ms)\n\n    ✔ should fetch Alt RPC URL (140ms)\n\n    ✔ should fetch Events Fetch Page Size (143ms)\n\n    ✔ should fetch NewEventsQueueURL (153ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (246ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (335ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (917ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (490ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (991ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (94ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (42ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event (48ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (9s)\n  6 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |      85 |     44.4 |   93.89 |   85.33 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   65.98 |    26.03 |   83.33 |   65.73 |                   \n\n  EventProcessorService.ts             |   52.08 |    16.92 |   72.72 |   52.12 | ...92,100,113-183 \n\n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n sandbox7748464/src/services/config    |    86.3 |    45.31 |    92.3 |   86.86 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   84.33 |    44.21 |      84 |   86.25 | ...,68-72,177-181 \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":47},"start":{"column":9,"line":33}}},{"id":"1","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:9943) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n    1) should process PositionOpened event and push messages to SQS\n\n    2) should process PositionClosed event and push messages to SQS\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n    5) should catch and report on Deposit event\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (155ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (150ms)\n\n    ✔ should fetch RPC URL (150ms)\n\n    ✔ should fetch Alt RPC URL (132ms)\n\n    ✔ should fetch Events Fetch Page Size (140ms)\n\n    ✔ should fetch NewEventsQueueURL (148ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (269ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (332ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (968ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (570ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1126ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event (70ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (9s)\n\n  6 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |      85 |    44.48 |   93.89 |   85.33 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   65.98 |    26.62 |   83.33 |   65.73 |                   \n  EventProcessorService.ts             |   52.08 |    17.69 |   72.72 |   52.12 | ...92,100,113-183 \n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n sandbox7748464/src/services/config    |    86.3 |    45.31 |    92.3 |   86.86 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   84.33 |    44.21 |      84 |   86.25 | ...,68-72,177-181 \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":53},"start":{"column":41,"line":32}}},{"id":"6","mutatorName":"BlockStatement","replacement":"{}","status":"Survived","testsCompleted":1,"location":{"end":{"column":6,"line":50},"start":{"column":21,"line":47}}},{"id":"5","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:9944) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:21:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:21:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:21:47 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:21:47 PM] \n\n    ✔ should process PositionOpened event and push messages to SQS (506ms)\n\n[2/23/2024 7:21:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:21:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:21:47 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:21:47 PM] \n\n    ✔ should process PositionClosed event and push messages to SQS (311ms)\n\n[2/23/2024 7:21:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:21:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:21:47 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:21:47 PM] \n\n    ✔ should process PositionLiquidated event and push messages to SQS (273ms)\n\n[2/23/2024 7:21:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:21:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:21:48 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:21:48 PM] \n\n    ✔ should process PositionExpired event and push messages to SQS (288ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:21:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:21:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:21:48 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:21:48 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:21:48 PM] \n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:21:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:21:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:21:48 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:21:48 PM] \n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (148ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (144ms)\n\n    ✔ should fetch RPC URL (140ms)\n\n    ✔ should fetch Alt RPC URL (155ms)\n\n    ✔ should fetch Events Fetch Page Size (150ms)\n\n    ✔ should fetch NewEventsQueueURL (141ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (248ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (379ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1307ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (391ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1022ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (55ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event (134ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.58 |    48.48 |   96.71 |   89.94 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   93.87 |    53.25 |     100 |    93.7 |                   \n  EventProcessorService.ts             |   94.79 |     52.3 |     100 |   94.68 | 6,24,39,100,183   \n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":46},"start":{"column":24,"line":46}}},{"id":"4","mutatorName":"StringLiteral","replacement":"``","status":"Survived","testsCompleted":1,"location":{"end":{"column":69,"line":37},"start":{"column":24,"line":35}}},{"id":"3","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":65,"line":34},"start":{"column":24,"line":34}}},{"id":"10","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:10237) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (160ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (165ms)\n\n    ✔ should fetch RPC URL (150ms)\n\n    ✔ should fetch Alt RPC URL (139ms)\n\n    ✔ should fetch Events Fetch Page Size (180ms)\n\n    ✔ should fetch NewEventsQueueURL (140ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (314ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (362ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (885ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (350ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (844ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    7) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    8) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (9s)\n\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected 'LeveragedPositionOpened' to equal 'LeveragedPositionClosed'\n      + expected - actual\n\n      -LeveragedPositionOpened\n      +LeveragedPositionClosed\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected 'LeveragedPositionLiquidated' to equal 'LeveragedPositionExpired'\n      + expected - actual\n\n      -LeveragedPositionLiquidated\n      +LeveragedPositionExpired\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   86.89 |    46.56 |   96.24 |   87.26 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   73.46 |    39.05 |   94.44 |   73.42 |                   \n\n  EventProcessorService.ts             |   66.66 |    35.38 |    90.9 |   67.02 | ...00,116-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":74},"start":{"column":96,"line":55}}},{"id":"7","mutatorName":"StringLiteral","replacement":"``","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:10161) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:21:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:21:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:21:59 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (378ms)\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (331ms)\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (296ms)\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (292ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:01 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (179ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (162ms)\n\n    ✔ should fetch RPC URL (158ms)\n\n    ✔ should fetch Alt RPC URL (178ms)\n\n    ✔ should fetch Events Fetch Page Size (140ms)\n\n    ✔ should fetch NewEventsQueueURL (143ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (305ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (355ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1121ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (328ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (816ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |       48 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   89.79 |     49.7 |     100 |   89.51 |                   \n  EventProcessorService.ts             |   91.66 |    49.23 |     100 |   91.48 | ...,39,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":48},"start":{"column":25,"line":48}}},{"id":"9","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:10173) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:21:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:21:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (397ms)\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (272ms)\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (287ms)\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (324ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:01 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (173ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (165ms)\n\n    ✔ should fetch RPC URL (157ms)\n\n    ✔ should fetch Alt RPC URL (179ms)\n\n    ✔ should fetch Events Fetch Page Size (139ms)\n\n    ✔ should fetch NewEventsQueueURL (140ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (305ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (363ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1691ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (675ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1208ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (44ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (11s)\n\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.08 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   89.79 |    50.29 |     100 |   89.51 |                   \n  EventProcessorService.ts             |   91.66 |       50 |     100 |   91.48 | ...,39,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":52},"start":{"column":15,"line":50}}},{"id":"11","mutatorName":"ArithmeticOperator","replacement":"startBlock - 1","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:10261) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (435ms)\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (303ms)\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (306ms)\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:01 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (286ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:01 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:01 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:01 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:02 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:02 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:02 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (299ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (148ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (152ms)\n\n    ✔ should fetch RPC URL (160ms)\n\n    ✔ should fetch Alt RPC URL (147ms)\n\n    ✔ should fetch Events Fetch Page Size (165ms)\n\n    ✔ should fetch NewEventsQueueURL (159ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (250ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (415ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1126ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (574ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1213ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event (43ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (11s)\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected 'LeveragedPositionLiquidated' to equal 'LeveragedPositionOpened'\n      + expected - actual\n\n      -LeveragedPositionLiquidated\n      +LeveragedPositionOpened\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.08 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   89.79 |    50.29 |     100 |   89.51 |                   \n  EventProcessorService.ts             |   91.66 |       50 |     100 |   91.48 | ...,39,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":49,"line":57},"start":{"column":35,"line":57}}},{"id":"12","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:10316) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:02 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:22:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:02 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (137ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (166ms)\n\n    ✔ should fetch RPC URL (148ms)\n\n    ✔ should fetch Alt RPC URL (142ms)\n\n    ✔ should fetch Events Fetch Page Size (189ms)\n\n    ✔ should fetch NewEventsQueueURL (182ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (305ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (394ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1211ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (365ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1068ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (42ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (48ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (10s)\n  6 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.16 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   89.79 |    50.88 |     100 |   89.51 |                   \n\n  EventProcessorService.ts             |   91.66 |    50.76 |     100 |   91.48 | ...,39,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":58},"start":{"column":7,"line":58}}},{"id":"13","mutatorName":"EqualityOperator","replacement":"currentStepStartBlock <"+" endBlock","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:10348) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (374ms)\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (281ms)\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (335ms)\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (271ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:02 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:02 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:02 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:02 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:02 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (241ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (163ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (152ms)\n\n    ✔ should fetch RPC URL (145ms)\n\n    ✔ should fetch Alt RPC URL (188ms)\n\n    ✔ should fetch Events Fetch Page Size (172ms)\n\n    ✔ should fetch NewEventsQueueURL (181ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (253ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (372ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1185ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (484ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1075ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (10s)\n  1 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.24 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   89.79 |    51.47 |     100 |   89.51 |                   \n\n  EventProcessorService.ts             |   91.66 |    51.53 |     100 |   91.48 | ...,39,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":58},"start":{"column":7,"line":58}}},{"id":"8","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:10172) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:21:59 PM] Executing the event fetcher workflow...\n[2/23/2024 7:21:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:21:59 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (404ms)\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (320ms)\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (291ms)\n\n[2/23/2024 7:22:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:00 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (288ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:01 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:01 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:01 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (178ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (161ms)\n\n    ✔ should fetch RPC URL (160ms)\n\n    ✔ should fetch Alt RPC URL (177ms)\n\n    ✔ should fetch Events Fetch Page Size (159ms)\n\n    ✔ should fetch NewEventsQueueURL (151ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (248ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (337ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (2648ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (472ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (883ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (56ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (51ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event (49ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (12s)\n  2 failing\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.24 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   89.79 |    51.47 |     100 |   89.51 |                   \n\n  EventProcessorService.ts             |   91.66 |    51.53 |     100 |   91.48 | ...,39,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":49},"start":{"column":21,"line":49}}},{"id":"14","mutatorName":"EqualityOperator","replacement":"currentStepStartBlock > endBlock","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:10469) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:12 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:22:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:13 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:22:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:13 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:22:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:13 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:22:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:14 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:22:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:14 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (191ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (162ms)\n\n    ✔ should fetch RPC URL (214ms)\n\n    ✔ should fetch Alt RPC URL (163ms)\n\n    ✔ should fetch Events Fetch Page Size (187ms)\n\n    ✔ should fetch NewEventsQueueURL (210ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (254ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (378ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1377ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (556ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (760ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (10s)\n  6 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.16 |    46.72 |   96.24 |   87.45 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   75.51 |    40.23 |   94.44 |   74.82 |                   \n\n  EventProcessorService.ts             |   69.79 |    36.92 |    90.9 |   69.14 | ...00,118-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":40,"line":58},"start":{"column":7,"line":58}}},{"id":"16","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:10626) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:13 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:22:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:14 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:22:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:14 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:22:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:14 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:15 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:22:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:15 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (290ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (151ms)\n\n    ✔ should fetch RPC URL (149ms)\n\n    ✔ should fetch Alt RPC URL (179ms)\n\n    ✔ should fetch Events Fetch Page Size (159ms)\n\n    ✔ should fetch NewEventsQueueURL (184ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (247ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (353ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (2551ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (1811ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (662ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (13s)\n\n  6 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   87.25 |    47.04 |   96.24 |   87.54 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   76.19 |     42.6 |   94.44 |   75.52 |                   \n  EventProcessorService.ts             |   70.83 |       40 |    90.9 |   70.21 | ...00,121-157,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":73},"start":{"column":7,"line":60}}},{"id":"17","mutatorName":"MethodExpression","replacement":"Math.max(currentStepStartBlock + this.configService.getEventsFetchPageSize() - 1, endBlock)","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:10627) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:14 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:14 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (496ms)\n\n[2/23/2024 7:22:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:14 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:14 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (302ms)\n\n[2/23/2024 7:22:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:14 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:14 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (289ms)\n\n[2/23/2024 7:22:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:15 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:15 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (341ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:15 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:15 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:15 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:15 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:15 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (159ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (172ms)\n\n    ✔ should fetch RPC URL (161ms)\n\n    ✔ should fetch Alt RPC URL (179ms)\n\n    ✔ should fetch Events Fetch Page Size (148ms)\n\n    ✔ should fetch NewEventsQueueURL (151ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (232ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (384ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (4115ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (412ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (673ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (13s)\n\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.76 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   89.79 |    47.92 |     100 |   89.51 |                   \n\n  EventProcessorService.ts             |   91.66 |    46.92 |     100 |   91.48 | ...,39,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":8,"line":64},"start":{"column":35,"line":61}}},{"id":"20","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:10746) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:14 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:22:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:14 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:22:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:15 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:22:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:15 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:16 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:22:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:16 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (176ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (140ms)\n\n    ✔ should fetch RPC URL (145ms)\n\n    ✔ should fetch Alt RPC URL (277ms)\n\n    ✔ should fetch Events Fetch Page Size (156ms)\n\n    ✔ should fetch NewEventsQueueURL (152ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (324ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (980ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1333ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (347ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1045ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (42ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (15s)\n  6 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |    87.7 |    47.36 |   96.71 |      88 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   79.59 |    44.97 |     100 |   79.02 |                   \n\n  EventProcessorService.ts             |   76.04 |    43.07 |     100 |   75.53 | ...00,133-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":87},"start":{"column":87,"line":76}}},{"id":"19","mutatorName":"ArithmeticOperator","replacement":"currentStepStartBlock - this.configService.getEventsFetchPageSize()","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:10713) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:15 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:15 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (1154ms)\n\n[2/23/2024 7:22:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:15 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:15 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (291ms)\n\n[2/23/2024 7:22:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:15 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:15 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (386ms)\n\n[2/23/2024 7:22:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:16 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:16 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (259ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:16 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:16 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:16 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:16 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:16 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (142ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (277ms)\n\n    ✔ should fetch RPC URL (157ms)\n\n    ✔ should fetch Alt RPC URL (159ms)\n\n    ✔ should fetch Events Fetch Page Size (196ms)\n\n    ✔ should fetch NewEventsQueueURL (166ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (294ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (939ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1640ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (338ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (979ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (15s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.08 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   89.79 |    50.29 |     100 |   89.51 |                   \n  EventProcessorService.ts             |   91.66 |       50 |     100 |   91.48 | ...,39,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":78,"line":62},"start":{"column":11,"line":62}}},{"id":"18","mutatorName":"ArithmeticOperator","replacement":"currentStepStartBlock + this.configService.getEventsFetchPageSize() + 1","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:10712) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:22:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:14 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:14 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (435ms)\n\n[2/23/2024 7:22:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:14 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:14 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (287ms)\n\n[2/23/2024 7:22:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:14 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:14 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (289ms)\n\n[2/23/2024 7:22:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:15 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:15 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (311ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:15 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:15 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:15 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:15 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:15 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (152ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (197ms)\n\n    ✔ should fetch RPC URL (155ms)\n\n    ✔ should fetch Alt RPC URL (165ms)\n\n    ✔ should fetch Events Fetch Page Size (149ms)\n\n    ✔ should fetch NewEventsQueueURL (136ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (234ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (383ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (6234ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (542ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (886ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (41ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (16s)\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.16 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   89.79 |    50.88 |     100 |   89.51 |                   \n  EventProcessorService.ts             |   91.66 |    50.76 |     100 |   91.48 | ...,39,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":62},"start":{"column":11,"line":62}}},{"id":"15","mutatorName":"AssignmentOperator","replacement":"currentStepStartBlock -= this.configService.getEventsFetchPageSize()","status":"Timeout","location":{"end":{"column":75,"line":59},"start":{"column":7,"line":59}}},{"id":"21","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:10809) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:25 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:22:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:26 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:26 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:22:26 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:26 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:26 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:22:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:27 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:27 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:22:27 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:28 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (142ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (157ms)\n\n    ✔ should fetch RPC URL (160ms)\n\n    ✔ should fetch Alt RPC URL (152ms)\n\n    ✔ should fetch Events Fetch Page Size (164ms)\n\n    ✔ should fetch NewEventsQueueURL (207ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (237ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (366ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (932ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (271ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (660ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (10s)\n  6 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.97 |    47.44 |   96.71 |   88.28 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   81.63 |    45.56 |     100 |   81.11 |                   \n\n  EventProcessorService.ts             |   79.16 |    43.84 |     100 |   78.72 | ...00,138-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":86},"start":{"column":40,"line":77}}},{"id":"22","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:10868) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:28 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:22:29 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:29 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:29 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:22:29 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:29 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:29 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:22:29 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:29 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:29 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:22:29 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:29 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:30 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:22:30 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:30 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (144ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (143ms)\n\n    ✔ should fetch RPC URL (157ms)\n\n    ✔ should fetch Alt RPC URL (155ms)\n\n    ✔ should fetch Events Fetch Page Size (141ms)\n\n    ✔ should fetch NewEventsQueueURL (138ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (276ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (360ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1018ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (301ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (711ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    7) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  31 passing (9s)\n\n  7 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     AssertionError: expected undefined to equal 'LeveragedPositionLiquidated'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.24 |    47.52 |   96.71 |   88.56 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   83.67 |    46.15 |     100 |   83.21 |                   \n\n  EventProcessorService.ts             |   82.29 |    44.61 |     100 |   81.91 | ...00,143-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":8,"line":81},"start":{"column":11,"line":78}}},{"id":"23","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:10923) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:29 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:29 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:29 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:29 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (352ms)\n\n[2/23/2024 7:22:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:30 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (277ms)\n\n[2/23/2024 7:22:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:30 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (294ms)\n\n[2/23/2024 7:22:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:30 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (256ms)\n\n\n  PSP Events\n\n[2/23/2024 7:22:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:30 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:30 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:30 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:31 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:31 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (159ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (164ms)\n\n    ✔ should fetch RPC URL (167ms)\n\n    ✔ should fetch Alt RPC URL (179ms)\n\n    ✔ should fetch Events Fetch Page Size (171ms)\n\n    ✔ should fetch NewEventsQueueURL (181ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (279ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (349ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (933ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (321ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (666ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.59 |     47.6 |   96.71 |   88.92 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   86.39 |    46.74 |     100 |   86.01 |                   \n\n  EventProcessorService.ts             |   86.45 |    45.38 |     100 |   86.17 | ...00,151-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":8,"line":85},"start":{"column":23,"line":81}}},{"id":"24","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:11026) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:31 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (355ms)\n\n[2/23/2024 7:22:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:31 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (304ms)\n\n[2/23/2024 7:22:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:32 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (390ms)\n\n[2/23/2024 7:22:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:32 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (291ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:32 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:32 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:32 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:33 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:33 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (217ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (160ms)\n\n    ✔ should fetch RPC URL (161ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (172ms)\n\n    ✔ should fetch NewEventsQueueURL (148ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (248ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (478ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1044ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (320ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (885ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   89.79 |    49.11 |     100 |   89.51 |                   \n  EventProcessorService.ts             |   91.66 |    48.46 |     100 |   91.48 | ...,39,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":82},"start":{"column":13,"line":82}}},{"id":"25","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:11058) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:31 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (353ms)\n\n[2/23/2024 7:22:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:32 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (308ms)\n\n[2/23/2024 7:22:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:32 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (287ms)\n\n[2/23/2024 7:22:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:32 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (291ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:32 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:32 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:33 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:33 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:33 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (181ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (152ms)\n\n    ✔ should fetch RPC URL (149ms)\n\n    ✔ should fetch Alt RPC URL (153ms)\n\n    ✔ should fetch Events Fetch Page Size (148ms)\n\n    ✔ should fetch NewEventsQueueURL (171ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (269ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (405ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1000ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (385ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (938ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (39ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.08 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   89.79 |    50.29 |     100 |   89.51 |                   \n\n  EventProcessorService.ts             |   91.66 |       50 |     100 |   91.48 | ...,39,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":59,"line":82},"start":{"column":13,"line":82}}},{"id":"26","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:11090) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:31 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (326ms)\n\n[2/23/2024 7:22:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:32 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (312ms)\n\n[2/23/2024 7:22:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:32 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (310ms)\n\n[2/23/2024 7:22:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:33 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (720ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:33 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:33 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:33 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:33 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:33 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (149ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (166ms)\n\n    ✔ should fetch RPC URL (145ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (149ms)\n\n    ✔ should fetch NewEventsQueueURL (136ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (280ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (343ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1169ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (294ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (788ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    3) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    4) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (10s)\n\n  4 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     AssertionError: expected undefined to equal 'LeveragedPositionClosed'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.24 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   89.79 |    51.47 |     100 |   89.51 |                   \n\n  EventProcessorService.ts             |   91.66 |    51.53 |     100 |   91.48 | ...,39,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":84},"start":{"column":61,"line":82}}},{"id":"27","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:11201) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:35 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:22:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:36 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:22:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:36 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:22:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:36 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:37 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:37 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:37 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:22:37 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:37 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:37 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (172ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (153ms)\n\n    ✔ should fetch RPC URL (204ms)\n\n    ✔ should fetch Alt RPC URL (145ms)\n\n    ✔ should fetch Events Fetch Page Size (145ms)\n\n    ✔ should fetch NewEventsQueueURL (150ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (255ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (334ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (683ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (289ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (667ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    7) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  31 passing (9s)\n\n  7 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) PSP Events Logging\n       should report on Withdraw event:\n     AssertionError: expected undefined to equal 'Withdraw'\n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   86.08 |    45.04 |   95.77 |   86.34 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   69.38 |     28.4 |   94.44 |   68.53 |                   \n\n  EventProcessorService.ts             |   60.41 |    21.53 |    90.9 |   59.57 | ...18-157,170-183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   87.55 |    45.69 |   94.23 |   88.13 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,177-181 \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":102},"start":{"column":56,"line":89}}},{"id":"29","mutatorName":"ArithmeticOperator","replacement":"currentBlockNumber + MaxNumberOfBlocksToProess","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:11319) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:39 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:22:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:40 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:22:40 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:40 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:22:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:40 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:22:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:41 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:22:41 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:42 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (139ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (139ms)\n\n    ✔ should fetch RPC URL (167ms)\n\n    ✔ should fetch Alt RPC URL (148ms)\n\n    ✔ should fetch Events Fetch Page Size (160ms)\n\n    ✔ should fetch NewEventsQueueURL (153ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (272ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (567ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1112ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (725ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (725ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    7) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    8) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (11s)\n\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     AssertionError: expected undefined to equal 'LeveragedPositionLiquidated'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n  8) PSP Events Logging\n       should report on Deposit event:\n     AssertionError: expected undefined to equal 'Deposit'\n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:66:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.16 |    46.88 |   96.24 |   87.45 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   75.51 |    41.42 |   94.44 |   74.82 |                   \n\n  EventProcessorService.ts             |   69.79 |    38.46 |    90.9 |   69.14 | ...00,118-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":87,"line":92},"start":{"column":41,"line":92}}},{"id":"30","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:11376) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:41 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (336ms)\n\n[2/23/2024 7:22:41 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:41 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (302ms)\n\n[2/23/2024 7:22:41 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:41 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:42 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (629ms)\n\n[2/23/2024 7:22:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:42 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:42 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (242ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:42 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:42 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:42 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:42 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:42 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:42 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (195ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (159ms)\n\n    ✔ should fetch RPC URL (183ms)\n\n    ✔ should fetch Alt RPC URL (172ms)\n\n    ✔ should fetch Events Fetch Page Size (205ms)\n\n    ✔ should fetch NewEventsQueueURL (150ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (258ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (376ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1038ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (291ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (695ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    3) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n\n  3 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 'LeveragedPositionOpened'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.08 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   89.79 |    50.29 |     100 |   89.51 |                   \n\n  EventProcessorService.ts             |   91.66 |       50 |     100 |   91.48 | ...,39,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":97},"start":{"column":9,"line":95}}},{"id":"32","mutatorName":"LogicalOperator","replacement":"(lastBlockScanned == 0 || currentBlockNumber - lastBlockScanned > MaxNumberOfBlocksToProess) && lastBlockScanned > currentBlockNumber","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:11510) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:43 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:22:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:43 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:22:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:44 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:22:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:44 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:44 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:22:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:45 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (235ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (158ms)\n\n    ✔ should fetch RPC URL (163ms)\n\n    ✔ should fetch Alt RPC URL (178ms)\n\n    ✔ should fetch Events Fetch Page Size (400ms)\n\n    ✔ should fetch NewEventsQueueURL (174ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (260ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (537ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1079ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (340ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1199ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    8) should report on PositionLiqiuidated event\n\n    9) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  29 passing (10s)\n  9 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 'LeveragedPositionOpened'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     AssertionError: expected undefined to equal 'LeveragedPositionLiquidated'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   86.98 |     45.6 |   96.24 |   87.26 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   74.14 |    31.95 |   94.44 |   73.42 |                   \n\n  EventProcessorService.ts             |    67.7 |    26.15 |    90.9 |   67.02 | ...18-157,176-180 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":97},"start":{"column":9,"line":95}}},{"id":"31","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:11509) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:43 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:22:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:43 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:22:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:44 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:22:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:44 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:44 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:22:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:45 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (163ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (167ms)\n\n    ✔ should fetch RPC URL (513ms)\n\n    ✔ should fetch Alt RPC URL (143ms)\n\n    ✔ should fetch Events Fetch Page Size (156ms)\n\n    ✔ should fetch NewEventsQueueURL (152ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (463ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (346ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (806ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (495ms)\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1044ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    8) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (11s)\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 'LeveragedPositionOpened'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   86.98 |    45.76 |   96.24 |   87.26 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   74.14 |    33.13 |   94.44 |   73.42 |                   \n  EventProcessorService.ts             |    67.7 |    27.69 |    90.9 |   67.02 | ...18-157,176-180 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":97},"start":{"column":9,"line":95}}},{"id":"33","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:11542) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:43 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (366ms)\n\n[2/23/2024 7:22:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:44 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:44 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (303ms)\n\n[2/23/2024 7:22:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:44 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:44 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (466ms)\n\n[2/23/2024 7:22:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:44 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:44 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (322ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:45 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:45 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:45 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:46 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:46 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (149ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (161ms)\n\n    ✔ should fetch RPC URL (157ms)\n\n    ✔ should fetch Alt RPC URL (218ms)\n\n    ✔ should fetch Events Fetch Page Size (193ms)\n\n    ✔ should fetch NewEventsQueueURL (158ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (372ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (359ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (784ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (374ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (783ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event (54ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    3) should report on PositionClosed event\n\n    4) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (10s)\n  4 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     AssertionError: expected undefined to equal 'LeveragedPositionClosed'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     AssertionError: expected undefined to equal 'LeveragedPositionLiquidated'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.13 |    47.68 |   96.71 |   89.48 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   90.47 |    47.33 |     100 |    90.2 |                   \n  EventProcessorService.ts             |    92.7 |    46.15 |     100 |   92.55 | 6,24,39,95-100    \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":96},"start":{"column":9,"line":95}}},{"id":"34","mutatorName":"LogicalOperator","replacement":"lastBlockScanned == 0 && currentBlockNumber - lastBlockScanned > MaxNumberOfBlocksToProess","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:11606) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:46 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:46 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (342ms)\n\n[2/23/2024 7:22:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:47 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:47 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (271ms)\n\n[2/23/2024 7:22:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:47 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:47 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (300ms)\n\n[2/23/2024 7:22:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:47 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:47 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (399ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:48 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:48 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:48 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:48 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:48 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (251ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (155ms)\n\n    ✔ should fetch RPC URL (162ms)\n\n    ✔ should fetch Alt RPC URL (145ms)\n\n    ✔ should fetch Events Fetch Page Size (180ms)\n\n    ✔ should fetch NewEventsQueueURL (157ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (342ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (382ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1019ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (367ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (887ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (39ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    3) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n\n  3 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 'LeveragedPositionOpened'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.28 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   89.79 |    44.37 |     100 |   89.51 |                   \n\n  EventProcessorService.ts             |   91.66 |     42.3 |     100 |   91.48 | ...,39,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":96},"start":{"column":9,"line":95}}},{"id":"28","mutatorName":"MethodExpression","replacement":"Math.min(currentBlockNumber - MaxNumberOfBlocksToProess, 0)","status":"Timeout","location":{"end":{"column":91,"line":92},"start":{"column":32,"line":92}}},{"id":"35","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:11698) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:52 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:52 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (499ms)\n\n[2/23/2024 7:22:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:52 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:52 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (313ms)\n\n[2/23/2024 7:22:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:53 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:53 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (314ms)\n\n[2/23/2024 7:22:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:53 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:53 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (328ms)\n\n\n  PSP Events\n\n[2/23/2024 7:22:53 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:53 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:53 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:54 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:54 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:54 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (154ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (165ms)\n\n    ✔ should fetch RPC URL (207ms)\n\n    ✔ should fetch Alt RPC URL (145ms)\n\n    ✔ should fetch Events Fetch Page Size (149ms)\n\n    ✔ should fetch NewEventsQueueURL (160ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (268ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (367ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1083ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (603ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (716ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    3) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n\n  3 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     AssertionError: expected undefined to equal 'LeveragedPositionClosed'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   89.79 |    49.11 |     100 |   89.51 |                   \n\n  EventProcessorService.ts             |   91.66 |    48.46 |     100 |   91.48 | ...,39,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":95},"start":{"column":9,"line":95}}},{"id":"36","mutatorName":"EqualityOperator","replacement":"lastBlockScanned != 0","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:11731) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:52 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:53 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (387ms)\n\n[2/23/2024 7:22:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:53 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:53 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (283ms)\n\n[2/23/2024 7:22:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:53 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:53 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (306ms)\n\n[2/23/2024 7:22:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:53 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:54 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (516ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:54 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:54 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:54 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:54 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:54 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:54 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:55 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (156ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (146ms)\n\n    ✔ should fetch RPC URL (170ms)\n\n    ✔ should fetch Alt RPC URL (157ms)\n\n    ✔ should fetch Events Fetch Page Size (144ms)\n\n    ✔ should fetch NewEventsQueueURL (168ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (319ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (360ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1011ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (329ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (671ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |       48 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   89.79 |     49.7 |     100 |   89.51 |                   \n\n  EventProcessorService.ts             |   91.66 |    49.23 |     100 |   91.48 | ...,39,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":95},"start":{"column":9,"line":95}}},{"id":"37","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:11863) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:56 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (344ms)\n\n[2/23/2024 7:22:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:56 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (291ms)\n\n[2/23/2024 7:22:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:56 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (290ms)\n\n[2/23/2024 7:22:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:57 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (314ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:57 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:57 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:57 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:57 PM] Executing the event fetcher workflow...\n[2/23/2024 7:22:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:57 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:57 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (148ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (155ms)\n\n    ✔ should fetch RPC URL (166ms)\n\n    ✔ should fetch Alt RPC URL (179ms)\n\n    ✔ should fetch Events Fetch Page Size (173ms)\n\n    ✔ should fetch NewEventsQueueURL (169ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (317ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (373ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (835ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (337ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (854ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.84 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   89.79 |    48.52 |     100 |   89.51 |                   \n  EventProcessorService.ts             |   91.66 |    47.69 |     100 |   91.48 | ...,39,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":96},"start":{"column":7,"line":96}}},{"id":"38","mutatorName":"EqualityOperator","replacement":"currentBlockNumber - lastBlockScanned >= MaxNumberOfBlocksToProess","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:11932) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:56 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (354ms)\n\n[2/23/2024 7:22:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:56 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (280ms)\n\n[2/23/2024 7:22:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:56 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (320ms)\n\n[2/23/2024 7:22:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:57 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (334ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:57 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:57 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:57 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:57 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:57 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (173ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (155ms)\n\n    ✔ should fetch RPC URL (190ms)\n\n    ✔ should fetch Alt RPC URL (146ms)\n\n    ✔ should fetch Events Fetch Page Size (190ms)\n\n    ✔ should fetch NewEventsQueueURL (154ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (405ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (362ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (704ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (344ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (769ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   89.79 |    49.11 |     100 |   89.51 |                   \n\n  EventProcessorService.ts             |   91.66 |    48.46 |     100 |   91.48 | ...,39,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":96},"start":{"column":7,"line":96}}},{"id":"39","mutatorName":"EqualityOperator","replacement":"currentBlockNumber - lastBlockScanned <"+"= MaxNumberOfBlocksToProess","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:11933) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:22:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:56 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (368ms)\n\n[2/23/2024 7:22:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:56 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:22:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (279ms)\n\n[2/23/2024 7:22:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:57 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:22:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (349ms)\n\n[2/23/2024 7:22:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:57 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (741ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:22:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:58 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:22:58 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:22:58 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:22:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:22:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:22:58 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:22:58 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (167ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (161ms)\n\n    ✔ should fetch RPC URL (171ms)\n\n    ✔ should fetch Alt RPC URL (164ms)\n\n    ✔ should fetch Events Fetch Page Size (242ms)\n\n    ✔ should fetch NewEventsQueueURL (289ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (275ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (434ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (951ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (355ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (886ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (45ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    47.36 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   89.79 |    44.97 |     100 |   89.51 |                   \n  EventProcessorService.ts             |   91.66 |    43.07 |     100 |   91.48 | ...,39,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":96},"start":{"column":7,"line":96}}},{"id":"40","mutatorName":"ArithmeticOperator","replacement":"currentBlockNumber + lastBlockScanned","status":"Survived","testsCompleted":1,"location":{"end":{"column":44,"line":96},"start":{"column":7,"line":96}}},{"id":"41","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:12149) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:01 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:23:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:01 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:23:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:01 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:23:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:02 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:02 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:02 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:23:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:02 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (244ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (156ms)\n\n    ✔ should fetch RPC URL (169ms)\n\n    ✔ should fetch Alt RPC URL (155ms)\n\n    ✔ should fetch Events Fetch Page Size (247ms)\n\n    ✔ should fetch NewEventsQueueURL (262ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (250ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (364ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (750ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (297ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (685ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    7) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  31 passing (9s)\n  7 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  7) PSP Events Logging\n       should report on Deposit event:\n     AssertionError: expected undefined to equal 'Deposit'\n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:66:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   86.98 |     46.8 |   96.24 |   87.26 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   74.14 |    40.82 |   94.44 |   73.42 |                   \n\n  EventProcessorService.ts             |    67.7 |    37.69 |    90.9 |   67.02 | ...18-157,176-180 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":97},"start":{"column":7,"line":97}}},{"id":"42","mutatorName":"EqualityOperator","replacement":"lastBlockScanned >= currentBlockNumber","status":"Survived","testsCompleted":1,"location":{"end":{"column":44,"line":97},"start":{"column":7,"line":97}}},{"id":"43","mutatorName":"EqualityOperator","replacement":"lastBlockScanned <"+"= currentBlockNumber","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:12295) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:04 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:23:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:05 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:23:05 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:05 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:23:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:05 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:06 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:23:06 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:06 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (146ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (182ms)\n\n    ✔ should fetch RPC URL (162ms)\n\n    ✔ should fetch Alt RPC URL (145ms)\n\n    ✔ should fetch Events Fetch Page Size (171ms)\n\n    ✔ should fetch NewEventsQueueURL (173ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (297ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (338ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (914ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (449ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (676ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (9s)\n  6 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.13 |       48 |   96.71 |   89.48 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   90.47 |     49.7 |     100 |    90.2 |                   \n\n  EventProcessorService.ts             |    92.7 |    49.23 |     100 |   92.55 | 6,24,39,95-100    \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":44,"line":97},"start":{"column":7,"line":97}}},{"id":"44","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:12396) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:08 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:23:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:08 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:23:08 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:08 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:23:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:08 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:09 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:23:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:09 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (166ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (184ms)\n\n    ✔ should fetch RPC URL (158ms)\n\n    ✔ should fetch Alt RPC URL (156ms)\n\n    ✔ should fetch Events Fetch Page Size (192ms)\n\n    ✔ should fetch NewEventsQueueURL (162ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (332ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (362ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (901ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (548ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (684ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (40ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (9s)\n\n  6 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.25 |     47.2 |   96.24 |   87.54 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   76.19 |    43.78 |   94.44 |   75.52 |                   \n\n  EventProcessorService.ts             |   68.75 |    38.46 |    90.9 |   68.08 | ...18-157,179-180 \n\n  lambda-handler.ts                    |   90.19 |    61.53 |     100 |   89.79 | 24,39,72-76       \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":99},"start":{"column":46,"line":97}}}],"source":"import {ethers} from 'ethers';\nimport {SQSService, Logger} from '@thisisarchimedes/backend-sdk';\nimport dotenv from 'dotenv';\nimport {ConfigService} from './services/config/ConfigService';\nimport {EventFactory, EventFactoryUnknownEventError} from './onchain_events/EventFactory';\nimport {EventFetcherRPC} from './services/blockchain/EventFetcherRPC';\nimport {ALL_TOPICS} from './onchain_events/EventTopic';\n\ndotenv.config();\n\n\nexport class EventProcessorService {\n  private readonly logger: Logger;\n  private readonly configService: ConfigService;\n  private readonly eventFactory: EventFactory;\n\n  private readonly sqsService: SQSService;\n  private readonly eventFetcher;\n\n  constructor(\n      logger: Logger,\n      configService: ConfigService,\n  ) {\n    this.sqsService = new SQSService();\n    this.logger = logger;\n    this.configService = configService;\n\n    this.eventFactory = new EventFactory(this.configService, this.logger, this.sqsService);\n    this.eventFetcher = new EventFetcherRPC(configService.getMainRPCURL(), configService.getAlternativeRPCURL());\n  }\n\n  public async execute(): Promise<"+"void> {\n    try {\n      this.logger.info('Executing the event fetcher workflow...');\n      this.logger.info(`RPC: ${this.configService.getMainRPCURL()}\\n\n                        SQS queue: ${this.configService.getEventQueueURL()}\\n\n                        Env: ${this.configService.getEnvironment()}`);\n\n      const startBlock = await this.getStartBlockNumber();\n      const endBlock = await this.eventFetcher.getCurrentBlockNumber();\n\n      await this.processEventsAtBlockRange(startBlock, endBlock);\n\n      await this.configService.setLastScannedBlock(endBlock);\n\n      this.logger.info('Event fetcher workflow completed.');\n    } catch (error) {\n      this.logger.error(`Error in event fetcher workflow: ${error}`);\n      console.error('Error in event fetcher workflow:', error);\n    } finally {\n      await this.logger.flush();\n    }\n  }\n\n  private async processEventsAtBlockRange(startBlock: number, endBlock: number): Promise<"+"void> {\n    for (\n      let currentStepStartBlock = startBlock + 1;\n      currentStepStartBlock <"+"= endBlock;\n      currentStepStartBlock += this.configService.getEventsFetchPageSize()\n    ) {\n      const currentStepEndBlock = Math.min(\n          currentStepStartBlock + this.configService.getEventsFetchPageSize() - 1,\n          endBlock,\n      );\n\n      const eventLogGroup = await this.eventFetcher.getOnChainEvents(\n          currentStepStartBlock,\n          currentStepEndBlock,\n          ALL_TOPICS,\n      );\n\n      await this.processLogGroup(eventLogGroup);\n    }\n  }\n\n  private async processLogGroup(eventLogGroup: ethers.providers.Log[]): Promise<"+"void> {\n    for (const event of eventLogGroup) {\n      try {\n        const evt = await this.eventFactory.createEvent(event);\n        evt.process();\n      } catch (error) {\n        if (error instanceof EventFactoryUnknownEventError) {\n          continue;\n        }\n      }\n    }\n  }\n\n  private async getStartBlockNumber(): Promise<"+"number> {\n    const MaxNumberOfBlocksToProess = this.configService.getMaxNumberOfBlocksToProcess();\n    const currentBlockNumber = await this.eventFetcher.getCurrentBlockNumber();\n    const defaultBlockNumber = Math.max(currentBlockNumber - MaxNumberOfBlocksToProess, 0);\n    const lastBlockScanned = this.configService.getLastBlockScanned();\n\n    if (lastBlockScanned == 0 ||\n      currentBlockNumber - lastBlockScanned > MaxNumberOfBlocksToProess ||\n      lastBlockScanned > currentBlockNumber) {\n      return defaultBlockNumber;\n    }\n\n    return lastBlockScanned;\n  }\n}\n"},"src/lambda-handler.ts":{"language":"typescript","mutants":[{"id":"45","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:12438) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n    1) should process PositionOpened event and push messages to SQS\n\n    2) should process PositionClosed event and push messages to SQS\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n    5) should catch and report on Deposit event\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (217ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (156ms)\n\n    ✔ should fetch RPC URL (258ms)\n\n    ✔ should fetch Alt RPC URL (162ms)\n\n    ✔ should fetch Events Fetch Page Size (176ms)\n\n    ✔ should fetch NewEventsQueueURL (172ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (271ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (428ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1465ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (510ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (727ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (8s)\n  6 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   79.35 |    42.64 |   90.14 |    79.7 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   23.12 |    13.01 |   38.88 |   23.07 |                   \n\n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   39.21 |    38.46 |   71.42 |   38.77 | 16-32,39,43,55-83 \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n\n sandbox7748464/src/services/config    |    86.3 |    45.31 |    92.3 |   86.86 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   84.33 |    44.21 |      84 |   86.25 | ...,68-72,177-181 \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":2,"line":29},"start":{"column":21,"line":10}}},{"id":"47","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:12559) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n    1) should process PositionOpened event and push messages to SQS\n\n    2) should process PositionClosed event and push messages to SQS\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n    5) should catch and report on Deposit event\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (212ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (168ms)\n\n    ✔ should fetch RPC URL (198ms)\n\n    ✔ should fetch Alt RPC URL (147ms)\n\n    ✔ should fetch Events Fetch Page Size (180ms)\n\n    ✔ should fetch NewEventsQueueURL (162ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (323ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (380ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1294ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (354ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (696ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  32 passing (8s)\n  6 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   81.05 |    43.28 |   91.07 |   81.36 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   36.05 |    17.75 |      50 |   35.66 |                   \n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n  lambda-handler.ts                    |   76.47 |    58.97 |     100 |   75.51 | 24,39,62-76       \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n sandbox7748464/src/services/config    |    86.3 |    45.31 |    92.3 |   86.86 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   84.33 |    44.21 |      84 |   86.25 | ...,68-72,177-181 \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":24},"start":{"column":7,"line":14}}},{"id":"46","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":37,"line":11},"start":{"column":21,"line":11}}},{"id":"48","mutatorName":"BlockStatement","replacement":"{}","status":"Survived","testsCompleted":1,"location":{"end":{"column":4,"line":26},"start":{"column":21,"line":24}}},{"id":"49","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":25,"line":25},"start":{"column":17,"line":25}}},{"id":"50","mutatorName":"BlockStatement","replacement":"{}","status":"Survived","testsCompleted":1,"location":{"end":{"column":4,"line":28},"start":{"column":13,"line":26}}}],"source":"import {Logger} from '@thisisarchimedes/backend-sdk';\nimport {ConfigServiceAWS} from './services/config/ConfigServiceAWS';\nimport {EventProcessorService} from './EventProcessorService';\n\nexport const handler = async (\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars, @typescript-eslint/no-explicit-any\n    _event: any,\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars, @typescript-eslint/no-explicit-any\n    _context: any,\n): Promise<"+"void> => {\n  Logger.initialize('Events fetcher');\n  const logger = Logger.getInstance();\n\n  try {\n    const environment = process.env.ENVIRONMENT as string;\n    const region = process.env.AWS_REGION as string;\n    const configService: ConfigServiceAWS = new ConfigServiceAWS(environment, region);\n    await configService.refreshConfig();\n\n    const eventProcessorService = new EventProcessorService(logger, configService);\n\n    await eventProcessorService.execute();\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  } catch (ex: any) {\n    console.log('Error:', (ex as Error).message);\n  } finally {\n    await logger.flush();\n  }\n};\n"},"src/onchain_events/EventFactory.ts":{"language":"typescript","mutants":[{"id":"51","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:12788) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:18 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:18 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (466ms)\n\n[2/23/2024 7:23:18 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:18 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:18 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (303ms)\n\n[2/23/2024 7:23:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:19 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (512ms)\n\n[2/23/2024 7:23:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:19 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (305ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:19 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:19 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:19 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (357ms)\n\n[2/23/2024 7:23:20 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:20 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:20 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (286ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (406ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (146ms)\n\n    ✔ should fetch RPC URL (162ms)\n\n    ✔ should fetch Alt RPC URL (213ms)\n\n    ✔ should fetch Events Fetch Page Size (197ms)\n\n    ✔ should fetch NewEventsQueueURL (184ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (231ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (544ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (833ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (362ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (723ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    1) should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (10s)\n  1 failing\n\n\n  1) Inner logic functions\n       should return an empty array for no logs:\n\n      AssertionError: expected promise to be rejected with an error including 'Event log has no topics' but got 'Must call super constructor in derive…'\n      + expected - actual\n\n      -Must call super constructor in derived class before accessing 'this' or returning from derived constructor\n      +Event log has no topics\n      \n  \n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |    88.5 |    47.76 |   96.71 |   88.83 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   86.39 |    46.74 |     100 |   86.01 |                   \n  EventProcessorService.ts             |   86.45 |    45.38 |     100 |   86.17 | ...00,153-157,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.37 |    50.64 |   86.48 |   87.06 |                   \n  EventFactory.ts                      |   85.93 |    52.77 |   77.27 |   89.07 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":26},"start":{"column":32,"line":23}}},{"id":"52","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":48,"line":25},"start":{"column":17,"line":25}}},{"id":"53","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:12902) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:19 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:23:20 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:20 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:23:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:20 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:23:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:21 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:21 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:23:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:21 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (200ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (166ms)\n\n    ✔ should fetch RPC URL (169ms)\n\n    ✔ should fetch Alt RPC URL (162ms)\n\n    ✔ should fetch Events Fetch Page Size (160ms)\n\n    ✔ should fetch NewEventsQueueURL (151ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (235ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (392ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1020ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (381ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (674ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    11) should report on Deposit event\n\n    12) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  26 passing (9s)\n  12 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n  11) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  12) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |    52.6 |    28.72 |   55.86 |   53.04 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   85.71 |    46.74 |     100 |   85.31 |                   \n  EventProcessorService.ts             |   85.41 |    45.38 |     100 |    85.1 | ...45,153-157,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |    41.5 |    19.15 |   51.35 |   42.78 |                   \n  EventFactory.ts                      |   39.84 |    14.81 |      50 |   42.01 | ...08-196,205-230 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      16 |    13.72 |   22.22 |   16.32 | 6,16-46,53-96     \n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n\n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n\n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   87.55 |    45.69 |   94.23 |   88.13 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,100-104 \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":38},"start":{"column":85,"line":34}}},{"id":"54","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:12962) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:21 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:23:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:21 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:23:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:21 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:23:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:22 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:22 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:22 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:23:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:22 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (179ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (172ms)\n\n    ✔ should fetch RPC URL (178ms)\n\n    ✔ should fetch Alt RPC URL (153ms)\n\n    ✔ should fetch Events Fetch Page Size (174ms)\n\n    ✔ should fetch NewEventsQueueURL (155ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (249ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (346ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1004ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (318ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (825ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (49ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    11) should report on Deposit event\n\n    12) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    13) should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  25 passing (10s)\n  13 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  11) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected 2 to equal 1\n      + expected - actual\n\n      -2\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n  12) PSP Events Logging\n       should report on Withdraw event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:88:18)\n\n  13) Inner logic functions\n       should return an empty array for no logs:\n     AssertionError: expected promise to be rejected with an error including 'Event log has no topics' but it was fulfilled with undefined\n  \n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   51.61 |    27.52 |   54.46 |   52.02 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   86.39 |    46.74 |     100 |   86.01 |                   \n  EventProcessorService.ts             |   86.45 |    45.38 |     100 |   86.17 | ...00,153-157,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   35.84 |    14.28 |   43.24 |   36.81 |                   \n  EventFactory.ts                      |   30.46 |     7.87 |   36.36 |   31.93 | ...9,61-66,88-230 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      16 |    13.72 |   22.22 |   16.32 | 6,16-46,53-96     \n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   87.55 |    45.69 |   94.23 |   88.13 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,100-104 \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":53},"start":{"column":83,"line":40}}},{"id":"55","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:13050) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:23 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:23:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:23 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:23:24 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:24 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:23:24 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:24 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:24 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:24 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:23:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:25 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (148ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (166ms)\n\n    ✔ should fetch RPC URL (154ms)\n\n    ✔ should fetch Alt RPC URL (166ms)\n\n    ✔ should fetch Events Fetch Page Size (146ms)\n\n    ✔ should fetch NewEventsQueueURL (171ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (239ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (368ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (952ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (341ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (697ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    11) should report on Deposit event\n\n    12) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  26 passing (9s)\n\n  12 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  11) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  12) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |    52.6 |    28.24 |   54.92 |   53.04 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   87.75 |    47.33 |     100 |   87.41 |                   \n\n  EventProcessorService.ts             |   88.54 |    46.15 |     100 |   88.29 | ...95-100,145,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   40.09 |    16.88 |   45.94 |   41.29 |                   \n\n  EventFactory.ts                      |    37.5 |    11.57 |    40.9 |   39.49 | 6,24,39,97-230    \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      16 |    13.72 |   22.22 |   16.32 | 6,16-46,53-96     \n\n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n\n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n\n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n\n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   87.55 |    45.69 |   94.23 |   88.13 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,100-104 \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":41},"start":{"column":9,"line":41}}},{"id":"56","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:13130) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:26 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:26 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:26 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (508ms)\n\n[2/23/2024 7:23:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:27 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:27 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (306ms)\n\n[2/23/2024 7:23:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:27 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:27 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (320ms)\n\n[2/23/2024 7:23:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:27 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:27 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (313ms)\n\n\n  PSP Events\n\n[2/23/2024 7:23:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:28 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:28 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:28 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:23:28 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:28 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:28 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (299ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (157ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (175ms)\n\n    ✔ should fetch RPC URL (152ms)\n\n    ✔ should fetch Alt RPC URL (155ms)\n\n    ✔ should fetch Events Fetch Page Size (179ms)\n\n    ✔ should fetch NewEventsQueueURL (146ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (320ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (360ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (981ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (372ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (657ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    2) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    3) should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (9s)\n\n  3 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n  3) Inner logic functions\n       should return an empty array for no logs:\n\n      AssertionError: expected promise to be rejected with an error including 'Event log has no topics' but got 'Cannot read properties of undefined (…'\n      + expected - actual\n\n      -Cannot read properties of undefined (reading 'address')\n      +Event log has no topics\n      \n  \n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |     47.6 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.37 |    49.67 |   86.48 |   87.06 |                   \n\n  EventFactory.ts                      |   85.93 |    51.38 |   77.27 |   89.07 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":41},"start":{"column":9,"line":41}}},{"id":"57","mutatorName":"EqualityOperator","replacement":"eventLog !== undefined","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:13184) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:27 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:23:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:27 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:23:27 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:27 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:23:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:28 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:23:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:28 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:23:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:28 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (155ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (166ms)\n\n    ✔ should fetch RPC URL (147ms)\n\n    ✔ should fetch Alt RPC URL (158ms)\n\n    ✔ should fetch Events Fetch Page Size (155ms)\n\n    ✔ should fetch NewEventsQueueURL (153ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (229ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (395ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1012ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (302ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (672ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    11) should report on Deposit event\n\n    12) should report on Withdraw event\n\n\n  Inner logic functions\n\n    13) should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  25 passing (9s)\n  13 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  11) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  12) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n  13) Inner logic functions\n       should return an empty array for no logs:\n\n      AssertionError: expected promise to be rejected with an error including 'Event log has no topics' but got 'Cannot read properties of undefined (…'\n      + expected - actual\n\n      -Cannot read properties of undefined (reading 'address')\n      +Event log has no topics\n      \n  \n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   86.79 |    50.97 |   86.48 |   88.55 |                   \n\n  EventFactory.ts                      |   88.28 |    53.24 |   77.27 |   91.59 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":41},"start":{"column":9,"line":41}}},{"id":"60","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:13351) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:31 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:23:31 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:23:31 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:31 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:23:31 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:23:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:31 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:23:31 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:23:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:32 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:23:32 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:32 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:32 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:23:32 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:23:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:32 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:23:32 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (179ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (168ms)\n\n    ✔ should fetch RPC URL (157ms)\n\n    ✔ should fetch Alt RPC URL (173ms)\n\n    ✔ should fetch Events Fetch Page Size (211ms)\n\n    ✔ should fetch NewEventsQueueURL (144ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (269ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (348ms)\n\n    7) \"before each\" hook for \"should get main and alt RPC URL from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (993ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (343ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (720ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    8) should report on PositionOpened event\n\n    9) should report on PositionClosed event\n\n    10) should report on PositionLiqiuidated event\n\n    11) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    12) should report on Deposit event\n\n    13) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  23 passing (8s)\n  13 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  7) Config Service Test\n       \"before each\" hook for \"should get main and alt RPC URL from AWS\":\n     Error: Error fetching configuration for EventsFetchPageSize: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async ConfigServiceAWS.refreshEventFetchPageSize (src/services/config/ConfigServiceAWS.ts:3:11556)\n      at async Promise.all (index 4)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  11) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  12) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  13) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   53.77 |     29.2 |   55.39 |   54.24 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   87.75 |    47.33 |     100 |   87.41 |                   \n\n  EventProcessorService.ts             |   88.54 |    46.15 |     100 |   88.29 | ...95-100,145,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   44.81 |    20.12 |   48.64 |   46.26 |                   \n\n  EventFactory.ts                      |   45.31 |     16.2 |   45.45 |   47.89 | ...99-165,185-230 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      16 |    13.72 |   22.22 |   16.32 | 6,16-46,53-96     \n\n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n\n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n\n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n\n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.44 |   94.23 |    89.4 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,100-104 \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":48},"start":{"column":39,"line":45}}},{"id":"58","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:13240) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:30 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (355ms)\n\n[2/23/2024 7:23:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:30 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (364ms)\n\n[2/23/2024 7:23:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:30 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (305ms)\n\n[2/23/2024 7:23:31 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:31 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (329ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:31 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:31 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:31 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (294ms)\n\n[2/23/2024 7:23:31 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:31 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:31 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (312ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (219ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (179ms)\n\n    ✔ should fetch RPC URL (178ms)\n\n    ✔ should fetch Alt RPC URL (166ms)\n\n    ✔ should fetch Events Fetch Page Size (161ms)\n\n    ✔ should fetch NewEventsQueueURL (165ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (223ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (409ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1033ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (287ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (729ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    1) should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n  1 failing\n\n\n\n  1) Inner logic functions\n       should return an empty array for no logs:\n\n      AssertionError: expected promise to be rejected with an error including 'Event log has no topics' but got 'Cannot read properties of undefined (…'\n      + expected - actual\n\n      -Cannot read properties of undefined (reading 'address')\n      +Event log has no topics\n      \n  \n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.31 |    48.24 |   96.71 |   89.66 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   86.79 |    51.62 |   86.48 |   88.55 |                   \n\n  EventFactory.ts                      |   88.28 |    54.16 |   77.27 |   91.59 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   90.04 |    46.81 |   96.15 |   90.67 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":43},"start":{"column":33,"line":41}}},{"id":"59","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:13297) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:30 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (483ms)\n\n[2/23/2024 7:23:31 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:31 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (293ms)\n\n[2/23/2024 7:23:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:31 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (275ms)\n\n[2/23/2024 7:23:31 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:31 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (351ms)\n\n\n  PSP Events\n\n[2/23/2024 7:23:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:32 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:32 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:32 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (320ms)\n\n[2/23/2024 7:23:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:32 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:32 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (287ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (197ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (175ms)\n\n    ✔ should fetch RPC URL (183ms)\n\n    ✔ should fetch Alt RPC URL (155ms)\n\n    ✔ should fetch Events Fetch Page Size (174ms)\n\n    ✔ should fetch NewEventsQueueURL (167ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (254ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (346ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (943ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (398ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (714ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    1) should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n  37 passing (9s)\n  1 failing\n\n  1) Inner logic functions\n       should return an empty array for no logs:\n\n      AssertionError: expected promise to be rejected with an error including 'Event log has no topics' but got ''\n      + expected - actual\n\n      +Event log has no topics\n      \n  \n\n\n\n\n----------|---------|----------|---------|---------|-------------------\nFile      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n----------|---------|----------|---------|---------|-------------------\nAll files |       0 |        0 |       0 |       0 |                   \n----------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":72,"line":42},"start":{"column":47,"line":42}}},{"id":"61","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:13406) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:32 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (359ms)\n\n[2/23/2024 7:23:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:32 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (265ms)\n\n[2/23/2024 7:23:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:32 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (274ms)\n\n[2/23/2024 7:23:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:33 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (270ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:33 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:33 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:23:33 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:23:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:33 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:23:33 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (147ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (176ms)\n\n    ✔ should fetch RPC URL (160ms)\n\n    ✔ should fetch Alt RPC URL (181ms)\n\n    ✔ should fetch Events Fetch Page Size (174ms)\n\n    ✔ should fetch NewEventsQueueURL (175ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (243ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (372ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (945ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (274ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (752ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    3) should report on Deposit event\n\n    4) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n  34 passing (9s)\n  4 failing\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n  4) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   79.71 |    43.36 |   85.91 |   80.07 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   77.35 |    44.48 |   83.78 |    78.6 |                   \n  EventFactory.ts                      |   72.65 |    43.98 |   72.72 |   74.78 | ...86-192,200-213 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":69},"start":{"column":84,"line":55}}},{"id":"62","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:13461) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:34 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:34 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (318ms)\n\n[2/23/2024 7:23:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:34 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:34 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (300ms)\n\n[2/23/2024 7:23:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:35 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:35 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (293ms)\n\n[2/23/2024 7:23:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:35 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:35 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (298ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:35 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:35 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:23:35 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:23:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:35 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:23:36 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (181ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (174ms)\n\n    ✔ should fetch RPC URL (139ms)\n\n    ✔ should fetch Alt RPC URL (241ms)\n\n    ✔ should fetch Events Fetch Page Size (152ms)\n\n    ✔ should fetch NewEventsQueueURL (168ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (366ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (360ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (944ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (315ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (709ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    3) should report on Deposit event\n\n    4) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n  4 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  4) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   80.16 |    43.76 |   85.91 |   80.53 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   79.71 |     46.1 |   83.78 |   81.09 |                   \n\n  EventFactory.ts                      |   76.56 |    46.29 |   72.72 |   78.99 | ...86-192,200-213 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n\n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n\n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":56},"start":{"column":9,"line":56}}},{"id":"63","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:13521) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:37 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:37 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:37 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:37 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (393ms)\n\n[2/23/2024 7:23:37 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:37 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:37 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:37 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (306ms)\n\n[2/23/2024 7:23:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:38 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:38 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (308ms)\n\n[2/23/2024 7:23:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:38 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:38 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (272ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:38 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:38 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:38 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:38 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:23:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:39 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:39 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (275ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (155ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (175ms)\n\n    ✔ should fetch RPC URL (295ms)\n\n    ✔ should fetch Alt RPC URL (155ms)\n\n    ✔ should fetch Events Fetch Page Size (161ms)\n\n    ✔ should fetch NewEventsQueueURL (166ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (266ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (322ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (968ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (339ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (647ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n  1 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.15 |    46.88 |   96.24 |   88.46 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   82.07 |    46.75 |   83.78 |   83.58 |                   \n\n  EventFactory.ts                      |   80.46 |    47.22 |   72.72 |   83.19 | ...86-192,200-213 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":56},"start":{"column":9,"line":56}}},{"id":"64","mutatorName":"EqualityOperator","replacement":"this.isLogEventEmittedByPSPContract(eventLog) !== false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:13575) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:38 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:38 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (349ms)\n\n[2/23/2024 7:23:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:38 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:38 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (296ms)\n\n[2/23/2024 7:23:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:38 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:38 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (320ms)\n\n[2/23/2024 7:23:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:39 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:39 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (282ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:39 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:39 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:39 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:23:39 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:23:39 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:39 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:23:39 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (154ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (171ms)\n\n    ✔ should fetch RPC URL (177ms)\n\n    ✔ should fetch Alt RPC URL (169ms)\n\n    ✔ should fetch Events Fetch Page Size (158ms)\n\n    ✔ should fetch NewEventsQueueURL (160ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (226ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (388ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (983ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (1559ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (657ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    3) should report on Deposit event\n\n    4) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (10s)\n  4 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  4) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   81.05 |     44.4 |   86.38 |   81.45 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   84.43 |     48.7 |   86.48 |   86.06 |                   \n\n  EventFactory.ts                      |   84.37 |       50 |   77.27 |   87.39 | ...24,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n\n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n\n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":56},"start":{"column":9,"line":56}}},{"id":"65","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:13655) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:41 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:41 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (350ms)\n\n[2/23/2024 7:23:41 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:41 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (295ms)\n\n[2/23/2024 7:23:41 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:41 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (284ms)\n\n[2/23/2024 7:23:41 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:41 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:42 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (302ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:42 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:42 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:42 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:23:42 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:23:42 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:42 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:23:42 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (189ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (155ms)\n\n    ✔ should fetch RPC URL (184ms)\n\n    ✔ should fetch Alt RPC URL (168ms)\n\n    ✔ should fetch Events Fetch Page Size (146ms)\n\n    ✔ should fetch NewEventsQueueURL (140ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (257ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (376ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (976ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (331ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (760ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    3) should report on Deposit event\n\n    4) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n\n  4 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  4) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   81.05 |    44.64 |   86.38 |   81.45 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   84.43 |    49.67 |   86.48 |   86.06 |                   \n  EventFactory.ts                      |   84.37 |    51.38 |   77.27 |   87.39 | ...24,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":56},"start":{"column":59,"line":56}}},{"id":"66","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:13688) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:41 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:41 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (394ms)\n\n[2/23/2024 7:23:41 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:41 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (282ms)\n\n[2/23/2024 7:23:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:42 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:42 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (301ms)\n\n[2/23/2024 7:23:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:42 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:42 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (306ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:42 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:42 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:42 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:42 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (363ms)\n\n[2/23/2024 7:23:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:42 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:43 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (169ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (146ms)\n\n    ✔ should fetch RPC URL (175ms)\n\n    ✔ should fetch Alt RPC URL (139ms)\n\n    ✔ should fetch Events Fetch Page Size (148ms)\n\n    ✔ should fetch NewEventsQueueURL (150ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (238ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (340ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1044ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (609ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (793ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n  1 failing\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.13 |    48.08 |   96.71 |   89.48 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   87.26 |    51.62 |   86.48 |   89.05 |                   \n\n  EventFactory.ts                      |   89.06 |    54.16 |   77.27 |   92.43 | ...39,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":58},"start":{"column":66,"line":56}}},{"id":"67","mutatorName":"ConditionalExpression","replacement":"case TOPIC_EVENT_PSP_DEPOSIT:","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:13742) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:41 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:41 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (340ms)\n\n[2/23/2024 7:23:42 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:42 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:42 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (294ms)\n\n[2/23/2024 7:23:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:42 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:42 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (301ms)\n\n[2/23/2024 7:23:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:42 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:42 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (350ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:43 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:43 PM] {\"event\":\"Withdraw\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:43 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:23:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:43 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:43 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (271ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (162ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (165ms)\n\n    ✔ should fetch RPC URL (142ms)\n\n    ✔ should fetch Alt RPC URL (152ms)\n\n    ✔ should fetch Events Fetch Page Size (170ms)\n\n    ✔ should fetch NewEventsQueueURL (154ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (253ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (330ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1201ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (426ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (727ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    2) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected 'Withdraw' to equal 'Deposit'\n      + expected - actual\n\n      -Withdraw\n      +Deposit\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:55:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.13 |    48.16 |   96.71 |   89.48 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   87.26 |    51.94 |   86.48 |   89.05 |                   \n  EventFactory.ts                      |   89.06 |    54.62 |   77.27 |   92.43 | ...39,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":103,"line":62},"start":{"column":7,"line":61}}},{"id":"68","mutatorName":"ConditionalExpression","replacement":"case TOPIC_EVENT_PSP_WITHDRAW:","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:13805) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:43 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (329ms)\n\n[2/23/2024 7:23:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:43 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (260ms)\n\n[2/23/2024 7:23:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:43 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (263ms)\n\n[2/23/2024 7:23:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:43 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (349ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:44 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:44 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:44 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (281ms)\n\n[2/23/2024 7:23:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:44 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:23:44 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (182ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (223ms)\n\n    ✔ should fetch RPC URL (192ms)\n\n    ✔ should fetch Alt RPC URL (172ms)\n\n    ✔ should fetch Events Fetch Page Size (163ms)\n\n    ✔ should fetch NewEventsQueueURL (202ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (239ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (432ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (994ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (319ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (706ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    2) should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   86.62 |    46.88 |   93.42 |   86.99 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   86.32 |    50.97 |   86.48 |   88.05 |                   \n  EventFactory.ts                      |    87.5 |    53.24 |   77.27 |   90.75 | ...24,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   68.21 |       36 |      75 |   68.25 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":104,"line":65},"start":{"column":7,"line":64}}},{"id":"69","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:13863) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:45 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:23:45 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:23:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:45 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:23:45 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:23:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:45 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:23:45 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:23:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:46 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:23:46 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:46 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:46 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:46 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (262ms)\n\n[2/23/2024 7:23:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:46 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:46 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (273ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (180ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (153ms)\n\n    ✔ should fetch RPC URL (167ms)\n\n    ✔ should fetch Alt RPC URL (162ms)\n\n    ✔ should fetch Events Fetch Page Size (149ms)\n\n    ✔ should fetch NewEventsQueueURL (151ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (249ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (410ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1121ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (328ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (676ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    5) should report on PositionOpened event\n\n    6) should report on PositionClosed event\n\n    7) should report on PositionLiqiuidated event\n\n    8) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (9s)\n\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   66.78 |    36.24 |   71.83 |   66.97 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   74.52 |    37.33 |   83.78 |   75.62 |                   \n\n  EventFactory.ts                      |   67.96 |    33.79 |   72.72 |   69.74 | ...86-192,217-230 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   87.55 |    45.69 |   94.23 |   88.13 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,100-104 \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":91},"start":{"column":89,"line":71}}},{"id":"70","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:13922) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:48 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:23:48 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:23:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:49 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:23:49 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:23:49 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:49 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:23:49 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:23:49 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:49 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:23:49 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:50 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:50 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:50 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:23:50 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:50 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:50 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (267ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (187ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (145ms)\n\n    ✔ should fetch RPC URL (154ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (142ms)\n\n    ✔ should fetch NewEventsQueueURL (169ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (277ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (357ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1269ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (373ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (645ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    6) should report on PositionOpened event\n\n    7) should report on PositionClosed event\n\n    8) should report on PositionLiqiuidated event\n\n    9) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  29 passing (10s)\n  9 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   67.23 |    36.64 |   71.83 |   67.43 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   76.88 |    38.96 |   83.78 |    78.1 |                   \n\n  EventFactory.ts                      |   71.87 |    36.11 |   72.72 |   73.94 | ...86-192,217-230 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   87.55 |    45.69 |   94.23 |   88.13 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,100-104 \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":72},"start":{"column":9,"line":72}}},{"id":"71","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","testsCompleted":1,"location":{"end":{"column":69,"line":72},"start":{"column":9,"line":72}}},{"id":"72","mutatorName":"EqualityOperator","replacement":"this.isLogEventEmittedByLeverageContract(eventLog) !== false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:14057) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:52 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:23:52 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:23:52 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:52 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:23:52 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:23:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:52 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:23:52 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:23:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:53 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:23:53 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:53 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:53 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:53 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (320ms)\n\n[2/23/2024 7:23:53 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:53 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:53 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (203ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (160ms)\n\n    ✔ should fetch RPC URL (177ms)\n\n    ✔ should fetch Alt RPC URL (173ms)\n\n    ✔ should fetch Events Fetch Page Size (155ms)\n\n    ✔ should fetch NewEventsQueueURL (172ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (474ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (407ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1042ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (377ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (691ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    6) should report on PositionOpened event\n\n    7) should report on PositionClosed event\n\n    8) should report on PositionLiqiuidated event\n\n    9) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  29 passing (9s)\n  9 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |    68.4 |     38.8 |   72.76 |   68.63 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |    81.6 |     47.4 |   86.48 |   83.08 |                   \n\n  EventFactory.ts                      |   79.68 |    48.14 |   77.27 |   82.35 | ...45-162,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":72},"start":{"column":9,"line":72}}},{"id":"74","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:14144) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:53 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:53 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (400ms)\n\n[2/23/2024 7:23:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:53 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:53 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (300ms)\n\n[2/23/2024 7:23:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:53 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:53 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (316ms)\n\n[2/23/2024 7:23:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:54 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:54 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (324ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:54 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:54 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:54 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:23:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:54 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:54 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (153ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (225ms)\n\n    ✔ should fetch RPC URL (142ms)\n\n    ✔ should fetch Alt RPC URL (150ms)\n\n    ✔ should fetch Events Fetch Page Size (224ms)\n\n    ✔ should fetch NewEventsQueueURL (312ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (277ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (422ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1131ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (368ms)\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (792ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |    68.4 |    39.04 |   72.76 |   68.63 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |    81.6 |    48.37 |   86.48 |   83.08 |                   \n\n  EventFactory.ts                      |   79.68 |    49.53 |   77.27 |   82.35 | ...45-162,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":74},"start":{"column":71,"line":72}}},{"id":"73","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:14112) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:52 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:23:52 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:23:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:53 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:23:53 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:23:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:53 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:23:53 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:23:53 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:53 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:23:53 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:54 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:54 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:54 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:23:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:54 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:54 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (158ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (172ms)\n\n    ✔ should fetch RPC URL (196ms)\n\n    ✔ should fetch Alt RPC URL (165ms)\n\n    ✔ should fetch Events Fetch Page Size (151ms)\n\n    ✔ should fetch NewEventsQueueURL (185ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (227ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (455ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1103ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (368ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (855ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    11) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  27 passing (10s)\n  11 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  11) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected 'LeveragedPositionOpened' to equal 'Withdraw'\n      + expected - actual\n\n      -LeveragedPositionOpened\n      +Withdraw\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |    68.4 |    39.04 |   72.76 |   68.63 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |    81.6 |    48.37 |   86.48 |   83.08 |                   \n\n  EventFactory.ts                      |   79.68 |    49.53 |   77.27 |   82.35 | ...45-162,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":72},"start":{"column":64,"line":72}}},{"id":"75","mutatorName":"ConditionalExpression","replacement":"case TOPIC_EVENT_LEVERAGE_POSITION_OPENED:","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:14199) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:54 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:54 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:23:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:54 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:54 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (297ms)\n\n[2/23/2024 7:23:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:54 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:54 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (276ms)\n\n[2/23/2024 7:23:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:55 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:55 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (294ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:55 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:55 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:55 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (275ms)\n\n[2/23/2024 7:23:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:55 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:55 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (307ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (282ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (212ms)\n\n    ✔ should fetch RPC URL (196ms)\n\n    ✔ should fetch Alt RPC URL (162ms)\n\n    ✔ should fetch Events Fetch Page Size (181ms)\n\n    ✔ should fetch NewEventsQueueURL (168ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (307ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (365ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1017ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (357ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (747ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected 'LeveragedPositionClosed' to equal 'LeveragedPositionOpened'\n      + expected - actual\n\n      -LeveragedPositionClosed\n      +LeveragedPositionOpened\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   83.93 |    45.76 |   91.07 |   84.22 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |    50.97 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    53.24 |   77.27 |   89.91 | ...47,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   72.69 |    38.14 |   80.32 |   72.56 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":115,"line":78},"start":{"column":7,"line":77}}},{"id":"76","mutatorName":"ConditionalExpression","replacement":"case TOPIC_EVENT_LEVERAGE_POSITION_CLOSED:","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:14258) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:55 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (666ms)\n\n[2/23/2024 7:23:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:56 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:23:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:56 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:23:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (279ms)\n\n[2/23/2024 7:23:56 PM] Executing the event fetcher workflow...\n[2/23/2024 7:23:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:56 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (307ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:23:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:57 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:23:57 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:23:57 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (321ms)\n\n[2/23/2024 7:23:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:57 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:23:57 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (312ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (167ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (260ms)\n\n    ✔ should fetch RPC URL (174ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (153ms)\n\n    ✔ should fetch NewEventsQueueURL (180ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (277ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (464ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (982ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (314ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (742ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    2) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |      85 |     46.4 |   91.54 |   85.33 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   87.26 |    51.94 |   86.48 |   89.05 |                   \n  EventFactory.ts                      |   86.71 |    53.24 |   77.27 |   89.91 | ...52,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      90 |    49.01 |     100 |   89.79 | 6,24,38-41        \n ...src/onchain_events/leverage_events |   75.76 |    39.51 |   81.96 |   75.69 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":115,"line":81},"start":{"column":7,"line":80}}},{"id":"77","mutatorName":"ConditionalExpression","replacement":"case TOPIC_EVENT_LEVERAGE_POSITION_LIQUIDATED:","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:14313) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:23:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:23:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:23:59 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:23:59 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (390ms)\n\n[2/23/2024 7:24:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:00 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (295ms)\n\n[2/23/2024 7:24:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:00 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x825cc02ec7B77d4432e82e7bCAf3B89a67a555F1\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:00 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:00 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (281ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:01 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:01 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:01 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:01 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:24:01 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:01 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:01 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (357ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (169ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (150ms)\n\n    ✔ should fetch RPC URL (142ms)\n\n    ✔ should fetch Alt RPC URL (143ms)\n\n    ✔ should fetch Events Fetch Page Size (154ms)\n\n    ✔ should fetch NewEventsQueueURL (177ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (217ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (375ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1154ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (359ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (655ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    3) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (9s)\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected 'LeveragedPositionExpired' to equal 'LeveragedPositionLiquidated'\n      + expected - actual\n\n      -LeveragedPositionExpired\n      +LeveragedPositionLiquidated\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   84.47 |       46 |   91.54 |   84.77 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |    50.97 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    53.24 |   77.27 |   89.91 | ...57,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   74.74 |    39.17 |   81.96 |   74.65 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":119,"line":84},"start":{"column":7,"line":83}}},{"id":"78","mutatorName":"ConditionalExpression","replacement":"case TOPIC_EVENT_LEVERAGE_POSITION_EXPIRED:","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:14370) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:01 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (350ms)\n\n[2/23/2024 7:24:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:02 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (306ms)\n\n[2/23/2024 7:24:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:02 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:24:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (284ms)\n\n[2/23/2024 7:24:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:02 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:24:02 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:24:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:02 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:02 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:03 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:24:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:03 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:03 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (268ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (146ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (153ms)\n\n    ✔ should fetch RPC URL (150ms)\n\n    ✔ should fetch Alt RPC URL (142ms)\n\n    ✔ should fetch Events Fetch Page Size (147ms)\n\n    ✔ should fetch NewEventsQueueURL (192ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (245ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (364ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (872ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (345ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (648ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    3) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (9s)\n  3 failing\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   84.91 |    46.16 |   91.54 |   85.23 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   86.32 |    50.97 |   86.48 |   88.05 |                   \n\n  EventFactory.ts                      |    87.5 |    53.24 |   77.27 |   90.75 | ...61-162,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |    76.1 |    39.86 |   81.96 |   76.04 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":116,"line":87},"start":{"column":7,"line":86}}},{"id":"79","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n  Leverage Events\n\n(node:14425) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:24:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:03 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:04 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:04 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:04 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:04 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:05 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:05 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:24:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:05 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (188ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (155ms)\n\n    ✔ should fetch RPC URL (167ms)\n\n    ✔ should fetch Alt RPC URL (161ms)\n\n    ✔ should fetch Events Fetch Page Size (141ms)\n\n    ✔ should fetch NewEventsQueueURL (269ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (253ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (373ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (731ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (343ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (670ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    11) should report on Deposit event\n\n    12) should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  26 passing (10s)\n  12 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  11) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected 2 to equal 1\n      + expected - actual\n\n      -2\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n  12) PSP Events Logging\n       should report on Withdraw event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:88:18)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   81.32 |    42.88 |   86.85 |   81.82 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   86.39 |    46.74 |     100 |   86.01 |                   \n\n  EventProcessorService.ts             |   86.45 |    45.38 |     100 |   86.17 | ...00,153-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   79.24 |    43.18 |   75.67 |   82.08 |                   \n\n  EventFactory.ts                      |   78.12 |    42.59 |   63.63 |   83.19 | ...27,165,172-196 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      78 |    41.17 |   88.88 |   77.55 | ...41,75-79,89-93 \n\n ...src/onchain_events/leverage_events |   72.35 |    36.08 |   77.04 |   72.22 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   78.68 |     36.5 |   84.61 |   78.33 | ...,78-89,121-137 \n\n  ...inEventLeveragePositionExpired.ts |   78.33 |    36.06 |   84.61 |   77.96 | ...,77-87,118-133 \n\n  ...ventLeveragePositionLiquidated.ts |   79.68 |    38.46 |   84.61 |   79.36 | ...,80-91,125-142 \n\n  ...ainEventLeveragePositionOpened.ts |   81.42 |    39.43 |   85.71 |   81.15 | ...,81-92,137-156 \n\n ...8464/src/onchain_events/psp_events |   79.84 |     42.4 |   89.28 |   79.36 |                   \n\n  OnChainEventPSP.ts                   |   82.97 |    43.58 |      90 |    82.6 | 6,24,38-41,63-67  \n\n  OnChainEventPSPDeposit.ts            |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n\n  OnChainEventPSPWithdraw.ts           |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":111},"start":{"column":53,"line":94}}},{"id":"80","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:14535) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:04 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:24:04 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:05 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:24:05 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:05 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:24:05 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:05 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:24:05 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:05 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:05 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:24:05 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:24:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:06 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:24:06 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (298ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (152ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (180ms)\n\n    ✔ should fetch RPC URL (228ms)\n\n    ✔ should fetch Alt RPC URL (196ms)\n\n    ✔ should fetch Events Fetch Page Size (192ms)\n\n    ✔ should fetch NewEventsQueueURL (167ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (273ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (376ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (858ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (270ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (750ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    6) should report on PositionOpened event\n\n    7) should report on PositionClosed event\n\n    8) should report on PositionLiqiuidated event\n\n    9) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    10) should report on Deposit event\n\n    11) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  27 passing (9s)\n  11 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  10) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  11) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   82.22 |     43.6 |   86.85 |   82.74 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   82.54 |    45.45 |   75.67 |   85.57 |                   \n\n  EventFactory.ts                      |   83.59 |    45.83 |   63.63 |   89.07 | ...27,165,185-196 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      78 |    41.17 |   88.88 |   77.55 | ...41,75-79,89-93 \n ...src/onchain_events/leverage_events |   72.35 |    36.08 |   77.04 |   72.22 |                   \n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n  ...ainEventLeveragePositionClosed.ts |   78.68 |     36.5 |   84.61 |   78.33 | ...,78-89,121-137 \n  ...inEventLeveragePositionExpired.ts |   78.33 |    36.06 |   84.61 |   77.96 | ...,77-87,118-133 \n  ...ventLeveragePositionLiquidated.ts |   79.68 |    38.46 |   84.61 |   79.36 | ...,80-91,125-142 \n  ...ainEventLeveragePositionOpened.ts |   81.42 |    39.43 |   85.71 |   81.15 | ...,81-92,137-156 \n ...8464/src/onchain_events/psp_events |   79.84 |     42.4 |   89.28 |   79.36 |                   \n  OnChainEventPSP.ts                   |   82.97 |    43.58 |      90 |    82.6 | 6,24,38-41,63-67  \n  OnChainEventPSPDeposit.ts            |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n  OnChainEventPSPWithdraw.ts           |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":95},"start":{"column":9,"line":95}}},{"id":"81","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:14534) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:04 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:04 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (339ms)\n\n[2/23/2024 7:24:04 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:04 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:05 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (296ms)\n\n[2/23/2024 7:24:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:05 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:24:05 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (277ms)\n\n[2/23/2024 7:24:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:05 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:05 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (303ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:05 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:05 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:24:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:06 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:06 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (280ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (160ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (191ms)\n\n    ✔ should fetch RPC URL (221ms)\n\n    ✔ should fetch Alt RPC URL (164ms)\n\n    ✔ should fetch Events Fetch Page Size (187ms)\n\n    ✔ should fetch NewEventsQueueURL (160ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (249ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (392ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (950ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (418ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (707ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    2) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected 2 to equal 1\n      + expected - actual\n\n      -2\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.95 |    47.84 |   96.24 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   86.32 |    50.32 |   83.78 |   88.55 |                   \n\n  EventFactory.ts                      |    87.5 |    52.31 |   72.72 |   91.59 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":95},"start":{"column":9,"line":95}}},{"id":"82","mutatorName":"MethodExpression","replacement":"results.some(result => result === undefined)","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:14593) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:05 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:24:05 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:05 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:24:05 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:06 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:24:06 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:06 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:24:06 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:06 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:06 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:24:06 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:24:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:07 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:24:07 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (158ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (193ms)\n\n    ✔ should fetch RPC URL (192ms)\n\n    ✔ should fetch Alt RPC URL (169ms)\n\n    ✔ should fetch Events Fetch Page Size (160ms)\n\n    ✔ should fetch NewEventsQueueURL (160ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (223ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (349ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (690ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (355ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (774ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    11) should report on Deposit event\n\n    12) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  26 passing (9s)\n  12 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n  11) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n  12) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   82.13 |    43.28 |   87.32 |   82.56 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   87.75 |    47.33 |     100 |   87.41 |                   \n\n  EventProcessorService.ts             |   88.54 |    46.15 |     100 |   88.29 | ...95-100,145,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   82.54 |    44.48 |   78.37 |   85.07 |                   \n\n  EventFactory.ts                      |   83.59 |    44.44 |   68.18 |   88.23 | ...27,165,185-196 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      78 |    41.17 |   88.88 |   77.55 | ...41,75-79,89-93 \n\n ...src/onchain_events/leverage_events |   72.35 |    36.08 |   77.04 |   72.22 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   78.68 |     36.5 |   84.61 |   78.33 | ...,78-89,121-137 \n\n  ...inEventLeveragePositionExpired.ts |   78.33 |    36.06 |   84.61 |   77.96 | ...,77-87,118-133 \n\n  ...ventLeveragePositionLiquidated.ts |   79.68 |    38.46 |   84.61 |   79.36 | ...,80-91,125-142 \n\n  ...ainEventLeveragePositionOpened.ts |   81.42 |    39.43 |   85.71 |   81.15 | ...,81-92,137-156 \n ...8464/src/onchain_events/psp_events |   79.84 |     42.4 |   89.28 |   79.36 |                   \n\n  OnChainEventPSP.ts                   |   82.97 |    43.58 |      90 |    82.6 | 6,24,38-41,63-67  \n  OnChainEventPSPDeposit.ts            |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n  OnChainEventPSPWithdraw.ts           |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":95},"start":{"column":9,"line":95}}},{"id":"83","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:14649) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:06 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:06 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (346ms)\n\n[2/23/2024 7:24:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:07 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (307ms)\n\n[2/23/2024 7:24:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:07 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:24:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (320ms)\n\n[2/23/2024 7:24:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:07 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (277ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:08 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:08 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (278ms)\n\n[2/23/2024 7:24:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:08 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:08 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (276ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (241ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (193ms)\n\n    ✔ should fetch RPC URL (183ms)\n\n    ✔ should fetch Alt RPC URL (169ms)\n\n    ✔ should fetch Events Fetch Page Size (157ms)\n\n    ✔ should fetch NewEventsQueueURL (137ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (213ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (479ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1470ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (378ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (875ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    1) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  37 passing (10s)\n  1 failing\n\n\n  1) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected 2 to equal 1\n      + expected - actual\n\n      -2\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.33 |    47.36 |   96.71 |   88.65 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   86.39 |    46.74 |     100 |   86.01 |                   \n\n  EventProcessorService.ts             |   86.45 |    45.38 |     100 |   86.17 | ...00,153-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   84.43 |    49.02 |   86.48 |   86.06 |                   \n\n  EventFactory.ts                      |   84.37 |    50.46 |   77.27 |   87.39 | ...74-180,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":95},"start":{"column":23,"line":95}}},{"id":"84","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:14707) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:10 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:24:10 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:10 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:24:11 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:11 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:24:11 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:11 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:24:11 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:11 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:11 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:24:12 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:24:12 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:12 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:24:12 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (171ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (166ms)\n\n    ✔ should fetch RPC URL (177ms)\n\n    ✔ should fetch Alt RPC URL (161ms)\n\n    ✔ should fetch Events Fetch Page Size (185ms)\n\n    ✔ should fetch NewEventsQueueURL (323ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (283ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (326ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1245ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (420ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (644ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    11) should report on Deposit event\n\n    12) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  26 passing (9s)\n  12 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  11) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  12) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   82.13 |    43.76 |   87.32 |   82.56 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   87.75 |    47.33 |     100 |   87.41 |                   \n  EventProcessorService.ts             |   88.54 |    46.15 |     100 |   88.29 | ...95-100,145,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   82.54 |    46.42 |   78.37 |   85.07 |                   \n  EventFactory.ts                      |   83.59 |    47.22 |   68.18 |   88.23 | ...27,165,185-196 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      78 |    41.17 |   88.88 |   77.55 | ...41,75-79,89-93 \n ...src/onchain_events/leverage_events |   72.35 |    36.08 |   77.04 |   72.22 |                   \n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n  ...ainEventLeveragePositionClosed.ts |   78.68 |     36.5 |   84.61 |   78.33 | ...,78-89,121-137 \n  ...inEventLeveragePositionExpired.ts |   78.33 |    36.06 |   84.61 |   77.96 | ...,77-87,118-133 \n  ...ventLeveragePositionLiquidated.ts |   79.68 |    38.46 |   84.61 |   79.36 | ...,80-91,125-142 \n  ...ainEventLeveragePositionOpened.ts |   81.42 |    39.43 |   85.71 |   81.15 | ...,81-92,137-156 \n ...8464/src/onchain_events/psp_events |   79.84 |     42.4 |   89.28 |   79.36 |                   \n  OnChainEventPSP.ts                   |   82.97 |    43.58 |      90 |    82.6 | 6,24,38-41,63-67  \n  OnChainEventPSPDeposit.ts            |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n  OnChainEventPSPWithdraw.ts           |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":95},"start":{"column":35,"line":95}}},{"id":"85","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:14762) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:12 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:12 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (333ms)\n\n[2/23/2024 7:24:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:12 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:12 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (295ms)\n\n[2/23/2024 7:24:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:12 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:24:12 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (277ms)\n\n[2/23/2024 7:24:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:13 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:13 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (268ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:13 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:13 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:13 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (756ms)\n\n[2/23/2024 7:24:14 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:14 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:14 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (343ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (147ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (152ms)\n\n    ✔ should fetch RPC URL (174ms)\n\n    ✔ should fetch Alt RPC URL (150ms)\n\n    ✔ should fetch Events Fetch Page Size (161ms)\n\n    ✔ should fetch NewEventsQueueURL (142ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (286ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (329ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (708ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (341ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (653ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    1) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  37 passing (9s)\n  1 failing\n\n\n  1) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected 2 to equal 1\n      + expected - actual\n\n      -2\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.33 |    47.52 |   96.71 |   88.65 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   86.39 |    46.74 |     100 |   86.01 |                   \n\n  EventProcessorService.ts             |   86.45 |    45.38 |     100 |   86.17 | ...00,153-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   84.43 |    49.67 |   86.48 |   86.06 |                   \n\n  EventFactory.ts                      |   84.37 |    51.38 |   77.27 |   87.39 | ...74-180,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":95},"start":{"column":35,"line":95}}},{"id":"89","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:14987) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:17 PM] Multiple events detected, but expecting just one: 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:24:17 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:17 PM] Multiple events detected, but expecting just one: 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:24:17 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:17 PM] Multiple events detected, but expecting just one: 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:24:17 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:17 PM] Multiple events detected, but expecting just one: 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:24:17 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:18 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:18 PM] Multiple events detected, but expecting just one: 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:24:18 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:24:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:18 PM] Multiple events detected, but expecting just one: 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:24:18 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (157ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (169ms)\n\n    ✔ should fetch RPC URL (160ms)\n\n    ✔ should fetch Alt RPC URL (205ms)\n\n    ✔ should fetch Events Fetch Page Size (179ms)\n\n    ✔ should fetch NewEventsQueueURL (200ms)\n\n\n\n  Config Service Test\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async initalizeObjectUnderTest (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n    7) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (722ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (273ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (674ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    8) should report on PositionOpened event\n\n    9) should report on PositionClosed event\n\n    10) should report on PositionLiqiuidated event\n\n    11) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    12) should report on Deposit event\n\n    13) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  19 passing (5s)\n  13 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: Error fetching configuration for LeverageContractInfo: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async ConfigServiceAWS.fetchLeverageContractInfo (src/services/config/ConfigServiceAWS.ts:3:5924)\n      at async ConfigServiceAWS.refreshLeverageContractAddresses (src/services/config/ConfigServiceAWS.ts:3:5092)\n      at async Promise.all (index 0)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  11) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  12) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  13) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   83.03 |    44.56 |   86.85 |   83.48 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   87.75 |    47.33 |     100 |   87.41 |                   \n\n  EventProcessorService.ts             |   88.54 |    46.15 |     100 |   88.29 | ...95-100,145,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.37 |     48.7 |   78.37 |   88.05 |                   \n\n  EventFactory.ts                      |   88.28 |    50.46 |   68.18 |   93.27 | ...27,165,195-196 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      78 |    41.17 |   88.88 |   77.55 | ...41,75-79,89-93 \n\n ...src/onchain_events/leverage_events |   72.35 |    36.08 |   77.04 |   72.22 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   78.68 |     36.5 |   84.61 |   78.33 | ...,78-89,121-137 \n\n  ...inEventLeveragePositionExpired.ts |   78.33 |    36.06 |   84.61 |   77.96 | ...,77-87,118-133 \n\n  ...ventLeveragePositionLiquidated.ts |   79.68 |    38.46 |   84.61 |   79.36 | ...,80-91,125-142 \n\n  ...ainEventLeveragePositionOpened.ts |   81.42 |    39.43 |   85.71 |   81.15 | ...,81-92,137-156 \n\n ...8464/src/onchain_events/psp_events |   79.84 |     42.4 |   89.28 |   79.36 |                   \n\n  OnChainEventPSP.ts                   |   82.97 |    43.58 |      90 |    82.6 | 6,24,38-41,63-67  \n\n  OnChainEventPSPDeposit.ts            |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n\n  OnChainEventPSPWithdraw.ts           |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   90.45 |    47.19 |   94.23 |    91.1 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,129-133 \n\n  ConfigServiceAWS.ts                  |   95.14 |    50.44 |     100 |   95.09 | 6,24,38-41        \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":102},"start":{"column":9,"line":102}}},{"id":"87","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:14900) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:15 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:16 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (335ms)\n\n[2/23/2024 7:24:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:16 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:16 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (278ms)\n\n[2/23/2024 7:24:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:16 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:24:16 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (344ms)\n\n[2/23/2024 7:24:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:16 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:16 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (302ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:17 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:17 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (251ms)\n\n[2/23/2024 7:24:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:17 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:17 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (269ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (172ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (153ms)\n\n    ✔ should fetch RPC URL (146ms)\n\n    ✔ should fetch Alt RPC URL (155ms)\n\n    ✔ should fetch Events Fetch Page Size (174ms)\n\n    ✔ should fetch NewEventsQueueURL (174ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (281ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (343ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1208ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (472ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (818ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    1) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n  1 failing\n\n\n  1) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected 2 to equal 1\n      + expected - actual\n\n      -2\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.42 |    47.76 |   96.71 |   88.74 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   86.39 |    46.74 |     100 |   86.01 |                   \n  EventProcessorService.ts             |   86.45 |    45.38 |     100 |   86.17 | ...00,153-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |    84.9 |    50.64 |   86.48 |   86.56 |                   \n\n  EventFactory.ts                      |   85.15 |    52.77 |   77.27 |   88.23 | ...77-180,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":99},"start":{"column":58,"line":95}}},{"id":"86","mutatorName":"EqualityOperator","replacement":"result !== undefined","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:14843) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:24:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:15 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:15 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (434ms)\n\n[2/23/2024 7:24:15 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:15 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:15 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (286ms)\n\n[2/23/2024 7:24:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:16 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:24:16 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (302ms)\n\n[2/23/2024 7:24:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:16 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:16 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (336ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:16 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:16 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (299ms)\n\n[2/23/2024 7:24:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:17 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:17 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (164ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (170ms)\n\n    ✔ should fetch RPC URL (182ms)\n\n    ✔ should fetch Alt RPC URL (153ms)\n\n    ✔ should fetch Events Fetch Page Size (159ms)\n\n    ✔ should fetch NewEventsQueueURL (167ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (326ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (319ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1267ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (413ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (856ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    2) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected 2 to equal 1\n      + expected - actual\n\n      -2\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.42 |    47.84 |   96.71 |   88.74 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   86.39 |    46.74 |     100 |   86.01 |                   \n  EventProcessorService.ts             |   86.45 |    45.38 |     100 |   86.17 | ...00,153-157,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |    84.9 |    50.97 |   86.48 |   86.56 |                   \n\n  EventFactory.ts                      |   85.15 |    53.24 |   77.27 |   88.23 | ...77-180,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":95},"start":{"column":35,"line":95}}},{"id":"88","mutatorName":"StringLiteral","replacement":"``","status":"Survived","testsCompleted":1,"location":{"end":{"column":72,"line":96},"start":{"column":28,"line":96}}},{"id":"90","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","testsCompleted":1,"location":{"end":{"column":56,"line":102},"start":{"column":9,"line":102}}},{"id":"91","mutatorName":"MethodExpression","replacement":"results.some(result => result !== undefined)","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:15099) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:21 PM] Multiple events detected, but expecting just one: 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:24:22 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:22 PM] Multiple events detected, but expecting just one: 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:24:22 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:22 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:22 PM] Multiple events detected, but expecting just one: 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:24:22 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:22 PM] Multiple events detected, but expecting just one: 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:24:23 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:24:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:23 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:23 PM] Multiple events detected, but expecting just one: 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:24:23 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:24:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:23 PM] Multiple events detected, but expecting just one: 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:24:23 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (178ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (171ms)\n\n    ✔ should fetch RPC URL (246ms)\n\n    ✔ should fetch Alt RPC URL (151ms)\n\n    ✔ should fetch Events Fetch Page Size (174ms)\n\n    ✔ should fetch NewEventsQueueURL (155ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (263ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (316ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (960ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (326ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (672ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    11) should report on Deposit event\n\n    12) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  26 passing (9s)\n  12 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  11) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  12) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   82.76 |    44.16 |   87.79 |   83.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   87.75 |    47.33 |     100 |   87.41 |                   \n\n  EventProcessorService.ts             |   88.54 |    46.15 |     100 |   88.29 | ...95-100,145,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |    48.05 |   81.08 |   88.05 |                   \n\n  EventFactory.ts                      |   89.06 |    49.53 |   72.72 |   93.27 | ...27,165,195-196 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      78 |    41.17 |   88.88 |   77.55 | ...41,75-79,89-93 \n\n ...src/onchain_events/leverage_events |   72.35 |    36.08 |   77.04 |   72.22 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   78.68 |     36.5 |   84.61 |   78.33 | ...,78-89,121-137 \n\n  ...inEventLeveragePositionExpired.ts |   78.33 |    36.06 |   84.61 |   77.96 | ...,77-87,118-133 \n\n  ...ventLeveragePositionLiquidated.ts |   79.68 |    38.46 |   84.61 |   79.36 | ...,80-91,125-142 \n\n  ...ainEventLeveragePositionOpened.ts |   81.42 |    39.43 |   85.71 |   81.15 | ...,81-92,137-156 \n\n ...8464/src/onchain_events/psp_events |   79.84 |     42.4 |   89.28 |   79.36 |                   \n\n  OnChainEventPSP.ts                   |   82.97 |    43.58 |      90 |    82.6 | 6,24,38-41,63-67  \n\n  OnChainEventPSPDeposit.ts            |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n\n  OnChainEventPSPWithdraw.ts           |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":56,"line":102},"start":{"column":9,"line":102}}},{"id":"92","mutatorName":"ArrowFunction","replacement":"() => undefined","status":"Survived","testsCompleted":1,"location":{"end":{"column":55,"line":102},"start":{"column":23,"line":102}}},{"id":"93","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:15209) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:23 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:23 PM] Multiple events detected, but expecting just one: 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:24:23 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:24 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:24 PM] Multiple events detected, but expecting just one: 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:24:24 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:24 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:24 PM] Multiple events detected, but expecting just one: 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:24:24 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:24 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:24 PM] Multiple events detected, but expecting just one: 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:24:24 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:24:24 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:25 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:25 PM] Multiple events detected, but expecting just one: 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:24:25 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:24:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:25 PM] Multiple events detected, but expecting just one: 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:24:25 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (311ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (150ms)\n\n    ✔ should fetch RPC URL (148ms)\n\n    ✔ should fetch Alt RPC URL (164ms)\n\n    ✔ should fetch Events Fetch Page Size (155ms)\n\n    ✔ should fetch NewEventsQueueURL (168ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (251ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (378ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (876ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (307ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (664ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    11) should report on Deposit event\n\n    12) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  26 passing (9s)\n\n  12 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  11) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  12) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.58 |    48.24 |   97.18 |   89.85 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   89.62 |    52.27 |   89.18 |   91.04 |                   \n  EventFactory.ts                      |   92.96 |    55.09 |   81.81 |   95.79 | 6,24,39,127,165   \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":102},"start":{"column":35,"line":102}}},{"id":"96","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:15378) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:27 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:27 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (383ms)\n\n[2/23/2024 7:24:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:27 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:27 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (286ms)\n\n[2/23/2024 7:24:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:28 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:24:28 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (318ms)\n\n[2/23/2024 7:24:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:28 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:28 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (287ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:28 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:28 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:28 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:24:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:28 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:29 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (324ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (150ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (155ms)\n\n    ✔ should fetch RPC URL (144ms)\n\n    ✔ should fetch Alt RPC URL (165ms)\n\n    ✔ should fetch Events Fetch Page Size (165ms)\n\n    ✔ should fetch NewEventsQueueURL (159ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (270ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (323ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (910ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (561ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (758ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n\n  1 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.86 |    47.68 |   96.71 |    89.2 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":106},"start":{"column":58,"line":102}}},{"id":"94","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","testsCompleted":1,"location":{"end":{"column":55,"line":102},"start":{"column":35,"line":102}}},{"id":"95","mutatorName":"EqualityOperator","replacement":"result === undefined","status":"Survived","testsCompleted":1,"location":{"end":{"column":55,"line":102},"start":{"column":35,"line":102}}},{"id":"97","mutatorName":"StringLiteral","replacement":"``","status":"Survived","testsCompleted":1,"location":{"end":{"column":101,"line":103},"start":{"column":28,"line":103}}},{"id":"98","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:15490) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:33 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:33 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:33 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:33 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:34 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:34 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:24:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:34 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (214ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (187ms)\n\n    ✔ should fetch RPC URL (148ms)\n\n    ✔ should fetch Alt RPC URL (191ms)\n\n    ✔ should fetch Events Fetch Page Size (149ms)\n\n    ✔ should fetch NewEventsQueueURL (160ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (273ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (475ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (869ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (307ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (645ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    11) should report on Deposit event\n\n    12) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  26 passing (9s)\n  12 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n  11) PSP Events Logging\n       should report on Deposit event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:55:18)\n\n  12) PSP Events Logging\n       should report on Withdraw event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:88:18)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   82.76 |    44.64 |   88.26 |   83.02 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.37 |    49.67 |   83.78 |   87.06 |                   \n  EventFactory.ts                      |   88.28 |    51.85 |   77.27 |   91.59 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      78 |    41.17 |   88.88 |   77.55 | ...41,75-79,89-93 \n ...src/onchain_events/leverage_events |   72.35 |    36.08 |   77.04 |   72.22 |                   \n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n  ...ainEventLeveragePositionClosed.ts |   78.68 |     36.5 |   84.61 |   78.33 | ...,78-89,121-137 \n  ...inEventLeveragePositionExpired.ts |   78.33 |    36.06 |   84.61 |   77.96 | ...,77-87,118-133 \n\n  ...ventLeveragePositionLiquidated.ts |   79.68 |    38.46 |   84.61 |   79.36 | ...,80-91,125-142 \n  ...ainEventLeveragePositionOpened.ts |   81.42 |    39.43 |   85.71 |   81.15 | ...,81-92,137-156 \n ...8464/src/onchain_events/psp_events |   79.84 |     42.4 |   89.28 |   79.36 |                   \n\n  OnChainEventPSP.ts                   |   82.97 |    43.58 |      90 |    82.6 | 6,24,38-41,63-67  \n  OnChainEventPSPDeposit.ts            |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n  OnChainEventPSPWithdraw.ts           |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":108},"start":{"column":32,"line":108}}},{"id":"99","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:15546) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:33 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:34 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:34 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:34 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:34 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:34 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:35 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (268ms)\n\n[2/23/2024 7:24:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:35 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:35 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (323ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (152ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (187ms)\n\n    ✔ should fetch RPC URL (170ms)\n\n    ✔ should fetch Alt RPC URL (162ms)\n\n    ✔ should fetch Events Fetch Page Size (166ms)\n\n    ✔ should fetch NewEventsQueueURL (182ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (238ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (320ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (838ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (340ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (664ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (41ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    5) should report on PositionOpened event\n\n    6) should report on PositionClosed event\n\n    7) should report on PositionLiqiuidated event\n\n    8) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (9s)\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   84.02 |    45.36 |   90.14 |   84.31 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   86.79 |    50.97 |   86.48 |   88.55 |                   \n\n  EventFactory.ts                      |   88.28 |    53.24 |   77.27 |   91.59 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   72.35 |    36.08 |   77.04 |   72.22 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   78.68 |     36.5 |   84.61 |   78.33 | ...,78-89,121-137 \n\n  ...inEventLeveragePositionExpired.ts |   78.33 |    36.06 |   84.61 |   77.96 | ...,77-87,118-133 \n\n  ...ventLeveragePositionLiquidated.ts |   79.68 |    38.46 |   84.61 |   79.36 | ...,80-91,125-142 \n\n  ...ainEventLeveragePositionOpened.ts |   81.42 |    39.43 |   85.71 |   81.15 | ...,81-92,137-156 \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":108},"start":{"column":44,"line":108}}},{"id":"100","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:15600) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:34 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:34 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:35 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:35 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:35 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:35 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:24:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:35 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (176ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (158ms)\n\n    ✔ should fetch RPC URL (155ms)\n\n    ✔ should fetch Alt RPC URL (171ms)\n\n    ✔ should fetch Events Fetch Page Size (195ms)\n\n    ✔ should fetch NewEventsQueueURL (155ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (385ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (335ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (900ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (311ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (671ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    11) should report on Deposit event\n\n    12) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  26 passing (9s)\n  12 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n  11) PSP Events Logging\n       should report on Deposit event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:55:18)\n\n  12) PSP Events Logging\n       should report on Withdraw event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:88:18)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   84.02 |    45.44 |   90.14 |   84.31 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   86.79 |    51.29 |   86.48 |   88.55 |                   \n  EventFactory.ts                      |   88.28 |     53.7 |   77.27 |   91.59 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   72.35 |    36.08 |   77.04 |   72.22 |                   \n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n  ...ainEventLeveragePositionClosed.ts |   78.68 |     36.5 |   84.61 |   78.33 | ...,78-89,121-137 \n  ...inEventLeveragePositionExpired.ts |   78.33 |    36.06 |   84.61 |   77.96 | ...,77-87,118-133 \n  ...ventLeveragePositionLiquidated.ts |   79.68 |    38.46 |   84.61 |   79.36 | ...,80-91,125-142 \n  ...ainEventLeveragePositionOpened.ts |   81.42 |    39.43 |   85.71 |   81.15 | ...,81-92,137-156 \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":108},"start":{"column":44,"line":108}}},{"id":"101","mutatorName":"EqualityOperator","replacement":"result === undefined","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:15714) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:38 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:38 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:39 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:39 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:39 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:39 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:24:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:40 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (294ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (175ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (191ms)\n\n    ✔ should fetch RPC URL (154ms)\n\n    ✔ should fetch Alt RPC URL (172ms)\n\n    ✔ should fetch Events Fetch Page Size (188ms)\n\n    ✔ should fetch NewEventsQueueURL (180ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (251ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (339ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (996ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (409ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (721ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    6) should report on PositionOpened event\n\n    7) should report on PositionClosed event\n\n    8) should report on PositionLiqiuidated event\n\n    9) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    10) should report on Deposit event\n\n    11) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  27 passing (9s)\n  11 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:18)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  10) PSP Events Logging\n       should report on Deposit event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:55:18)\n\n  11) PSP Events Logging\n       should report on Withdraw event:\n     TypeError: Cannot read properties of undefined (reading 'getEventName')\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:88:18)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   82.76 |    44.72 |   88.26 |   83.02 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.37 |       50 |   83.78 |   87.06 |                   \n  EventFactory.ts                      |   88.28 |    52.31 |   77.27 |   91.59 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      78 |    41.17 |   88.88 |   77.55 | ...41,75-79,89-93 \n ...src/onchain_events/leverage_events |   72.35 |    36.08 |   77.04 |   72.22 |                   \n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n  ...ainEventLeveragePositionClosed.ts |   78.68 |     36.5 |   84.61 |   78.33 | ...,78-89,121-137 \n  ...inEventLeveragePositionExpired.ts |   78.33 |    36.06 |   84.61 |   77.96 | ...,77-87,118-133 \n  ...ventLeveragePositionLiquidated.ts |   79.68 |    38.46 |   84.61 |   79.36 | ...,80-91,125-142 \n  ...ainEventLeveragePositionOpened.ts |   81.42 |    39.43 |   85.71 |   81.15 | ...,81-92,137-156 \n ...8464/src/onchain_events/psp_events |   79.84 |     42.4 |   89.28 |   79.36 |                   \n  OnChainEventPSP.ts                   |   82.97 |    43.58 |      90 |    82.6 | 6,24,38-41,63-67  \n  OnChainEventPSPDeposit.ts            |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n  OnChainEventPSPWithdraw.ts           |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":64,"line":108},"start":{"column":44,"line":108}}},{"id":"102","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:15715) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:38 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:38 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (351ms)\n\n[2/23/2024 7:24:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:38 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:39 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (278ms)\n\n[2/23/2024 7:24:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:39 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:24:39 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (280ms)\n\n[2/23/2024 7:24:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:39 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:39 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (332ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:39 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:39 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:39 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:39 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:24:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:40 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:40 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (195ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (158ms)\n\n    ✔ should fetch RPC URL (143ms)\n\n    ✔ should fetch Alt RPC URL (210ms)\n\n    ✔ should fetch Events Fetch Page Size (155ms)\n\n    ✔ should fetch NewEventsQueueURL (191ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (244ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (384ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (963ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (333ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (762ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.13 |    48.16 |   96.71 |   89.48 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   87.26 |    51.62 |   86.48 |   89.05 |                   \n\n  EventFactory.ts                      |   89.06 |    54.16 |   77.27 |   92.43 | ...39,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":120},"start":{"column":83,"line":113}}},{"id":"103","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:15769) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:39 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:39 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (322ms)\n\n[2/23/2024 7:24:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:39 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:39 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (287ms)\n\n[2/23/2024 7:24:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:39 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:24:39 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (303ms)\n\n[2/23/2024 7:24:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:40 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:40 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (410ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:40 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:40 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:24:40 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:24:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:40 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:24:40 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (150ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (198ms)\n\n    ✔ should fetch RPC URL (183ms)\n\n    ✔ should fetch Alt RPC URL (191ms)\n\n    ✔ should fetch Events Fetch Page Size (166ms)\n\n    ✔ should fetch NewEventsQueueURL (223ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (214ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (366ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (981ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (325ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (685ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    3) should report on Deposit event\n\n    4) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n  4 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  4) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.13 |    48.24 |   96.71 |   89.48 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   87.26 |    51.94 |   86.48 |   89.05 |                   \n\n  EventFactory.ts                      |   89.06 |    54.62 |   77.27 |   92.43 | ...39,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":116},"start":{"column":9,"line":116}}},{"id":"104","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","testsCompleted":1,"location":{"end":{"column":26,"line":116},"start":{"column":9,"line":116}}},{"id":"105","mutatorName":"EqualityOperator","replacement":"res !== undefined","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:15881) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:43 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (296ms)\n\n[2/23/2024 7:24:43 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:43 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (287ms)\n\n[2/23/2024 7:24:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:43 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:24:44 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (299ms)\n\n[2/23/2024 7:24:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:44 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:44 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (327ms)\n\n\n  PSP Events\n\n[2/23/2024 7:24:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:44 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:44 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:24:44 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:24:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:45 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:24:45 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (428ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (207ms)\n\n    ✔ should fetch RPC URL (190ms)\n\n    ✔ should fetch Alt RPC URL (182ms)\n\n    ✔ should fetch Events Fetch Page Size (202ms)\n\n    ✔ should fetch NewEventsQueueURL (148ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (284ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (342ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (884ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (318ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (678ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    3) should report on Deposit event\n\n    4) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n  4 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  4) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   81.05 |    44.48 |   86.38 |   81.45 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   84.43 |    49.02 |   86.48 |   86.06 |                   \n\n  EventFactory.ts                      |   84.37 |    50.46 |   77.27 |   87.39 | ...24,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n\n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n\n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":116},"start":{"column":9,"line":116}}},{"id":"106","mutatorName":"BlockStatement","replacement":"{}","status":"Survived","testsCompleted":1,"location":{"end":{"column":6,"line":118},"start":{"column":28,"line":116}}},{"id":"107","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:15998) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:45 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (823ms)\n\n[2/23/2024 7:24:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:45 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (327ms)\n\n[2/23/2024 7:24:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:46 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:24:46 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (326ms)\n\n[2/23/2024 7:24:46 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:46 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:46 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (588ms)\n\n\n  PSP Events\n\n[2/23/2024 7:24:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:46 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:46 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:46 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (272ms)\n\n[2/23/2024 7:24:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:47 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:47 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (162ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (501ms)\n\n    ✔ should fetch RPC URL (169ms)\n\n    ✔ should fetch Alt RPC URL (172ms)\n\n    ✔ should fetch Events Fetch Page Size (153ms)\n\n    ✔ should fetch NewEventsQueueURL (159ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (233ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (469ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (763ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (348ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (710ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (10s)\n  1 failing\n\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.86 |    47.76 |   96.71 |    89.2 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |    50.32 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    52.31 |   77.27 |   89.91 | ...12,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":117},"start":{"column":14,"line":117}}},{"id":"108","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:16138) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:50 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:50 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (360ms)\n\n[2/23/2024 7:24:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:50 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:50 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (273ms)\n\n[2/23/2024 7:24:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:50 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:24:50 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (243ms)\n\n[2/23/2024 7:24:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:51 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (537ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:51 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:51 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:24:51 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:24:51 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:51 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:24:51 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (167ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (147ms)\n\n    ✔ should fetch RPC URL (172ms)\n\n    ✔ should fetch Alt RPC URL (163ms)\n\n    ✔ should fetch Events Fetch Page Size (146ms)\n\n    ✔ should fetch NewEventsQueueURL (163ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (227ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (342ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (774ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (342ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (655ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (66ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    3) should report on Deposit event\n\n    4) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n  4 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  4) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   80.87 |    44.56 |   86.38 |   81.27 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   83.49 |    49.35 |   86.48 |   85.07 |                   \n\n  EventFactory.ts                      |   82.81 |    50.92 |   77.27 |   85.71 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n\n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n\n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":16,"line":119},"start":{"column":12,"line":119}}},{"id":"110","mutatorName":"ConditionalExpression","replacement":"true","status":"Survived","testsCompleted":1,"location":{"end":{"column":82,"line":128},"start":{"column":9,"line":125}}},{"id":"109","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:16137) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:50 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:50 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (335ms)\n\n[2/23/2024 7:24:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:50 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:24:50 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (284ms)\n\n[2/23/2024 7:24:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:50 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:24:50 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (360ms)\n\n[2/23/2024 7:24:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:51 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (324ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:51 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:51 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:51 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:24:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:51 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:51 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (187ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (162ms)\n\n    ✔ should fetch RPC URL (378ms)\n\n    ✔ should fetch Alt RPC URL (147ms)\n\n    ✔ should fetch Events Fetch Page Size (186ms)\n\n    ✔ should fetch NewEventsQueueURL (226ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (252ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (338ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1214ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (344ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (733ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.13 |    48.16 |   96.71 |   89.48 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   87.26 |    51.94 |   86.48 |   89.05 |                   \n\n  EventFactory.ts                      |   89.06 |    54.62 |   77.27 |   92.43 | ...39,127,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":132},"start":{"column":88,"line":122}}},{"id":"111","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:16227) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:51 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:24:51 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:52 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:24:52 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:52 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:24:52 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:52 PM] Executing the event fetcher workflow...\n[2/23/2024 7:24:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:52 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:24:52 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:52 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:52 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:52 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (339ms)\n\n[2/23/2024 7:24:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:53 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:53 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (361ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (147ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (160ms)\n\n    ✔ should fetch RPC URL (147ms)\n\n    ✔ should fetch Alt RPC URL (141ms)\n\n    ✔ should fetch Events Fetch Page Size (140ms)\n\n    ✔ should fetch NewEventsQueueURL (172ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (228ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (386ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (639ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (263ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (696ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    5) should report on PositionOpened event\n\n    6) should report on PositionClosed event\n\n    7) should report on PositionLiqiuidated event\n\n    8) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (9s)\n  8 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   67.68 |    37.12 |    72.3 |   67.89 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   79.24 |     40.9 |   86.48 |   80.59 |                   \n\n  EventFactory.ts                      |   75.78 |    38.88 |   77.27 |   78.15 | ...86-192,223-227 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   87.55 |    45.69 |   94.23 |   88.13 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,100-104 \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":128},"start":{"column":9,"line":125}}},{"id":"112","mutatorName":"LogicalOperator","replacement":"(this.configService.getLeveragePositionOpenerAddress() === emitterAddress || this.configService.getLeveragePositionCloserAddress() === emitterAddress || this.configService.getLeveragePositionLiquidatorAddress() === emitterAddress) && this.configService.getLeveragePositionExpiratorAddress() === emitterAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:16282) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:54 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:24:54 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:54 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:24:54 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:55 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:24:55 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:55 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:24:55 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:55 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:55 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:55 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (305ms)\n\n[2/23/2024 7:24:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:56 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:56 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (297ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (225ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (159ms)\n\n    ✔ should fetch RPC URL (190ms)\n\n    ✔ should fetch Alt RPC URL (169ms)\n\n    ✔ should fetch Events Fetch Page Size (227ms)\n\n    ✔ should fetch NewEventsQueueURL (223ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (331ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (354ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (898ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (368ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (660ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    5) should report on PositionOpened event\n\n    6) should report on PositionClosed event\n\n    7) should report on PositionLiqiuidated event\n\n    8) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  30 passing (10s)\n  8 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   67.95 |    37.44 |   72.76 |   68.17 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   79.24 |    41.88 |   86.48 |   80.59 |                   \n\n  EventFactory.ts                      |   75.78 |    40.27 |   77.27 |   78.15 | ...86-192,223-227 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":128},"start":{"column":9,"line":125}}},{"id":"113","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:16341) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:55 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:24:55 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:55 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:24:55 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:56 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:24:56 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:56 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (311ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:56 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:56 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:56 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (300ms)\n\n[2/23/2024 7:24:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:57 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:57 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (351ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (221ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (196ms)\n\n    ✔ should fetch RPC URL (159ms)\n\n    ✔ should fetch Alt RPC URL (212ms)\n\n    ✔ should fetch Events Fetch Page Size (140ms)\n\n    ✔ should fetch NewEventsQueueURL (149ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (353ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (309ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (852ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (378ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (694ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    4) should report on PositionOpened event\n\n    5) should report on PositionClosed event\n\n    6) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (9s)\n  6 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n\n\n----------|---------|----------|---------|---------|-------------------\n\nFile      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n----------|---------|----------|---------|---------|-------------------\n\nAll files |       0 |        0 |       0 |       0 |                   \n----------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":127},"start":{"column":9,"line":125}}},{"id":"114","mutatorName":"LogicalOperator","replacement":"(this.configService.getLeveragePositionOpenerAddress() === emitterAddress || this.configService.getLeveragePositionCloserAddress() === emitterAddress) && this.configService.getLeveragePositionLiquidatorAddress() === emitterAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:16398) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:24:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:56 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:24:56 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:24:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:56 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:24:56 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:24:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:57 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:24:57 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:24:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:57 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (307ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:24:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:57 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:24:57 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:24:57 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (282ms)\n\n[2/23/2024 7:24:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:24:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:24:58 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:24:58 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (283ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (156ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (215ms)\n\n    ✔ should fetch RPC URL (149ms)\n\n    ✔ should fetch Alt RPC URL (202ms)\n\n    ✔ should fetch Events Fetch Page Size (156ms)\n\n    ✔ should fetch NewEventsQueueURL (167ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (278ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (353ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (764ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (889ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (706ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    4) should report on PositionOpened event\n\n    5) should report on PositionClosed event\n\n    6) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (10s)\n\n  6 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   74.77 |    40.72 |   80.75 |      75 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   82.54 |    45.77 |   86.48 |   84.07 |                   \n\n  EventFactory.ts                      |   81.25 |    45.83 |   77.27 |   84.03 | ...57,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   40.27 |    21.99 |   44.26 |   40.27 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":127},"start":{"column":9,"line":125}}},{"id":"116","mutatorName":"LogicalOperator","replacement":"this.configService.getLeveragePositionOpenerAddress() === emitterAddress && this.configService.getLeveragePositionCloserAddress() === emitterAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:16566) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:01 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:25:01 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:01 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:25:01 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:02 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (333ms)\n\n[2/23/2024 7:25:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:02 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (325ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:02 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:02 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:02 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (341ms)\n\n[2/23/2024 7:25:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:03 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:03 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (283ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (207ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (154ms)\n\n    ✔ should fetch RPC URL (156ms)\n\n    ✔ should fetch Alt RPC URL (198ms)\n\n    ✔ should fetch Events Fetch Page Size (522ms)\n\n    ✔ should fetch NewEventsQueueURL (193ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (265ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (347ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (964ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (352ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (808ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    3) should report on PositionOpened event\n\n    4) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  34 passing (10s)\n  4 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   79.44 |    43.36 |   85.91 |    79.7 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   83.96 |     48.7 |   86.48 |   85.57 |                   \n  EventFactory.ts                      |   83.59 |       50 |   77.27 |   86.55 | ...52,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   56.99 |    30.24 |   62.29 |   56.94 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":126},"start":{"column":9,"line":125}}},{"id":"115","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:16456) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:01 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:25:01 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:01 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:25:01 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:01 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (303ms)\n\n[2/23/2024 7:25:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:02 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (321ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:02 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:02 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:02 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Deposit event\n\n[2/23/2024 7:25:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:02 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:02 PM] Event fetcher workflow completed.\n\n    4) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (188ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (204ms)\n\n    ✔ should fetch RPC URL (177ms)\n\n    ✔ should fetch Alt RPC URL (141ms)\n\n    ✔ should fetch Events Fetch Page Size (163ms)\n\n    ✔ should fetch NewEventsQueueURL (177ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (324ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (332ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1111ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (481ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (811ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    5) should report on PositionOpened event\n\n    6) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    7) should report on Deposit event\n\n    8) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  30 passing (10s)\n  8 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n  7) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected 'LeveragedPositionLiquidated' to equal 'Deposit'\n      + expected - actual\n\n      -LeveragedPositionLiquidated\n      +Deposit\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:66:5)\n\n  8) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected 'LeveragedPositionExpired' to equal 'Withdraw'\n      + expected - actual\n\n      -LeveragedPositionExpired\n      +Withdraw\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   79.44 |    43.36 |   85.91 |    79.7 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   83.96 |     48.7 |   86.48 |   85.57 |                   \n  EventFactory.ts                      |   83.59 |       50 |   77.27 |   86.55 | ...52,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   56.99 |    30.24 |   62.29 |   56.94 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":126},"start":{"column":9,"line":125}}},{"id":"117","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:16565) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:01 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:25:01 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:02 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (534ms)\n\n[2/23/2024 7:25:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:02 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (382ms)\n\n[2/23/2024 7:25:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:02 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (331ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:03 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:03 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:03 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:25:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:03 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:03 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (304ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (164ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (187ms)\n\n    ✔ should fetch RPC URL (524ms)\n\n    ✔ should fetch Alt RPC URL (411ms)\n\n    ✔ should fetch Events Fetch Page Size (172ms)\n\n    ✔ should fetch NewEventsQueueURL (162ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (294ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (390ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (932ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (292ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (719ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    3) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  35 passing (10s)\n  3 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   83.84 |    45.92 |   91.07 |   84.13 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.37 |    51.62 |   86.48 |   87.06 |                   \n  EventFactory.ts                      |   85.93 |    54.16 |   77.27 |   89.07 | ...47,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   72.69 |    38.14 |   80.32 |   72.56 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":81,"line":125},"start":{"column":9,"line":125}}},{"id":"118","mutatorName":"EqualityOperator","replacement":"this.configService.getLeveragePositionOpenerAddress() !== emitterAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:16621) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:02 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:25:02 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:02 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (324ms)\n\n[2/23/2024 7:25:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:03 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:03 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (304ms)\n\n[2/23/2024 7:25:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:03 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:03 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (292ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:03 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:03 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:03 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:25:03 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:03 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:03 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (303ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (1242ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (283ms)\n\n    ✔ should fetch RPC URL (161ms)\n\n    ✔ should fetch Alt RPC URL (164ms)\n\n    ✔ should fetch Events Fetch Page Size (157ms)\n\n    ✔ should fetch NewEventsQueueURL (173ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (236ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (370ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1215ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (364ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (683ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    3) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (11s)\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   83.93 |    45.52 |   91.07 |   84.22 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...45-147,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   72.69 |    38.14 |   80.32 |   72.56 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":81,"line":125},"start":{"column":9,"line":125}}},{"id":"121","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:16790) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:08 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (376ms)\n\n[2/23/2024 7:25:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:08 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (256ms)\n\n[2/23/2024 7:25:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:08 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:25:08 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:08 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (325ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:09 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:09 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:09 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (269ms)\n\n[2/23/2024 7:25:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:09 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:09 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (320ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (163ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (153ms)\n\n    ✔ should fetch RPC URL (169ms)\n\n    ✔ should fetch Alt RPC URL (154ms)\n\n    ✔ should fetch Events Fetch Page Size (183ms)\n\n    ✔ should fetch NewEventsQueueURL (144ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async initalizeObjectUnderTest (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n    2) \"before each\" hook for \"should get the correct PSP contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1430ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (493ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (824ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (85ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    3) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (7s)\n  3 failing\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       \"before each\" hook for \"should get the correct PSP contract addresses from AWS\":\n     Error: Error fetching configuration for LeverageContractInfo: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async ConfigServiceAWS.fetchLeverageContractInfo (src/services/config/ConfigServiceAWS.ts:3:5924)\n      at async ConfigServiceAWS.refreshLeverageContractAddresses (src/services/config/ConfigServiceAWS.ts:3:5092)\n      at async Promise.all (index 0)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   84.73 |    46.08 |   91.07 |   85.05 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.37 |    50.32 |   86.48 |   87.06 |                   \n  EventFactory.ts                      |   85.93 |    52.31 |   77.27 |   89.07 | ...57,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   74.74 |    39.17 |   81.96 |   74.65 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   90.45 |    47.19 |   94.23 |    91.1 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,129-133 \n\n  ConfigServiceAWS.ts                  |   95.14 |    50.44 |     100 |   95.09 | 6,24,38-41        \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":127},"start":{"column":7,"line":127}}},{"id":"119","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:16680) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:05 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:05 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (320ms)\n\n[2/23/2024 7:25:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:06 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:25:06 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:06 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:06 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (302ms)\n\n[2/23/2024 7:25:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:06 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:06 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (273ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:07 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:07 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:07 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (297ms)\n\n[2/23/2024 7:25:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:07 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:07 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (286ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (142ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (178ms)\n\n    ✔ should fetch RPC URL (170ms)\n\n    ✔ should fetch Alt RPC URL (171ms)\n\n    ✔ should fetch Events Fetch Page Size (153ms)\n\n    ✔ should fetch NewEventsQueueURL (148ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (334ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (337ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (607ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (298ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (827ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (50ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    3) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (9s)\n\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected 'Withdraw' to equal 'LeveragedPositionOpened'\n      + expected - actual\n\n      -Withdraw\n      +LeveragedPositionOpened\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.67 |     48.4 |   96.71 |   90.03 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   86.79 |    51.62 |   86.48 |   88.55 |                   \n\n  EventFactory.ts                      |   88.28 |    54.16 |   77.27 |   91.59 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |    91.7 |    47.56 |   96.15 |   92.37 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   95.14 |    50.44 |     100 |   95.09 | 6,24,38-41        \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":126},"start":{"column":7,"line":126}}},{"id":"120","mutatorName":"EqualityOperator","replacement":"this.configService.getLeveragePositionCloserAddress() !== emitterAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:16735) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:06 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:06 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (374ms)\n\n[2/23/2024 7:25:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:06 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:25:06 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:07 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (280ms)\n\n[2/23/2024 7:25:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:07 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (278ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:07 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:07 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:07 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (318ms)\n\n[2/23/2024 7:25:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:08 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:08 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (177ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (209ms)\n\n    ✔ should fetch RPC URL (188ms)\n\n    ✔ should fetch Alt RPC URL (188ms)\n\n    ✔ should fetch Events Fetch Page Size (233ms)\n\n    ✔ should fetch NewEventsQueueURL (164ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (266ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (523ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (709ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (265ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (767ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (58ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    3) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (9s)\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.76 |    48.48 |   96.71 |   90.12 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   87.26 |    51.94 |   86.48 |   89.05 |                   \n\n  EventFactory.ts                      |   89.06 |    54.62 |   77.27 |   92.43 | ...39,127,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |    91.7 |    47.56 |   96.15 |   92.37 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   95.14 |    50.44 |     100 |   95.09 | 6,24,38-41        \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":79,"line":126},"start":{"column":7,"line":126}}},{"id":"123","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:16902) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:13 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:13 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (381ms)\n\n[2/23/2024 7:25:13 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:13 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:13 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (287ms)\n\n[2/23/2024 7:25:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:13 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:13 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (280ms)\n\n[2/23/2024 7:25:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:14 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:25:14 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:14 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:14 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:14 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:14 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:25:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:14 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:14 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (172ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (150ms)\n\n    ✔ should fetch RPC URL (156ms)\n\n    ✔ should fetch Alt RPC URL (150ms)\n\n    ✔ should fetch Events Fetch Page Size (156ms)\n\n    ✔ should fetch NewEventsQueueURL (135ms)\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (277ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (370ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async initalizeObjectUnderTest (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n    4) \"before each\" hook for \"should retrieve event queue URL from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (804ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (470ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (641ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    5) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  33 passing (8s)\n  5 failing\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Config Service Test\n       \"before each\" hook for \"should retrieve event queue URL from AWS\":\n     Error: Error fetching configuration for LeverageContractInfo: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async ConfigServiceAWS.fetchLeverageContractInfo (src/services/config/ConfigServiceAWS.ts:3:5924)\n      at async ConfigServiceAWS.refreshLeverageContractAddresses (src/services/config/ConfigServiceAWS.ts:3:5092)\n      at async Promise.all (index 0)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   85.09 |    46.24 |   91.07 |   85.42 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.37 |    50.32 |   86.48 |   87.06 |                   \n\n  EventFactory.ts                      |   85.93 |    52.31 |   77.27 |   89.07 | ...60-165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |    76.1 |    39.86 |   81.96 |   76.04 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   90.45 |    47.19 |   94.23 |    91.1 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,100-104 \n\n  ConfigServiceAWS.ts                  |   95.14 |    50.44 |     100 |   95.09 | 6,24,38-41        \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":128},"start":{"column":7,"line":128}}},{"id":"122","mutatorName":"EqualityOperator","replacement":"this.configService.getLeveragePositionLiquidatorAddress() !== emitterAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:16903) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:13 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:13 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (524ms)\n\n[2/23/2024 7:25:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:13 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:13 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (331ms)\n\n[2/23/2024 7:25:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:14 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:25:14 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:14 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:14 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (281ms)\n\n\n  PSP Events\n\n[2/23/2024 7:25:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:14 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:14 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:14 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:25:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:15 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:15 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (276ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (187ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (142ms)\n\n    ✔ should fetch RPC URL (135ms)\n\n    ✔ should fetch Alt RPC URL (158ms)\n\n    ✔ should fetch Events Fetch Page Size (137ms)\n\n    ✔ should fetch NewEventsQueueURL (171ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (257ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (347ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (930ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (280ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (655ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    3) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (9s)\n\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   84.47 |    45.76 |   91.54 |   84.77 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...55-157,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   74.74 |    39.17 |   81.96 |   74.65 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":83,"line":127},"start":{"column":7,"line":127}}},{"id":"124","mutatorName":"EqualityOperator","replacement":"this.configService.getLeveragePositionExpiratorAddress() !== emitterAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:16957) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:14 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:14 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (444ms)\n\n[2/23/2024 7:25:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:14 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:14 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (290ms)\n\n[2/23/2024 7:25:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:14 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:14 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (363ms)\n\n[2/23/2024 7:25:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:15 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:25:15 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:15 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:15 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:15 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:15 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (296ms)\n\n[2/23/2024 7:25:15 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:15 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:15 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (260ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (170ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (151ms)\n\n    ✔ should fetch RPC URL (154ms)\n\n    ✔ should fetch Alt RPC URL (152ms)\n\n    ✔ should fetch Events Fetch Page Size (161ms)\n\n    ✔ should fetch NewEventsQueueURL (166ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (285ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (379ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (788ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (311ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (674ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    2) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n----------|---------|----------|---------|---------|-------------------\n\nFile      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n----------|---------|----------|---------|---------|-------------------\n\nAll files |       0 |        0 |       0 |       0 |                   \n\n----------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":128},"start":{"column":7,"line":128}}},{"id":"125","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:17012) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:25:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:15 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:25:15 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:15 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:25:15 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:15 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:25:15 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:16 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:16 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:25:16 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:25:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:16 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:16 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:16 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (308ms)\n\n[2/23/2024 7:25:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:16 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:16 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (168ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (168ms)\n\n    ✔ should fetch RPC URL (202ms)\n\n    ✔ should fetch Alt RPC URL (188ms)\n\n    ✔ should fetch Events Fetch Page Size (149ms)\n\n    ✔ should fetch NewEventsQueueURL (205ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (253ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (445ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (868ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (303ms)\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (748ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (41ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    6) should report on PositionOpened event\n\n    7) should report on PositionClosed event\n\n    8) should report on PositionLiqiuidated event\n\n    9) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  29 passing (9s)\n  9 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   68.04 |    38.88 |   72.76 |   68.26 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   79.71 |    47.72 |   86.48 |   81.09 |                   \n\n  EventFactory.ts                      |   76.56 |    48.61 |   77.27 |   78.99 | ...86-192,226-227 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":130},"start":{"column":84,"line":128}}},{"id":"127","mutatorName":"BooleanLiteral","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:17128) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:16 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:16 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (355ms)\n\n[2/23/2024 7:25:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:16 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:17 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (256ms)\n\n[2/23/2024 7:25:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:17 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:17 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (317ms)\n\n[2/23/2024 7:25:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:17 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:17 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (291ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:17 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:17 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:17 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (309ms)\n\n[2/23/2024 7:25:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:18 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:18 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (284ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (159ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (177ms)\n\n    ✔ should fetch RPC URL (154ms)\n\n    ✔ should fetch Alt RPC URL (155ms)\n\n    ✔ should fetch Events Fetch Page Size (183ms)\n\n    ✔ should fetch NewEventsQueueURL (161ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (371ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (348ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1002ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (331ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (842ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    1) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  37 passing (9s)\n\n  1 failing\n\n\n  1) PSP Events Logging\n       should report on Withdraw event:\n     AssertionError: expected undefined to equal 'Withdraw'\n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.86 |    47.76 |   96.71 |    89.2 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |    50.32 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    52.31 |   77.27 |   89.91 | ...36-140,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":131},"start":{"column":12,"line":131}}},{"id":"126","mutatorName":"BooleanLiteral","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:17127) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:16 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:25:16 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:16 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:25:17 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:17 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:25:17 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:17 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:25:17 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:17 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:17 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:18 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (315ms)\n\n[2/23/2024 7:25:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:18 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:18 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (262ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (182ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (147ms)\n\n    ✔ should fetch RPC URL (155ms)\n\n    ✔ should fetch Alt RPC URL (146ms)\n\n    ✔ should fetch Events Fetch Page Size (172ms)\n\n    ✔ should fetch NewEventsQueueURL (168ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (275ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (346ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1053ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (484ms)\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (838ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    5) should report on PositionOpened event\n\n    6) should report on PositionClosed event\n\n    7) should report on PositionLiqiuidated event\n\n    8) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  30 passing (10s)\n  8 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.13 |    48.08 |   96.71 |   89.48 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   87.26 |    51.62 |   86.48 |   89.05 |                   \n  EventFactory.ts                      |   89.06 |    54.16 |   77.27 |   92.43 | ...39,127,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":18,"line":129},"start":{"column":14,"line":129}}}],"source":"import {ethers} from 'ethers';\nimport {ConfigService} from '../services/config/ConfigService';\nimport {Logger, SQSService} from '@thisisarchimedes/backend-sdk';\n\nimport {OnChainEvent} from './OnChainEvent';\nimport {OnChainEventPSPDeposit} from './psp_events/OnChainEventPSPDeposit';\nimport {OnChainEventPSPWithdraw} from './psp_events/OnChainEventPSPWithdraw';\nimport {OnChainEventLeveragePositionOpened} from './leverage_events/OnChainEventLeveragePositionOpened';\nimport {OnChainEventLeveragePositionClosed} from './leverage_events/OnChainEventLeveragePositionClosed';\nimport {OnChainEventLeveragePositionLiquidated} from './leverage_events/OnChainEventLeveragePositionLiquidated';\nimport {OnChainEventLeveragePositionExpired} from './leverage_events/OnChainEventLeveragePositionExpired';\n\nimport {\n  TOPIC_EVENT_LEVERAGE_POSITION_CLOSED,\n  TOPIC_EVENT_LEVERAGE_POSITION_EXPIRED,\n  TOPIC_EVENT_LEVERAGE_POSITION_LIQUIDATED,\n  TOPIC_EVENT_LEVERAGE_POSITION_OPENED,\n  TOPIC_EVENT_PSP_DEPOSIT,\n  TOPIC_EVENT_PSP_WITHDRAW,\n} from './EventTopic';\n\nexport class EventFactoryUnknownEventError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'EventFactoryUnknownEventError';\n  }\n}\n\nexport class EventFactory {\n  private configService: ConfigService;\n  private logger: Logger;\n  private sqsService: SQSService;\n\n  constructor(configService: ConfigService, logger: Logger, sqsService: SQSService) {\n    this.configService = configService;\n    this.logger = logger;\n    this.sqsService = sqsService;\n  }\n\n  public async createEvent(eventLog: ethers.providers.Log): Promise<"+"OnChainEvent> {\n    if (eventLog === undefined) {\n      throw new EventFactoryUnknownEventError('Event log has no topics');\n    }\n\n    const results = await Promise.all([\n      this.createPSPEvent(eventLog),\n      this.createLeverageEvent(eventLog),\n    ]);\n\n    const event = this.getEventObjectOrThrowError(results, eventLog);\n\n    return event;\n  }\n\n  private createPSPEvent(eventLog: ethers.providers.Log): OnChainEvent | undefined {\n    if (this.isLogEventEmittedByPSPContract(eventLog) === false) {\n      return undefined;\n    }\n\n    switch (eventLog.topics[0]) {\n      case TOPIC_EVENT_PSP_DEPOSIT:\n        return new OnChainEventPSPDeposit(eventLog, this.logger, this.sqsService, this.configService);\n\n      case TOPIC_EVENT_PSP_WITHDRAW:\n        return new OnChainEventPSPWithdraw(eventLog, this.logger, this.sqsService, this.configService);\n    }\n\n    return undefined;\n  }\n\n  private createLeverageEvent(eventLog: ethers.providers.Log): OnChainEvent | undefined {\n    if (this.isLogEventEmittedByLeverageContract(eventLog) === false) {\n      return undefined;\n    }\n\n    switch (eventLog.topics[0]) {\n      case TOPIC_EVENT_LEVERAGE_POSITION_OPENED:\n        return new OnChainEventLeveragePositionOpened(eventLog, this.logger, this.sqsService, this.configService);\n\n      case TOPIC_EVENT_LEVERAGE_POSITION_CLOSED:\n        return new OnChainEventLeveragePositionClosed(eventLog, this.logger, this.sqsService, this.configService);\n\n      case TOPIC_EVENT_LEVERAGE_POSITION_LIQUIDATED:\n        return new OnChainEventLeveragePositionLiquidated(eventLog, this.logger, this.sqsService, this.configService);\n\n      case TOPIC_EVENT_LEVERAGE_POSITION_EXPIRED:\n        return new OnChainEventLeveragePositionExpired(eventLog, this.logger, this.sqsService, this.configService);\n    }\n\n    return undefined;\n  }\n\n  private getEventObjectOrThrowError(results: [OnChainEvent | undefined, OnChainEvent | undefined],\n      eventLog: ethers.providers.Log): OnChainEvent {\n    if (results.every((result) => result === undefined)) {\n      const errorMessage = `Unknown event topic, ${eventLog.topics[0]}`;\n      this.logger.error(errorMessage);\n      throw new EventFactoryUnknownEventError(errorMessage);\n    }\n\n    // this should NOT happen\n    if (results.every((result) => result !== undefined)) {\n      const errorMessage = `Multiple events detected, but expecting just one: ${eventLog.topics[0]}`;\n      this.logger.error(errorMessage);\n      throw new EventFactoryUnknownEventError(errorMessage);\n    }\n\n    const event = results.find((result) => result !== undefined);\n\n    return event as unknown as OnChainEvent;\n  }\n\n  private isLogEventEmittedByPSPContract(eventLog: ethers.providers.Log): boolean {\n    const res = this.configService.getPSPStrategyInfoByAddress(eventLog.address);\n\n    if (res === undefined) {\n      return false;\n    }\n    return true;\n  }\n\n  private isLogEventEmittedByLeverageContract(eventLog: ethers.providers.Log): boolean {\n    const emitterAddress = eventLog.address;\n\n    if (this.configService.getLeveragePositionOpenerAddress() === emitterAddress ||\n      this.configService.getLeveragePositionCloserAddress() === emitterAddress ||\n      this.configService.getLeveragePositionLiquidatorAddress() === emitterAddress ||\n      this.configService.getLeveragePositionExpiratorAddress() === emitterAddress) {\n      return true;\n    }\n    return false;\n  }\n}\n"},"src/onchain_events/EventTopic.ts":{"language":"typescript","mutants":[{"id":"128","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:17186) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:17 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:17 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:17 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:18 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:18 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:25:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:18 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (162ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (169ms)\n\n    ✔ should fetch RPC URL (185ms)\n\n    ✔ should fetch Alt RPC URL (162ms)\n\n    ✔ should fetch Events Fetch Page Size (177ms)\n\n    ✔ should fetch NewEventsQueueURL (232ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (279ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (364ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (756ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (383ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (730ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    7) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  31 passing (9s)\n  7 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.76 |    48.64 |   96.71 |   90.12 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   91.15 |    49.11 |     100 |    90.9 |                   \n\n  EventProcessorService.ts             |   93.75 |    48.46 |     100 |   93.61 | 6,24,38-41,183    \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   88.67 |    52.92 |   86.48 |   90.54 |                   \n\n  EventFactory.ts                      |   89.84 |    54.16 |   77.27 |   93.27 | 6,24,39,186-192   \n\n  EventTopic.ts                        |   91.17 |    58.53 |     100 |    90.9 | 7,25,40           \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":108,"line":2},"start":{"column":40,"line":2}}},{"id":"129","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:17243) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:23 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:23 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:24 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:24 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:24 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:24 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:24 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:24 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:25:24 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:24 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (186ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (181ms)\n\n    ✔ should fetch RPC URL (157ms)\n\n    ✔ should fetch Alt RPC URL (152ms)\n\n    ✔ should fetch Events Fetch Page Size (146ms)\n\n    ✔ should fetch NewEventsQueueURL (168ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (293ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (388ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1112ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (336ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (661ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    7) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  31 passing (9s)\n\n  7 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   85.18 |    46.16 |   92.95 |   85.51 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   78.23 |    43.19 |   94.44 |   77.62 |                   \n\n  EventProcessorService.ts             |   73.95 |    40.76 |    90.9 |    73.4 | ...92,124-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |    50.32 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   85.15 |    50.92 |   77.27 |   88.23 | ...24,165,186-192 \n\n  EventTopic.ts                        |   91.17 |    56.09 |     100 |    90.9 | 7,25,40           \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   68.21 |       36 |      75 |   68.25 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":109,"line":3},"start":{"column":41,"line":3}}},{"id":"130","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:17298) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:24 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:24 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:24 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:24 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:24 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:24 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:25 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:25 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:25 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:25:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:25 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (162ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (147ms)\n\n    ✔ should fetch RPC URL (179ms)\n\n    ✔ should fetch Alt RPC URL (159ms)\n\n    ✔ should fetch Events Fetch Page Size (163ms)\n\n    ✔ should fetch NewEventsQueueURL (174ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (234ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (418ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (870ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (407ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    7) should have the expected topic[0] for PositionOpened event\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    8) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (9s)\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Validating Topic hash calculation for leverage events\n       should have the expected topic[0] for PositionOpened event:\n\n      AssertionError: expected '0x80feb7c33cd39a42e347b6b7577a63af2c7…' to equal ''\n      + expected - actual\n\n      -0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n      \n      at Context.<"+"anonymous> (test/interface/LogEventTopics.test.ts:41:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.88 |    47.52 |   96.24 |   88.19 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   78.23 |    43.19 |   94.44 |   77.62 |                   \n\n  EventProcessorService.ts             |   73.95 |    40.76 |    90.9 |    73.4 | ...92,124-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   87.73 |    51.62 |   86.48 |   89.55 |                   \n\n  EventFactory.ts                      |   88.28 |    51.85 |   77.27 |   91.59 | ...,38-41,186-192 \n\n  EventTopic.ts                        |   91.17 |    60.97 |     100 |    90.9 | 7,25,40           \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":121,"line":5},"start":{"column":53,"line":5}}},{"id":"131","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:17353) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:25 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:25 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:25 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:25 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:26 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:26 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:25:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:26 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:26 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (184ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (148ms)\n\n    ✔ should fetch RPC URL (212ms)\n\n    ✔ should fetch Alt RPC URL (181ms)\n\n    ✔ should fetch Events Fetch Page Size (157ms)\n\n    ✔ should fetch NewEventsQueueURL (139ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (251ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (365ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (785ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (305ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (669ms)\n\n    7) should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (8s)\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Validating Topic hash calculation for leverage events\n       should have the expected topic[0] for PositionClosed event:\n\n      AssertionError: expected '0x3120c845c5d2c39308641201562a412527c…' to equal ''\n      + expected - actual\n\n      -0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n      \n      at Context.<"+"anonymous> (test/interface/LogEventTopics.test.ts:55:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   83.39 |    45.36 |   91.07 |   83.67 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   78.23 |    43.19 |   94.44 |   77.62 |                   \n\n  EventProcessorService.ts             |   73.95 |    40.76 |    90.9 |    73.4 | ...92,124-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |    50.32 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   85.15 |    50.92 |   77.27 |   88.23 | ...50-152,186-192 \n\n  EventTopic.ts                        |   91.17 |    56.09 |     100 |    90.9 | 7,25,40           \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   75.76 |    39.51 |   81.96 |   75.69 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":121,"line":6},"start":{"column":53,"line":6}}},{"id":"132","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:17412) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:26 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:26 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:26 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:26 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:27 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:27 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:25:27 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:27 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:25:27 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:27 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '',\n    '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78'\n  ]\n}\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (158ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (178ms)\n\n    ✔ should fetch RPC URL (145ms)\n\n    ✔ should fetch Alt RPC URL (182ms)\n\n    ✔ should fetch Events Fetch Page Size (155ms)\n\n    ✔ should fetch NewEventsQueueURL (203ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (307ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (353ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (970ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (345ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (742ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    7) should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    8) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (9s)\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Validating Topic hash calculation for leverage events\n       should have the expected topic[0] for PositionLiquidated event:\n\n      AssertionError: expected '0x5564304997c5a4b15399de434a73fbc4339…' to equal ''\n      + expected - actual\n\n      -0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n      \n      at Context.<"+"anonymous> (test/interface/LogEventTopics.test.ts:70:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   83.12 |    45.28 |   91.07 |   83.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   78.23 |    43.19 |   94.44 |   77.62 |                   \n  EventProcessorService.ts             |   73.95 |    40.76 |    90.9 |    73.4 | ...92,124-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |    50.32 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   85.15 |    50.92 |   77.27 |   88.23 | ...55-157,186-192 \n\n  EventTopic.ts                        |   91.17 |    56.09 |     100 |    90.9 | 7,25,40           \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   74.74 |    39.17 |   81.96 |   74.65 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":125,"line":7},"start":{"column":57,"line":7}}},{"id":"133","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:17491) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:27 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    ''\n  ]\n}\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:28 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    ''\n  ]\n}\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:28 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    ''\n  ]\n}\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:28 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    ''\n  ]\n}\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:28 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    ''\n  ]\n}\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:25:29 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:29 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:29 PM] Error in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: invalid hash (argument=\"value\", value=\"\", code=INVALID_ARGUMENT, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at Logger.throwArgumentError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:285:21)\n    at Formatter.hex (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:220:23)\n    at Formatter.hash (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:268:29)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:432:25)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:42\n    at Array.map (<"+"anonymous>)\n    at Formatter.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:429:26)\n    at Object.topics (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/formatter.ts:465:20) {\n  reason: 'invalid hash',\n  code: 'INVALID_ARGUMENT',\n  argument: 'value',\n  value: '',\n  checkKey: 'topics',\n  checkValue: [\n    '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7',\n    '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db',\n    '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd',\n    '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067',\n    '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2',\n    ''\n  ]\n}\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (183ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (167ms)\n\n    ✔ should fetch RPC URL (189ms)\n\n    ✔ should fetch Alt RPC URL (177ms)\n\n    ✔ should fetch Events Fetch Page Size (202ms)\n\n    ✔ should fetch NewEventsQueueURL (218ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (235ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (338ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (782ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (265ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (683ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    7) should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    8) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  30 passing (8s)\n  8 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Validating Topic hash calculation for leverage events\n       should have the expected topic[0] for PositionExpired event:\n\n      AssertionError: expected '0x412514176d888af8c5fdb2ccf226830116c…' to equal ''\n      + expected - actual\n\n      -0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n      \n      at Context.<"+"anonymous> (test/interface/LogEventTopics.test.ts:83:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   83.48 |    45.44 |   91.07 |   83.76 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   78.23 |    43.19 |   94.44 |   77.62 |                   \n\n  EventProcessorService.ts             |   73.95 |    40.76 |    90.9 |    73.4 | ...92,124-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |    50.32 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   85.15 |    50.92 |   77.27 |   88.23 | ...60-162,186-192 \n\n  EventTopic.ts                        |   91.17 |    56.09 |     100 |    90.9 | 7,25,40           \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |    76.1 |    39.86 |   81.96 |   76.04 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":122,"line":8},"start":{"column":54,"line":8}}},{"id":"134","mutatorName":"ArrayDeclaration","replacement":"[]","status":"Survived","testsCompleted":1,"location":{"end":{"column":235,"line":10},"start":{"column":27,"line":10}}}],"source":"/* eslint-disable max-len */\nexport const TOPIC_EVENT_PSP_DEPOSIT = '0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7';\nexport const TOPIC_EVENT_PSP_WITHDRAW = '0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db';\n\nexport const TOPIC_EVENT_LEVERAGE_POSITION_OPENED = '0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd';\nexport const TOPIC_EVENT_LEVERAGE_POSITION_CLOSED = '0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067';\nexport const TOPIC_EVENT_LEVERAGE_POSITION_LIQUIDATED = '0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2';\nexport const TOPIC_EVENT_LEVERAGE_POSITION_EXPIRED = '0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78';\n\nexport const ALL_TOPICS = [TOPIC_EVENT_PSP_DEPOSIT, TOPIC_EVENT_PSP_WITHDRAW, TOPIC_EVENT_LEVERAGE_POSITION_OPENED, TOPIC_EVENT_LEVERAGE_POSITION_CLOSED, TOPIC_EVENT_LEVERAGE_POSITION_LIQUIDATED, TOPIC_EVENT_LEVERAGE_POSITION_EXPIRED];\n"},"src/onchain_events/OnChainEvent.ts":{"language":"typescript","mutants":[{"id":"135","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":35,"line":7},"start":{"column":33,"line":7}}},{"id":"136","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:17634) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:34 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:34 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (327ms)\n\n[2/23/2024 7:25:34 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:34 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:34 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (334ms)\n\n[2/23/2024 7:25:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:34 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:35 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (272ms)\n\n[2/23/2024 7:25:35 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:35 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:35 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (354ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:35 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:35 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:35 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:25:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:35 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:36 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (153ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (153ms)\n\n    ✔ should fetch RPC URL (148ms)\n\n    ✔ should fetch Alt RPC URL (146ms)\n\n    ✔ should fetch Events Fetch Page Size (179ms)\n\n    ✔ should fetch NewEventsQueueURL (140ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (259ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (366ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (783ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (648ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (672ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   86.79 |    50.97 |   86.48 |   88.55 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      88 |    49.01 |     100 |   87.75 | 6,24,39,89-93     \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":8},"start":{"column":35,"line":8}}},{"id":"137","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":32,"line":9},"start":{"column":30,"line":9}}},{"id":"138","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:17747) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:25:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:35 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:36 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:36 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:36 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:36 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:36 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:36 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:36 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:37 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:25:37 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:37 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:37 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (171ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (150ms)\n\n    ✔ should fetch RPC URL (140ms)\n\n    ✔ should fetch Alt RPC URL (141ms)\n\n    ✔ should fetch Events Fetch Page Size (175ms)\n\n    ✔ should fetch NewEventsQueueURL (174ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (269ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (401ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (977ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (371ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (664ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    11) should report on Deposit event\n\n    12) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  26 passing (9s)\n  12 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     TypeError: Cannot read properties of undefined (reading 'info')\n      at OnChainEventLeveragePositionClosed.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionClosed.ts:3:4497)\n      at OnChainEventLeveragePositionClosed.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     TypeError: Cannot read properties of undefined (reading 'info')\n      at OnChainEventLeveragePositionExpired.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionExpired.ts:3:4458)\n      at OnChainEventLeveragePositionExpired.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n  11) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  12) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   82.67 |     44.4 |   90.61 |   82.84 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   83.01 |    49.67 |   86.48 |   84.57 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      72 |    41.17 |     100 |   71.42 | ...39,65-70,88-96 \n\n ...src/onchain_events/leverage_events |    74.4 |    35.73 |    83.6 |   73.95 |                   \n\n  OnChainEventLeverage.ts              |   71.05 |    41.93 |    87.5 |   70.27 | 6,24,38-41,58-70  \n\n  ...ainEventLeveragePositionClosed.ts |   85.24 |    41.26 |    92.3 |      85 | ...,38-41,121-137 \n\n  ...inEventLeveragePositionExpired.ts |      85 |    40.98 |    92.3 |   84.74 | ...,38-41,118-133 \n\n  ...ventLeveragePositionLiquidated.ts |   67.18 |    29.23 |   76.92 |   66.66 | ...,75-91,114-142 \n\n  ...ainEventLeveragePositionOpened.ts |   64.28 |    29.57 |   71.42 |   63.76 | ...76-100,125-156 \n\n ...8464/src/onchain_events/psp_events |   78.29 |     40.8 |   89.28 |   77.77 |                   \n\n  OnChainEventPSP.ts                   |   82.97 |    43.58 |      90 |    82.6 | 6,24,38-41,63-67  \n\n  OnChainEventPSPDeposit.ts            |    75.6 |    39.53 |   88.88 |      75 | 6,24,38-41,61-75  \n\n  OnChainEventPSPWithdraw.ts           |    75.6 |    39.53 |   88.88 |      75 | 6,24,38-41,61-75  \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":24},"start":{"column":120,"line":17}}},{"id":"139","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:17804) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:37 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:37 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:37 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:37 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (363ms)\n\n[2/23/2024 7:25:37 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:37 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:37 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:37 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (264ms)\n\n[2/23/2024 7:25:38 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:38 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:38 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (284ms)\n\n[2/23/2024 7:25:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:38 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:38 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (286ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:38 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:38 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:38 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (293ms)\n\n[2/23/2024 7:25:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:39 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:39 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (337ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (190ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (149ms)\n\n    ✔ should fetch RPC URL (162ms)\n\n    ✔ should fetch Alt RPC URL (199ms)\n\n    ✔ should fetch Events Fetch Page Size (176ms)\n\n    ✔ should fetch NewEventsQueueURL (173ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (262ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (397ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (710ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (325ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (695ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    1) should report on PositionOpened event\n\n    2) should report on PositionClosed event\n\n    3) should report on PositionLiqiuidated event\n\n    4) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    5) should report on Deposit event\n\n    6) should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (9s)\n  6 failing\n\n\n  1) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 'LeveragedPositionOpened'\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     AssertionError: expected undefined to equal 'LeveragedPositionClosed'\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     AssertionError: expected undefined to equal 'LeveragedPositionLiquidated'\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  5) PSP Events Logging\n       should report on Deposit event:\n     AssertionError: expected undefined to equal 'Deposit'\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:55:37)\n\n\n  6) PSP Events Logging\n       should report on Withdraw event:\n     AssertionError: expected undefined to equal 'Withdraw'\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:88:37)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.86 |    47.92 |   96.71 |    89.2 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |    50.97 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    49.01 |     100 |   83.67 | ...39,78-79,89-93 \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":30},"start":{"column":33,"line":28}}},{"id":"140","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:17859) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:38 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:38 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:38 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (280ms)\n\n[2/23/2024 7:25:39 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:39 PM] Event fetcher workflow completed.\n\n    2) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:39 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:39 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (269ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:39 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:39 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Deposit event\n\n[2/23/2024 7:25:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:40 PM] Event fetcher workflow completed.\n\n    4) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (180ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (146ms)\n\n    ✔ should fetch RPC URL (164ms)\n\n    ✔ should fetch Alt RPC URL (160ms)\n\n    ✔ should fetch Events Fetch Page Size (197ms)\n\n    ✔ should fetch NewEventsQueueURL (167ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (300ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (362ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1169ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (346ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (670ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    5) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    6) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    7) should report on Deposit event\n\n    8) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  30 passing (9s)\n  8 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'strategyName')\n      at OnChainEventLeveragePositionOpened.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionOpened.ts:3:4425)\n      at OnChainEventLeveragePositionOpened.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'strategyName')\n      at OnChainEventLeveragePositionLiquidated.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionLiquidated.ts:3:4431)\n      at OnChainEventLeveragePositionLiquidated.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n  7) PSP Events Logging\n       should report on Deposit event:\n     TypeError: Cannot read properties of undefined (reading 'strategyName')\n      at OnChainEventPSPDeposit.logPSPEvent (src/onchain_events/psp_events/OnChainEventPSPDeposit.ts:3:3740)\n      at OnChainEventPSPDeposit.process (src/onchain_events/psp_events/OnChainEventPSP.ts:3:3423)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:57:11)\n\n  8) PSP Events Logging\n       should report on Withdraw event:\n     TypeError: Cannot read properties of undefined (reading 'strategyName')\n      at OnChainEventPSPWithdraw.logPSPEvent (src/onchain_events/psp_events/OnChainEventPSPWithdraw.ts:3:3742)\n      at OnChainEventPSPWithdraw.process (src/onchain_events/psp_events/OnChainEventPSP.ts:3:3423)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:90:11)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   87.61 |    47.04 |   95.77 |   87.91 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |    84.9 |    49.67 |   86.48 |   86.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      80 |    41.17 |     100 |   79.59 | 6,24,39,86-96     \n ...src/onchain_events/leverage_events |   88.05 |    44.67 |   96.72 |   87.84 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   84.37 |    41.53 |    92.3 |   84.12 | ...-41,91,125-142 \n  ...ainEventLeveragePositionOpened.ts |   85.71 |    42.25 |   92.85 |    85.5 | ...-41,92,137-156 \n ...8464/src/onchain_events/psp_events |   86.82 |     46.4 |     100 |    86.5 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |   85.36 |    46.51 |     100 |      85 | 6,24,38-41,75     \n  OnChainEventPSPWithdraw.ts           |   85.36 |    46.51 |     100 |      85 | 6,24,38-41,75     \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":39},"start":{"column":90,"line":32}}},{"id":"142","mutatorName":"ConditionalExpression","replacement":"false","status":"Survived","testsCompleted":1,"location":{"end":{"column":26,"line":34},"start":{"column":9,"line":34}}},{"id":"141","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n  Leverage Events\n\n(node:17968) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:25:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:39 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:39 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:39 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (264ms)\n\n[2/23/2024 7:25:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:40 PM] Event fetcher workflow completed.\n\n    2) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:40 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:40 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (297ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:40 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:40 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Deposit event\n\n[2/23/2024 7:25:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:41 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (361ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (166ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (157ms)\n\n    ✔ should fetch RPC URL (170ms)\n\n    ✔ should fetch Alt RPC URL (194ms)\n\n    ✔ should fetch Events Fetch Page Size (194ms)\n\n    ✔ should fetch NewEventsQueueURL (161ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (230ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (367ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (797ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (297ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (757ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    4) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    5) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    6) should report on Deposit event\n\n    7) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  31 passing (9s)\n  7 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  6) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  7) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.31 |    48.32 |   96.71 |   89.66 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |    88.2 |    52.27 |   86.48 |   90.04 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      94 |    56.86 |     100 |   93.87 | 6,24,39           \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":34},"start":{"column":9,"line":34}}},{"id":"143","mutatorName":"EqualityOperator","replacement":"res !== undefined","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:18028) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:25:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:45 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:45 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:46 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (280ms)\n\n[2/23/2024 7:25:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:46 PM] Event fetcher workflow completed.\n\n    2) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:46 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:46 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (281ms)\n\n\n  PSP Events\n\n[2/23/2024 7:25:46 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:46 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:46 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (314ms)\n\n[2/23/2024 7:25:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:47 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (178ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (170ms)\n\n    ✔ should fetch RPC URL (148ms)\n\n    ✔ should fetch Alt RPC URL (141ms)\n\n    ✔ should fetch Events Fetch Page Size (171ms)\n\n    ✔ should fetch NewEventsQueueURL (155ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (269ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (313ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (779ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (348ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (670ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    4) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    5) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    6) should report on Deposit event\n\n    7) should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  31 passing (9s)\n  7 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  6) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  7) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   84.82 |    45.44 |   92.01 |   85.05 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   87.73 |    50.97 |   86.48 |   89.55 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      92 |    49.01 |     100 |   91.83 | 6,24,39,96        \n\n ...src/onchain_events/leverage_events |   79.18 |    38.83 |   88.52 |   78.81 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   67.18 |    29.23 |   76.92 |   66.66 | ...,75-91,114-142 \n\n  ...ainEventLeveragePositionOpened.ts |   64.28 |    29.57 |   71.42 |   63.76 | ...76-100,125-156 \n\n ...8464/src/onchain_events/psp_events |   78.29 |     40.8 |   89.28 |   77.77 |                   \n\n  OnChainEventPSP.ts                   |   82.97 |    43.58 |      90 |    82.6 | 6,24,38-41,63-67  \n  OnChainEventPSPDeposit.ts            |    75.6 |    39.53 |   88.88 |      75 | 6,24,38-41,61-75  \n\n  OnChainEventPSPWithdraw.ts           |    75.6 |    39.53 |   88.88 |      75 | 6,24,38-41,61-75  \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":26,"line":34},"start":{"column":9,"line":34}}},{"id":"144","mutatorName":"BlockStatement","replacement":"{}","status":"Survived","testsCompleted":1,"location":{"end":{"column":6,"line":36},"start":{"column":28,"line":34}}},{"id":"145","mutatorName":"StringLiteral","replacement":"``","status":"Survived","testsCompleted":1,"location":{"end":{"column":69,"line":35},"start":{"column":23,"line":35}}}],"source":"import {Logger, SQSService} from '@thisisarchimedes/backend-sdk';\nimport {ConfigService} from '../services/config/ConfigService';\nimport {ContractInfoPSP} from '../types/ContractInfoPSP';\nimport {ethers} from 'ethers';\n\nexport abstract class OnChainEvent {\n  protected eventName: string = '';\n  protected userAddress: string = '';\n  protected txHash: string = '';\n  protected blockNumber: number = 0;\n\n  protected strategyConfig!: ContractInfoPSP;\n  protected logger: Logger;\n  protected sqsService: SQSService;\n  protected configService: ConfigService;\n\n  constructor(rawEventLog: ethers.providers.Log, logger: Logger, sqsService: SQSService, configService: ConfigService) {\n    this.logger = logger;\n    this.sqsService = sqsService;\n    this.configService = configService;\n\n    this.txHash = rawEventLog.transactionHash;\n    this.blockNumber = rawEventLog.blockNumber;\n  }\n\n  abstract process(): void;\n\n  public getEventName(): string {\n    return this.eventName;\n  }\n\n  protected findStrategyConfigBStrategyAddress(strategyAddress: string): ContractInfoPSP {\n    const res = this.configService.getPSPStrategyInfoByAddress(strategyAddress);\n    if (res === undefined) {\n      throw new Error(`Unknown strategy address: ${strategyAddress}`);\n    }\n\n    return res;\n  }\n}\n"},"src/onchain_events/leverage_events/OnChainEventLeverage.ts":{"language":"typescript","mutants":[{"id":"146","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:18200) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:48 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:49 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:49 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:49 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:49 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:49 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:49 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:25:50 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:50 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:50 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (184ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (165ms)\n\n    ✔ should fetch RPC URL (155ms)\n\n    ✔ should fetch Alt RPC URL (145ms)\n\n    ✔ should fetch Events Fetch Page Size (176ms)\n\n    ✔ should fetch NewEventsQueueURL (147ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (248ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (364ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (680ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (318ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (701ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (62ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    7) should report on PositionOpened event\n\n    8) should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  28 passing (9s)\n\n  10 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 'LeveragedPositionOpened'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     AssertionError: expected undefined to equal 'LeveragedPositionClosed'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     AssertionError: expected undefined to equal 'LeveragedPositionLiquidated'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   84.47 |    45.36 |   91.54 |   84.77 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   74.74 |    37.45 |   81.96 |   74.65 |                   \n\n  OnChainEventLeverage.ts              |    42.1 |    35.48 |    62.5 |   43.24 | ...32,39,43,56-70 \n\n  ...ainEventLeveragePositionClosed.ts |   78.68 |     36.5 |   84.61 |   78.33 | ...,78-89,121-137 \n\n  ...inEventLeveragePositionExpired.ts |   78.33 |    36.06 |   84.61 |   77.96 | ...,77-87,118-133 \n\n  ...ventLeveragePositionLiquidated.ts |   79.68 |    38.46 |   84.61 |   79.36 | ...,80-91,125-142 \n\n  ...ainEventLeveragePositionOpened.ts |   81.42 |    39.43 |   85.71 |   81.15 | ...,81-92,137-156 \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":10},"start":{"column":26,"line":7}}},{"id":"147","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:18259) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:49 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:49 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:25:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:49 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:49 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:50 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:50 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:25:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:50 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:50 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:50 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:50 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:50 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (260ms)\n\n[2/23/2024 7:25:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:51 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:51 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (298ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (151ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (227ms)\n\n    ✔ should fetch RPC URL (171ms)\n\n    ✔ should fetch Alt RPC URL (190ms)\n\n    ✔ should fetch Events Fetch Page Size (153ms)\n\n    ✔ should fetch NewEventsQueueURL (147ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (336ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (446ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (740ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (311ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (712ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    5) should report on PositionOpened event\n\n    6) should report on PositionClosed event\n\n    7) should report on PositionLiqiuidated event\n\n    8) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (9s)\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:201:35)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:201:35)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:201:35)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:201:35)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.25 |    46.72 |   94.83 |   87.54 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   85.32 |    43.29 |   93.44 |   85.06 |                   \n\n  OnChainEventLeverage.ts              |   81.57 |    58.06 |     100 |   81.08 | 6,24,39,67-70     \n\n  ...ainEventLeveragePositionClosed.ts |   85.24 |    41.26 |    92.3 |      85 | ...,38-41,121-137 \n\n  ...inEventLeveragePositionExpired.ts |      85 |    40.98 |    92.3 |   84.74 | ...,38-41,118-133 \n\n  ...ventLeveragePositionLiquidated.ts |   85.93 |    41.53 |    92.3 |   85.71 | ...,38-41,125-142 \n\n  ...ainEventLeveragePositionOpened.ts |   87.14 |    42.25 |   92.85 |   86.95 | ...,38-41,137-156 \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":19},"start":{"column":40,"line":15}}}],"source":"import {OnChainEvent} from '../OnChainEvent';\nimport {EventFetcherSQSMessage} from '../../types/EventFetcherSQSMessage';\n\nexport abstract class OnChainEventLeverage extends OnChainEvent {\n  protected nftId!: number;\n\n  public process(): void {\n    this.logLeverageEvent();\n    this.sendSqsLeverageEvent();\n  }\n\n  protected abstract getSQSMessage(): EventFetcherSQSMessage;\n  protected abstract logLeverageEvent(): void;\n\n  private sendSqsLeverageEvent(): void {\n    const sqsMessage = JSON.stringify(this.getSQSMessage());\n    const queueUrl = this.configService.getEventQueueURL();\n    this.sqsService.sendMessage(queueUrl, sqsMessage);\n  }\n}\n"},"src/onchain_events/leverage_events/OnChainEventLeveragePositionClosed.ts":{"language":"typescript","mutants":[{"id":"149","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:18371) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:50 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:50 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (329ms)\n\n[2/23/2024 7:25:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:50 PM] {\"event\":\"\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:50 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (261ms)\n\n[2/23/2024 7:25:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:51 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (279ms)\n\n[2/23/2024 7:25:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:51 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (315ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:51 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:51 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:51 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (309ms)\n\n[2/23/2024 7:25:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:52 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:52 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (269ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (186ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (159ms)\n\n    ✔ should fetch RPC URL (207ms)\n\n    ✔ should fetch Alt RPC URL (171ms)\n\n    ✔ should fetch Events Fetch Page Size (151ms)\n\n    ✔ should fetch NewEventsQueueURL (224ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (277ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (321ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (888ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (276ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (687ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    1) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n  1 failing\n\n\n\n  1) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected '' to equal 'LeveragedPositionClosed'\n      + expected - actual\n\n      +LeveragedPositionClosed\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   92.15 |    48.45 |     100 |   92.01 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |   95.08 |    52.38 |     100 |      95 | 6,24,39           \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":14},"start":{"column":22,"line":14}}},{"id":"148","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:18337) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:25:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:50 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:50 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (330ms)\n\n[2/23/2024 7:25:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:55 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:55 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:56 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (316ms)\n\n[2/23/2024 7:25:56 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:56 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (386ms)\n\n\n  PSP Events\n\n[2/23/2024 7:25:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:56 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:56 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:56 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (278ms)\n\n[2/23/2024 7:25:57 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:57 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:57 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (215ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (293ms)\n\n    ✔ should fetch RPC URL (147ms)\n\n    ✔ should fetch Alt RPC URL (164ms)\n\n    ✔ should fetch Events Fetch Page Size (175ms)\n\n    ✔ should fetch NewEventsQueueURL (131ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (228ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (376ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1075ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (364ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (651ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    3) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (14s)\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   85.36 |    46.24 |   92.95 |    85.7 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   78.15 |    40.89 |   86.88 |   78.12 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   27.86 |    17.46 |   38.46 |   28.33 | ...2,39,43,61-137 \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":16},"start":{"column":120,"line":12}}},{"id":"150","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:18431) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:56 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (394ms)\n\n[2/23/2024 7:25:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:56 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:25:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:57 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (318ms)\n\n[2/23/2024 7:25:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:57 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (404ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:57 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:57 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:57 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:57 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (318ms)\n\n[2/23/2024 7:25:58 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:58 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:58 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (317ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (151ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (170ms)\n\n    ✔ should fetch RPC URL (178ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (157ms)\n\n    ✔ should fetch NewEventsQueueURL (140ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (262ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (378ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1010ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (376ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (650ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    2) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionClosed.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionClosed.ts:3:4404)\n      at OnChainEventLeveragePositionClosed.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.07 |    47.04 |   94.83 |   87.36 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   84.64 |    44.32 |   93.44 |   84.37 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   59.01 |    33.33 |   69.23 |   58.33 | ...9,71-74,89-137 \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":22},"start":{"column":65,"line":18}}},{"id":"151","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:18485) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:56 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (400ms)\n\n[2/23/2024 7:25:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (304ms)\n\n[2/23/2024 7:25:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:57 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (393ms)\n\n[2/23/2024 7:25:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:58 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (307ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:58 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:58 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:58 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (254ms)\n\n[2/23/2024 7:25:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:58 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:58 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (266ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (154ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (160ms)\n\n    ✔ should fetch RPC URL (140ms)\n\n    ✔ should fetch Alt RPC URL (148ms)\n\n    ✔ should fetch Events Fetch Page Size (176ms)\n\n    ✔ should fetch NewEventsQueueURL (143ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (341ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (342ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1273ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (446ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (686ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    1) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (10s)\n  1 failing\n\n\n\n  1) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected 'LeveragedPositionOpened' to equal 'LeveragedPositionClosed'\n      + expected - actual\n\n      -LeveragedPositionOpened\n      +LeveragedPositionClosed\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.76 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.12 |    47.76 |     100 |   90.97 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |   90.16 |     49.2 |     100 |      90 | 6,24,39,81-89     \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":34},"start":{"column":38,"line":24}}},{"id":"152","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:18540) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:58 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (327ms)\n\n[2/23/2024 7:25:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:58 PM] {}\n\n[2/23/2024 7:25:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (282ms)\n\n[2/23/2024 7:25:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:58 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:25:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (249ms)\n\n[2/23/2024 7:25:58 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:58 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (258ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:25:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:59 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:25:59 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:25:59 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (261ms)\n\n[2/23/2024 7:25:59 PM] Executing the event fetcher workflow...\n[2/23/2024 7:25:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:59 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:25:59 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (291ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (154ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (174ms)\n\n    ✔ should fetch RPC URL (166ms)\n\n    ✔ should fetch Alt RPC URL (173ms)\n\n    ✔ should fetch Events Fetch Page Size (161ms)\n\n    ✔ should fetch NewEventsQueueURL (178ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (246ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (362ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1015ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (604ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (690ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    1) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n  1 failing\n\n  1) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     AssertionError: expected undefined to equal 'LeveragedPositionClosed'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    47.84 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   92.15 |     48.1 |     100 |   92.01 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |   95.08 |    50.79 |     100 |      95 | 6,24,39           \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":31},"start":{"column":55,"line":25}}},{"id":"153","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:18596) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:25:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:59 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:59 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (336ms)\n\n[2/23/2024 7:25:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:25:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:25:59 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Stryker was here!\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:25:59 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (272ms)\n\n[2/23/2024 7:26:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:00 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (275ms)\n\n[2/23/2024 7:26:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:00 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (296ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:00 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:00 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:00 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:00 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (362ms)\n\n[2/23/2024 7:26:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:01 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:01 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (175ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (190ms)\n\n    ✔ should fetch RPC URL (150ms)\n\n    ✔ should fetch Alt RPC URL (160ms)\n\n    ✔ should fetch Events Fetch Page Size (163ms)\n\n    ✔ should fetch NewEventsQueueURL (215ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (240ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (361ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1027ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (385ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (697ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event (56ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    2) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected 'Stryker was here!' to equal ''\n      + expected - actual\n\n      -Stryker was here!\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:211:42)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    48.45 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   95.08 |    52.38 |     100 |      95 | 6,24,39           \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":28},"start":{"column":17,"line":28}}},{"id":"154","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:18650) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:00 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (311ms)\n\n[2/23/2024 7:26:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:00 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:00 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:26:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:00 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (381ms)\n\n[2/23/2024 7:26:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:01 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (281ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:01 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:01 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:01 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (276ms)\n\n[2/23/2024 7:26:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:01 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:01 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (283ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (173ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (158ms)\n\n    ✔ should fetch RPC URL (213ms)\n\n    ✔ should fetch Alt RPC URL (168ms)\n\n    ✔ should fetch Events Fetch Page Size (160ms)\n\n    ✔ should fetch NewEventsQueueURL (145ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (217ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (355ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1124ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (297ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (755ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    2) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected '{\"user\":\"0x925cc02EC7b77d4432e82e7bCa…' to equal '{\"nftId\":2,\"user\":\"0x925cc02EC7b77d44…'\n      + expected - actual\n\n      -{\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"receivedAmount\":\"1\",\"wbtcDebtAmount\":\"2\"}\n      +{\"nftId\":2,\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"receivedAmount\":\"1\",\"wbtcDebtAmount\":\"2\"}\n      \n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:221:54)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.08 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    49.14 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   95.08 |    55.55 |     100 |      95 | 6,24,39           \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":38},"start":{"column":75,"line":36}}},{"id":"155","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:18707) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:01 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (324ms)\n\n[2/23/2024 7:26:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:01 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:01 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:26:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:01 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (261ms)\n\n[2/23/2024 7:26:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:01 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (293ms)\n\n\n  PSP Events\n\n[2/23/2024 7:26:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:02 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:02 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:02 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (334ms)\n\n[2/23/2024 7:26:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:02 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:02 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (349ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (161ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (190ms)\n\n    ✔ should fetch RPC URL (162ms)\n\n    ✔ should fetch Alt RPC URL (192ms)\n\n    ✔ should fetch Events Fetch Page Size (162ms)\n\n    ✔ should fetch NewEventsQueueURL (149ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (288ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (378ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (963ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (323ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (696ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    2) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected '' to equal '0x925cc02EC7b77d4432e82e7bCaf3B89a67a…'\n      + expected - actual\n\n      +0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:210:38)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.68 |    47.76 |   96.71 |   89.02 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   90.78 |    47.76 |     100 |   90.62 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   88.52 |     49.2 |     100 |   88.33 | 6,24,39,104-107   \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":44},"start":{"column":76,"line":40}}},{"id":"156","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":32,"line":42},"start":{"column":28,"line":42}}},{"id":"157","mutatorName":"MethodExpression","replacement":"rawAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:18821) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:07 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (579ms)\n\n[2/23/2024 7:26:08 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:08 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:26:08 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:08 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (281ms)\n\n[2/23/2024 7:26:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:08 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (283ms)\n\n\n  PSP Events\n\n[2/23/2024 7:26:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:08 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:08 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:08 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (274ms)\n\n[2/23/2024 7:26:09 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:09 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:09 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (281ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (147ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (149ms)\n\n    ✔ should fetch RPC URL (155ms)\n\n    ✔ should fetch Alt RPC URL (247ms)\n\n    ✔ should fetch Events Fetch Page Size (151ms)\n\n    ✔ should fetch NewEventsQueueURL (162ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (239ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (367ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (740ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (352ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (682ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    2) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.16 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    49.14 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   95.08 |    55.55 |     100 |      95 | 6,24,39           \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":42},"start":{"column":35,"line":42}}},{"id":"158","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:18876) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:08 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (368ms)\n\n[2/23/2024 7:26:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:08 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:26:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:09 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (270ms)\n\n[2/23/2024 7:26:09 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:09 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (294ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:09 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:09 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:09 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (292ms)\n\n[2/23/2024 7:26:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:09 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:10 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (365ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (149ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (167ms)\n\n    ✔ should fetch RPC URL (153ms)\n\n    ✔ should fetch Alt RPC URL (154ms)\n\n    ✔ should fetch Events Fetch Page Size (144ms)\n\n    ✔ should fetch NewEventsQueueURL (148ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (272ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (398ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1028ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (436ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (705ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    2) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionClosed.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionClosed.ts:3:4404)\n      at OnChainEventLeveragePositionClosed.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.24 |    47.44 |   96.24 |   88.56 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   89.07 |    46.04 |   98.36 |   88.88 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |   80.32 |    41.26 |    92.3 |      80 | ...,39,89,114-137 \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":53},"start":{"column":84,"line":46}}},{"id":"159","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:18931) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:09 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (337ms)\n\n[2/23/2024 7:26:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:09 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:26:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:10 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:10 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (273ms)\n\n[2/23/2024 7:26:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:10 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:10 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (270ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:10 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:10 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:10 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (288ms)\n\n[2/23/2024 7:26:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:10 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:10 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (266ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (152ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (158ms)\n\n    ✔ should fetch RPC URL (163ms)\n\n    ✔ should fetch Alt RPC URL (152ms)\n\n    ✔ should fetch Events Fetch Page Size (188ms)\n\n    ✔ should fetch NewEventsQueueURL (150ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (289ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (360ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (769ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (273ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (782ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    2) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionClosed.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionClosed.ts:3:4404)\n      at OnChainEventLeveragePositionClosed.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.59 |     47.6 |   96.24 |   88.92 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   90.44 |    46.73 |   98.36 |   90.27 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   86.88 |    44.44 |    92.3 |   86.66 | ...,39,89,121-137 \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":48},"start":{"column":9,"line":48}}},{"id":"160","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:18988) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:10 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:10 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (306ms)\n\n[2/23/2024 7:26:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:11 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:26:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:11 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:11 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (276ms)\n\n[2/23/2024 7:26:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:11 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:11 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (274ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:11 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:11 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:11 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:26:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:12 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:12 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (154ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (174ms)\n\n    ✔ should fetch RPC URL (160ms)\n\n    ✔ should fetch Alt RPC URL (160ms)\n\n    ✔ should fetch Events Fetch Page Size (181ms)\n\n    ✔ should fetch NewEventsQueueURL (160ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (299ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (369ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (698ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (306ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (742ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    4) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n\n  4 failing\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionClosed.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionClosed.ts:3:4446)\n      at OnChainEventLeveragePositionClosed.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.59 |    47.68 |   96.24 |   88.92 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   90.44 |    47.07 |   98.36 |   90.27 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |   86.88 |    46.03 |    92.3 |   86.66 | ...,39,89,121-137 \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":48},"start":{"column":10,"line":48}}},{"id":"161","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:19043) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:11 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:11 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (321ms)\n\n[2/23/2024 7:26:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:11 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:26:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:11 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:12 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (260ms)\n\n[2/23/2024 7:26:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:12 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:12 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (286ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:12 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:12 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:12 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:26:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:12 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:12 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (200ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (187ms)\n\n    ✔ should fetch RPC URL (190ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (178ms)\n\n    ✔ should fetch NewEventsQueueURL (157ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (260ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (343ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (710ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (575ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (778ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    4) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n  4 failing\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionClosed.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionClosed.ts:3:4446)\n      at OnChainEventLeveragePositionClosed.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.59 |    47.84 |   96.24 |   88.92 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   90.44 |    47.76 |   98.36 |   90.27 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   86.88 |     49.2 |    92.3 |   86.66 | ...,39,89,121-137 \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":48},"start":{"column":21,"line":48}}},{"id":"162","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:19098) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:12 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:12 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (323ms)\n\n[2/23/2024 7:26:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:12 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:12 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:26:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:12 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:12 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (277ms)\n\n[2/23/2024 7:26:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:13 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:13 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (267ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:13 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:13 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:13 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (335ms)\n\n[2/23/2024 7:26:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:13 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:13 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (280ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (161ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (165ms)\n\n    ✔ should fetch RPC URL (178ms)\n\n    ✔ should fetch Alt RPC URL (161ms)\n\n    ✔ should fetch Events Fetch Page Size (156ms)\n\n    ✔ should fetch NewEventsQueueURL (148ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (236ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (332ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (2116ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (455ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (669ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    2) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (11s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:201:35)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.68 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.12 |    47.42 |     100 |   90.97 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   90.16 |    47.61 |     100 |      90 | 6,24,39,124-137   \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":70},"start":{"column":53,"line":55}}},{"id":"163","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:19159) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:17 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:17 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (355ms)\n\n[2/23/2024 7:26:17 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:17 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:17 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:26:18 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:18 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:18 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (454ms)\n\n[2/23/2024 7:26:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:18 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:18 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (263ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:18 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:18 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:18 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:19 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (361ms)\n\n[2/23/2024 7:26:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:19 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:19 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (294ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (189ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (194ms)\n\n    ✔ should fetch RPC URL (144ms)\n\n    ✔ should fetch Alt RPC URL (202ms)\n\n    ✔ should fetch Events Fetch Page Size (419ms)\n\n    ✔ should fetch NewEventsQueueURL (163ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (313ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (370ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1527ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (579ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (638ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    2) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     AssertionError: expected undefined to equal 6000003\n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:219:45)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.76 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    47.76 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   95.08 |     49.2 |     100 |      95 | 6,24,39           \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":67},"start":{"column":41,"line":56}}},{"id":"164","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:19215) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:18 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:18 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:18 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (429ms)\n\n[2/23/2024 7:26:18 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:18 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:18 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:26:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:18 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (413ms)\n\n[2/23/2024 7:26:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:19 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (279ms)\n\n\n  PSP Events\n\n[2/23/2024 7:26:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:19 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:19 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:19 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (342ms)\n\n[2/23/2024 7:26:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:19 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:19 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (279ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (764ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (170ms)\n\n    ✔ should fetch RPC URL (174ms)\n\n    ✔ should fetch Alt RPC URL (155ms)\n\n    ✔ should fetch Events Fetch Page Size (169ms)\n\n    ✔ should fetch NewEventsQueueURL (157ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (236ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (353ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1570ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (383ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (652ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    2) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (11s)\n\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected '' to equal 'PositionClosed'\n      + expected - actual\n\n      +PositionClosed\n      \n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:222:38)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   92.15 |    48.45 |     100 |   92.01 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |   95.08 |    52.38 |     100 |      95 | 6,24,39           \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":57},"start":{"column":13,"line":57}}},{"id":"165","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:19271) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:19 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (404ms)\n\n[2/23/2024 7:26:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:20 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:20 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:26:20 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:20 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (279ms)\n\n[2/23/2024 7:26:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:20 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (471ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:21 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:21 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:21 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (292ms)\n\n[2/23/2024 7:26:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:21 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:21 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (163ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (157ms)\n\n    ✔ should fetch RPC URL (149ms)\n\n    ✔ should fetch Alt RPC URL (255ms)\n\n    ✔ should fetch Events Fetch Page Size (141ms)\n\n    ✔ should fetch NewEventsQueueURL (158ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (245ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (337ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1523ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (587ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (880ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (41ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    3) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (11s)\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected '{}' to equal '{\"nftId\":2,\"user\":\"0x925cc02EC7b77d44…'\n      + expected - actual\n\n      -{}\n      +{\"nftId\":2,\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"receivedAmount\":\"1\",\"wbtcDebtAmount\":\"2\"}\n      \n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:221:54)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    48.45 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   95.08 |    52.38 |     100 |      95 | 6,24,39           \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":8,"line":66},"start":{"column":13,"line":61}}}],"source":"import {ethers} from 'ethers';\nimport {OnChainEventLeverage} from './OnChainEventLeverage';\nimport {Logger, SQSService} from '@thisisarchimedes/backend-sdk';\nimport {ConfigService} from '../../services/config/ConfigService';\nimport {EventFetcherSQSMessage} from '../../types/EventFetcherSQSMessage';\nimport {EventFetcherLogEntryMessage} from '../../types/NewRelicLogEntry';\n\nexport class OnChainEventLeveragePositionClosed extends OnChainEventLeverage {\n  private receivedAmount!: bigint;\n  private debtAmount!: bigint;\n\n  constructor(rawEventLog: ethers.providers.Log, logger: Logger, sqsService: SQSService, configService: ConfigService) {\n    super(rawEventLog, logger, sqsService, configService);\n    this.eventName = 'LeveragedPositionClosed';\n    this.parseEventLog(rawEventLog);\n  }\n\n  protected parseEventLog(eventLog: ethers.providers.Log): void {\n    this.setUserAddressFromEventLog(eventLog);\n    this.setNftIdFromEventLogTopic(eventLog);\n    this.setPositionAmountsFromEventLogData(eventLog);\n  }\n\n  protected logLeverageEvent(): void {\n    const eventDetails: EventFetcherLogEntryMessage = {\n      event: this.eventName,\n      user: this.userAddress,\n      strategy: '',\n      depositAmount: this.receivedAmount.toString(),\n      borrowedAmount: this.debtAmount.toString(),\n    };\n\n    this.logger.info(JSON.stringify(eventDetails));\n  }\n\n  private setNftIdFromEventLogTopic(eventLog: ethers.providers.Log): void {\n    this.nftId = Number(eventLog.topics[1]);\n  }\n\n  private setUserAddressFromEventLog(eventLog: ethers.providers.Log): void {\n    const rawAddress = eventLog.topics[2];\n    const trimmedAddress = '0x' + rawAddress.slice(26);\n    this.userAddress = ethers.utils.getAddress(trimmedAddress);\n  }\n\n  private setPositionAmountsFromEventLogData(eventLog: ethers.providers.Log): void {\n    const decodedData = ethers.utils.defaultAbiCoder.decode(\n        ['uint256', 'uint256'],\n        eventLog.data);\n\n    this.receivedAmount = decodedData[0];\n    this.debtAmount = decodedData[1];\n  }\n\n  protected getSQSMessage(): EventFetcherSQSMessage {\n    const msg: EventFetcherSQSMessage = {\n      name: 'PositionClosed',\n      contractType: 1,\n      txHash: this.txHash,\n      blockNumber: this.blockNumber,\n      data: {\n        nftId: this.nftId,\n        user: this.userAddress,\n        receivedAmount: this.receivedAmount.toString(),\n        wbtcDebtAmount: this.debtAmount.toString(),\n      },\n    };\n\n    return msg;\n  }\n}\n"},"src/onchain_events/leverage_events/OnChainEventLeveragePositionExpired.ts":{"language":"typescript","mutants":[{"id":"166","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:19325) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:20 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (341ms)\n\n[2/23/2024 7:26:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:20 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (267ms)\n\n[2/23/2024 7:26:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:20 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (287ms)\n\n[2/23/2024 7:26:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:21 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:21 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:21 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:21 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (254ms)\n\n[2/23/2024 7:26:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:21 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:21 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (196ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (189ms)\n\n    ✔ should fetch RPC URL (153ms)\n\n    ✔ should fetch Alt RPC URL (154ms)\n\n    ✔ should fetch Events Fetch Page Size (150ms)\n\n    ✔ should fetch NewEventsQueueURL (153ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (235ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (438ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1474ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (547ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (980ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event (57ms)\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    3) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.22 |     48.4 |   96.71 |   89.57 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   92.83 |    50.17 |     100 |    92.7 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |   95.08 |    53.96 |     100 |      95 | 6,24,39           \n  ...inEventLeveragePositionExpired.ts |      95 |    54.09 |     100 |   94.91 | 6,24,39           \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":15},"start":{"column":120,"line":11}}},{"id":"167","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:19382) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:21 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:21 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (327ms)\n\n[2/23/2024 7:26:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:21 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:21 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (255ms)\n\n[2/23/2024 7:26:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:22 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (461ms)\n\n[2/23/2024 7:26:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:22 PM] {\"event\":\"\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (281ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:22 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:22 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:22 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (298ms)\n\n[2/23/2024 7:26:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:23 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:23 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (297ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (156ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (162ms)\n\n    ✔ should fetch RPC URL (166ms)\n\n    ✔ should fetch Alt RPC URL (162ms)\n\n    ✔ should fetch Events Fetch Page Size (188ms)\n\n    ✔ should fetch NewEventsQueueURL (151ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (330ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (353ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (906ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (337ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (871ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    1) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n  1 failing\n\n\n  1) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected '' to equal 'LeveragedPositionExpired'\n      + expected - actual\n\n      +LeveragedPositionExpired\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.22 |    48.48 |   96.71 |   89.57 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.83 |    50.51 |     100 |    92.7 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |   95.08 |    53.96 |     100 |      95 | 6,24,39           \n\n  ...inEventLeveragePositionExpired.ts |      95 |    55.73 |     100 |   94.91 | 6,24,39           \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":13},"start":{"column":22,"line":13}}},{"id":"168","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:19437) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:22 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (331ms)\n\n[2/23/2024 7:26:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:22 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (278ms)\n\n[2/23/2024 7:26:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:22 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (292ms)\n\n[2/23/2024 7:26:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:23 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:23 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:23 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:23 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (282ms)\n\n[2/23/2024 7:26:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:23 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:23 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (257ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (145ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (197ms)\n\n    ✔ should fetch RPC URL (151ms)\n\n    ✔ should fetch Alt RPC URL (160ms)\n\n    ✔ should fetch Events Fetch Page Size (148ms)\n\n    ✔ should fetch NewEventsQueueURL (159ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (302ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (370ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (732ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (294ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (799ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (39ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    2) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionExpired.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionExpired.ts:3:4407)\n      at OnChainEventLeveragePositionExpired.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n----------|---------|----------|---------|---------|-------------------\n\nFile      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n----------|---------|----------|---------|---------|-------------------\n\nAll files |       0 |        0 |       0 |       0 |                   \n\n----------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":21},"start":{"column":65,"line":17}}},{"id":"169","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:19492) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:24 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:24 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:24 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (384ms)\n\n[2/23/2024 7:26:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:25 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:25 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (296ms)\n\n[2/23/2024 7:26:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:25 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:25 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (414ms)\n\n[2/23/2024 7:26:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:25 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (311ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:26 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:26 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:26 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:26 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (346ms)\n\n[2/23/2024 7:26:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:26 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:26 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:26 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (290ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (183ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (158ms)\n\n    ✔ should fetch RPC URL (199ms)\n\n    ✔ should fetch Alt RPC URL (176ms)\n\n    ✔ should fetch Events Fetch Page Size (155ms)\n\n    ✔ should fetch NewEventsQueueURL (189ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (275ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (369ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (804ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (278ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (731ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    1) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n\n  1 failing\n\n\n\n  1) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.76 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.12 |    47.76 |     100 |   90.97 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |      90 |    49.18 |     100 |   89.83 | 6,24,39,80-87     \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":32},"start":{"column":38,"line":23}}},{"id":"170","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:19552) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:29 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:29 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:29 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (402ms)\n\n[2/23/2024 7:26:30 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:30 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (311ms)\n\n[2/23/2024 7:26:30 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:30 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (286ms)\n\n[2/23/2024 7:26:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:30 PM] {}\n\n[2/23/2024 7:26:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (312ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:31 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:31 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:31 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (523ms)\n\n[2/23/2024 7:26:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:31 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:31 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (298ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (197ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (148ms)\n\n    ✔ should fetch RPC URL (177ms)\n\n    ✔ should fetch Alt RPC URL (202ms)\n\n    ✔ should fetch Events Fetch Page Size (202ms)\n\n    ✔ should fetch NewEventsQueueURL (377ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (336ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (659ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (839ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (354ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (680ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    1) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (10s)\n  1 failing\n\n\n  1) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.84 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |     48.1 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |      95 |    50.81 |     100 |   94.91 | 6,24,39           \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":29},"start":{"column":55,"line":24}}},{"id":"171","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:19609) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:31 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (451ms)\n\n[2/23/2024 7:26:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:32 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (330ms)\n\n[2/23/2024 7:26:32 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:32 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (348ms)\n\n[2/23/2024 7:26:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:32 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Stryker was here!\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (325ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:33 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:33 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:33 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:26:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:33 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:33 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (355ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (178ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (180ms)\n\n    ✔ should fetch RPC URL (278ms)\n\n    ✔ should fetch Alt RPC URL (176ms)\n\n    ✔ should fetch Events Fetch Page Size (209ms)\n\n    ✔ should fetch NewEventsQueueURL (183ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (328ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (435ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (918ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (582ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (708ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    2) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected 'Stryker was here!' to equal ''\n      + expected - actual\n\n      -Stryker was here!\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:211:42)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    48.45 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |      95 |    52.45 |     100 |   94.91 | 6,24,39           \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":27},"start":{"column":17,"line":27}}},{"id":"173","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:19743) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:32 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (376ms)\n\n[2/23/2024 7:26:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:33 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (308ms)\n\n[2/23/2024 7:26:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:33 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (489ms)\n\n[2/23/2024 7:26:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:33 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:33 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:34 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:34 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:34 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (367ms)\n\n[2/23/2024 7:26:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:34 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:34 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (288ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (154ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (182ms)\n\n    ✔ should fetch RPC URL (151ms)\n\n    ✔ should fetch Alt RPC URL (149ms)\n\n    ✔ should fetch Events Fetch Page Size (177ms)\n\n    ✔ should fetch NewEventsQueueURL (172ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (282ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (367ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1149ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (2905ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (643ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    2) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (13s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected '' to equal '0x925cc02EC7b77d4432e82e7bCaf3B89a67a…'\n      + expected - actual\n\n      +0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:210:38)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.68 |    47.76 |   96.71 |   89.02 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   90.78 |    47.76 |     100 |   90.62 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   88.33 |    49.18 |     100 |   88.13 | 6,24,39,102-105   \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":42},"start":{"column":76,"line":38}}},{"id":"172","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:19688) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:32 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (626ms)\n\n[2/23/2024 7:26:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:33 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (474ms)\n\n[2/23/2024 7:26:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:33 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (369ms)\n\n[2/23/2024 7:26:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:34 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:34 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:34 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:34 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:34 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (400ms)\n\n[2/23/2024 7:26:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:34 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:34 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (180ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (151ms)\n\n    ✔ should fetch RPC URL (149ms)\n\n    ✔ should fetch Alt RPC URL (180ms)\n\n    ✔ should fetch Events Fetch Page Size (149ms)\n\n    ✔ should fetch NewEventsQueueURL (175ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (304ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (429ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (4258ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (4449ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (644ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    3) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (17s)\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected '{\"user\":\"0x925cc02EC7b77d4432e82e7bCa…' to equal '{\"nftId\":2,\"user\":\"0x925cc02EC7b77d44…'\n      + expected - actual\n\n      -{\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"claimableAmount\":\"1\"}\n      +{\"nftId\":2,\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"claimableAmount\":\"1\"}\n      \n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:221:54)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.86 |    47.92 |   96.71 |    89.2 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    48.45 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    52.45 |     100 |   91.52 | 6,24,39,94-95     \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":36},"start":{"column":75,"line":34}}},{"id":"175","mutatorName":"MethodExpression","replacement":"rawAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:19829) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:33 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (333ms)\n\n[2/23/2024 7:26:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:33 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (322ms)\n\n[2/23/2024 7:26:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:34 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:34 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (279ms)\n\n[2/23/2024 7:26:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:34 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:34 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:34 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:34 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:26:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:35 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:35 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (181ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (192ms)\n\n    ✔ should fetch RPC URL (170ms)\n\n    ✔ should fetch Alt RPC URL (185ms)\n\n    ✔ should fetch Events Fetch Page Size (181ms)\n\n    ✔ should fetch NewEventsQueueURL (191ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (267ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (347ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (4872ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (5301ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (851ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    4) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (19s)\n  4 failing\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.88 |     47.2 |    95.3 |   88.19 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   87.71 |    45.01 |   95.08 |    87.5 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   73.33 |    36.06 |   76.92 |   72.88 | ...,73-87,109-133 \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":40},"start":{"column":35,"line":40}}},{"id":"174","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":32,"line":40},"start":{"column":28,"line":40}}},{"id":"176","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:19886) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:35 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:35 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (316ms)\n\n[2/23/2024 7:26:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:35 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:35 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (286ms)\n\n[2/23/2024 7:26:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:36 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:36 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (319ms)\n\n[2/23/2024 7:26:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:36 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:36 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:36 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:36 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (268ms)\n\n[2/23/2024 7:26:37 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:37 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:37 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:37 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (378ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (157ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (171ms)\n\n    ✔ should fetch RPC URL (178ms)\n\n    ✔ should fetch Alt RPC URL (225ms)\n\n    ✔ should fetch Events Fetch Page Size (161ms)\n\n    ✔ should fetch NewEventsQueueURL (172ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (359ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (966ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1265ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (540ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (752ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    2) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (20s)\n\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionExpired.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionExpired.ts:3:4407)\n      at OnChainEventLeveragePositionExpired.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.33 |    47.52 |   96.24 |   88.65 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   89.41 |    46.39 |   98.36 |   89.23 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   81.66 |    42.62 |    92.3 |   81.35 | ...,39,87,112-133 \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":50},"start":{"column":84,"line":44}}},{"id":"178","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:20000) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:48 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:50 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (7011ms)\n\n[2/23/2024 7:26:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:51 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (724ms)\n\n[2/23/2024 7:26:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:51 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (293ms)\n\n[2/23/2024 7:26:51 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:52 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:26:52 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:52 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:52 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:52 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (293ms)\n\n[2/23/2024 7:26:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:52 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:52 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (533ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (172ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (245ms)\n\n    ✔ should fetch RPC URL (148ms)\n\n    ✔ should fetch Alt RPC URL (331ms)\n\n    ✔ should fetch Events Fetch Page Size (159ms)\n\n    ✔ should fetch NewEventsQueueURL (159ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (415ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (336ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1190ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (602ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (724ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    2) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (17s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionExpired.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionExpired.ts:3:4407)\n      at OnChainEventLeveragePositionExpired.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.59 |    47.68 |   96.24 |   88.92 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   90.44 |    47.07 |   98.36 |   90.27 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   86.66 |     45.9 |    92.3 |   86.44 | ...,39,87,118-133 \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":46},"start":{"column":10,"line":46}}},{"id":"179","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:20060) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:51 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (4182ms)\n\n[2/23/2024 7:26:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:51 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (380ms)\n\n[2/23/2024 7:26:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:51 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (288ms)\n\n[2/23/2024 7:26:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:52 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:52 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:52 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:52 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:52 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (392ms)\n\n[2/23/2024 7:26:52 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:52 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:52 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (436ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (176ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (229ms)\n\n    ✔ should fetch RPC URL (157ms)\n\n    ✔ should fetch Alt RPC URL (325ms)\n\n    ✔ should fetch Events Fetch Page Size (165ms)\n\n    ✔ should fetch NewEventsQueueURL (168ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (336ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (411ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1400ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (453ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (717ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    2) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (14s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:201:35)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.84 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.12 |    47.76 |     100 |   90.97 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |      90 |    49.18 |     100 |   89.83 | 6,24,39,121-133   \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":66},"start":{"column":53,"line":52}}},{"id":"177","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:19945) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:45 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (4310ms)\n\n[2/23/2024 7:26:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:52 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:52 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (6497ms)\n\n[2/23/2024 7:26:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:52 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:52 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (519ms)\n\n[2/23/2024 7:26:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:53 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:53 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:53 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:53 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (337ms)\n\n[2/23/2024 7:26:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:53 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:53 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (437ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (151ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (159ms)\n\n    ✔ should fetch RPC URL (182ms)\n\n    ✔ should fetch Alt RPC URL (156ms)\n\n    ✔ should fetch Events Fetch Page Size (290ms)\n\n    ✔ should fetch NewEventsQueueURL (224ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (261ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (417ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (873ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (332ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (714ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    2) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (20s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionExpired.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionExpired.ts:3:4407)\n      at OnChainEventLeveragePositionExpired.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.77 |    47.92 |   96.71 |   89.11 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.12 |     48.1 |     100 |   90.97 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |      90 |    50.81 |     100 |   89.83 | 6,24,39,121-133   \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":20,"line":46},"start":{"column":9,"line":46}}},{"id":"180","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:20124) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:51 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:52 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (344ms)\n\n[2/23/2024 7:26:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:52 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:52 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (281ms)\n\n[2/23/2024 7:26:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:52 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:52 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (533ms)\n\n[2/23/2024 7:26:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:53 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:53 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:53 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:53 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:53 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:53 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (335ms)\n\n[2/23/2024 7:26:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:53 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:53 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (477ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (156ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (230ms)\n\n    ✔ should fetch RPC URL (154ms)\n\n    ✔ should fetch Alt RPC URL (273ms)\n\n    ✔ should fetch Events Fetch Page Size (244ms)\n\n    ✔ should fetch NewEventsQueueURL (169ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (429ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (452ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1378ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (351ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (740ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (43ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (55ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    2) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (12s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 6000003\n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:219:45)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.76 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   92.15 |    47.76 |     100 |   92.01 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |      95 |    49.18 |     100 |   94.91 | 6,24,39           \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":63},"start":{"column":41,"line":53}}},{"id":"181","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:20202) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:26:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:54 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:54 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (477ms)\n\n[2/23/2024 7:26:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:54 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:54 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (369ms)\n\n[2/23/2024 7:26:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:55 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:55 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (311ms)\n\n[2/23/2024 7:26:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:55 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:55 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:55 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:55 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:55 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (357ms)\n\n[2/23/2024 7:26:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:55 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:56 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (281ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (163ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (150ms)\n\n    ✔ should fetch RPC URL (138ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (176ms)\n\n    ✔ should fetch NewEventsQueueURL (191ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (281ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (682ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (834ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (281ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1034ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    2) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected '' to equal 'PositionExpired'\n      + expected - actual\n\n      +PositionExpired\n      \n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:222:38)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |       48 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    48.79 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |      95 |    54.09 |     100 |   94.91 | 6,24,39           \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":54},"start":{"column":13,"line":54}}},{"id":"182","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:20234) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:54 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:54 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (315ms)\n\n[2/23/2024 7:26:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:54 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:54 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (458ms)\n\n[2/23/2024 7:26:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:55 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:26:55 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (307ms)\n\n[2/23/2024 7:26:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:55 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:55 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:55 PM] Executing the event fetcher workflow...\n[2/23/2024 7:26:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:55 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:55 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:55 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (313ms)\n\n[2/23/2024 7:26:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:56 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:56 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (283ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (157ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (146ms)\n\n    ✔ should fetch RPC URL (146ms)\n\n    ✔ should fetch Alt RPC URL (175ms)\n\n    ✔ should fetch Events Fetch Page Size (225ms)\n\n    ✔ should fetch NewEventsQueueURL (191ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (280ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (375ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (972ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (339ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1066ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    2) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected '{}' to equal '{\"nftId\":2,\"user\":\"0x925cc02EC7b77d44…'\n      + expected - actual\n\n      -{}\n      +{\"nftId\":2,\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"claimableAmount\":\"1\"}\n      \n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:221:54)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.16 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   92.15 |    49.48 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |      95 |    57.37 |     100 |   94.91 | 6,24,39           \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":8,"line":62},"start":{"column":13,"line":58}}}],"source":"import {ethers} from 'ethers';\nimport {OnChainEventLeverage} from './OnChainEventLeverage';\nimport {Logger, SQSService} from '@thisisarchimedes/backend-sdk';\nimport {ConfigService} from '../../services/config/ConfigService';\nimport {EventFetcherSQSMessage} from '../../types/EventFetcherSQSMessage';\nimport {EventFetcherLogEntryMessage} from '../../types/NewRelicLogEntry';\n\nexport class OnChainEventLeveragePositionExpired extends OnChainEventLeverage {\n  private claimableAmount!: bigint;\n\n  constructor(rawEventLog: ethers.providers.Log, logger: Logger, sqsService: SQSService, configService: ConfigService) {\n    super(rawEventLog, logger, sqsService, configService);\n    this.eventName = 'LeveragedPositionExpired';\n    this.parseEventLog(rawEventLog);\n  }\n\n  protected parseEventLog(eventLog: ethers.providers.Log): void {\n    this.setNftIdFromEventLogTopic(eventLog);\n    this.setUserAddressFromEventLog(eventLog);\n    this.setPositionAmountsFromEventLogData(eventLog);\n  }\n\n  protected logLeverageEvent(): void {\n    const eventDetails: EventFetcherLogEntryMessage = {\n      event: this.eventName,\n      user: this.userAddress,\n      strategy: '',\n      depositAmount: this.claimableAmount.toString(),\n    };\n\n    this.logger.info(JSON.stringify(eventDetails));\n  }\n\n  private setNftIdFromEventLogTopic(eventLog: ethers.providers.Log): void {\n    this.nftId = Number(eventLog.topics[1]);\n  }\n\n  private setUserAddressFromEventLog(eventLog: ethers.providers.Log): void {\n    const rawAddress = eventLog.topics[2];\n    const trimmedAddress = '0x' + rawAddress.slice(26);\n    this.userAddress = ethers.utils.getAddress(trimmedAddress);\n  }\n\n  private setPositionAmountsFromEventLogData(eventLog: ethers.providers.Log): void {\n    const decodedData = ethers.utils.defaultAbiCoder.decode(\n        ['uint256'],\n        eventLog.data);\n\n    this.claimableAmount = decodedData[0];\n  }\n\n  protected getSQSMessage(): EventFetcherSQSMessage {\n    const msg: EventFetcherSQSMessage = {\n      name: 'PositionExpired',\n      contractType: 3,\n      txHash: this.txHash,\n      blockNumber: this.blockNumber,\n      data: {\n        nftId: this.nftId,\n        user: this.userAddress,\n        claimableAmount: this.claimableAmount.toString(),\n      },\n    };\n\n    return msg;\n  }\n}\n"},"src/onchain_events/leverage_events/OnChainEventLeveragePositionLiquidated.ts":{"language":"typescript","mutants":[{"id":"183","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:20293) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:26:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:57 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (387ms)\n\n[2/23/2024 7:26:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:57 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:26:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (359ms)\n\n[2/23/2024 7:26:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:58 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:26:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:58 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (333ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:26:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:58 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:26:58 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:26:58 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (503ms)\n\n[2/23/2024 7:26:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:26:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:26:59 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:26:59 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (635ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (192ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (173ms)\n\n    ✔ should fetch RPC URL (212ms)\n\n    ✔ should fetch Alt RPC URL (185ms)\n\n    ✔ should fetch Events Fetch Page Size (167ms)\n\n    ✔ should fetch NewEventsQueueURL (163ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (335ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (347ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (790ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (296ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (825ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    2) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   85.09 |    46.16 |   92.95 |   85.42 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   77.13 |    40.54 |   86.88 |   77.08 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   26.56 |    16.92 |   38.46 |   26.98 | ...2,39,43,62-142 \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":17},"start":{"column":120,"line":13}}},{"id":"184","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:20427) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:03 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:03 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (364ms)\n\n[2/23/2024 7:27:04 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:04 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:04 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (291ms)\n\n[2/23/2024 7:27:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:04 PM] {\"event\":\"\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:04 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (329ms)\n\n[2/23/2024 7:27:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:04 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:04 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (348ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:05 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:05 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:05 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:05 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (296ms)\n\n[2/23/2024 7:27:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:05 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:05 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (316ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (156ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (163ms)\n\n    ✔ should fetch RPC URL (162ms)\n\n    ✔ should fetch Alt RPC URL (154ms)\n\n    ✔ should fetch Events Fetch Page Size (156ms)\n\n    ✔ should fetch NewEventsQueueURL (169ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (267ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (340ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (928ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (344ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (665ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    1) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n  1 failing\n\n\n  1) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected '' to equal 'LeveragedPositionLiquidated'\n      + expected - actual\n\n      +LeveragedPositionLiquidated\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    48.45 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   95.31 |     52.3 |     100 |   95.23 | 6,24,39           \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":15},"start":{"column":22,"line":15}}},{"id":"185","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:20428) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:03 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:04 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (397ms)\n\n[2/23/2024 7:27:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:04 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:04 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (303ms)\n\n[2/23/2024 7:27:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:04 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:27:04 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:04 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:04 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (358ms)\n\n\n  PSP Events\n\n[2/23/2024 7:27:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:05 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:05 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:05 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (327ms)\n\n[2/23/2024 7:27:05 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:05 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:05 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (297ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (159ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (144ms)\n\n    ✔ should fetch RPC URL (164ms)\n\n    ✔ should fetch Alt RPC URL (144ms)\n\n    ✔ should fetch Events Fetch Page Size (165ms)\n\n    ✔ should fetch NewEventsQueueURL (145ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (323ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (352ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1249ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (375ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (689ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    2) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'strategyName')\n      at OnChainEventLeveragePositionLiquidated.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionLiquidated.ts:3:4431)\n      at OnChainEventLeveragePositionLiquidated.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.16 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    49.14 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   95.31 |    55.38 |     100 |   95.23 | 6,24,39           \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":25},"start":{"column":65,"line":19}}},{"id":"186","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:20460) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:04 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:04 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (378ms)\n\n[2/23/2024 7:27:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:04 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:04 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (335ms)\n\n[2/23/2024 7:27:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:05 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:05 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (337ms)\n\n[2/23/2024 7:27:05 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:05 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:05 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (297ms)\n\n\n  PSP Events\n\n[2/23/2024 7:27:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:05 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:05 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:05 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (371ms)\n\n[2/23/2024 7:27:05 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:06 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:06 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (289ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (149ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (176ms)\n\n    ✔ should fetch RPC URL (164ms)\n\n    ✔ should fetch Alt RPC URL (207ms)\n\n    ✔ should fetch Events Fetch Page Size (169ms)\n\n    ✔ should fetch NewEventsQueueURL (687ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (242ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (387ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1120ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (467ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (807ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    1) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n  37 passing (10s)\n  1 failing\n\n\n  1) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected '' to equal '0'\n      + expected - actual\n\n      +0\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:210:38)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   92.15 |    48.45 |     100 |   92.01 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   95.31 |     52.3 |     100 |   95.23 | 6,24,39           \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":27,"line":24},"start":{"column":24,"line":24}}},{"id":"187","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:20518) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:27:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:05 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:05 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (433ms)\n\n[2/23/2024 7:27:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:06 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:06 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (280ms)\n\n[2/23/2024 7:27:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:06 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (304ms)\n\n[2/23/2024 7:27:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:07 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (613ms)\n\n\n  PSP Events\n\n[2/23/2024 7:27:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:07 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:07 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:07 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (268ms)\n\n[2/23/2024 7:27:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:07 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:07 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (286ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (231ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (177ms)\n\n    ✔ should fetch RPC URL (197ms)\n\n    ✔ should fetch Alt RPC URL (168ms)\n\n    ✔ should fetch Events Fetch Page Size (144ms)\n\n    ✔ should fetch NewEventsQueueURL (146ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (283ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (387ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1508ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (305ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (841ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (73ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    1) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (11s)\n  1 failing\n\n\n\n  1) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected 'LeveragedPositionClosed' to equal 'LeveragedPositionLiquidated'\n      + expected - actual\n\n      -LeveragedPositionClosed\n      +LeveragedPositionLiquidated\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.77 |    47.84 |   96.71 |   89.11 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.12 |     48.1 |     100 |   90.97 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   90.62 |    50.76 |     100 |   90.47 | 6,24,39,83-91     \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":37},"start":{"column":38,"line":27}}},{"id":"189","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:20630) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:06 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:06 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (362ms)\n\n[2/23/2024 7:27:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:06 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:06 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (304ms)\n\n[2/23/2024 7:27:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:07 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:07 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:27:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:07 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (273ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:07 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:07 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:07 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (348ms)\n\n[2/23/2024 7:27:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:08 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:08 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (262ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (165ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (166ms)\n\n    ✔ should fetch RPC URL (148ms)\n\n    ✔ should fetch Alt RPC URL (162ms)\n\n    ✔ should fetch Events Fetch Page Size (200ms)\n\n    ✔ should fetch NewEventsQueueURL (158ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (257ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (384ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1439ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (299ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (923ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (39ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    2) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected '{\"strategy\":\"0x825cc02ec7B77d4432e82e…' to equal '{\"nftId\":2,\"strategy\":\"0x825cc02ec7B7…'\n      + expected - actual\n\n      -{\"strategy\":\"0x825cc02ec7B77d4432e82e7bCAf3B89a67a555F1\",\"wbtcDebtPaid\":\"1\",\"claimableAmount\":\"2\",\"liquidationFee\":\"3\"}\n      +{\"nftId\":2,\"strategy\":\"0x825cc02ec7B77d4432e82e7bCAf3B89a67a555F1\",\"wbtcDebtPaid\":\"1\",\"claimableAmount\":\"2\",\"liquidationFee\":\"3\"}\n      \n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:221:54)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.08 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    49.14 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   95.31 |    55.38 |     100 |   95.23 | 6,24,39           \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":41},"start":{"column":75,"line":39}}},{"id":"188","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:20631) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:06 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:06 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (371ms)\n\n[2/23/2024 7:27:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:06 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (337ms)\n\n[2/23/2024 7:27:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:07 PM] {}\n\n[2/23/2024 7:27:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (512ms)\n\n[2/23/2024 7:27:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:07 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (348ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:08 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:08 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:08 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:27:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:08 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:08 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (285ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (157ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (153ms)\n\n    ✔ should fetch RPC URL (177ms)\n\n    ✔ should fetch Alt RPC URL (188ms)\n\n    ✔ should fetch Events Fetch Page Size (158ms)\n\n    ✔ should fetch NewEventsQueueURL (216ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (307ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (368ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (2041ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (425ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (871ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    2) should report on PositionLiqiuidated event\n\n    3) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (11s)\n  3 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     AssertionError: expected undefined to equal 'LeveragedPositionLiquidated'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.16 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   92.15 |    49.48 |     100 |   92.01 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   95.31 |    56.92 |     100 |   95.23 | 6,24,39           \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":34},"start":{"column":55,"line":28}}},{"id":"190","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:20686) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:08 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (307ms)\n\n[2/23/2024 7:27:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:08 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (290ms)\n\n[2/23/2024 7:27:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:09 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:27:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:09 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (335ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:09 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:09 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:09 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (298ms)\n\n[2/23/2024 7:27:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:10 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:10 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (357ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (148ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (161ms)\n\n    ✔ should fetch RPC URL (218ms)\n\n    ✔ should fetch Alt RPC URL (234ms)\n\n    ✔ should fetch Events Fetch Page Size (281ms)\n\n    ✔ should fetch NewEventsQueueURL (194ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (248ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (783ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (656ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (293ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (725ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    2) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'strategyName')\n      at OnChainEventLeveragePositionLiquidated.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionLiquidated.ts:3:4431)\n      at OnChainEventLeveragePositionLiquidated.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.15 |    47.52 |   96.24 |   88.46 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   88.73 |    46.39 |   98.36 |   88.54 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   79.68 |    43.07 |    92.3 |   79.36 | ...06-110,125-142 \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":49},"start":{"column":84,"line":43}}},{"id":"191","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":32,"line":45},"start":{"column":28,"line":45}}},{"id":"192","mutatorName":"MethodExpression","replacement":"rawAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:20800) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:15 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:16 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:16 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (497ms)\n\n[2/23/2024 7:27:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:16 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:16 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (322ms)\n\n[2/23/2024 7:27:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:16 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:27:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:17 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:17 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (367ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:17 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:17 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:17 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (280ms)\n\n[2/23/2024 7:27:17 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:17 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:17 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (321ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (154ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (148ms)\n\n    ✔ should fetch RPC URL (178ms)\n\n    ✔ should fetch Alt RPC URL (189ms)\n\n    ✔ should fetch Events Fetch Page Size (142ms)\n\n    ✔ should fetch NewEventsQueueURL (134ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (256ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (435ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (897ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (368ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (661ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    2) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.52 |    47.04 |    95.3 |   87.82 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   86.34 |    44.32 |   95.08 |   86.11 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   68.75 |    33.84 |   76.92 |   68.25 | ...,75-91,110-142 \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":45},"start":{"column":35,"line":45}}},{"id":"193","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:20857) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:17 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:17 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (529ms)\n\n[2/23/2024 7:27:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:17 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:17 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (288ms)\n\n[2/23/2024 7:27:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:18 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:27:18 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:18 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:18 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (272ms)\n\n\n  PSP Events\n\n[2/23/2024 7:27:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:18 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:18 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:18 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (287ms)\n\n[2/23/2024 7:27:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:19 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:19 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (266ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (163ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (173ms)\n\n    ✔ should fetch RPC URL (145ms)\n\n    ✔ should fetch Alt RPC URL (182ms)\n\n    ✔ should fetch Events Fetch Page Size (170ms)\n\n    ✔ should fetch NewEventsQueueURL (179ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (269ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (385ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (859ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (355ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (694ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    2) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionLiquidated.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionLiquidated.ts:3:4479)\n      at OnChainEventLeveragePositionLiquidated.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.15 |    47.36 |   96.24 |   88.46 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   88.73 |     45.7 |   98.36 |   88.54 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   79.68 |       40 |    92.3 |   79.36 | ...,39,91,117-142 \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":59},"start":{"column":84,"line":51}}},{"id":"195","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:20968) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:19 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (346ms)\n\n[2/23/2024 7:27:19 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:19 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (279ms)\n\n[2/23/2024 7:27:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:19 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:27:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:19 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (287ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:20 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:20 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:20 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (289ms)\n\n[2/23/2024 7:27:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:20 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:20 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (199ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (165ms)\n\n    ✔ should fetch RPC URL (146ms)\n\n    ✔ should fetch Alt RPC URL (179ms)\n\n    ✔ should fetch Events Fetch Page Size (177ms)\n\n    ✔ should fetch NewEventsQueueURL (173ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (283ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (326ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1009ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (339ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (656ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n  Leverage Events Logging & Queuing\n\n    3) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    4) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n  4 failing\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 'LeveragedPositionOpened'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionLiquidated.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionLiquidated.ts:3:4525)\n      at OnChainEventLeveragePositionLiquidated.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.59 |    47.68 |   96.24 |   88.92 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   90.44 |    47.07 |   98.36 |   90.27 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |    87.5 |    46.15 |    92.3 |    87.3 | ...,39,91,125-142 \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":53},"start":{"column":10,"line":53}}},{"id":"194","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:20966) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:27:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:19 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (340ms)\n\n[2/23/2024 7:27:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:19 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (299ms)\n\n[2/23/2024 7:27:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:19 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:27:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:19 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (241ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:20 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:20 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:20 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (304ms)\n\n[2/23/2024 7:27:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:20 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:20 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (158ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (192ms)\n\n    ✔ should fetch RPC URL (185ms)\n\n    ✔ should fetch Alt RPC URL (202ms)\n\n    ✔ should fetch Events Fetch Page Size (171ms)\n\n    ✔ should fetch NewEventsQueueURL (178ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (284ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (377ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1494ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (452ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (820ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    3) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n  3 failing\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionLiquidated.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionLiquidated.ts:3:4479)\n      at OnChainEventLeveragePositionLiquidated.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.59 |    47.76 |   96.24 |   88.92 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   90.44 |    47.42 |   98.36 |   90.27 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |    87.5 |    47.69 |    92.3 |    87.3 | ...,39,91,125-142 \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":42,"line":53},"start":{"column":9,"line":53}}},{"id":"196","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:21023) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:19 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (316ms)\n\n[2/23/2024 7:27:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:19 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (250ms)\n\n[2/23/2024 7:27:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:20 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:27:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:20 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (267ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:20 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:20 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:20 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (341ms)\n\n[2/23/2024 7:27:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:21 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:21 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (307ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (181ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (184ms)\n\n    ✔ should fetch RPC URL (270ms)\n\n    ✔ should fetch Alt RPC URL (278ms)\n\n    ✔ should fetch Events Fetch Page Size (209ms)\n\n    ✔ should fetch NewEventsQueueURL (173ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (276ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (418ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1296ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (365ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (776ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    2) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (11s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionLiquidated.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionLiquidated.ts:3:4525)\n      at OnChainEventLeveragePositionLiquidated.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.59 |    47.68 |   96.24 |   88.92 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   90.44 |    47.07 |   98.36 |   90.27 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |    87.5 |    46.15 |    92.3 |    87.3 | ...,39,91,125-142 \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":53},"start":{"column":21,"line":53}}},{"id":"197","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:21077) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:20 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (374ms)\n\n[2/23/2024 7:27:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:20 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (276ms)\n\n[2/23/2024 7:27:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:21 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:27:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:21 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:21 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (334ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:21 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:21 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:21 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (333ms)\n\n[2/23/2024 7:27:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:22 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:22 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (414ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (215ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (158ms)\n\n    ✔ should fetch RPC URL (178ms)\n\n    ✔ should fetch Alt RPC URL (182ms)\n\n    ✔ should fetch Events Fetch Page Size (172ms)\n\n    ✔ should fetch NewEventsQueueURL (287ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (260ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (366ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1349ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (361ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (790ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    2) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionLiquidated.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionLiquidated.ts:3:4525)\n      at OnChainEventLeveragePositionLiquidated.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.59 |    47.84 |   96.24 |   88.92 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   90.44 |    47.76 |   98.36 |   90.27 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |    87.5 |    49.23 |    92.3 |    87.3 | ...,39,91,125-142 \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":53},"start":{"column":32,"line":53}}},{"id":"198","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:21137) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:26 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:26 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:26 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (444ms)\n\n[2/23/2024 7:27:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:26 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:26 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:26 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (460ms)\n\n[2/23/2024 7:27:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:26 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:26 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:26 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:27:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:27 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:27 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (326ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:27 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:27 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:27 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (268ms)\n\n[2/23/2024 7:27:27 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:28 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:28 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (550ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (166ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (180ms)\n\n    ✔ should fetch RPC URL (171ms)\n\n    ✔ should fetch Alt RPC URL (189ms)\n\n    ✔ should fetch Events Fetch Page Size (174ms)\n\n    ✔ should fetch NewEventsQueueURL (154ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (282ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (336ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1329ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (426ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (677ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    2) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:201:35)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.68 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.12 |    47.42 |     100 |   90.97 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   90.62 |    47.69 |     100 |   90.47 | 6,24,39,128-142   \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":77},"start":{"column":53,"line":61}}},{"id":"199","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:21196) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:27 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:27 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (401ms)\n\n[2/23/2024 7:27:27 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:27 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:27 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (308ms)\n\n[2/23/2024 7:27:27 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:27 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:27 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:27 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:27:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:28 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:28 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (299ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:28 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:28 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:28 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (336ms)\n\n[2/23/2024 7:27:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:28 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:28 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (177ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (158ms)\n\n    ✔ should fetch RPC URL (305ms)\n\n    ✔ should fetch Alt RPC URL (141ms)\n\n    ✔ should fetch Events Fetch Page Size (171ms)\n\n    ✔ should fetch NewEventsQueueURL (162ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (248ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (375ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1301ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (399ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (665ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    3) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n  3 failing\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     AssertionError: expected undefined to equal 6000003\n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:219:45)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.84 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |     48.1 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   95.31 |    50.76 |     100 |   95.23 | 6,24,39           \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":74},"start":{"column":41,"line":62}}},{"id":"200","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:21251) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:28 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:28 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:28 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:29 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (405ms)\n\n[2/23/2024 7:27:29 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:29 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:29 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:29 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (450ms)\n\n[2/23/2024 7:27:29 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:29 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:29 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:29 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:27:29 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:29 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:29 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (301ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:30 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:30 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:30 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (278ms)\n\n[2/23/2024 7:27:30 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:30 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:30 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (301ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (153ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (158ms)\n\n    ✔ should fetch RPC URL (160ms)\n\n    ✔ should fetch Alt RPC URL (162ms)\n\n    ✔ should fetch Events Fetch Page Size (170ms)\n\n    ✔ should fetch NewEventsQueueURL (144ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (241ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (446ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1070ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (322ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (732ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    2) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected '' to equal 'PositionLiquidated'\n      + expected - actual\n\n      +PositionLiquidated\n      \n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:222:38)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    48.45 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   95.31 |     52.3 |     100 |   95.23 | 6,24,39           \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":63},"start":{"column":13,"line":63}}},{"id":"201","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:21307) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:30 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (390ms)\n\n[2/23/2024 7:27:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:31 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (282ms)\n\n[2/23/2024 7:27:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:31 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:31 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:27:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:31 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (290ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:31 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:31 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:31 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:31 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (285ms)\n\n[2/23/2024 7:27:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:32 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:32 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (543ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (216ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (240ms)\n\n    ✔ should fetch RPC URL (200ms)\n\n    ✔ should fetch Alt RPC URL (190ms)\n\n    ✔ should fetch Events Fetch Page Size (218ms)\n\n    ✔ should fetch NewEventsQueueURL (182ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (285ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (395ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (977ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (446ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (692ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event (55ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    2) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected '{}' to equal '{\"nftId\":2,\"strategy\":\"0x825cc02ec7B7…'\n      + expected - actual\n\n      -{}\n      +{\"nftId\":2,\"strategy\":\"0x825cc02ec7B77d4432e82e7bCAf3B89a67a555F1\",\"wbtcDebtPaid\":\"1\",\"claimableAmount\":\"2\",\"liquidationFee\":\"3\"}\n      \n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:221:54)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    48.45 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   95.31 |     52.3 |     100 |   95.23 | 6,24,39           \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":8,"line":73},"start":{"column":13,"line":67}}}],"source":"import {ethers} from 'ethers';\nimport {OnChainEventLeverage} from './OnChainEventLeverage';\nimport {Logger, SQSService} from '@thisisarchimedes/backend-sdk';\nimport {ConfigService} from '../../services/config/ConfigService';\nimport {EventFetcherSQSMessage} from '../../types/EventFetcherSQSMessage';\nimport {EventFetcherLogEntryMessage} from '../../types/NewRelicLogEntry';\n\nexport class OnChainEventLeveragePositionLiquidated extends OnChainEventLeverage {\n  private debtPaid!: bigint;\n  private claimableAmount!: bigint;\n  private liquidationFee!: bigint;\n\n  constructor(rawEventLog: ethers.providers.Log, logger: Logger, sqsService: SQSService, configService: ConfigService) {\n    super(rawEventLog, logger, sqsService, configService);\n    this.eventName = 'LeveragedPositionLiquidated';\n    this.parseEventLog(rawEventLog);\n  }\n\n  protected parseEventLog(eventLog: ethers.providers.Log): void {\n    this.setNftIdFromEventLogTopic(eventLog);\n    this.setStrategyConfigFromEventLogTopic(eventLog);\n    this.setPositionAmountsFromEventLogData(eventLog);\n\n    this.userAddress = '0';\n  }\n\n  protected logLeverageEvent(): void {\n    const eventDetails: EventFetcherLogEntryMessage = {\n      event: this.eventName,\n      user: this.userAddress,\n      strategy: this.strategyConfig.strategyName,\n      depositAmount: this.claimableAmount.toString(),\n      borrowedAmount: this.liquidationFee.toString(),\n    };\n\n    this.logger.info(JSON.stringify(eventDetails));\n  }\n\n  private setNftIdFromEventLogTopic(eventLog: ethers.providers.Log): void {\n    this.nftId = Number(eventLog.topics[1]);\n  }\n\n  private setStrategyConfigFromEventLogTopic(eventLog: ethers.providers.Log): void {\n    const rawAddress = eventLog.topics[2];\n    const trimmedAddress = '0x' + rawAddress.slice(26);\n    const strategyAddress = ethers.utils.getAddress(trimmedAddress);\n\n    this.strategyConfig = this.findStrategyConfigBStrategyAddress(strategyAddress);\n  }\n\n  private setPositionAmountsFromEventLogData(eventLog: ethers.providers.Log): void {\n    const decodedData = ethers.utils.defaultAbiCoder.decode(\n        ['uint256', 'uint256', 'uint256'],\n        eventLog.data);\n\n    this.debtPaid = decodedData[0];\n    this.claimableAmount = decodedData[1];\n    this.liquidationFee = decodedData[2];\n  }\n\n  protected getSQSMessage(): EventFetcherSQSMessage {\n    const msg: EventFetcherSQSMessage = {\n      name: 'PositionLiquidated',\n      contractType: 2,\n      txHash: this.txHash,\n      blockNumber: this.blockNumber,\n      data: {\n        nftId: this.nftId,\n        strategy: this.strategyConfig.strategyAddress,\n        wbtcDebtPaid: this.debtPaid.toString(),\n        claimableAmount: this.claimableAmount.toString(),\n        liquidationFee: this.liquidationFee.toString(),\n      },\n    };\n\n    return msg;\n  }\n}\n"},"src/onchain_events/leverage_events/OnChainEventLeveragePositionOpened.ts":{"language":"typescript","mutants":[{"id":"202","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:21364) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:31 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:27:31 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:31 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (268ms)\n\n[2/23/2024 7:27:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:32 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (621ms)\n\n[2/23/2024 7:27:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:32 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (325ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:33 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:33 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:33 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (365ms)\n\n[2/23/2024 7:27:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:33 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:33 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (339ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (203ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (220ms)\n\n    ✔ should fetch RPC URL (176ms)\n\n    ✔ should fetch Alt RPC URL (187ms)\n\n    ✔ should fetch Events Fetch Page Size (175ms)\n\n    ✔ should fetch NewEventsQueueURL (156ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (231ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (328ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1132ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (314ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (744ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.22 |     48.4 |   96.71 |   89.57 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.83 |    50.17 |     100 |    92.7 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   95.31 |    53.84 |     100 |   95.23 | 6,24,39           \n\n  ...ainEventLeveragePositionOpened.ts |   95.71 |    53.52 |     100 |   95.65 | 6,24,39           \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":18},"start":{"column":120,"line":14}}},{"id":"203","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:21442) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:32 PM] {\"event\":\"\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (377ms)\n\n[2/23/2024 7:27:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:32 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (301ms)\n\n[2/23/2024 7:27:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:33 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (337ms)\n\n[2/23/2024 7:27:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:33 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (361ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:33 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:33 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:33 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:27:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:34 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:34 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (339ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (225ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (173ms)\n\n    ✔ should fetch RPC URL (152ms)\n\n    ✔ should fetch Alt RPC URL (170ms)\n\n    ✔ should fetch Events Fetch Page Size (159ms)\n\n    ✔ should fetch NewEventsQueueURL (497ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (238ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (332ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1230ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (402ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (776ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (58ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    3) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n  3 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected '' to equal 'LeveragedPositionOpened'\n      + expected - actual\n\n      +LeveragedPositionOpened\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:186:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    48.45 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   95.71 |    52.11 |     100 |   95.65 | 6,24,39           \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":47,"line":16},"start":{"column":22,"line":16}}},{"id":"204","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:21474) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:32 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:27:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:33 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (357ms)\n\n[2/23/2024 7:27:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:33 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (324ms)\n\n[2/23/2024 7:27:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:33 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (414ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:34 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:34 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:34 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:27:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:34 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:34 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (317ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (178ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (177ms)\n\n    ✔ should fetch RPC URL (171ms)\n\n    ✔ should fetch Alt RPC URL (373ms)\n\n    ✔ should fetch Events Fetch Page Size (302ms)\n\n    ✔ should fetch NewEventsQueueURL (160ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (226ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (465ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1116ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (337ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (802ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (51ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    3) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n  3 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'strategyName')\n      at OnChainEventLeveragePositionOpened.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionOpened.ts:3:4425)\n      at OnChainEventLeveragePositionOpened.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.16 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   92.15 |    49.14 |     100 |   92.01 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   95.71 |    54.92 |     100 |   95.65 | 6,24,39           \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":26},"start":{"column":65,"line":20}}},{"id":"205","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:21534) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:38 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (395ms)\n\n[2/23/2024 7:27:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:38 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:38 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (426ms)\n\n[2/23/2024 7:27:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:38 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:38 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (292ms)\n\n[2/23/2024 7:27:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:39 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:39 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (304ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:39 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:39 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:39 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (292ms)\n\n[2/23/2024 7:27:39 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:39 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:39 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (158ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (168ms)\n\n    ✔ should fetch RPC URL (176ms)\n\n    ✔ should fetch Alt RPC URL (143ms)\n\n    ✔ should fetch Events Fetch Page Size (139ms)\n\n    ✔ should fetch NewEventsQueueURL (157ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (255ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (336ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1306ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (326ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (656ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 'LeveragedPositionOpened'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.84 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.12 |     48.1 |     100 |   90.97 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   91.42 |     50.7 |     100 |    91.3 | 6,24,39,84-92     \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":38},"start":{"column":38,"line":28}}},{"id":"206","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:21588) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:38 PM] {}\n\n[2/23/2024 7:27:38 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (473ms)\n\n[2/23/2024 7:27:38 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:38 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:38 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:39 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (298ms)\n\n[2/23/2024 7:27:39 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:39 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:39 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (298ms)\n\n[2/23/2024 7:27:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:39 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:39 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (284ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:39 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:39 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:39 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (283ms)\n\n[2/23/2024 7:27:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:40 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:40 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (152ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (185ms)\n\n    ✔ should fetch RPC URL (145ms)\n\n    ✔ should fetch Alt RPC URL (170ms)\n\n    ✔ should fetch Events Fetch Page Size (154ms)\n\n    ✔ should fetch NewEventsQueueURL (282ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (215ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (436ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1158ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (358ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (648ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 'LeveragedPositionOpened'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   92.15 |    48.45 |     100 |   92.01 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   95.71 |    52.11 |     100 |   95.65 | 6,24,39           \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":35},"start":{"column":55,"line":29}}},{"id":"207","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:21643) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:40 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:40 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:27:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:40 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:40 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (255ms)\n\n[2/23/2024 7:27:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:40 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (295ms)\n\n[2/23/2024 7:27:41 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:41 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (285ms)\n\n\n  PSP Events\n\n[2/23/2024 7:27:41 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:41 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:41 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:41 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (444ms)\n\n[2/23/2024 7:27:41 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:41 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:42 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (147ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (159ms)\n\n    ✔ should fetch RPC URL (159ms)\n\n    ✔ should fetch Alt RPC URL (144ms)\n\n    ✔ should fetch Events Fetch Page Size (153ms)\n\n    ✔ should fetch NewEventsQueueURL (172ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (278ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (427ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1150ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (306ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (690ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    3) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (9s)\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected '{\"user\":\"0x925cc02EC7b77d4432e82e7bCa…' to equal '{\"nftId\":2,\"user\":\"0x925cc02EC7b77d44…'\n      + expected - actual\n\n      -{\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"0x825cc02ec7B77d4432e82e7bCAf3B89a67a555F1\",\"collateralAmount\":\"1\",\"wbtcToBorrow\":\"2\",\"positionExpireBlock\":\"3\",\"sharesReceived\":\"4\"}\n      +{\"nftId\":2,\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"0x825cc02ec7B77d4432e82e7bCAf3B89a67a555F1\",\"collateralAmount\":\"1\",\"wbtcToBorrow\":\"2\",\"positionExpireBlock\":\"3\",\"sharesReceived\":\"4\"}\n      \n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:221:54)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.86 |    47.92 |   96.71 |    89.2 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    48.45 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    52.11 |     100 |   92.75 | 6,24,39,99-100    \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":42},"start":{"column":75,"line":40}}},{"id":"208","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:21701) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:42 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:42 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:27:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:42 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:42 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (260ms)\n\n[2/23/2024 7:27:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:43 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (290ms)\n\n[2/23/2024 7:27:43 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:43 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (575ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:43 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:43 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:44 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (286ms)\n\n[2/23/2024 7:27:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:44 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:44 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (356ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (150ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (242ms)\n\n    ✔ should fetch RPC URL (273ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (190ms)\n\n    ✔ should fetch NewEventsQueueURL (190ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (276ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (370ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1338ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (521ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (687ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (46ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'strategyName')\n      at OnChainEventLeveragePositionOpened.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionOpened.ts:3:4425)\n      at OnChainEventLeveragePositionOpened.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.15 |    47.52 |   96.24 |   88.46 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   88.73 |    46.39 |   98.36 |   88.54 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   81.42 |    43.66 |   92.85 |   81.15 | ...07-111,137-156 \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":50},"start":{"column":84,"line":44}}},{"id":"209","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:21755) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:43 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (379ms)\n\n[2/23/2024 7:27:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:43 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (291ms)\n\n[2/23/2024 7:27:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:43 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (269ms)\n\n[2/23/2024 7:27:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:44 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:44 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (305ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:44 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:44 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:44 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:27:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:44 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:44 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (185ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (195ms)\n\n    ✔ should fetch RPC URL (194ms)\n\n    ✔ should fetch Alt RPC URL (172ms)\n\n    ✔ should fetch Events Fetch Page Size (200ms)\n\n    ✔ should fetch NewEventsQueueURL (192ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (317ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (383ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1230ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (355ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (745ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.08 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   92.15 |    48.79 |     100 |   92.01 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   95.71 |    53.52 |     100 |   95.65 | 6,24,39           \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":46},"start":{"column":28,"line":46}}},{"id":"210","mutatorName":"MethodExpression","replacement":"rawAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:21864) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:44 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:27:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:44 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:44 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (317ms)\n\n[2/23/2024 7:27:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:45 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (346ms)\n\n[2/23/2024 7:27:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:45 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (284ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:45 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:45 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:45 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:27:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:46 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:46 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (239ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (167ms)\n\n    ✔ should fetch RPC URL (163ms)\n\n    ✔ should fetch Alt RPC URL (154ms)\n\n    ✔ should fetch Events Fetch Page Size (159ms)\n\n    ✔ should fetch NewEventsQueueURL (150ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (246ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (336ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (752ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (391ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (693ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    4) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n  4 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.24 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    49.48 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   95.71 |    56.33 |     100 |   95.65 | 6,24,39           \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":46},"start":{"column":35,"line":46}}},{"id":"211","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:21865) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:44 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:44 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:27:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:44 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:44 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (400ms)\n\n[2/23/2024 7:27:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:45 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (306ms)\n\n[2/23/2024 7:27:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:45 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (494ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:46 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:46 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:46 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (317ms)\n\n[2/23/2024 7:27:46 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:46 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:46 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (349ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (166ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (159ms)\n\n    ✔ should fetch RPC URL (160ms)\n\n    ✔ should fetch Alt RPC URL (152ms)\n\n    ✔ should fetch Events Fetch Page Size (184ms)\n\n    ✔ should fetch NewEventsQueueURL (193ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (231ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (337ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1074ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (329ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (746ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected '' to equal '0x925cc02EC7b77d4432e82e7bCaf3B89a67a…'\n      + expected - actual\n\n      +0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:210:38)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.68 |    47.76 |   96.71 |   89.02 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   90.78 |    47.76 |     100 |   90.62 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |      90 |    49.29 |     100 |   89.85 | 6,24,39,118-121   \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":56},"start":{"column":76,"line":52}}},{"id":"212","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:21924) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:49 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:49 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (362ms)\n\n[2/23/2024 7:27:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:49 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:49 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (290ms)\n\n[2/23/2024 7:27:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:49 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:49 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (285ms)\n\n[2/23/2024 7:27:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:50 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:50 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (321ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:50 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:50 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:50 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (311ms)\n\n[2/23/2024 7:27:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:50 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:50 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (273ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (147ms)\n\n    ✔ should fetch RPC URL (188ms)\n\n    ✔ should fetch Alt RPC URL (193ms)\n\n    ✔ should fetch Events Fetch Page Size (152ms)\n\n    ✔ should fetch NewEventsQueueURL (190ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (287ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (410ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (720ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (324ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (754ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n  1 failing\n\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    48.45 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   95.71 |    52.11 |     100 |   95.65 | 6,24,39           \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":54},"start":{"column":28,"line":54}}},{"id":"213","mutatorName":"MethodExpression","replacement":"rawAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:21979) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:50 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:27:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:50 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:50 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (405ms)\n\n[2/23/2024 7:27:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:51 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (290ms)\n\n[2/23/2024 7:27:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:51 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (300ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:51 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:51 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:51 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (288ms)\n\n[2/23/2024 7:27:52 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:52 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:52 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (343ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (163ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (159ms)\n\n    ✔ should fetch RPC URL (206ms)\n\n    ✔ should fetch Alt RPC URL (176ms)\n\n    ✔ should fetch Events Fetch Page Size (166ms)\n\n    ✔ should fetch NewEventsQueueURL (178ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (241ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (352ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (763ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (543ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (664ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event (41ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   86.62 |    46.72 |   94.36 |    86.9 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   82.93 |    42.95 |    91.8 |   82.63 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   57.14 |    29.57 |   64.28 |   56.52 | ...75-111,125-156 \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":54},"start":{"column":35,"line":54}}},{"id":"214","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:22038) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:51 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:27:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:51 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (294ms)\n\n[2/23/2024 7:27:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:52 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:52 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (282ms)\n\n[2/23/2024 7:27:52 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:52 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:52 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (285ms)\n\n\n  PSP Events\n\n[2/23/2024 7:27:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:52 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:52 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:52 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (280ms)\n\n[2/23/2024 7:27:52 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:53 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:53 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (334ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (187ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (137ms)\n\n    ✔ should fetch RPC URL (158ms)\n\n    ✔ should fetch Alt RPC URL (141ms)\n\n    ✔ should fetch Events Fetch Page Size (237ms)\n\n    ✔ should fetch NewEventsQueueURL (174ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (265ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (400ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    2) \"before each\" hook for \"should retrieve event queue URL from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (971ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (353ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (742ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    3) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (9s)\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       \"before each\" hook for \"should retrieve event queue URL from AWS\":\n     Error: Error fetching configuration for LastBlockScannedS3FileURL: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async ConfigServiceAWS.refreshLastScannedBlock (src/services/config/ConfigServiceAWS.ts:3:9914)\n      at async Promise.all (index 2)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionOpened.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionOpened.ts:3:4474)\n      at OnChainEventLeveragePositionOpened.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.33 |    47.52 |   96.24 |   88.65 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   88.39 |     45.7 |   98.36 |   88.19 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |      80 |    40.84 |   92.85 |   79.71 | ...,39,92,128-156 \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   90.04 |    46.81 |   96.15 |   90.67 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":67},"start":{"column":84,"line":58}}},{"id":"215","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:22123) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:54 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:27:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:55 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:55 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (268ms)\n\n[2/23/2024 7:27:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:55 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:55 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (290ms)\n\n[2/23/2024 7:27:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:55 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:55 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (280ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:55 PM] Executing the event fetcher workflow...\n[2/23/2024 7:27:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:55 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:55 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:56 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (309ms)\n\n[2/23/2024 7:27:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:56 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:56 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (294ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (174ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (206ms)\n\n    ✔ should fetch RPC URL (172ms)\n\n    ✔ should fetch Alt RPC URL (164ms)\n\n    ✔ should fetch Events Fetch Page Size (172ms)\n\n    ✔ should fetch NewEventsQueueURL (208ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (259ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (403ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1061ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (423ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (670ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionOpened.logLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeveragePositionOpened.ts:3:4474)\n      at OnChainEventLeveragePositionOpened.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3064)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.59 |    47.36 |   96.24 |   88.92 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   90.44 |     45.7 |   98.36 |   90.27 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   88.57 |    40.84 |   92.85 |    88.4 | ...,39,92,137-156 \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":60},"start":{"column":9,"line":60}}},{"id":"216","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:22178) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:55 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:55 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:27:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:55 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:55 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (280ms)\n\n[2/23/2024 7:27:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:55 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:55 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (343ms)\n\n[2/23/2024 7:27:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:56 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (293ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:56 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:56 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:56 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:27:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:56 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:56 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (201ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (197ms)\n\n    ✔ should fetch RPC URL (206ms)\n\n    ✔ should fetch Alt RPC URL (189ms)\n\n    ✔ should fetch Events Fetch Page Size (188ms)\n\n    ✔ should fetch NewEventsQueueURL (210ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (292ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (312ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1023ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (309ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (682ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    4) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  34 passing (10s)\n  4 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionOpened.getSQSMessage (src/onchain_events/leverage_events/OnChainEventLeveragePositionOpened.ts:3:8494)\n      at OnChainEventLeveragePositionOpened.sendSqsLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3411)\n      at OnChainEventLeveragePositionOpened.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3113)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.95 |       48 |   96.71 |   89.29 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |    91.8 |    48.45 |     100 |   91.66 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   94.28 |    52.11 |     100 |    94.2 | 6,24,39,156       \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":19,"line":60},"start":{"column":10,"line":60}}},{"id":"217","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:22210) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:55 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:55 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:27:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:55 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:55 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (282ms)\n\n[2/23/2024 7:27:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:56 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (285ms)\n\n[2/23/2024 7:27:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:56 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (336ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:56 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:56 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:56 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (330ms)\n\n[2/23/2024 7:27:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:57 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:57 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (322ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (217ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (183ms)\n\n    ✔ should fetch RPC URL (188ms)\n\n    ✔ should fetch Alt RPC URL (178ms)\n\n    ✔ should fetch Events Fetch Page Size (209ms)\n\n    ✔ should fetch NewEventsQueueURL (153ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (272ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (352ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1055ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (292ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (705ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionOpened.getSQSMessage (src/onchain_events/leverage_events/OnChainEventLeveragePositionOpened.ts:3:8494)\n      at OnChainEventLeveragePositionOpened.sendSqsLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3411)\n      at OnChainEventLeveragePositionOpened.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3113)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.95 |    48.16 |   96.71 |   89.29 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |    91.8 |    49.14 |     100 |   91.66 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   94.28 |    54.92 |     100 |    94.2 | 6,24,39,156       \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":60},"start":{"column":21,"line":60}}},{"id":"218","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:22267) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:27:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:56 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:56 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:27:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:56 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:27:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (326ms)\n\n[2/23/2024 7:27:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:57 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:27:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (331ms)\n\n[2/23/2024 7:27:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:57 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (329ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:27:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:58 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:27:58 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:27:58 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (639ms)\n\n[2/23/2024 7:27:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:27:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:27:58 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:27:58 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (298ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (165ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (154ms)\n\n    ✔ should fetch RPC URL (174ms)\n\n    ✔ should fetch Alt RPC URL (179ms)\n\n    ✔ should fetch Events Fetch Page Size (209ms)\n\n    ✔ should fetch NewEventsQueueURL (179ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (231ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (435ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (745ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (371ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (728ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionOpened.getSQSMessage (src/onchain_events/leverage_events/OnChainEventLeveragePositionOpened.ts:3:8494)\n      at OnChainEventLeveragePositionOpened.sendSqsLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3411)\n      at OnChainEventLeveragePositionOpened.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3113)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.95 |       48 |   96.71 |   89.29 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |    91.8 |    48.45 |     100 |   91.66 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   94.28 |    52.11 |     100 |    94.2 | 6,24,39,156       \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":41,"line":60},"start":{"column":32,"line":60}}},{"id":"219","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:22324) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:00 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:00 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:28:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:00 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (321ms)\n\n[2/23/2024 7:28:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:00 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (258ms)\n\n[2/23/2024 7:28:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:01 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (331ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:01 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:01 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:28:01 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (319ms)\n\n[2/23/2024 7:28:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:01 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:01 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (326ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (216ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (194ms)\n\n    ✔ should fetch RPC URL (202ms)\n\n    ✔ should fetch Alt RPC URL (174ms)\n\n    ✔ should fetch Events Fetch Page Size (204ms)\n\n    ✔ should fetch NewEventsQueueURL (237ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (264ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (319ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (943ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (303ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (664ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventLeveragePositionOpened.getSQSMessage (src/onchain_events/leverage_events/OnChainEventLeveragePositionOpened.ts:3:8494)\n      at OnChainEventLeveragePositionOpened.sendSqsLeverageEvent (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3411)\n      at OnChainEventLeveragePositionOpened.process (src/onchain_events/leverage_events/OnChainEventLeverage.ts:3:3113)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:196:11)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.95 |       48 |   96.71 |   89.29 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |    91.8 |    48.45 |     100 |   91.66 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   94.28 |    52.11 |     100 |    94.2 | 6,24,39,156       \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":60},"start":{"column":43,"line":60}}},{"id":"220","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:22380) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:01 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:01 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:28:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:01 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (294ms)\n\n[2/23/2024 7:28:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:01 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (370ms)\n\n[2/23/2024 7:28:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:02 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (299ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:02 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:02 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:28:02 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (303ms)\n\n[2/23/2024 7:28:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:02 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:02 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (377ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (322ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (156ms)\n\n    ✔ should fetch RPC URL (171ms)\n\n    ✔ should fetch Alt RPC URL (186ms)\n\n    ✔ should fetch Events Fetch Page Size (181ms)\n\n    ✔ should fetch NewEventsQueueURL (179ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (225ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (442ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (996ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (294ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (672ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:201:35)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.68 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.12 |    47.42 |     100 |   90.97 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   91.42 |    47.88 |     100 |    91.3 | 6,24,39,140-156   \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":87},"start":{"column":53,"line":69}}},{"id":"221","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:22438) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:01 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:02 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:28:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:02 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (303ms)\n\n[2/23/2024 7:28:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:02 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (331ms)\n\n[2/23/2024 7:28:02 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:03 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:03 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (398ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:03 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:03 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:28:03 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (399ms)\n\n[2/23/2024 7:28:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:03 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:03 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (310ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (215ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (176ms)\n\n    ✔ should fetch RPC URL (191ms)\n\n    ✔ should fetch Alt RPC URL (157ms)\n\n    ✔ should fetch Events Fetch Page Size (159ms)\n\n    ✔ should fetch NewEventsQueueURL (164ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (671ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (360ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (887ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (314ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (860ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 6000003\n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:219:45)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.76 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    47.76 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   95.71 |    49.29 |     100 |   95.65 | 6,24,39           \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":84},"start":{"column":41,"line":70}}},{"id":"222","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:22497) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:06 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:06 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:28:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:06 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:06 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (286ms)\n\n[2/23/2024 7:28:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:07 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (301ms)\n\n[2/23/2024 7:28:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:07 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (337ms)\n\n\n  PSP Events\n\n[2/23/2024 7:28:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:07 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:07 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:28:07 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (350ms)\n\n[2/23/2024 7:28:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:07 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:08 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (287ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (185ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (220ms)\n\n    ✔ should fetch RPC URL (202ms)\n\n    ✔ should fetch Alt RPC URL (158ms)\n\n    ✔ should fetch Events Fetch Page Size (142ms)\n\n    ✔ should fetch NewEventsQueueURL (191ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (237ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (375ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (951ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (337ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (653ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    2) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected '' to equal 'PositionOpened'\n      + expected - actual\n\n      +PositionOpened\n      \n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:222:38)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   92.15 |    48.45 |     100 |   92.01 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   95.71 |    52.11 |     100 |   95.65 | 6,24,39           \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":29,"line":71},"start":{"column":13,"line":71}}},{"id":"223","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:22610) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:07 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:07 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:28:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:07 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (324ms)\n\n[2/23/2024 7:28:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:07 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (308ms)\n\n[2/23/2024 7:28:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:08 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (356ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:08 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:08 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:28:08 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:28:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:09 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:09 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (571ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (172ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (140ms)\n\n    ✔ should fetch RPC URL (165ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (143ms)\n\n    ✔ should fetch NewEventsQueueURL (154ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (262ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (403ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (747ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (432ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (673ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    3) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected '{}' to equal '{\"nftId\":2,\"user\":\"0x925cc02EC7b77d44…'\n      + expected - actual\n\n      -{}\n      +{\"nftId\":2,\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"0x825cc02ec7B77d4432e82e7bCAf3B89a67a555F1\",\"collateralAmount\":\"1\",\"wbtcToBorrow\":\"2\",\"positionExpireBlock\":\"3\",\"sharesReceived\":\"4\"}\n      \n      at validateSQSMessage (test/unit/EventFactoryLeverage.test.ts:221:54)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:202:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.22 |     48.4 |   96.71 |   89.57 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   92.15 |    48.79 |     100 |   92.01 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   95.71 |    53.52 |     100 |   95.65 | 6,24,39           \n ...8464/src/onchain_events/psp_events |   89.92 |     49.6 |     100 |   89.68 |                   \n  OnChainEventPSP.ts                   |   93.61 |    56.41 |     100 |   93.47 | 6,24,39           \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":8,"line":83},"start":{"column":13,"line":75}}}],"source":"import {ethers} from 'ethers';\nimport {OnChainEventLeverage} from './OnChainEventLeverage';\nimport {Logger, SQSService} from '@thisisarchimedes/backend-sdk';\nimport {ConfigService} from '../../services/config/ConfigService';\nimport {EventFetcherSQSMessage} from '../../types/EventFetcherSQSMessage';\nimport {EventFetcherLogEntryMessage} from '../../types/NewRelicLogEntry';\n\nexport class OnChainEventLeveragePositionOpened extends OnChainEventLeverage {\n  private collateralAmount!: bigint;\n  private borrowedAmount!: bigint;\n  private positionExpireBlock!: number;\n  private sharesReceived!: bigint;\n\n  constructor(rawEventLog: ethers.providers.Log, logger: Logger, sqsService: SQSService, configService: ConfigService) {\n    super(rawEventLog, logger, sqsService, configService);\n    this.eventName = 'LeveragedPositionOpened';\n    this.parseEventLog(rawEventLog);\n  }\n\n  protected parseEventLog(eventLog: ethers.providers.Log): void {\n    this.setUserAddressFromEventLog(eventLog);\n    this.setStrategyConfigFromEventLogTopic(eventLog);\n    this.setNftIdFromEventLogTopic(eventLog);\n\n    this.setPositionAmountsFromEventLogData(eventLog);\n  }\n\n  protected logLeverageEvent(): void {\n    const eventDetails: EventFetcherLogEntryMessage = {\n      event: this.eventName,\n      user: this.userAddress,\n      strategy: this.strategyConfig.strategyName,\n      depositAmount: this.collateralAmount.toString(),\n      borrowedAmount: this.borrowedAmount.toString(),\n    };\n\n    this.logger.info(JSON.stringify(eventDetails));\n  }\n\n  private setNftIdFromEventLogTopic(eventLog: ethers.providers.Log): void {\n    this.nftId = Number(eventLog.topics[1]);\n  }\n\n  private setStrategyConfigFromEventLogTopic(eventLog: ethers.providers.Log): void {\n    const rawAddress = eventLog.topics[3];\n    const trimmedAddress = '0x' + rawAddress.slice(26);\n    const strategyAddress = ethers.utils.getAddress(trimmedAddress);\n\n    this.strategyConfig = this.findStrategyConfigBStrategyAddress(strategyAddress);\n  }\n\n  private setUserAddressFromEventLog(eventLog: ethers.providers.Log): void {\n    const rawAddress = eventLog.topics[2];\n    const trimmedAddress = '0x' + rawAddress.slice(26);\n    this.userAddress = ethers.utils.getAddress(trimmedAddress);\n  }\n\n  private setPositionAmountsFromEventLogData(eventLog: ethers.providers.Log): void {\n    const decodedData = ethers.utils.defaultAbiCoder.decode(\n        ['uint256', 'uint256', 'uint256', 'uint256'],\n        eventLog.data);\n\n    this.collateralAmount = decodedData[0];\n    this.borrowedAmount = decodedData[1];\n    this.positionExpireBlock = decodedData[2];\n    this.sharesReceived = decodedData[3];\n  }\n\n  protected getSQSMessage(): EventFetcherSQSMessage {\n    const msg: EventFetcherSQSMessage = {\n      name: 'PositionOpened',\n      contractType: 0,\n      txHash: this.txHash,\n      blockNumber: this.blockNumber,\n      data: {\n        nftId: this.nftId,\n        user: this.userAddress,\n        strategy: this.strategyConfig.strategyAddress,\n        collateralAmount: this.collateralAmount.toString(),\n        wbtcToBorrow: this.borrowedAmount.toString(),\n        positionExpireBlock: this.positionExpireBlock.toString(),\n        sharesReceived: this.sharesReceived.toString(),\n      },\n    };\n\n    return msg;\n  }\n}\n"},"src/onchain_events/psp_events/OnChainEventPSP.ts":{"language":"typescript","mutants":[{"id":"224","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:22611) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:07 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (336ms)\n\n[2/23/2024 7:28:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:07 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (329ms)\n\n[2/23/2024 7:28:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:07 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (315ms)\n\n[2/23/2024 7:28:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:08 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (298ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:08 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:08 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:08 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (184ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (299ms)\n\n    ✔ should fetch RPC URL (166ms)\n\n    ✔ should fetch Alt RPC URL (163ms)\n\n    ✔ should fetch Events Fetch Page Size (157ms)\n\n    ✔ should fetch NewEventsQueueURL (143ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (234ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (440ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (984ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (494ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (714ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    3) should report on Deposit event\n\n    4) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n  34 passing (9s)\n  4 failing\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n  4) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   85.18 |    46.08 |   92.48 |   85.51 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   56.58 |     29.6 |   67.85 |   56.34 |                   \n\n  OnChainEventPSP.ts                   |   36.17 |     28.2 |      50 |   36.95 | ...32,39,43,57-89 \n  OnChainEventPSPDeposit.ts            |   68.29 |    30.23 |   77.77 |    67.5 | 6,24,38-41,61-83  \n  OnChainEventPSPWithdraw.ts           |   68.29 |    30.23 |   77.77 |    67.5 | 6,24,38-41,61-83  \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":11},"start":{"column":120,"line":8}}},{"id":"225","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:22666) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:08 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (385ms)\n\n[2/23/2024 7:28:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:08 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (335ms)\n\n[2/23/2024 7:28:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:08 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (273ms)\n\n[2/23/2024 7:28:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:09 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (583ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:09 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:09 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:10 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (148ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (169ms)\n\n    ✔ should fetch RPC URL (203ms)\n\n    ✔ should fetch Alt RPC URL (169ms)\n\n    ✔ should fetch Events Fetch Page Size (177ms)\n\n    ✔ should fetch NewEventsQueueURL (175ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (255ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (356ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1053ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (370ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (714ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    3) should report on Deposit event\n\n    4) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n  4 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events Logging\n       should report on Deposit event:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:65:46)\n\n  4) PSP Events Logging\n       should report on Withdraw event:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:98:46)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.15 |     47.6 |   95.77 |   88.46 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   82.17 |     45.6 |   92.85 |   81.74 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    53.84 |     100 |   89.13 | 6,24,39,66-67     \n\n  OnChainEventPSPDeposit.ts            |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n  OnChainEventPSPWithdraw.ts           |   78.04 |    41.86 |   88.88 |    77.5 | 6,24,38-41,65-75  \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":15},"start":{"column":26,"line":13}}},{"id":"226","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:22721) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:11 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:11 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (323ms)\n\n[2/23/2024 7:28:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:11 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:11 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (315ms)\n\n[2/23/2024 7:28:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:11 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:11 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (265ms)\n\n[2/23/2024 7:28:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:12 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:12 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (300ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:12 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:12 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:12 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:12 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (177ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (185ms)\n\n    ✔ should fetch RPC URL (189ms)\n\n    ✔ should fetch Alt RPC URL (176ms)\n\n    ✔ should fetch Events Fetch Page Size (169ms)\n\n    ✔ should fetch NewEventsQueueURL (186ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (280ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (338ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (646ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (401ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (680ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    3) should report on Deposit event\n\n    4) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n  4 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events Logging\n       should report on Deposit event:\n     TypeError: Cannot read properties of undefined (reading 'strategyName')\n      at OnChainEventPSPDeposit.logPSPEvent (src/onchain_events/psp_events/OnChainEventPSPDeposit.ts:3:3740)\n      at OnChainEventPSPDeposit.process (src/onchain_events/psp_events/OnChainEventPSP.ts:3:3423)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:57:11)\n\n\n  4) PSP Events Logging\n       should report on Withdraw event:\n     TypeError: Cannot read properties of undefined (reading 'strategyName')\n      at OnChainEventPSPWithdraw.logPSPEvent (src/onchain_events/psp_events/OnChainEventPSPWithdraw.ts:3:3742)\n      at OnChainEventPSPWithdraw.process (src/onchain_events/psp_events/OnChainEventPSP.ts:3:3423)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:90:11)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.52 |    47.12 |    95.3 |   87.82 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   76.74 |       40 |   89.28 |   76.19 |                   \n\n  OnChainEventPSP.ts                   |   74.46 |    46.15 |      90 |   73.91 | 6,24,39,75-89     \n\n  OnChainEventPSPDeposit.ts            |   78.04 |     37.2 |   88.88 |    77.5 | 6,24,38-41,75-83  \n\n  OnChainEventPSPWithdraw.ts           |   78.04 |     37.2 |   88.88 |    77.5 | 6,24,38-41,75-83  \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":23},"start":{"column":65,"line":19}}},{"id":"227","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:22778) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:12 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:12 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (358ms)\n\n[2/23/2024 7:28:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:12 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:13 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (303ms)\n\n[2/23/2024 7:28:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:13 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:13 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (283ms)\n\n[2/23/2024 7:28:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:13 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:13 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (310ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:13 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:13 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:13 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:13 PM] {\"event\":\"Deposit\",\"user\":\"\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:28:13 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:14 PM] {\"event\":\"Withdraw\",\"user\":\"\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:14 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (176ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (156ms)\n\n    ✔ should fetch RPC URL (246ms)\n\n    ✔ should fetch Alt RPC URL (333ms)\n\n    ✔ should fetch Events Fetch Page Size (146ms)\n\n    ✔ should fetch NewEventsQueueURL (167ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (226ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (358ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (885ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (305ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (658ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    3) should report on Deposit event\n\n    4) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n  4 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected '' to equal '0x93B435e55881Ea20cBBAaE00eaEdAf7Ce36…'\n      + expected - actual\n\n      +0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:108:38)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:66:5)\n\n\n  4) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected '' to equal '0x22222222222222222222222222222222222…'\n      + expected - actual\n\n      +0x2222222222222222222222222222222222222222\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:108:38)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.68 |    47.76 |   96.71 |   89.02 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   86.82 |     47.2 |     100 |    86.5 |                   \n\n  OnChainEventPSP.ts                   |    85.1 |    48.71 |     100 |   84.78 | 6,24,39,86-89     \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":31},"start":{"column":76,"line":27}}},{"id":"229","mutatorName":"MethodExpression","replacement":"rawAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:22892) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:17 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:17 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (346ms)\n\n[2/23/2024 7:28:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:17 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:17 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (254ms)\n\n[2/23/2024 7:28:18 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:18 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:18 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (321ms)\n\n[2/23/2024 7:28:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:18 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:18 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (295ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:18 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:18 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:18 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:19 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (182ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (171ms)\n\n    ✔ should fetch RPC URL (172ms)\n\n    ✔ should fetch Alt RPC URL (192ms)\n\n    ✔ should fetch Events Fetch Page Size (279ms)\n\n    ✔ should fetch NewEventsQueueURL (174ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (229ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (336ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (935ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (353ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (670ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    3) should report on Deposit event\n\n    4) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n  4 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  4) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.16 |     46.8 |   94.36 |   87.45 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   73.64 |     36.8 |   82.14 |   73.01 |                   \n\n  OnChainEventPSP.ts                   |   82.97 |    51.28 |      90 |    82.6 | ...39,63-67,77-78 \n\n  OnChainEventPSPDeposit.ts            |   68.29 |    30.23 |   77.77 |    67.5 | 6,24,38-41,61-83  \n\n  OnChainEventPSPWithdraw.ts           |   68.29 |    30.23 |   77.77 |    67.5 | 6,24,38-41,61-83  \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":55,"line":29},"start":{"column":35,"line":29}}},{"id":"228","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":32,"line":29},"start":{"column":28,"line":29}}}],"source":"import {ethers} from 'ethers';\n\nimport {Logger, SQSService} from '@thisisarchimedes/backend-sdk';\nimport {OnChainEvent} from '../OnChainEvent';\nimport {ConfigService} from '../../services/config/ConfigService';\n\nexport abstract class OnChainEventPSP extends OnChainEvent {\n  constructor(rawEventLog: ethers.providers.Log, logger: Logger, sqsService: SQSService, configService: ConfigService) {\n    super(rawEventLog, logger, sqsService, configService);\n    this.parseEventLog(rawEventLog);\n  }\n\n  public process(): void {\n    this.logPSPEvent();\n  }\n\n  protected abstract logPSPEvent(): void;\n\n  protected parseEventLog(eventLog: ethers.providers.Log): void {\n    this.setUserAddressFromEventLog(eventLog);\n    this.setAmountFromEventLogData(eventLog);\n    this.strategyConfig = this.findStrategyConfigBStrategyAddress(eventLog.address);\n  }\n\n  protected abstract setAmountFromEventLogData(eventLog: ethers.providers.Log): void\n\n  private setUserAddressFromEventLog(eventLog: ethers.providers.Log): void {\n    const rawAddress = eventLog.topics[2];\n    const trimmedAddress = '0x' + rawAddress.slice(26);\n    this.userAddress = ethers.utils.getAddress(trimmedAddress);\n  }\n}\n"},"src/onchain_events/psp_events/OnChainEventPSPDeposit.ts":{"language":"typescript","mutants":[{"id":"230","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:22970) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:18 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:18 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (443ms)\n\n[2/23/2024 7:28:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:19 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (301ms)\n\n[2/23/2024 7:28:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:19 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (294ms)\n\n[2/23/2024 7:28:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:19 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (316ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:20 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:20 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:20 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:20 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (298ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (181ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (151ms)\n\n    ✔ should fetch RPC URL (150ms)\n\n    ✔ should fetch Alt RPC URL (145ms)\n\n    ✔ should fetch Events Fetch Page Size (160ms)\n\n    ✔ should fetch NewEventsQueueURL (151ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (236ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (366ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1003ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (295ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (707ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    2) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   87.16 |    47.04 |   94.83 |   87.54 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   73.64 |     39.2 |   85.71 |    73.8 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |   41.46 |    25.58 |   55.55 |    42.5 | ...32,39,43,59-83 \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":13},"start":{"column":120,"line":10}}},{"id":"231","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:23003) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:18 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:19 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (398ms)\n\n[2/23/2024 7:28:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:19 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (269ms)\n\n[2/23/2024 7:28:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:19 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (273ms)\n\n[2/23/2024 7:28:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:19 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (359ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:20 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:20 PM] {\"event\":\"\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:28:20 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:20 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:20 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (293ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (148ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (189ms)\n\n    ✔ should fetch RPC URL (159ms)\n\n    ✔ should fetch Alt RPC URL (138ms)\n\n    ✔ should fetch Events Fetch Page Size (141ms)\n\n    ✔ should fetch NewEventsQueueURL (322ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (234ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (382ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1046ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (403ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (751ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (38ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    2) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected '' to equal 'Deposit'\n      + expected - actual\n\n      +Deposit\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:55:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.08 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   89.92 |     49.6 |     100 |   89.68 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |   92.68 |    55.81 |     100 |    92.5 | 6,24,39           \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":31,"line":12},"start":{"column":22,"line":12}}},{"id":"232","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:23057) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:19 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:19 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (345ms)\n\n[2/23/2024 7:28:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:19 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:19 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (358ms)\n\n[2/23/2024 7:28:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:20 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (362ms)\n\n[2/23/2024 7:28:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:20 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (298ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:20 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:20 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:21 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:21 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (263ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (155ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (196ms)\n\n    ✔ should fetch RPC URL (324ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (185ms)\n\n    ✔ should fetch NewEventsQueueURL (170ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (228ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (436ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (841ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (304ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (768ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event (38ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    2) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events Logging\n       should report on Deposit event:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:65:46)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.24 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   89.92 |     51.2 |     100 |   89.68 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |   92.68 |    60.46 |     100 |    92.5 | 6,24,39           \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":24},"start":{"column":33,"line":15}}},{"id":"233","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:23114) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:22 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (479ms)\n\n[2/23/2024 7:28:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:22 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (264ms)\n\n[2/23/2024 7:28:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:22 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (271ms)\n\n[2/23/2024 7:28:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:22 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (263ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:23 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:23 PM] {}\n\n[2/23/2024 7:28:23 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:23 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:23 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (326ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (163ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (205ms)\n\n    ✔ should fetch RPC URL (181ms)\n\n    ✔ should fetch Alt RPC URL (197ms)\n\n    ✔ should fetch Events Fetch Page Size (165ms)\n\n    ✔ should fetch NewEventsQueueURL (216ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (277ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (386ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (825ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (426ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (838ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (43ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    2) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events Logging\n       should report on Deposit event:\n     AssertionError: expected undefined to equal 'Deposit'\n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:66:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   89.92 |     48.8 |     100 |   89.68 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |   92.68 |    53.48 |     100 |    92.5 | 6,24,39           \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":21},"start":{"column":55,"line":16}}},{"id":"234","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:23169) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:23 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:23 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (335ms)\n\n[2/23/2024 7:28:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:24 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:24 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (320ms)\n\n[2/23/2024 7:28:24 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:24 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:24 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (336ms)\n\n[2/23/2024 7:28:24 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:24 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:24 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (335ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:25 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:25 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:25 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:25 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:25 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (318ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (190ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (151ms)\n\n    ✔ should fetch RPC URL (201ms)\n\n    ✔ should fetch Alt RPC URL (303ms)\n\n    ✔ should fetch Events Fetch Page Size (153ms)\n\n    ✔ should fetch NewEventsQueueURL (187ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (229ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (363ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1313ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (381ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (662ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    2) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events Logging\n       should report on Deposit event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventPSPDeposit.logPSPEvent (src/onchain_events/psp_events/OnChainEventPSPDeposit.ts:3:3786)\n      at OnChainEventPSPDeposit.process (src/onchain_events/psp_events/OnChainEventPSP.ts:3:3423)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:57:11)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.76 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   87.59 |     46.4 |     100 |    87.3 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |   85.36 |    46.51 |     100 |      85 | 6,24,39,75,82-83  \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":28},"start":{"column":77,"line":26}}},{"id":"235","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:23228) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:29 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:29 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:29 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:29 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (408ms)\n\n[2/23/2024 7:28:29 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:29 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:29 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:29 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (266ms)\n\n[2/23/2024 7:28:29 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:29 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:29 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:29 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (315ms)\n\n[2/23/2024 7:28:30 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:30 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (319ms)\n\n\n  PSP Events\n\n[2/23/2024 7:28:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:30 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:30 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:30 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:30 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:30 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (319ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (180ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (160ms)\n\n    ✔ should fetch RPC URL (176ms)\n\n    ✔ should fetch Alt RPC URL (161ms)\n\n    ✔ should fetch Events Fetch Page Size (173ms)\n\n    ✔ should fetch NewEventsQueueURL (156ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (269ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (391ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1389ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (515ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (647ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    2) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.59 |     47.6 |   96.24 |   88.92 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   86.04 |     44.8 |   96.42 |   85.71 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |   80.48 |    41.86 |   88.88 |      80 | 6,24,39,61-75     \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":92,"line":27},"start":{"column":70,"line":27}}},{"id":"236","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:23306) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:30 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:30 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (393ms)\n\n[2/23/2024 7:28:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:30 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:30 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (313ms)\n\n[2/23/2024 7:28:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:31 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (308ms)\n\n[2/23/2024 7:28:31 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:31 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (269ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:31 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:31 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:32 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:32 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (171ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (181ms)\n\n    ✔ should fetch RPC URL (167ms)\n\n    ✔ should fetch Alt RPC URL (155ms)\n\n    ✔ should fetch Events Fetch Page Size (146ms)\n\n    ✔ should fetch NewEventsQueueURL (166ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (264ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (377ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1191ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (380ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (749ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    3) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n  3 failing\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.59 |    47.76 |   96.24 |   88.92 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   86.04 |     46.4 |   96.42 |   85.71 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |   80.48 |    46.51 |   88.88 |      80 | 6,24,39,61-75     \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":80,"line":27},"start":{"column":71,"line":27}}},{"id":"237","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n  Leverage Events\n\n(node:23361) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:28:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:30 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (381ms)\n\n[2/23/2024 7:28:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:31 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (281ms)\n\n[2/23/2024 7:28:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:31 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (309ms)\n\n[2/23/2024 7:28:31 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:31 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (269ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:32 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:32 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:32 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:32 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (308ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (166ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (157ms)\n\n    ✔ should fetch RPC URL (170ms)\n\n    ✔ should fetch Alt RPC URL (145ms)\n\n    ✔ should fetch Events Fetch Page Size (196ms)\n\n    ✔ should fetch NewEventsQueueURL (170ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (254ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (395ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1436ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (492ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (954ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (55ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    2) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n\n\nENOENT: no such file or directory, scandir '/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/.nyc_output/processinfo'\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":91,"line":27},"start":{"column":82,"line":27}}}],"source":"import {ethers} from 'ethers';\nimport {OnChainEventPSP} from './OnChainEventPSP';\nimport {Logger, SQSService} from '@thisisarchimedes/backend-sdk';\nimport {ConfigService} from '../../services/config/ConfigService';\nimport {EventFetcherLogEntryMessage} from '../../types/NewRelicLogEntry';\n\nexport class OnChainEventPSPDeposit extends OnChainEventPSP {\n  private depositAmount!: bigint;\n\n  constructor(rawEventLog: ethers.providers.Log, logger: Logger, sqsService: SQSService, configService: ConfigService) {\n    super(rawEventLog, logger, sqsService, configService);\n    this.eventName = 'Deposit';\n  }\n\n  protected logPSPEvent(): void {\n    const eventDetails: EventFetcherLogEntryMessage = {\n      event: this.eventName,\n      user: this.userAddress,\n      strategy: this.strategyConfig.strategyName,\n      depositAmount: this.depositAmount.toString(),\n    };\n\n    this.logger.info(JSON.stringify(eventDetails));\n  }\n\n  protected setAmountFromEventLogData(eventLog: ethers.providers.Log): void {\n    this.depositAmount = BigInt((ethers.utils.defaultAbiCoder.decode(['uint256', 'uint256'], eventLog.data))[1]);\n  }\n}\n"},"src/onchain_events/psp_events/OnChainEventPSPWithdraw.ts":{"language":"typescript","mutants":[{"id":"238","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:23394) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:31 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (344ms)\n\n[2/23/2024 7:28:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:31 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (309ms)\n\n[2/23/2024 7:28:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:32 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (312ms)\n\n[2/23/2024 7:28:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:32 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (297ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:32 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:32 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:32 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:28:32 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:32 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (159ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (153ms)\n\n    ✔ should fetch RPC URL (205ms)\n\n    ✔ should fetch Alt RPC URL (158ms)\n\n    ✔ should fetch Events Fetch Page Size (168ms)\n\n    ✔ should fetch NewEventsQueueURL (183ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (306ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (445ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1324ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (376ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (894ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (51ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    3) should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n\n  3 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.16 |    47.04 |   94.83 |   87.54 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   73.64 |     39.2 |   85.71 |    73.8 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |   41.46 |    25.58 |   55.55 |    42.5 | ...32,39,43,59-83 \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":13},"start":{"column":120,"line":10}}},{"id":"239","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:23450) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:31 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (323ms)\n\n[2/23/2024 7:28:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:32 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (310ms)\n\n[2/23/2024 7:28:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:32 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (281ms)\n\n[2/23/2024 7:28:32 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:32 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (245ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:32 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:32 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:28:32 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (271ms)\n\n[2/23/2024 7:28:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:33 PM] {\"event\":\"\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:33 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (195ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (152ms)\n\n    ✔ should fetch RPC URL (174ms)\n\n    ✔ should fetch Alt RPC URL (173ms)\n\n    ✔ should fetch Events Fetch Page Size (224ms)\n\n    ✔ should fetch NewEventsQueueURL (173ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (260ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (461ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1396ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (322ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (820ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (55ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    2) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected '' to equal 'Withdraw'\n      + expected - actual\n\n      +Withdraw\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:88:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.08 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   89.92 |     49.6 |     100 |   89.68 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |   92.68 |    55.81 |     100 |    92.5 | 6,24,39           \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":12},"start":{"column":22,"line":12}}},{"id":"240","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:23505) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:33 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (588ms)\n\n[2/23/2024 7:28:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:33 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:34 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (319ms)\n\n[2/23/2024 7:28:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:34 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:34 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (264ms)\n\n[2/23/2024 7:28:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:34 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:34 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (332ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:34 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:34 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:28:35 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (346ms)\n\n[2/23/2024 7:28:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:35 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (176ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (178ms)\n\n    ✔ should fetch RPC URL (165ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (243ms)\n\n    ✔ should fetch NewEventsQueueURL (179ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (316ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (358ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1024ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (365ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (819ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (44ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (56ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    2) should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected 'Deposit' to equal 'Withdraw'\n      + expected - actual\n\n      -Deposit\n      +Withdraw\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.84 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   87.59 |       48 |     100 |    87.3 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |   85.36 |    51.16 |     100 |      85 | 6,24,39,68-75     \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":24},"start":{"column":33,"line":15}}},{"id":"241","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:23560) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:35 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:35 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (371ms)\n\n[2/23/2024 7:28:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:35 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:35 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (309ms)\n\n[2/23/2024 7:28:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:35 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:35 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (329ms)\n\n[2/23/2024 7:28:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:36 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:36 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (345ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:36 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:36 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:28:36 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (315ms)\n\n[2/23/2024 7:28:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:36 PM] {}\n\n[2/23/2024 7:28:36 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (215ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (187ms)\n\n    ✔ should fetch RPC URL (184ms)\n\n    ✔ should fetch Alt RPC URL (173ms)\n\n    ✔ should fetch Events Fetch Page Size (214ms)\n\n    ✔ should fetch NewEventsQueueURL (157ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (262ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (558ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (876ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (342ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (914ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    2) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events Logging\n       should report on Withdraw event:\n     AssertionError: expected undefined to equal 'Withdraw'\n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   89.92 |     48.8 |     100 |   89.68 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |   92.68 |    53.48 |     100 |    92.5 | 6,24,39           \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":21},"start":{"column":55,"line":16}}},{"id":"242","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n  Leverage Events\n\n(node:23619) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:28:41 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:41 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (397ms)\n\n[2/23/2024 7:28:41 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:41 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (402ms)\n\n[2/23/2024 7:28:41 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:41 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (278ms)\n\n[2/23/2024 7:28:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:42 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:42 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (314ms)\n\n\n  PSP Events\n\n[2/23/2024 7:28:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:42 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:42 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:28:42 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (293ms)\n\n[2/23/2024 7:28:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:42 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (157ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (140ms)\n\n    ✔ should fetch RPC URL (221ms)\n\n    ✔ should fetch Alt RPC URL (148ms)\n\n    ✔ should fetch Events Fetch Page Size (159ms)\n\n    ✔ should fetch NewEventsQueueURL (152ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (235ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (326ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (990ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (396ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (635ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    2) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events Logging\n       should report on Withdraw event:\n     TypeError: Cannot read properties of undefined (reading 'toString')\n      at OnChainEventPSPWithdraw.logPSPEvent (src/onchain_events/psp_events/OnChainEventPSPWithdraw.ts:3:3789)\n      at OnChainEventPSPWithdraw.process (src/onchain_events/psp_events/OnChainEventPSP.ts:3:3423)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:90:11)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.76 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   87.59 |     46.4 |     100 |    87.3 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |   85.36 |    46.51 |     100 |      85 | 6,24,39,75,82-83  \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":28},"start":{"column":77,"line":26}}},{"id":"243","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:23676) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:28:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:42 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:42 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (408ms)\n\n[2/23/2024 7:28:43 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:43 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:28:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (354ms)\n\n[2/23/2024 7:28:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:43 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:28:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (309ms)\n\n[2/23/2024 7:28:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:43 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:28:43 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (292ms)\n\n\n  PSP Events\n\n[2/23/2024 7:28:44 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:44 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:28:44 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:28:44 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:28:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:44 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (186ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (164ms)\n\n    ✔ should fetch RPC URL (206ms)\n\n    ✔ should fetch Alt RPC URL (211ms)\n\n    ✔ should fetch Events Fetch Page Size (170ms)\n\n    ✔ should fetch NewEventsQueueURL (156ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (314ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (392ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (817ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (377ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (693ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (41ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    3) should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (9s)\n  3 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.59 |     47.6 |   96.24 |   88.92 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   86.04 |     44.8 |   96.42 |   85.71 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |   80.48 |    41.86 |   88.88 |      80 | 6,24,39,61-75     \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":93,"line":27},"start":{"column":71,"line":27}}},{"id":"244","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":81,"line":27},"start":{"column":72,"line":27}}},{"id":"245","mutatorName":"StringLiteral","replacement":"\"\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":92,"line":27},"start":{"column":83,"line":27}}}],"source":"import {ethers} from 'ethers';\nimport {OnChainEventPSP} from './OnChainEventPSP';\nimport {Logger, SQSService} from '@thisisarchimedes/backend-sdk';\nimport {ConfigService} from '../../services/config/ConfigService';\nimport {EventFetcherLogEntryMessage} from '../../types/NewRelicLogEntry';\n\nexport class OnChainEventPSPWithdraw extends OnChainEventPSP {\n  private withdrawAmount!: bigint;\n\n  constructor(rawEventLog: ethers.providers.Log, logger: Logger, sqsService: SQSService, configService: ConfigService) {\n    super(rawEventLog, logger, sqsService, configService);\n    this.eventName = 'Withdraw';\n  }\n\n  protected logPSPEvent(): void {\n    const eventDetails: EventFetcherLogEntryMessage = {\n      event: this.eventName,\n      user: this.userAddress,\n      strategy: this.strategyConfig.strategyName,\n      depositAmount: this.withdrawAmount.toString(),\n    };\n\n    this.logger.info(JSON.stringify(eventDetails));\n  }\n\n  protected setAmountFromEventLogData(eventLog: ethers.providers.Log): void {\n    this.withdrawAmount = BigInt((ethers.utils.defaultAbiCoder.decode(['uint256', 'uint256'], eventLog.data))[0]);\n  }\n}\n"},"src/services/blockchain/EventFetcher.ts":{"language":"typescript","mutants":[{"id":"246","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:23841) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:44 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:28:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:44 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:28:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:44 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:94:5)\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:28:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:44 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:45 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:28:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:45 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\n    ✔ should catch and report on Withdraw event (227ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (159ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (144ms)\n\n    ✔ should fetch RPC URL (157ms)\n\n    ✔ should fetch Alt RPC URL (168ms)\n\n    ✔ should fetch Events Fetch Page Size (169ms)\n\n    ✔ should fetch NewEventsQueueURL (160ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (242ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (372ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    6) should fetch on-chain events from RPC provider\n\n    7) should fetch deposit event of crvUSD/USDT strategy\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (762ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    8) should report on PositionOpened event\n\n    9) should report on PositionClosed event\n\n    10) should report on PositionLiqiuidated event\n\n    11) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    12) should report on Deposit event\n\n    13) should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    14) should return the same logs if all are unique\n\n    15) should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    16) should return a single log when all logs are duplicates\n\n\n\n\n  22 passing (9s)\n  16 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) Fetch on-chain events from blockchain\n       should fetch on-chain events from RPC provider:\n     AssertionError: expected undefined to be an array\n      at Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:19:33)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Fetch on-chain events from blockchain\n       should fetch deposit event of crvUSD/USDT strategy:\n     TypeError: Cannot read properties of undefined (reading 'find')\n      at Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:33:40)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     TypeError: eventsLog is not iterable\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:172:25)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     TypeError: eventsLog is not iterable\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:172:25)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     TypeError: eventsLog is not iterable\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:172:25)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n  11) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     TypeError: eventsLog is not iterable\n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:172:25)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n  12) PSP Events Logging\n       should report on Deposit event:\n     TypeError: eventsLog is not iterable\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:41:25)\n\n  13) PSP Events Logging\n       should report on Withdraw event:\n     TypeError: eventsLog is not iterable\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:74:25)\n\n\n  14) Inner logic functions\n       should return the same logs if all are unique:\n     TypeError: Cannot read properties of undefined (reading 'length')\n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:88:17)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n  15) Inner logic functions\n       should handle a mix of unique and duplicate logs correctly and remove duplicate logs:\n     TypeError: Cannot read properties of undefined (reading 'length')\n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:96:17)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n  16) Inner logic functions\n       should return a single log when all logs are duplicates:\n     TypeError: Cannot read properties of undefined (reading 'length')\n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:104:17)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n\n\n\n----------|---------|----------|---------|---------|-------------------\n\nFile      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n----------|---------|----------|---------|---------|-------------------\n\nAll files |       0 |        0 |       0 |       0 |                   \n\n----------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":22},"start":{"column":109,"line":10}}},{"id":"248","mutatorName":"ArithmeticOperator","replacement":"log.transactionHash + log.logIndex - log.topics[0]","status":"Survived","testsCompleted":1,"location":{"end":{"column":77,"line":14},"start":{"column":27,"line":14}}},{"id":"247","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:23897) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:45 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:28:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:45 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:28:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:46 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:28:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:46 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:46 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:28:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:47 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (181ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (160ms)\n\n    ✔ should fetch RPC URL (167ms)\n\n    ✔ should fetch Alt RPC URL (202ms)\n\n    ✔ should fetch Events Fetch Page Size (155ms)\n\n    ✔ should fetch NewEventsQueueURL (217ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (1821ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (376ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (710ms)\n\n    7) should fetch deposit event of crvUSD/USDT strategy\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (764ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    8) should report on PositionOpened event\n\n    9) should report on PositionClosed event\n\n    10) should report on PositionLiqiuidated event\n\n    11) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    12) should report on Deposit event\n\n    13) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    14) should return the same logs if all are unique\n\n    15) should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    16) should return a single log when all logs are duplicates\n\n\n\n\n\n  22 passing (11s)\n  16 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  7) Fetch on-chain events from blockchain\n       should fetch deposit event of crvUSD/USDT strategy:\n     AssertionError: expected undefined to be an object\n      at Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:35:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  11) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  12) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  13) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n  14) Inner logic functions\n       should return the same logs if all are unique:\n\n      AssertionError: expected +0 to equal 2\n      + expected - actual\n\n      -0\n      +2\n      \n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:88:28)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n  15) Inner logic functions\n       should handle a mix of unique and duplicate logs correctly and remove duplicate logs:\n\n      AssertionError: expected +0 to equal 3\n      + expected - actual\n\n      -0\n      +3\n      \n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:96:28)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n  16) Inner logic functions\n       should return a single log when all logs are duplicates:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:104:28)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   91.01 |    51.11 |     100 |    90.8 |                   \n\n  EventFetcher.ts                      |   92.68 |    55.55 |     100 |    92.5 | 6,24,39           \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":8,"line":18},"start":{"column":31,"line":13}}},{"id":"249","mutatorName":"ArithmeticOperator","replacement":"log.transactionHash - log.logIndex","status":"Survived","testsCompleted":1,"location":{"end":{"column":61,"line":14},"start":{"column":27,"line":14}}},{"id":"250","mutatorName":"BooleanLiteral","replacement":"uniqueLogs.has(uniqueKey)","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:24068) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:54 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:28:54 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:54 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:54 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:28:55 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:55 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:28:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:55 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:55 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:28:56 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:56 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (164ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (158ms)\n\n    ✔ should fetch RPC URL (161ms)\n\n    ✔ should fetch Alt RPC URL (177ms)\n\n    ✔ should fetch Events Fetch Page Size (159ms)\n\n    ✔ should fetch NewEventsQueueURL (149ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (263ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (368ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (868ms)\n\n    7) should fetch deposit event of crvUSD/USDT strategy\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (651ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    8) should report on PositionOpened event\n\n    9) should report on PositionClosed event\n\n    10) should report on PositionLiqiuidated event\n\n    11) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    12) should report on Deposit event\n\n    13) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    14) should return the same logs if all are unique\n\n    15) should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    16) should return a single log when all logs are duplicates\n\n\n\n\n\n  22 passing (9s)\n  16 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  7) Fetch on-chain events from blockchain\n       should fetch deposit event of crvUSD/USDT strategy:\n     AssertionError: expected undefined to be an object\n      at Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:35:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  11) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  12) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  13) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n  14) Inner logic functions\n       should return the same logs if all are unique:\n\n      AssertionError: expected +0 to equal 2\n      + expected - actual\n\n      -0\n      +2\n      \n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:88:28)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n  15) Inner logic functions\n       should handle a mix of unique and duplicate logs correctly and remove duplicate logs:\n\n      AssertionError: expected +0 to equal 3\n      + expected - actual\n\n      -0\n      +3\n      \n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:96:28)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n  16) Inner logic functions\n       should return a single log when all logs are duplicates:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:104:28)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   51.25 |    27.52 |   54.92 |   51.66 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   79.59 |    43.19 |     100 |   79.02 |                   \n\n  EventProcessorService.ts             |   76.04 |    40.76 |     100 |   75.53 | ...00,135-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   39.15 |     15.9 |   45.94 |   40.29 |                   \n\n  EventFactory.ts                      |   35.93 |    10.18 |    40.9 |   37.81 | 6,24,38-41,97-230 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      16 |    13.72 |   22.22 |   16.32 | 6,16-46,53-96     \n\n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n\n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n\n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n\n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n ...box7748464/src/services/blockchain |   87.64 |    48.88 |     100 |   87.35 |                   \n\n  EventFetcher.ts                      |   85.36 |    51.11 |     100 |      85 | 6,24,39,64-68     \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   87.55 |    45.69 |   94.23 |   88.13 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,100-104 \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":15},"start":{"column":13,"line":15}}},{"id":"252","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:24178) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:55 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:28:55 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:55 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:55 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:28:56 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:56 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:28:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:56 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:28:56 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:56 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:28:56 PM] Executing the event fetcher workflow...\n[2/23/2024 7:28:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:57 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (135ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (145ms)\n\n    ✔ should fetch RPC URL (152ms)\n\n    ✔ should fetch Alt RPC URL (171ms)\n\n    ✔ should fetch Events Fetch Page Size (203ms)\n\n    ✔ should fetch NewEventsQueueURL (185ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (258ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (401ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (803ms)\n\n    7) should fetch deposit event of crvUSD/USDT strategy\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (673ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (48ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (109ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    8) should report on PositionOpened event\n\n    9) should report on PositionClosed event\n\n    10) should report on PositionLiqiuidated event\n\n    11) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    12) should report on Deposit event\n\n    13) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    14) should return the same logs if all are unique\n\n    15) should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    16) should return a single log when all logs are duplicates\n\n\n\n\n\n  22 passing (10s)\n  16 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Fetch on-chain events from blockchain\n       should fetch deposit event of crvUSD/USDT strategy:\n     AssertionError: expected undefined to be an object\n      at Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:35:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  11) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  12) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  13) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n  14) Inner logic functions\n       should return the same logs if all are unique:\n\n      AssertionError: expected +0 to equal 2\n      + expected - actual\n\n      -0\n      +2\n      \n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:88:28)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n  15) Inner logic functions\n       should handle a mix of unique and duplicate logs correctly and remove duplicate logs:\n\n      AssertionError: expected +0 to equal 3\n      + expected - actual\n\n      -0\n      +3\n      \n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:96:28)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n  16) Inner logic functions\n       should return a single log when all logs are duplicates:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:104:28)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   51.25 |    27.36 |   54.92 |   51.66 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   79.59 |    43.19 |     100 |   79.02 |                   \n  EventProcessorService.ts             |   76.04 |    40.76 |     100 |   75.53 | ...00,135-157,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   39.15 |     15.9 |   45.94 |   40.29 |                   \n\n  EventFactory.ts                      |   35.93 |    10.18 |    40.9 |   37.81 | 6,24,38-41,97-230 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      16 |    13.72 |   22.22 |   16.32 | 6,16-46,53-96     \n\n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n\n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n\n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n\n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n\n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n\n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n\n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n\n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n\n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n ...box7748464/src/services/blockchain |   87.64 |    46.66 |     100 |   87.35 |                   \n\n  EventFetcher.ts                      |   85.36 |    46.66 |     100 |      85 | 6,24,39,64-68     \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   87.55 |    45.69 |   94.23 |   88.13 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,100-104 \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":39,"line":15},"start":{"column":13,"line":15}}},{"id":"251","mutatorName":"ConditionalExpression","replacement":"true","status":"Survived","testsCompleted":1,"location":{"end":{"column":39,"line":15},"start":{"column":13,"line":15}}},{"id":"253","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:24245) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:56 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:28:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:57 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:28:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:57 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:28:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:57 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:58 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:28:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:58 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (266ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (628ms)\n\n    ✔ should fetch RPC URL (173ms)\n\n    ✔ should fetch Alt RPC URL (211ms)\n\n    ✔ should fetch Events Fetch Page Size (169ms)\n\n    ✔ should fetch NewEventsQueueURL (159ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (246ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (366ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (716ms)\n\n    7) should fetch deposit event of crvUSD/USDT strategy\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (849ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (43ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    8) should report on PositionOpened event\n\n    9) should report on PositionClosed event\n\n    10) should report on PositionLiqiuidated event\n\n    11) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    12) should report on Deposit event\n\n    13) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    14) should return the same logs if all are unique\n\n    15) should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    16) should return a single log when all logs are duplicates\n\n\n\n\n\n  22 passing (10s)\n  16 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Fetch on-chain events from blockchain\n       should fetch deposit event of crvUSD/USDT strategy:\n     AssertionError: expected undefined to be an object\n      at Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:35:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n  11) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n  12) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n  13) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n  14) Inner logic functions\n       should return the same logs if all are unique:\n\n      AssertionError: expected +0 to equal 2\n      + expected - actual\n\n      -0\n      +2\n      \n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:88:28)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n  15) Inner logic functions\n       should handle a mix of unique and duplicate logs correctly and remove duplicate logs:\n\n      AssertionError: expected +0 to equal 3\n      + expected - actual\n\n      -0\n      +3\n      \n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:96:28)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n  16) Inner logic functions\n       should return a single log when all logs are duplicates:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/InnerLogicFunctions.test.ts:104:28)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at runNextTicks (node:internal/process/task_queues:64:3)\n      at listOnTimeout (node:internal/timers:540:9)\n      at processTimers (node:internal/timers:514:7)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   51.34 |     27.6 |   54.92 |   51.75 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   79.59 |    43.19 |     100 |   79.02 |                   \n\n  EventProcessorService.ts             |   76.04 |    40.76 |     100 |   75.53 | ...00,135-157,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   39.15 |     15.9 |   45.94 |   40.29 |                   \n\n  EventFactory.ts                      |   35.93 |    10.18 |    40.9 |   37.81 | 6,24,38-41,97-230 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      16 |    13.72 |   22.22 |   16.32 | 6,16-46,53-96     \n ...src/onchain_events/leverage_events |   16.72 |    12.02 |   16.39 |   17.01 |                   \n  OnChainEventLeverage.ts              |   23.68 |    22.58 |      25 |   24.32 | 6,16-46,53-70     \n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n  ...inEventLeveragePositionExpired.ts |   16.66 |    11.47 |   15.38 |   16.94 | 6,16-46,57-133    \n  ...ventLeveragePositionLiquidated.ts |   15.62 |    10.76 |   15.38 |   15.87 | 6,16-46,59-142    \n  ...ainEventLeveragePositionOpened.ts |   14.28 |     9.85 |   14.28 |   14.49 | 6,16-46,60-156    \n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n ...box7748464/src/services/blockchain |   88.76 |       50 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    53.33 |     100 |    87.5 | 6,24,39,67-68     \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   87.55 |    45.69 |   94.23 |   88.13 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   87.95 |    45.26 |      88 |      90 | ...,38-41,100-104 \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":10,"line":17},"start":{"column":41,"line":15}}}],"source":"import {ethers} from 'ethers';\n\nexport abstract class EventFetcher {\n    public abstract getOnChainEvents(\n        blockNumberFrom: number,\n        blockNumberTo: number,\n        topics: string[]\n    ): Promise<"+"ethers.providers.Log[]>;\n\n    protected dedupLogsBasedOnTxHashLogIndexAndTopic0(logs: ethers.providers.Log[]): ethers.providers.Log[] {\n      const uniqueLogs = new Map<"+"string, ethers.providers.Log>();\n\n      for (const log of logs) {\n        const uniqueKey = log.transactionHash + log.logIndex + log.topics[0];\n        if (!uniqueLogs.has(uniqueKey)) {\n          uniqueLogs.set(uniqueKey, log);\n        }\n      }\n\n      const res = Array.from(uniqueLogs.values());\n      return res;\n    }\n}\n"},"src/services/blockchain/EventFetcherRPC.ts":{"language":"typescript","mutants":[{"id":"255","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:24355) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:28:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:57 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:28:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:58 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:28:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:58 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:94:5)\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:28:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:58 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:28:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:58 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:28:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:28:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:28:59 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (163ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (158ms)\n\n    ✔ should fetch RPC URL (170ms)\n\n    ✔ should fetch Alt RPC URL (179ms)\n\n    ✔ should fetch Events Fetch Page Size (167ms)\n\n    ✔ should fetch NewEventsQueueURL (193ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (326ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (380ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    7) should fetch on-chain events from RPC provider\n\n    8) should fetch deposit event of crvUSD/USDT strategy\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (767ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (8s)\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Fetch on-chain events from blockchain\n       should fetch on-chain events from RPC provider:\n     AssertionError: expected undefined to be an array\n      at Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:19:33)\n\n\n  8) Fetch on-chain events from blockchain\n       should fetch deposit event of crvUSD/USDT strategy:\n     TypeError: Cannot read properties of undefined (reading 'find')\n      at Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:33:40)\n\n\n\n\n\n----------|---------|----------|---------|---------|-------------------\n\nFile      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n----------|---------|----------|---------|---------|-------------------\nAll files |       0 |        0 |       0 |       0 |                   \n----------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":27},"start":{"column":38,"line":18}}},{"id":"254","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:24354) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nError: Must call super constructor in derived class before accessing 'this' or returning from derived constructor\n\n    1) should process PositionOpened event and push messages to SQS\n\nError: Must call super constructor in derived class before accessing 'this' or returning from derived constructor\n\n    2) should process PositionClosed event and push messages to SQS\n\nError: Must call super constructor in derived class before accessing 'this' or returning from derived constructor\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nError: Must call super constructor in derived class before accessing 'this' or returning from derived constructor\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nError: Must call super constructor in derived class before accessing 'this' or returning from derived constructor\n\n    5) should catch and report on Deposit event\n\nError: Must call super constructor in derived class before accessing 'this' or returning from derived constructor\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (159ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (166ms)\n\n    ✔ should fetch RPC URL (179ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (188ms)\n\n    ✔ should fetch NewEventsQueueURL (171ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (268ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (382ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    7) should fetch on-chain events from RPC provider\n\n    8) should fetch deposit event of crvUSD/USDT strategy\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (878ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  30 passing (9s)\n  8 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  7) Fetch on-chain events from blockchain\n       should fetch on-chain events from RPC provider:\n     ReferenceError: Must call super constructor in derived class before accessing 'this' or returning from derived constructor\n      at new EventFetcherRPC (src/services/blockchain/EventFetcherRPC.ts:3:3311)\n      at Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:13:26)\n\n  8) Fetch on-chain events from blockchain\n       should fetch deposit event of crvUSD/USDT strategy:\n     ReferenceError: Must call super constructor in derived class before accessing 'this' or returning from derived constructor\n      at new EventFetcherRPC (src/services/blockchain/EventFetcherRPC.ts:3:3311)\n      at Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:26:26)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.33 |    47.92 |   96.71 |   88.65 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   81.63 |    44.37 |     100 |   81.11 |                   \n  EventProcessorService.ts             |   76.04 |    40.76 |     100 |   75.53 | ...00,135-157,183 \n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   93.25 |    56.66 |     100 |    93.1 |                   \n\n  EventFetcher.ts                      |   92.68 |    57.77 |     100 |    92.5 | 6,24,39           \n\n  EventFetcherRPC.ts                   |   93.75 |    55.55 |     100 |   93.61 | 6,24,39           \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":13},"start":{"column":70,"line":9}}},{"id":"262","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\nAn unexpected error occurred:\n\n\n\nSyntaxError: /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/cache/solidity-files-cache.json: Unexpected end of JSON input\n    at JSON.parse (<"+"anonymous>)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/jsonfile/index.js:33:18\n    at /Users/tomermayara/github/EventFetcherService/node_modules/graceful-fs/graceful-fs.js:123:16\n    at FSReqCallback.readFileAfterClose [as oncomplete] (node:internal/fs/read/context:68:3)\n\n-------------------|---------|----------|---------|---------|-------------------\n\nFile               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n-------------------|---------|----------|---------|---------|-------------------\n\nAll files          |     100 |      100 |     100 |     100 |                   \n\n hardhat.config.ts |     100 |      100 |     100 |     100 |                   \n\n-------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":88,"line":46},"start":{"column":57,"line":46}}},{"id":"256","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:24412) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:02 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (343ms)\n\n[2/23/2024 7:29:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:03 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:03 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (292ms)\n\n[2/23/2024 7:29:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:03 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:03 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (285ms)\n\n[2/23/2024 7:29:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:03 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:03 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (285ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:03 PM] Executing the event fetcher workflow...\n[2/23/2024 7:29:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:03 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:03 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:04 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (310ms)\n\n[2/23/2024 7:29:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:04 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:04 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (314ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (193ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (345ms)\n\n    ✔ should fetch RPC URL (177ms)\n\n    ✔ should fetch Alt RPC URL (148ms)\n\n    ✔ should fetch Events Fetch Page Size (159ms)\n\n    ✔ should fetch NewEventsQueueURL (181ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (342ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (369ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (726ms)\n\n    1) should fetch deposit event of crvUSD/USDT strategy\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (639ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n  1 failing\n\n\n\n  1) Fetch on-chain events from blockchain\n       should fetch deposit event of crvUSD/USDT strategy:\n     AssertionError: expected undefined to be an object\n      at Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:35:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   91.01 |    51.11 |     100 |    90.8 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   93.75 |    53.33 |     100 |   93.61 | 6,24,39           \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":23},"start":{"column":45,"line":19}}},{"id":"257","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:24468) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:05 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:05 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:05 PM] Error in event fetcher workflow: TypeError: Cannot read properties of undefined (reading 'toString')\n\nError in event fetcher workflow: TypeError: Cannot read properties of undefined (reading 'toString')\n    at ConfigServiceAWS.setLastScannedBlock (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:4558)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:348)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:29:06 PM] Executing the event fetcher workflow...\n[2/23/2024 7:29:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:06 PM] Error in event fetcher workflow: TypeError: Cannot read properties of undefined (reading 'toString')\n\nError in event fetcher workflow: TypeError: Cannot read properties of undefined (reading 'toString')\n    at ConfigServiceAWS.setLastScannedBlock (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:4558)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:348)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:29:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:06 PM] Error in event fetcher workflow: TypeError: Cannot read properties of undefined (reading 'toString')\nError in event fetcher workflow: TypeError: Cannot read properties of undefined (reading 'toString')\n    at ConfigServiceAWS.setLastScannedBlock (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:4558)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:348)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:94:5)\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:29:06 PM] Executing the event fetcher workflow...\n[2/23/2024 7:29:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:06 PM] Error in event fetcher workflow: TypeError: Cannot read properties of undefined (reading 'toString')\nError in event fetcher workflow: TypeError: Cannot read properties of undefined (reading 'toString')\n    at ConfigServiceAWS.setLastScannedBlock (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:4558)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:348)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:29:06 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:06 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:06 PM] Error in event fetcher workflow: TypeError: Cannot read properties of undefined (reading 'toString')\n\nError in event fetcher workflow: TypeError: Cannot read properties of undefined (reading 'toString')\n    at ConfigServiceAWS.setLastScannedBlock (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:4558)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:348)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:29:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:07 PM] Error in event fetcher workflow: TypeError: Cannot read properties of undefined (reading 'toString')\nError in event fetcher workflow: TypeError: Cannot read properties of undefined (reading 'toString')\n    at ConfigServiceAWS.setLastScannedBlock (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:4558)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:348)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (152ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (145ms)\n\n    ✔ should fetch RPC URL (142ms)\n\n    ✔ should fetch Alt RPC URL (207ms)\n\n    ✔ should fetch Events Fetch Page Size (201ms)\n\n    ✔ should fetch NewEventsQueueURL (193ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (234ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (417ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (926ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (363ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (697ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (9s)\n  6 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.06 |     47.6 |   96.24 |   88.37 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   76.87 |    41.42 |   94.44 |   76.22 |                   \n\n  EventProcessorService.ts             |   68.75 |    36.92 |    90.9 |   68.08 | ...18-157,176-180 \n\n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   87.64 |    48.88 |     100 |   87.35 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |    87.5 |    48.88 |     100 |   87.23 | 6,24,39,81-83     \n\n sandbox7748464/src/services/config    |   92.53 |    49.06 |   96.15 |   93.22 |                   \n\n  AppConfigClient.ts                   |   89.09 |    50.84 |     100 |   88.88 | 6,24,39,107-111   \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   95.14 |    50.44 |     100 |   95.09 | 6,24,38-41        \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":36},"start":{"column":57,"line":29}}},{"id":"258","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n  Leverage Events\n\n(node:24550) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:29:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:07 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:29:07 PM] Executing the event fetcher workflow...\n[2/23/2024 7:29:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:07 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:29:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:07 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:29:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:08 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:08 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:29:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:08 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (198ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (198ms)\n\n    ✔ should fetch RPC URL (164ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (167ms)\n\n    ✔ should fetch NewEventsQueueURL (155ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (297ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (412ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (847ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (326ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1260ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (89ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event (49ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    7) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    8) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (10s)\n  8 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected 'LeveragedPositionOpened' to equal 'LeveragedPositionClosed'\n      + expected - actual\n\n      -LeveragedPositionOpened\n      +LeveragedPositionClosed\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected 'LeveragedPositionLiquidated' to equal 'LeveragedPositionExpired'\n      + expected - actual\n\n      -LeveragedPositionLiquidated\n      +LeveragedPositionExpired\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.33 |    47.76 |   96.71 |   88.65 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   82.99 |    44.97 |     100 |   82.51 |                   \n  EventProcessorService.ts             |   81.25 |    43.07 |     100 |   80.85 | ...,38-41,135-157 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   91.01 |    53.33 |     100 |    90.8 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   93.75 |    57.77 |     100 |   93.61 | 6,24,39           \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":33},"start":{"column":65,"line":30}}},{"id":"260","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:24637) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:08 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:29:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:08 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:29:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:08 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:94:5)\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:29:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:08 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:09 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:29:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:09 PM] Error in event fetcher workflow: TypeError: eventLogGroup is not iterable\n\nError in event fetcher workflow: TypeError: eventLogGroup is not iterable\n    at EventProcessorService.processLogGroup (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3771)\n    at EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3469)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (166ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (168ms)\n\n    ✔ should fetch RPC URL (167ms)\n\n    ✔ should fetch Alt RPC URL (193ms)\n\n    ✔ should fetch Events Fetch Page Size (178ms)\n\n    ✔ should fetch NewEventsQueueURL (211ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (303ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (1100ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    7) should fetch on-chain events from RPC provider\n\n    8) should fetch deposit event of crvUSD/USDT strategy\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1098ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (55ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    9) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    10) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  28 passing (9s)\n  10 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  7) Fetch on-chain events from blockchain\n       should fetch on-chain events from RPC provider:\n     AssertionError: expected undefined to be an array\n      at Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:19:33)\n\n  8) Fetch on-chain events from blockchain\n       should fetch deposit event of crvUSD/USDT strategy:\n     TypeError: Cannot read properties of undefined (reading 'find')\n      at Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:33:40)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected 'LeveragedPositionLiquidated' to equal 'LeveragedPositionClosed'\n      + expected - actual\n\n      -LeveragedPositionLiquidated\n      +LeveragedPositionClosed\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n  10) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected 'Withdraw' to equal 'LeveragedPositionExpired'\n      + expected - actual\n\n      -Withdraw\n      +LeveragedPositionExpired\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.33 |    47.76 |   96.71 |   88.65 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   82.99 |    44.97 |     100 |   82.51 |                   \n  EventProcessorService.ts             |   81.25 |    43.07 |     100 |   80.85 | ...,38-41,135-157 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   91.01 |    53.33 |     100 |    90.8 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   93.75 |    57.77 |     100 |   93.61 | 6,24,39           \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":47},"start":{"column":38,"line":40}}},{"id":"261","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:24746) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:08 PM] Error in event fetcher workflow: TypeError: alchemyLogs is not iterable\n\nError in event fetcher workflow: TypeError: alchemyLogs is not iterable\n    at EventFetcherRPC.fetchLogsFromBlockchain (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/blockchain/EventFetcherRPC.ts:3:5335)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventFetcherRPC.getOnChainEvents (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/blockchain/EventFetcherRPC.ts:3:3878)\n    at async EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3324)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:29:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:09 PM] Error in event fetcher workflow: TypeError: alchemyLogs is not iterable\n\nError in event fetcher workflow: TypeError: alchemyLogs is not iterable\n    at EventFetcherRPC.fetchLogsFromBlockchain (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/blockchain/EventFetcherRPC.ts:3:5335)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventFetcherRPC.getOnChainEvents (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/blockchain/EventFetcherRPC.ts:3:3878)\n    at async EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3324)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:29:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:09 PM] Error in event fetcher workflow: TypeError: alchemyLogs is not iterable\n\nError in event fetcher workflow: TypeError: alchemyLogs is not iterable\n    at EventFetcherRPC.fetchLogsFromBlockchain (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/blockchain/EventFetcherRPC.ts:3:5335)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventFetcherRPC.getOnChainEvents (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/blockchain/EventFetcherRPC.ts:3:3878)\n    at async EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3324)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:94:5)\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:29:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:09 PM] Error in event fetcher workflow: TypeError: alchemyLogs is not iterable\n\nError in event fetcher workflow: TypeError: alchemyLogs is not iterable\n    at EventFetcherRPC.fetchLogsFromBlockchain (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/blockchain/EventFetcherRPC.ts:3:5335)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventFetcherRPC.getOnChainEvents (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/blockchain/EventFetcherRPC.ts:3:3878)\n    at async EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3324)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:09 PM] Error in event fetcher workflow: TypeError: alchemyLogs is not iterable\n\nError in event fetcher workflow: TypeError: alchemyLogs is not iterable\n    at EventFetcherRPC.fetchLogsFromBlockchain (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/blockchain/EventFetcherRPC.ts:3:5335)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventFetcherRPC.getOnChainEvents (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/blockchain/EventFetcherRPC.ts:3:3878)\n    at async EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3324)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:29:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:09 PM] Error in event fetcher workflow: TypeError: alchemyLogs is not iterable\n\nError in event fetcher workflow: TypeError: alchemyLogs is not iterable\n    at EventFetcherRPC.fetchLogsFromBlockchain (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/blockchain/EventFetcherRPC.ts:3:5335)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async EventFetcherRPC.getOnChainEvents (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/blockchain/EventFetcherRPC.ts:3:3878)\n    at async EventProcessorService.processEventsAtBlockRange (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:3324)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:265)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (184ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (192ms)\n\n    ✔ should fetch RPC URL (153ms)\n\n    ✔ should fetch Alt RPC URL (151ms)\n\n    ✔ should fetch Events Fetch Page Size (189ms)\n\n    ✔ should fetch NewEventsQueueURL (214ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (282ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (373ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    7) should fetch on-chain events from RPC provider\n\n    8) should fetch deposit event of crvUSD/USDT strategy\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1180ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (50ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (43ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (8s)\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Fetch on-chain events from blockchain\n       should fetch on-chain events from RPC provider:\n     TypeError: alchemyLogs is not iterable\n      at EventFetcherRPC.fetchLogsFromBlockchain (src/services/blockchain/EventFetcherRPC.ts:3:5335)\n      at async EventFetcherRPC.getOnChainEvents (src/services/blockchain/EventFetcherRPC.ts:3:3878)\n      at async Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:18:27)\n\n\n  8) Fetch on-chain events from blockchain\n       should fetch deposit event of crvUSD/USDT strategy:\n     TypeError: alchemyLogs is not iterable\n      at EventFetcherRPC.fetchLogsFromBlockchain (src/services/blockchain/EventFetcherRPC.ts:3:5335)\n      at async EventFetcherRPC.getOnChainEvents (src/services/blockchain/EventFetcherRPC.ts:3:3878)\n      at async Context.<"+"anonymous> (test/interface/EventFetcher.test.ts:31:27)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.33 |    47.84 |   96.71 |   88.65 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   82.99 |    44.97 |     100 |   82.51 |                   \n\n  EventProcessorService.ts             |   81.25 |    43.07 |     100 |   80.85 | ...,38-41,135-157 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   91.01 |    54.44 |     100 |    90.8 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   93.75 |       60 |     100 |   93.61 | 6,24,39           \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":44},"start":{"column":57,"line":41}}},{"id":"259","mutatorName":"MethodExpression","replacement":"Math.max(mainBlockNumber, altBlockNumber)","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:24605) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:07 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:07 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:07 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:07 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (319ms)\n\n[2/23/2024 7:29:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:08 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (348ms)\n\n[2/23/2024 7:29:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:08 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (306ms)\n\n[2/23/2024 7:29:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:08 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (288ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:08 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:08 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:09 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:29:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:09 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:09 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (295ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (172ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (179ms)\n\n    ✔ should fetch RPC URL (156ms)\n\n    ✔ should fetch Alt RPC URL (198ms)\n\n    ✔ should fetch Events Fetch Page Size (173ms)\n\n    ✔ should fetch NewEventsQueueURL (229ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (252ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (391ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (773ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (298ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1140ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (64ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (39ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  37 passing (10s)\n  1 failing\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   90.57 |    49.36 |   96.71 |   90.95 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   93.87 |    50.88 |     100 |    93.7 |                   \n  EventProcessorService.ts             |   94.79 |    49.23 |     100 |   94.68 | 6,24,38-41        \n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   91.01 |    55.55 |     100 |    90.8 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   93.75 |    62.22 |     100 |   93.61 | 6,24,39           \n sandbox7748464/src/services/config    |   92.53 |    49.06 |   96.15 |   93.22 |                   \n  AppConfigClient.ts                   |   89.09 |    50.84 |     100 |   88.88 | 6,24,39,107-111   \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   95.14 |    50.44 |     100 |   95.09 | 6,24,38-41        \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":53,"line":35},"start":{"column":12,"line":35}}}],"source":"import {ethers} from 'ethers';\nimport {EventFetcher} from './EventFetcher';\n\n\nexport class EventFetcherRPC extends EventFetcher {\n  private readonly mainProvider: ethers.providers.Provider;\n  private readonly altProvider: ethers.providers.Provider;\n\n  constructor(mainProviderRPCURL: string, altProviderRPCURL: string) {\n    super();\n    this.mainProvider = new ethers.providers.JsonRpcProvider(mainProviderRPCURL);\n    this.altProvider = new ethers.providers.JsonRpcProvider(altProviderRPCURL);\n  }\n\n  public async getOnChainEvents(blockNumberFrom: number,\n      blockNumberTo: number,\n      topics: string[],\n  ): Promise<"+"ethers.providers.Log[]> {\n    const filter: ethers.providers.Filter = {\n      topics: topics,\n      fromBlock: blockNumberFrom,\n      toBlock: blockNumberTo,\n    };\n\n    const logs = await this.fetchLogsFromBlockchain(filter);\n    return logs;\n  }\n\n  public async getCurrentBlockNumber(): Promise<"+"number> {\n    const [mainBlockNumber, altBlockNumber] = await Promise.all([\n      this.mainProvider.getBlockNumber(),\n      this.altProvider.getBlockNumber(),\n    ]);\n\n    return Math.min(mainBlockNumber, altBlockNumber);\n  }\n\n  private async fetchLogsFromBlockchain(\n      filter: ethers.providers.Filter,\n  ): Promise<"+"ethers.providers.Log[]> {\n    const [alchemyLogs, infuraLogs] = await Promise.all([\n      this.mainProvider.getLogs(filter),\n      this.altProvider.getLogs(filter),\n    ]);\n\n    return this.dedupLogsBasedOnTxHashLogIndexAndTopic0([...alchemyLogs, ...infuraLogs]);\n  }\n}\n"},"src/services/config/AppConfigClient.ts":{"language":"typescript","mutants":[{"id":"263","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:24802) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nError: Error fetching configuration for PSPStrategyInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n\n    1) should process PositionOpened event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\nError: Error fetching configuration for PSPStrategyInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n\n    2) should process PositionClosed event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\nError: Error fetching configuration for PSPStrategyInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\nError: Error fetching configuration for LeverageContractInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nError: Error fetching configuration for PSPStrategyInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n\n    5) should catch and report on Deposit event\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\nError: Error fetching configuration for PSPStrategyInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\n    7) should fetch PSP strategies via AWS AppConfig\n\n    8) should fetch Leverage addresses via AWS AppConfig\n\n    9) should fetch RPC URL\n\n    10) should fetch Alt RPC URL\n\n    11) should fetch Events Fetch Page Size\n\n    12) should fetch NewEventsQueueURL\n\n\n\n  Config Service Test\n\n    13) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\n    ✔ should fetch on-chain events from RPC provider (800ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (356ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (751ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  19 passing (5s)\n  13 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Config Service - Demo Environment\n       should fetch PSP strategies via AWS AppConfig:\n     Error: Error fetching configuration for PSPStrategyInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:16:35)\n\n\n  8) Config Service - Demo Environment\n       should fetch Leverage addresses via AWS AppConfig:\n     Error: Error fetching configuration for LeverageContractInfo: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:22:17)\n\n\n  9) Config Service - Demo Environment\n       should fetch RPC URL:\n     Error: Error fetching configuration for RpcUrl: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:41:20)\n\n\n  10) Config Service - Demo Environment\n       should fetch Alt RPC URL:\n     Error: Error fetching configuration for AltRpcUrl: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:49:20)\n\n  11) Config Service - Demo Environment\n       should fetch Events Fetch Page Size:\n     Error: Error fetching configuration for EventsFetchPageSize: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:57:36)\n\n  12) Config Service - Demo Environment\n       should fetch NewEventsQueueURL:\n     Error: Error fetching configuration for NewEventsQueueURL: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:66:20)\n\n  13) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: Error fetching configuration for LastBlockScannedS3FileURL: BadRequestException: 1 validation error detected: Value '' at 'clientId' failed to satisfy constraint: Member must have length greater than or equal to 1\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async ConfigServiceAWS.refreshLastScannedBlock (src/services/config/ConfigServiceAWS.ts:3:9914)\n      at async Promise.all (index 2)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   77.28 |    40.96 |   87.32 |   77.49 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n\n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n\n sandbox7748464/src/services/config    |   66.39 |    34.83 |   76.92 |   66.52 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | 6,24,39,75,99-111 \n\n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n\n  ConfigServiceAWS.ts                  |   59.22 |    28.31 |   83.33 |   58.82 | ...75,184-185,194 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":6},"start":{"column":39,"line":6}}},{"id":"264","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:24859) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n\n    1) should process PositionOpened event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n\n    2) should process PositionClosed event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:94:5)\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n\n    5) should catch and report on Deposit event\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    7) should fetch PSP strategies via AWS AppConfig\n\n    8) should fetch Leverage addresses via AWS AppConfig\n\n    9) should fetch RPC URL\n\n    10) should fetch Alt RPC URL\n\n    11) should fetch Events Fetch Page Size\n\n    12) should fetch NewEventsQueueURL\n\n\n\n  Config Service Test\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async initalizeObjectUnderTest (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n    13) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (854ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (319ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1195ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (38ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (45ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  19 passing (3s)\n  13 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n\n  7) Config Service - Demo Environment\n       should fetch PSP strategies via AWS AppConfig:\n     Error: Error fetching configuration for PSPStrategyInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:16:35)\n\n  8) Config Service - Demo Environment\n       should fetch Leverage addresses via AWS AppConfig:\n     Error: Error fetching configuration for LeverageContractInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:22:17)\n\n  9) Config Service - Demo Environment\n       should fetch RPC URL:\n     Error: Error fetching configuration for RpcUrl: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:41:20)\n\n  10) Config Service - Demo Environment\n       should fetch Alt RPC URL:\n     Error: Error fetching configuration for AltRpcUrl: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:49:20)\n\n  11) Config Service - Demo Environment\n       should fetch Events Fetch Page Size:\n     Error: Error fetching configuration for EventsFetchPageSize: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:57:36)\n\n  12) Config Service - Demo Environment\n       should fetch NewEventsQueueURL:\n     Error: Error fetching configuration for NewEventsQueueURL: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:66:20)\n\n  13) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: Error fetching configuration for PSPStrategyInfo: TypeError: Cannot read properties of undefined (reading 'getConfiguration')\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async ConfigServiceAWS.refreshPSPContractInfo (src/services/config/ConfigServiceAWS.ts:3:9414)\n      at async Promise.all (index 1)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |    89.4 |    48.64 |   96.71 |   89.76 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   85.03 |    46.15 |     100 |   84.61 |                   \n\n  EventProcessorService.ts             |   81.25 |    43.07 |     100 |   80.85 | ...,38-41,135-157 \n\n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   91.01 |    54.44 |     100 |    90.8 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   93.75 |       60 |     100 |   93.61 | 6,24,39           \n sandbox7748464/src/services/config    |   92.53 |    49.06 |   96.15 |   93.22 |                   \n  AppConfigClient.ts                   |   89.09 |    50.84 |     100 |   88.88 | 6,24,39,107-111   \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   95.14 |    50.44 |     100 |   95.09 | 6,24,38-41        \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":11},"start":{"column":52,"line":8}}},{"id":"266","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:24974) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\nError: \"undefined\" is not valid JSON\n\n    1) should process PositionOpened event and push messages to SQS\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\nError: \"undefined\" is not valid JSON\n    2) should process PositionClosed event and push messages to SQS\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:94:5)\n\nError: \"undefined\" is not valid JSON\n    3) should process PositionLiquidated event and push messages to SQS\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\nError: \"undefined\" is not valid JSON\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\nError: \"undefined\" is not valid JSON\n\n    5) should catch and report on Deposit event\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\nError: \"undefined\" is not valid JSON\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    7) should fetch PSP strategies via AWS AppConfig\n\n    8) should fetch Leverage addresses via AWS AppConfig\n\n    9) should fetch RPC URL\n\n    10) should fetch Alt RPC URL\n\n    11) should fetch Events Fetch Page Size\n\n    12) should fetch NewEventsQueueURL\n\n\n\n  Config Service Test\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async initalizeObjectUnderTest (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n    13) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1001ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (416ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (871ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    14) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  18 passing (3s)\n  14 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n\n\n  7) Config Service - Demo Environment\n       should fetch PSP strategies via AWS AppConfig:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:16:29)\n\n\n  8) Config Service - Demo Environment\n       should fetch Leverage addresses via AWS AppConfig:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:23:29)\n\n\n  9) Config Service - Demo Environment\n       should fetch RPC URL:\n     AssertionError: expected undefined not to be undefined\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:43:29)\n\n\n  10) Config Service - Demo Environment\n       should fetch Alt RPC URL:\n     AssertionError: expected undefined not to be undefined\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:51:29)\n\n\n  11) Config Service - Demo Environment\n       should fetch Events Fetch Page Size:\n\n      AssertionError: expected NaN to be above 1\n      + expected - actual\n\n      -NaN\n      +1\n      \n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:62:39)\n\n  12) Config Service - Demo Environment\n       should fetch NewEventsQueueURL:\n     AssertionError: expected undefined not to be undefined\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:68:29)\n\n\n  13) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at ConfigServiceAWS.refreshPSPContractInfo (src/services/config/ConfigServiceAWS.ts:3:9640)\n      at async Promise.all (index 1)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n  14) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 'LeveragedPositionOpened'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   76.66 |    40.56 |   86.85 |   76.84 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n\n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n\n sandbox7748464/src/services/config    |   63.48 |    32.95 |      75 |   63.55 |                   \n\n  AppConfigClient.ts                   |   58.18 |     32.2 |   88.88 |    57.4 | 6,24,39,68-111    \n\n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n\n  ConfigServiceAWS.ts                  |   64.07 |    28.31 |   83.33 |   63.72 | ...13-156,174-175 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":20},"start":{"column":74,"line":13}}},{"id":"267","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:25161) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\nError: \"undefined\" is not valid JSON\n\n    1) should process PositionOpened event and push messages to SQS\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\nError: \"undefined\" is not valid JSON\n\n    2) should process PositionClosed event and push messages to SQS\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:94:5)\n\nError: \"undefined\" is not valid JSON\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\nError: \"undefined\" is not valid JSON\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\nError: \"undefined\" is not valid JSON\n\n    5) should catch and report on Deposit event\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\nError: \"undefined\" is not valid JSON\n\n    ✔ should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    6) should fetch PSP strategies via AWS AppConfig\n\n    7) should fetch Leverage addresses via AWS AppConfig\n\n    8) should fetch RPC URL\n\n    9) should fetch Alt RPC URL\n\n    10) should fetch Events Fetch Page Size\n\n    11) should fetch NewEventsQueueURL\n\n\n\n  Config Service Test\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async initalizeObjectUnderTest (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n    12) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (795ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (379ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (755ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    13) should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  19 passing (3s)\n  13 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n\n  6) Config Service - Demo Environment\n       should fetch PSP strategies via AWS AppConfig:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:16:29)\n\n  7) Config Service - Demo Environment\n       should fetch Leverage addresses via AWS AppConfig:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:23:29)\n\n  8) Config Service - Demo Environment\n       should fetch RPC URL:\n     AssertionError: expected undefined not to be undefined\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:43:29)\n\n\n  9) Config Service - Demo Environment\n       should fetch Alt RPC URL:\n     AssertionError: expected undefined not to be undefined\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:51:29)\n\n\n  10) Config Service - Demo Environment\n       should fetch Events Fetch Page Size:\n\n      AssertionError: expected NaN to be above 1\n      + expected - actual\n\n      -NaN\n      +1\n      \n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:62:39)\n\n  11) Config Service - Demo Environment\n       should fetch NewEventsQueueURL:\n     AssertionError: expected undefined not to be undefined\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:68:29)\n\n  12) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at ConfigServiceAWS.refreshPSPContractInfo (src/services/config/ConfigServiceAWS.ts:3:9640)\n      at async Promise.all (index 1)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n  13) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected 'Deposit' to equal 'Withdraw'\n      + expected - actual\n\n      -Deposit\n      +Withdraw\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   77.28 |     40.8 |   87.32 |   77.49 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n\n sandbox7748464/src/services/config    |   66.39 |    34.08 |   76.92 |   66.52 |                   \n\n  AppConfigClient.ts                   |    70.9 |    37.28 |     100 |   70.37 | ...9,78-82,91-111 \n\n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n\n  ConfigServiceAWS.ts                  |   64.07 |    28.31 |   83.33 |   63.72 | ...13-156,174-175 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":17},"start":{"column":9,"line":14}}},{"id":"270","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:25217) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\nError: \"undefined\" is not valid JSON\n\n    1) should process PositionOpened event and push messages to SQS\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\nError: \"undefined\" is not valid JSON\n    2) should process PositionClosed event and push messages to SQS\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:94:5)\n\nError: \"undefined\" is not valid JSON\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\nError: \"undefined\" is not valid JSON\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\nError: \"undefined\" is not valid JSON\n\n    5) should catch and report on Deposit event\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\nError: \"undefined\" is not valid JSON\n\n    ✔ should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    6) should fetch PSP strategies via AWS AppConfig\n\n    7) should fetch Leverage addresses via AWS AppConfig\n\n    8) should fetch RPC URL\n\n    9) should fetch Alt RPC URL\n\n    10) should fetch Events Fetch Page Size\n\n    11) should fetch NewEventsQueueURL\n\n\n  Config Service Test\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async initalizeObjectUnderTest (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n    12) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (707ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (273ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (747ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    13) should report on PositionOpened event\n\n    14) should report on PositionClosed event\n\n    15) should report on PositionLiqiuidated event\n\n    16) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  16 passing (2s)\n  16 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n\n\n  6) Config Service - Demo Environment\n       should fetch PSP strategies via AWS AppConfig:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:16:29)\n\n  7) Config Service - Demo Environment\n       should fetch Leverage addresses via AWS AppConfig:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:23:29)\n\n\n  8) Config Service - Demo Environment\n       should fetch RPC URL:\n     AssertionError: expected undefined not to be undefined\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:43:29)\n\n\n  9) Config Service - Demo Environment\n       should fetch Alt RPC URL:\n     AssertionError: expected undefined not to be undefined\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:51:29)\n\n\n  10) Config Service - Demo Environment\n       should fetch Events Fetch Page Size:\n\n      AssertionError: expected NaN to be above 1\n      + expected - actual\n\n      -NaN\n      +1\n      \n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:62:39)\n\n  11) Config Service - Demo Environment\n       should fetch NewEventsQueueURL:\n     AssertionError: expected undefined not to be undefined\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:68:29)\n\n  12) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at ConfigServiceAWS.refreshPSPContractInfo (src/services/config/ConfigServiceAWS.ts:3:9640)\n      at async Promise.all (index 1)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n  13) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected 'LeveragedPositionClosed' to equal 'LeveragedPositionOpened'\n      + expected - actual\n\n      -LeveragedPositionClosed\n      +LeveragedPositionOpened\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n  14) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected 'LeveragedPositionLiquidated' to equal 'LeveragedPositionClosed'\n      + expected - actual\n\n      -LeveragedPositionLiquidated\n      +LeveragedPositionClosed\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n  15) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected 'LeveragedPositionExpired' to equal 'LeveragedPositionLiquidated'\n      + expected - actual\n\n      -LeveragedPositionExpired\n      +LeveragedPositionLiquidated\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n  16) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected 'Deposit' to equal 'LeveragedPositionExpired'\n      + expected - actual\n\n      -Deposit\n      +LeveragedPositionExpired\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   77.28 |     40.8 |   87.32 |   77.49 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n\n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n\n sandbox7748464/src/services/config    |   66.39 |    34.08 |   76.92 |   66.52 |                   \n\n  AppConfigClient.ts                   |    70.9 |    37.28 |     100 |   70.37 | ...9,78-82,91-111 \n\n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n\n  ConfigServiceAWS.ts                  |   64.07 |    28.31 |   83.33 |   63.72 | ...13-156,174-175 \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":37},"start":{"column":77,"line":22}}},{"id":"271","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:25249) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Expected a non-null value for ClientId\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError: Expected a non-null value for ClientId\n\n    1) should process PositionOpened event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Expected a non-null value for ClientId\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError: Expected a non-null value for ClientId\n\n    2) should process PositionClosed event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Expected a non-null value for ClientId\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:94:5)\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError: Expected a non-null value for ClientId\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Expected a non-null value for ClientId\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError: Expected a non-null value for ClientId\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Expected a non-null value for ClientId\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError: Expected a non-null value for ClientId\n\n    5) should catch and report on Deposit event\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Expected a non-null value for ClientId\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError: Expected a non-null value for ClientId\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    7) should fetch PSP strategies via AWS AppConfig\n\n    8) should fetch Leverage addresses via AWS AppConfig\n\n    9) should fetch RPC URL\n\n    10) should fetch Alt RPC URL\n\n    11) should fetch Events Fetch Page Size\n\n    12) should fetch NewEventsQueueURL\n\n\n\n  Config Service Test\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError: Expected a non-null value for ClientId\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async initalizeObjectUnderTest (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n    13) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (880ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (393ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (723ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  19 passing (3s)\n  13 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n\n  7) Config Service - Demo Environment\n       should fetch PSP strategies via AWS AppConfig:\n     Error: Error fetching configuration for PSPStrategyInfo: TypeError: Expected a non-null value for ClientId\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:16:35)\n\n  8) Config Service - Demo Environment\n       should fetch Leverage addresses via AWS AppConfig:\n     Error: Error fetching configuration for LeverageContractInfo: TypeError: Expected a non-null value for ClientId\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:22:17)\n\n\n  9) Config Service - Demo Environment\n       should fetch RPC URL:\n     Error: Error fetching configuration for RpcUrl: TypeError: Expected a non-null value for ClientId\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:41:20)\n\n\n  10) Config Service - Demo Environment\n       should fetch Alt RPC URL:\n     Error: Error fetching configuration for AltRpcUrl: TypeError: Expected a non-null value for ClientId\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:49:20)\n\n\n  11) Config Service - Demo Environment\n       should fetch Events Fetch Page Size:\n     Error: Error fetching configuration for EventsFetchPageSize: TypeError: Expected a non-null value for ClientId\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:57:36)\n\n\n  12) Config Service - Demo Environment\n       should fetch NewEventsQueueURL:\n     Error: Error fetching configuration for NewEventsQueueURL: TypeError: Expected a non-null value for ClientId\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:66:20)\n\n\n  13) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: Error fetching configuration for PSPStrategyInfo: TypeError: Expected a non-null value for ClientId\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async ConfigServiceAWS.refreshPSPContractInfo (src/services/config/ConfigServiceAWS.ts:3:9414)\n      at async Promise.all (index 1)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   77.82 |    41.12 |   87.32 |   78.04 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n\n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n\n sandbox7748464/src/services/config    |   68.87 |    35.58 |   76.92 |   69.06 |                   \n\n  AppConfigClient.ts                   |   81.81 |    44.06 |     100 |   81.48 | 6,24,39,99-111    \n\n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n\n  ConfigServiceAWS.ts                  |   64.07 |    28.31 |   83.33 |   63.72 | ...13-156,174-175 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":28},"start":{"column":20,"line":23}}},{"id":"265","mutatorName":"ObjectLiteral","replacement":"{}","status":"Survived","testsCompleted":1,"location":{"end":{"column":58,"line":9},"start":{"column":42,"line":9}}},{"id":"268","mutatorName":"BlockStatement","replacement":"{}","status":"Survived","testsCompleted":1,"location":{"end":{"column":6,"line":19},"start":{"column":21,"line":17}}},{"id":"269","mutatorName":"StringLiteral","replacement":"``","status":"Survived","testsCompleted":1,"location":{"end":{"column":81,"line":18},"start":{"column":23,"line":18}}},{"id":"273","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:25419) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: Error: Configuration LeverageContractInfo not found or is empty.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\nError: Error fetching configuration for LeverageContractInfo: Error: Configuration LeverageContractInfo not found or is empty.\n\n    1) should process PositionOpened event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: Error: Configuration LeverageContractInfo not found or is empty.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\nError: Error fetching configuration for LeverageContractInfo: Error: Configuration LeverageContractInfo not found or is empty.\n\n    2) should process PositionClosed event and push messages to SQS\n\nError: Error fetching configuration for PSPStrategyInfo: Error: Configuration PSPStrategyInfo not found or is empty.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: Error: Configuration LeverageContractInfo not found or is empty.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: Error: Configuration LeverageContractInfo not found or is empty.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\nError: Error fetching configuration for LeverageContractInfo: Error: Configuration LeverageContractInfo not found or is empty.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: Error: Configuration LeverageContractInfo not found or is empty.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\nError: Error fetching configuration for LeverageContractInfo: Error: Configuration LeverageContractInfo not found or is empty.\n\n    5) should catch and report on Deposit event\n\nError: Error fetching configuration for PSPStrategyInfo: Error: Configuration PSPStrategyInfo not found or is empty.\n\n    ✔ should catch and report on Withdraw event (354ms)\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: Error: Configuration LeverageContractInfo not found or is empty.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\n\n\n  Config Service - Demo Environment\n\n    6) should fetch PSP strategies via AWS AppConfig\n\n    7) should fetch Leverage addresses via AWS AppConfig\n\n    8) should fetch RPC URL\n\n    9) should fetch Alt RPC URL\n\n    10) should fetch Events Fetch Page Size\n\n    11) should fetch NewEventsQueueURL\n\n\n\n  Config Service Test\n\n    12) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: Error: Configuration LeverageContractInfo not found or is empty.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\n    ✔ should fetch on-chain events from RPC provider (791ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (272ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (876ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (65ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  20 passing (5s)\n\n  12 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) Config Service - Demo Environment\n       should fetch PSP strategies via AWS AppConfig:\n     Error: Error fetching configuration for PSPStrategyInfo: Error: Configuration PSPStrategyInfo not found or is empty.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:16:35)\n\n\n  7) Config Service - Demo Environment\n       should fetch Leverage addresses via AWS AppConfig:\n     Error: Error fetching configuration for LeverageContractInfo: Error: Configuration LeverageContractInfo not found or is empty.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:22:17)\n\n\n  8) Config Service - Demo Environment\n       should fetch RPC URL:\n     Error: Error fetching configuration for RpcUrl: Error: Configuration RpcUrl not found or is empty.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:41:20)\n\n\n  9) Config Service - Demo Environment\n       should fetch Alt RPC URL:\n     Error: Error fetching configuration for AltRpcUrl: Error: Configuration AltRpcUrl not found or is empty.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:49:20)\n\n\n  10) Config Service - Demo Environment\n       should fetch Events Fetch Page Size:\n     Error: Error fetching configuration for EventsFetchPageSize: Error: Configuration EventsFetchPageSize not found or is empty.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:57:36)\n\n  11) Config Service - Demo Environment\n       should fetch NewEventsQueueURL:\n     Error: Error fetching configuration for NewEventsQueueURL: Error: Configuration NewEventsQueueURL not found or is empty.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:66:20)\n\n  12) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: Error fetching configuration for PSPStrategyInfo: Error: Configuration PSPStrategyInfo not found or is empty.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async ConfigServiceAWS.refreshPSPContractInfo (src/services/config/ConfigServiceAWS.ts:3:9414)\n      at async Promise.all (index 1)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   90.21 |    48.72 |   96.71 |   90.59 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   90.47 |    48.52 |     100 |    90.2 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   93.77 |    50.18 |   96.15 |   94.49 |                   \n  AppConfigClient.ts                   |   94.54 |    55.93 |     100 |   94.44 | 6,24,39           \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   95.14 |    50.44 |     100 |   95.09 | 6,24,38-41        \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":25,"line":32},"start":{"column":9,"line":32}}},{"id":"274","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:25420) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nError: \"undefined\" is not valid JSON\n\n    1) should process PositionOpened event and push messages to SQS\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\nError: \"undefined\" is not valid JSON\n\n    2) should process PositionClosed event and push messages to SQS\n\nError: \"undefined\" is not valid JSON\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\nError: \"undefined\" is not valid JSON\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\nError: \"undefined\" is not valid JSON\n\n    5) should catch and report on Deposit event\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\nError: \"undefined\" is not valid JSON\n\n    ✔ should catch and report on Withdraw event (385ms)\n\n\n\n  Config Service - Demo Environment\n\n    6) should fetch PSP strategies via AWS AppConfig\n\n    7) should fetch Leverage addresses via AWS AppConfig\n\n    8) should fetch RPC URL\n\n    9) should fetch Alt RPC URL\n\n    10) should fetch Events Fetch Page Size\n\n    11) should fetch NewEventsQueueURL\n\n\n\n  Config Service Test\n\n    12) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n  Fetch on-chain events from blockchain\n\nFailed to refresh leverage contract addresses: SyntaxError: \"undefined\" is not valid JSON\n    at JSON.parse (<"+"anonymous>)\n    at ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:6141)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\n    ✔ should fetch on-chain events from RPC provider (976ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (484ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (925ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  20 passing (6s)\n  12 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) Config Service - Demo Environment\n       should fetch PSP strategies via AWS AppConfig:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:16:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  7) Config Service - Demo Environment\n       should fetch Leverage addresses via AWS AppConfig:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:23:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  8) Config Service - Demo Environment\n       should fetch RPC URL:\n     AssertionError: expected undefined not to be undefined\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:43:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  9) Config Service - Demo Environment\n       should fetch Alt RPC URL:\n     AssertionError: expected undefined not to be undefined\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:51:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  10) Config Service - Demo Environment\n       should fetch Events Fetch Page Size:\n\n      AssertionError: expected NaN to be above 1\n      + expected - actual\n\n      -NaN\n      +1\n      \n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:62:39)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  11) Config Service - Demo Environment\n       should fetch NewEventsQueueURL:\n     AssertionError: expected undefined not to be undefined\n      at Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:68:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  12) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at ConfigServiceAWS.refreshPSPContractInfo (src/services/config/ConfigServiceAWS.ts:3:9640)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Promise.all (index 1)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   77.73 |    41.12 |   87.32 |   77.95 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n sandbox7748464/src/services/config    |   68.46 |    35.58 |   76.92 |   68.64 |                   \n  AppConfigClient.ts                   |      80 |    44.06 |     100 |   79.62 | ...,78-82,103-111 \n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n  ConfigServiceAWS.ts                  |   64.07 |    28.31 |   83.33 |   63.72 | ...13-156,174-175 \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":34},"start":{"column":27,"line":32}}},{"id":"275","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:25474) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nError: Error fetching configuration for LastBlockScannedS3FileURL: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n\n    1) should process PositionOpened event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\nError: Error fetching configuration for RpcUrl: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n\n    2) should process PositionClosed event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n\n    3) should process PositionLiquidated event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\nError: Error fetching configuration for LeverageContractInfo: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\nError: Error fetching configuration for LeverageContractInfo: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n\n    5) should catch and report on Deposit event\n\nError: Error fetching configuration for PSPStrategyInfo: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n\n    ✔ should catch and report on Withdraw event (203ms)\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\n\n\n  Config Service - Demo Environment\n\n    6) should fetch PSP strategies via AWS AppConfig\n\n    7) should fetch Leverage addresses via AWS AppConfig\n\n    8) should fetch RPC URL\n\n    9) should fetch Alt RPC URL\n\n    10) should fetch Events Fetch Page Size\n\n    11) should fetch NewEventsQueueURL\n\n\n\n  Config Service Test\n\n    12) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1053ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (377ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (776ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  20 passing (6s)\n\n  12 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) Config Service - Demo Environment\n       should fetch PSP strategies via AWS AppConfig:\n     Error: Error fetching configuration for PSPStrategyInfo: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:16:35)\n\n  7) Config Service - Demo Environment\n       should fetch Leverage addresses via AWS AppConfig:\n     Error: Error fetching configuration for LeverageContractInfo: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:22:17)\n\n\n  8) Config Service - Demo Environment\n       should fetch RPC URL:\n     Error: Error fetching configuration for RpcUrl: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:41:20)\n\n\n  9) Config Service - Demo Environment\n       should fetch Alt RPC URL:\n     Error: Error fetching configuration for AltRpcUrl: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:49:20)\n\n\n  10) Config Service - Demo Environment\n       should fetch Events Fetch Page Size:\n     Error: Error fetching configuration for EventsFetchPageSize: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:57:36)\n\n  11) Config Service - Demo Environment\n       should fetch NewEventsQueueURL:\n     Error: Error fetching configuration for NewEventsQueueURL: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Context.<"+"anonymous> (test/interface/AWSAppConfig.test.ts:66:20)\n\n  12) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: Error fetching configuration for RpcUrl: TypeError [ERR_UNKNOWN_ENCODING]: Unknown encoding: \n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async Promise.all (index 0)\n      at async ConfigServiceAWS.refreshRPCURL (src/services/config/ConfigServiceAWS.ts:3:10749)\n      at async Promise.all (index 3)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   78.18 |    41.44 |   87.32 |   78.41 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n sandbox7748464/src/services/config    |   70.53 |    37.07 |   76.92 |   70.76 |                   \n  AppConfigClient.ts                   |   89.09 |    50.84 |     100 |   88.88 | 6,24,39,107-111   \n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n\n  ConfigServiceAWS.ts                  |   64.07 |    28.31 |   83.33 |   63.72 | ...13-156,174-175 \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":33},"start":{"column":53,"line":33}}},{"id":"272","mutatorName":"ConditionalExpression","replacement":"true","status":"Survived","testsCompleted":1,"location":{"end":{"column":25,"line":32},"start":{"column":9,"line":32}}},{"id":"276","mutatorName":"BlockStatement","replacement":"{}","status":"Survived","testsCompleted":1,"location":{"end":{"column":6,"line":36},"start":{"column":12,"line":34}}},{"id":"277","mutatorName":"StringLiteral","replacement":"``","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:25590) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:31 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (558ms)\n\n[2/23/2024 7:29:32 PM] Executing the event fetcher workflow...\n[2/23/2024 7:29:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:32 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (325ms)\n\n[2/23/2024 7:29:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:32 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (488ms)\n\n[2/23/2024 7:29:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:33 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (302ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:33 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:33 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:33 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (260ms)\n\n[2/23/2024 7:29:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:33 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:33 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (269ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (162ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (159ms)\n\n    ✔ should fetch RPC URL (167ms)\n\n    ✔ should fetch Alt RPC URL (163ms)\n\n    ✔ should fetch Events Fetch Page Size (150ms)\n\n    ✔ should fetch NewEventsQueueURL (162ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (275ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (357ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (937ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (335ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (770ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (117ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    1) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  37 passing (10s)\n  1 failing\n\n  1) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.86 |    47.68 |   96.71 |    89.2 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":75,"line":35},"start":{"column":23,"line":35}}}],"source":"import {AppConfig, GetConfigurationCommandOutput} from '@aws-sdk/client-appconfig';\n\nexport class AppConfigClient {\n  private readonly appConfigClient: AppConfig;\n  private readonly environment: string;\n  private readonly clientId: string = 'EventFetcherService';\n\n  constructor(environment: string, region: string) {\n    this.appConfigClient = new AppConfig({region: region});\n    this.environment = environment;\n  }\n\n  public async fetchConfigRawString(configName: string): Promise<"+"string> {\n    try {\n      const response = await this.getConfigFromAppConfig(configName);\n      return response;\n    } catch (error) {\n      throw new Error(`Error fetching configuration for ${configName}: ${error}`);\n    }\n  }\n\n  private async getConfigFromAppConfig(configName: string): Promise<"+"string> {\n    const params = {\n      Application: this.environment,\n      Configuration: configName,\n      Environment: this.environment,\n      ClientId: this.clientId,\n    };\n\n    const response: GetConfigurationCommandOutput = await this.appConfigClient.getConfiguration(params);\n\n    if (response.Content) {\n      return Buffer.from(response.Content).toString('utf-8');\n    } else {\n      throw new Error(`Configuration ${configName} not found or is empty.`);\n    }\n  }\n}\n"},"src/services/config/ConfigService.ts":{"language":"typescript","mutants":[{"id":"278","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:25723) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:32 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (371ms)\n\n[2/23/2024 7:29:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:32 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (293ms)\n\n[2/23/2024 7:29:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:32 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (292ms)\n\n[2/23/2024 7:29:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:33 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (315ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:33 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:33 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:33 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:29:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:33 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:33 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (290ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (159ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (165ms)\n\n    ✔ should fetch RPC URL (160ms)\n\n    ✔ should fetch Alt RPC URL (151ms)\n\n    ✔ should fetch Events Fetch Page Size (194ms)\n\n    ✔ should fetch NewEventsQueueURL (171ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (249ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (384ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (804ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (314ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (870ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (80ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n  1 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |       48 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    47.56 |   96.15 |   90.25 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   93.97 |    50.52 |      92 |   96.25 | 6,24,39           \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":37,"line":11},"start":{"column":35,"line":11}}},{"id":"279","mutatorName":"ArrayDeclaration","replacement":"[\"Stryker was here\"]","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:25724) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:32 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (373ms)\n\n[2/23/2024 7:29:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:32 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:32 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (345ms)\n\n[2/23/2024 7:29:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:33 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (295ms)\n\n[2/23/2024 7:29:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:33 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:33 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (281ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:33 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:33 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:33 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:29:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:34 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:34 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (167ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (144ms)\n\n    ✔ should fetch RPC URL (150ms)\n\n    ✔ should fetch Alt RPC URL (180ms)\n\n    ✔ should fetch Events Fetch Page Size (170ms)\n\n    ✔ should fetch NewEventsQueueURL (180ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (268ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (353ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (808ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (380ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (830ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.08 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    47.94 |   96.15 |   90.25 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   93.97 |    51.57 |      92 |   96.25 | 6,24,39           \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":52,"line":13},"start":{"column":50,"line":13}}},{"id":"280","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":36,"line":15},"start":{"column":34,"line":15}}},{"id":"281","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":35,"line":16},"start":{"column":33,"line":16}}},{"id":"282","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":39,"line":18},"start":{"column":37,"line":18}}},{"id":"283","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:25925) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:39 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:39 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: undefined\n\n[2/23/2024 7:29:39 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:40 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (444ms)\n\n[2/23/2024 7:29:40 PM] Executing the event fetcher workflow...\n[2/23/2024 7:29:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: undefined\n\n[2/23/2024 7:29:40 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:40 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (404ms)\n\n[2/23/2024 7:29:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: undefined\n\n[2/23/2024 7:29:40 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:40 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (285ms)\n\n[2/23/2024 7:29:40 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:40 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: undefined\n\n[2/23/2024 7:29:40 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (276ms)\n\n\n  PSP Events\n\n[2/23/2024 7:29:41 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: undefined\n\n[2/23/2024 7:29:41 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:41 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:41 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:29:41 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: undefined\n\n[2/23/2024 7:29:41 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:41 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (468ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (184ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (166ms)\n\n    ✔ should fetch RPC URL (147ms)\n\n    ✔ should fetch Alt RPC URL (158ms)\n\n    ✔ should fetch Events Fetch Page Size (189ms)\n\n    ✔ should fetch NewEventsQueueURL (152ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (220ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (413ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1300ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (347ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (639ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (10s)\n  1 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.86 |    47.92 |   96.71 |    89.2 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    47.19 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    49.47 |      92 |   93.75 | 6,24,39,71-72     \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":26},"start":{"column":35,"line":24}}},{"id":"286","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n  Leverage Events\n\n(node:26116) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:29:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:44 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:44 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (406ms)\n\n[2/23/2024 7:29:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:44 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:29:44 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (299ms)\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (331ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:45 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:29:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:46 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:46 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (177ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (148ms)\n\n    ✔ should fetch RPC URL (156ms)\n\n    ✔ should fetch Alt RPC URL (151ms)\n\n    ✔ should fetch Events Fetch Page Size (187ms)\n\n    ✔ should fetch NewEventsQueueURL (166ms)\n\n\n\n  Config Service Test\n\n    4) should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (288ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (372ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (857ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (370ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (737ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (38ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (58ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    5) should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    6) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (9s)\n\n  6 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n     TypeError: Cannot read properties of undefined (reading 'startsWith')\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:36:20)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Config Service Test\n       should get the correct leverage contract addresses when run locally:\n     AssertionError: expected undefined to equal '0x51bdb160c8057cD684ea71135A19dd6fEBF…'\n      at validateLeverageContractAddress (test/unit/ConfigService.test.ts:53:30)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:40:5)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:88:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   84.47 |    45.92 |   91.54 |   84.77 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   84.43 |    49.35 |   86.48 |   86.06 |                   \n  EventFactory.ts                      |   84.37 |    50.92 |   77.27 |   87.39 | ...52,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   75.76 |    39.51 |   81.96 |   75.69 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |   16.39 |    11.11 |   15.38 |   16.66 | 6,16-46,58-137    \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    47.19 |   96.15 |    89.4 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    49.47 |      92 |   93.75 | 6,24,39,95-96     \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":38},"start":{"column":53,"line":36}}},{"id":"284","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:26029) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:44 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:29:44 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:29:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:44 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:44 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (339ms)\n\n[2/23/2024 7:29:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:44 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (547ms)\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (267ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:45 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (232ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (173ms)\n\n    ✔ should fetch RPC URL (153ms)\n\n    ✔ should fetch Alt RPC URL (170ms)\n\n    ✔ should fetch Events Fetch Page Size (168ms)\n\n    ✔ should fetch NewEventsQueueURL (183ms)\n\n\n\n  Config Service Test\n\n    4) should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (301ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (375ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1398ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (403ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (954ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    5) should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    6) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  32 passing (10s)\n  6 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n     TypeError: Cannot read properties of undefined (reading 'startsWith')\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:28:20)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) Config Service Test\n       should get the correct leverage contract addresses when run locally:\n     AssertionError: expected undefined to equal '0x5D137d65AF65E37f0dD0DD2FaC9b8d24039…'\n      at validateLeverageContractAddress (test/unit/ConfigService.test.ts:53:30)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:30:5)\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.08 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    47.94 |   96.15 |   90.25 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   93.97 |    51.57 |      92 |   96.25 | 6,24,39           \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":30},"start":{"column":53,"line":28}}},{"id":"287","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:26170) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:44 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:44 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (366ms)\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (337ms)\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (289ms)\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:46 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:46 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:46 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (318ms)\n\n[2/23/2024 7:29:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:46 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:46 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (268ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (154ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (150ms)\n\n    ✔ should fetch RPC URL (142ms)\n\n    ✔ should fetch Alt RPC URL (189ms)\n\n    ✔ should fetch Events Fetch Page Size (182ms)\n\n    ✔ should fetch NewEventsQueueURL (173ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (273ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (323ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1159ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (338ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (937ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (43ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    2) should report on PositionClosed event\n\n    3) should report on PositionLiqiuidated event\n\n    4) should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    5) should report on Deposit event\n\n    6) should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  32 passing (10s)\n  6 failing\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n\n      AssertionError: expected 'LeveragedPositionOpened' to equal 'LeveragedPositionClosed'\n      + expected - actual\n\n      -LeveragedPositionOpened\n      +LeveragedPositionClosed\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected 'LeveragedPositionClosed' to equal 'LeveragedPositionLiquidated'\n      + expected - actual\n\n      -LeveragedPositionClosed\n      +LeveragedPositionLiquidated\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:145:33)\n\n\n  5) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected 'LeveragedPositionExpired' to equal 'Deposit'\n      + expected - actual\n\n      -LeveragedPositionExpired\n      +Deposit\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:66:5)\n\n  6) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected 'Deposit' to equal 'Withdraw'\n      + expected - actual\n\n      -Deposit\n      +Withdraw\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.24 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    48.68 |   96.15 |   90.25 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   93.97 |    53.68 |      92 |   96.25 | 6,24,39           \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":42},"start":{"column":56,"line":40}}},{"id":"285","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:26086) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:44 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:44 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (624ms)\n\n[2/23/2024 7:29:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:44 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (281ms)\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (318ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:45 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (311ms)\n\n[2/23/2024 7:29:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:46 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:46 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (158ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (170ms)\n\n    ✔ should fetch RPC URL (152ms)\n\n    ✔ should fetch Alt RPC URL (403ms)\n\n    ✔ should fetch Events Fetch Page Size (172ms)\n\n    ✔ should fetch NewEventsQueueURL (169ms)\n\n\n\n  Config Service Test\n\n    3) should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (247ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (332ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1048ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (431ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (964ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    4) should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    5) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  33 passing (10s)\n  5 failing\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n     TypeError: Cannot read properties of undefined (reading 'startsWith')\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:32:20)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Config Service Test\n       should get the correct leverage contract addresses when run locally:\n     AssertionError: expected undefined to equal '0x11632eFC0DBeb46cB84c6d28015d179E936…'\n      at validateLeverageContractAddress (test/unit/ConfigService.test.ts:53:30)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:35:5)\n\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    48.24 |   96.71 |   89.39 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    48.68 |   96.15 |   90.25 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   93.97 |    53.68 |      92 |   96.25 | 6,24,39           \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":34},"start":{"column":57,"line":32}}},{"id":"288","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:26202) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:44 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:44 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:44 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (337ms)\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (307ms)\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (322ms)\n\n[2/23/2024 7:29:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:45 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:45 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (310ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:46 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:46 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:46 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:29:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:46 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:46 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (158ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (201ms)\n\n    ✔ should fetch RPC URL (161ms)\n\n    ✔ should fetch Alt RPC URL (161ms)\n\n    ✔ should fetch Events Fetch Page Size (160ms)\n\n    ✔ should fetch NewEventsQueueURL (208ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    3) should get the correct PSP contract addresses from AWS\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (341ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1201ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (345ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (913ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    4) should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    5) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  33 passing (10s)\n  5 failing\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Config Service Test\n       should get the correct PSP contract addresses from AWS:\n     AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal undefined\n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:49:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:47:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Config Service Test\n       should get the correct PSP contract addresses when run locally:\n     AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal undefined\n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/unit/ConfigService.test.ts:61:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:59:29)\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected 'Withdraw' to equal 'LeveragedPositionOpened'\n      + expected - actual\n\n      -Withdraw\n      +LeveragedPositionOpened\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.32 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    49.06 |   96.15 |   90.25 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   93.97 |    54.73 |      92 |   96.25 | 6,24,39           \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":50},"start":{"column":76,"line":44}}},{"id":"289","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:26258) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:46 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:46 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (355ms)\n\n[2/23/2024 7:29:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:46 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:46 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (272ms)\n\n[2/23/2024 7:29:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:46 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:46 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (276ms)\n\n[2/23/2024 7:29:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:47 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:47 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (324ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:47 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:47 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:47 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (290ms)\n\n[2/23/2024 7:29:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:47 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:47 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (328ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (177ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (215ms)\n\n    ✔ should fetch RPC URL (166ms)\n\n    ✔ should fetch Alt RPC URL (173ms)\n\n    ✔ should fetch Events Fetch Page Size (193ms)\n\n    ✔ should fetch NewEventsQueueURL (181ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    1) should get the correct PSP contract addresses from AWS\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (387ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (815ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (586ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1009ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (38ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (52ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    2) should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n\n  2 failing\n\n\n\n  1) Config Service Test\n       should get the correct PSP contract addresses from AWS:\n\n      AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal ''\n      + expected - actual\n\n      -0xF326Cd46A1A189B305AFF7500b02C5C26b405266\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:49:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:47:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       should get the correct PSP contract addresses when run locally:\n\n      AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal ''\n      + expected - actual\n\n      -0xF326Cd46A1A189B305AFF7500b02C5C26b405266\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/unit/ConfigService.test.ts:61:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:59:29)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.77 |    47.76 |   96.24 |   89.02 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.38 |    46.44 |   94.23 |   88.55 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   90.36 |    47.36 |      88 |   91.25 | ...39,114,129-133 \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":46},"start":{"column":48,"line":45}}},{"id":"290","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:26317) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:51 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (353ms)\n\n[2/23/2024 7:29:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:51 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (303ms)\n\n[2/23/2024 7:29:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:51 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (301ms)\n\n[2/23/2024 7:29:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:52 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:52 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (331ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:52 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:52 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:52 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (299ms)\n\n[2/23/2024 7:29:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:52 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:52 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (281ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (159ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (148ms)\n\n    ✔ should fetch RPC URL (158ms)\n\n    ✔ should fetch Alt RPC URL (144ms)\n\n    ✔ should fetch Events Fetch Page Size (139ms)\n\n    ✔ should fetch NewEventsQueueURL (318ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    1) should get the correct PSP contract addresses from AWS\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (327ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (993ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (425ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (656ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    2) should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n\n  1) Config Service Test\n       should get the correct PSP contract addresses from AWS:\n\n      AssertionError: expected '0xD078a331A8A00AB5391ba9f3AfC910225a7…' to equal '0xF326Cd46A1A189B305AFF7500b02C5C26b4…'\n      + expected - actual\n\n      -0xD078a331A8A00AB5391ba9f3AfC910225a78e6A1\n      +0xF326Cd46A1A189B305AFF7500b02C5C26b405266\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:49:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:47:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       should get the correct PSP contract addresses when run locally:\n\n      AssertionError: expected '0xD078a331A8A00AB5391ba9f3AfC910225a7…' to equal '0xF326Cd46A1A189B305AFF7500b02C5C26b4…'\n      + expected - actual\n\n      -0xD078a331A8A00AB5391ba9f3AfC910225a78e6A1\n      +0xF326Cd46A1A189B305AFF7500b02C5C26b405266\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/unit/ConfigService.test.ts:61:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:59:29)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.84 |   96.24 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.38 |    46.81 |   94.23 |   88.98 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   90.36 |    48.42 |      88 |    92.5 | 6,24,39,129-133   \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":46},"start":{"column":7,"line":46}}},{"id":"292","mutatorName":"EqualityOperator","replacement":"contract.strategyName !== strategyName","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:26498) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:56 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (438ms)\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (289ms)\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (276ms)\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (307ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:58 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:58 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:58 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:29:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:58 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:58 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (208ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (156ms)\n\n    ✔ should fetch RPC URL (162ms)\n\n    ✔ should fetch Alt RPC URL (155ms)\n\n    ✔ should fetch Events Fetch Page Size (161ms)\n\n    ✔ should fetch NewEventsQueueURL (158ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    3) should get the correct PSP contract addresses from AWS\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (613ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (803ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (437ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (780ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    4) should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n\n  4 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Config Service Test\n       should get the correct PSP contract addresses from AWS:\n\n      AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal '0xD078a331A8A00AB5391ba9f3AfC910225a7…'\n      + expected - actual\n\n      -0xF326Cd46A1A189B305AFF7500b02C5C26b405266\n      +0xD078a331A8A00AB5391ba9f3AfC910225a78e6A1\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:49:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:47:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Config Service Test\n       should get the correct PSP contract addresses when run locally:\n\n      AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal '0xD078a331A8A00AB5391ba9f3AfC910225a7…'\n      + expected - actual\n\n      -0xF326Cd46A1A189B305AFF7500b02C5C26b405266\n      +0xD078a331A8A00AB5391ba9f3AfC910225a78e6A1\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/unit/ConfigService.test.ts:61:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:59:29)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.68 |   96.24 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.38 |    46.06 |   94.23 |   88.98 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   90.36 |    46.31 |      88 |    92.5 | 6,24,39,129-133   \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":46},"start":{"column":7,"line":46}}},{"id":"291","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:26399) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:56 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:56 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (457ms)\n\n[2/23/2024 7:29:56 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:56 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (346ms)\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (268ms)\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (264ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:57 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:29:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:58 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:58 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (217ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (222ms)\n\n    ✔ should fetch RPC URL (145ms)\n\n    ✔ should fetch Alt RPC URL (168ms)\n\n    ✔ should fetch Events Fetch Page Size (170ms)\n\n    ✔ should fetch NewEventsQueueURL (144ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    3) should get the correct PSP contract addresses from AWS\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (394ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (969ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (441ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (699ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    4) should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (10s)\n  4 failing\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Config Service Test\n       should get the correct PSP contract addresses from AWS:\n\n      AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal ''\n      + expected - actual\n\n      -0xF326Cd46A1A189B305AFF7500b02C5C26b405266\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:49:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:47:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Config Service Test\n       should get the correct PSP contract addresses when run locally:\n\n      AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal ''\n      + expected - actual\n\n      -0xF326Cd46A1A189B305AFF7500b02C5C26b405266\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/unit/ConfigService.test.ts:61:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:59:29)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |       48 |   96.24 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.38 |    47.56 |   94.23 |   88.98 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   90.36 |    50.52 |      88 |    92.5 | 6,24,39,129-133   \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":45,"line":46},"start":{"column":7,"line":46}}},{"id":"293","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:26564) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (359ms)\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (271ms)\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (340ms)\n\n[2/23/2024 7:29:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:58 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (314ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:58 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:58 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:58 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (319ms)\n\n[2/23/2024 7:29:58 PM] Executing the event fetcher workflow...\n[2/23/2024 7:29:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:58 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:58 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (163ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (141ms)\n\n    ✔ should fetch RPC URL (150ms)\n\n    ✔ should fetch Alt RPC URL (153ms)\n\n    ✔ should fetch Events Fetch Page Size (153ms)\n\n    ✔ should fetch NewEventsQueueURL (208ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    2) should get the correct PSP contract addresses from AWS\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (605ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1019ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (409ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (738ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    3) should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (9s)\n  3 failing\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       should get the correct PSP contract addresses from AWS:\n     AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal true\n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:49:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:47:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Config Service Test\n       should get the correct PSP contract addresses when run locally:\n     AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal true\n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/unit/ConfigService.test.ts:61:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:59:29)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    48.24 |   96.24 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.38 |    48.68 |   94.23 |   88.98 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   90.36 |    53.68 |      88 |    92.5 | 6,24,39,129-133   \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":49},"start":{"column":12,"line":49}}},{"id":"295","mutatorName":"LogicalOperator","replacement":"contract?.strategyAddress && ''","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:26597) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (365ms)\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (341ms)\n\n[2/23/2024 7:29:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:58 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (355ms)\n\n[2/23/2024 7:29:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:58 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (300ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:58 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:58 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:58 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (344ms)\n\n[2/23/2024 7:29:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:59 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:59 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (246ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (159ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (155ms)\n\n    ✔ should fetch RPC URL (617ms)\n\n    ✔ should fetch Alt RPC URL (165ms)\n\n    ✔ should fetch Events Fetch Page Size (148ms)\n\n    ✔ should fetch NewEventsQueueURL (146ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    1) should get the correct PSP contract addresses from AWS\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (410ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1031ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (877ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (832ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    2) should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (11s)\n  2 failing\n\n\n\n  1) Config Service Test\n       should get the correct PSP contract addresses from AWS:\n\n      AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal ''\n      + expected - actual\n\n      -0xF326Cd46A1A189B305AFF7500b02C5C26b405266\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:49:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:47:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       should get the correct PSP contract addresses when run locally:\n\n      AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal ''\n      + expected - actual\n\n      -0xF326Cd46A1A189B305AFF7500b02C5C26b405266\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/unit/ConfigService.test.ts:61:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:59:29)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.77 |    47.68 |   96.24 |   89.11 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.38 |    46.06 |   94.23 |   88.98 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   90.36 |    46.31 |      88 |    92.5 | 6,24,39,129-133   \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":49},"start":{"column":12,"line":49}}},{"id":"294","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n  Leverage Events\n\n(node:26563) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (359ms)\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (317ms)\n\n[2/23/2024 7:29:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:57 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:29:57 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (337ms)\n\n[2/23/2024 7:29:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:58 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (335ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:29:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:29:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:58 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:29:58 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:29:58 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (301ms)\n\n[2/23/2024 7:29:58 PM] Executing the event fetcher workflow...\n[2/23/2024 7:29:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:29:58 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:29:58 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (158ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (173ms)\n\n    ✔ should fetch RPC URL (164ms)\n\n    ✔ should fetch Alt RPC URL (598ms)\n\n    ✔ should fetch Events Fetch Page Size (142ms)\n\n    ✔ should fetch NewEventsQueueURL (148ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    2) should get the correct PSP contract addresses from AWS\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (426ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1932ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (500ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (827ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (69ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    3) should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (11s)\n\n  3 failing\n\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       should get the correct PSP contract addresses from AWS:\n     AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal false\n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:49:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:47:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Config Service Test\n       should get the correct PSP contract addresses when run locally:\n     AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal false\n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/unit/ConfigService.test.ts:61:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:59:29)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.77 |    47.84 |   96.24 |   89.11 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.38 |    46.81 |   94.23 |   88.98 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   90.36 |    48.42 |      88 |    92.5 | 6,24,39,129-133   \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":43,"line":49},"start":{"column":12,"line":49}}},{"id":"297","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","status":"Survived","testsCompleted":1,"location":{"end":{"column":43,"line":49},"start":{"column":41,"line":49}}},{"id":"296","mutatorName":"OptionalChaining","replacement":"contract.strategyAddress","status":"Survived","testsCompleted":1,"location":{"end":{"column":37,"line":49},"start":{"column":12,"line":49}}},{"id":"298","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:26801) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:08 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:08 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (276ms)\n\n[2/23/2024 7:30:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:09 PM] Event fetcher workflow completed.\n\n    2) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:09 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (259ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:09 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:09 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:09 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:30:09 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Deposit event\n\n[2/23/2024 7:30:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:10 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:30:10 PM] Event fetcher workflow completed.\n\n    4) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (176ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (151ms)\n\n    ✔ should fetch RPC URL (151ms)\n\n    ✔ should fetch Alt RPC URL (145ms)\n\n    ✔ should fetch Events Fetch Page Size (190ms)\n\n    ✔ should fetch NewEventsQueueURL (198ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (328ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (345ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1285ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (409ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (733ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    5) should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    6) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    7) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    8) should report on Deposit event\n\n    9) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  29 passing (10s)\n  9 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Config Service Test\n       should get ContracInfoPSP by address:\n     AssertionError: expected { …(22) } to deeply equal undefined\n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/unit/ConfigService.test.ts:77:40\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:75:29)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  8) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  9) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   77.46 |    42.32 |   82.62 |   77.76 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   83.01 |    48.37 |   86.48 |   84.57 |                   \n\n  EventFactory.ts                      |   80.46 |    48.61 |   77.27 |   83.19 | ...65,186-192,213 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      88 |    47.05 |     100 |   87.75 | 6,24,38-41,96     \n\n ...src/onchain_events/leverage_events |   79.18 |    38.83 |   88.52 |   78.81 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   67.18 |    29.23 |   76.92 |   66.66 | ...,75-91,114-142 \n\n  ...ainEventLeveragePositionOpened.ts |   64.28 |    29.57 |   71.42 |   63.76 | ...76-100,125-156 \n\n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n\n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n\n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.38 |    45.69 |   94.23 |   88.98 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   90.36 |    45.26 |      88 |    92.5 | 6,24,39,122-125   \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":56},"start":{"column":92,"line":52}}},{"id":"299","mutatorName":"ArrowFunction","replacement":"() => undefined","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:26886) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:08 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:09 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (311ms)\n\n[2/23/2024 7:30:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:09 PM] Event fetcher workflow completed.\n\n    2) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:09 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (329ms)\n\n\n  PSP Events\n\n[2/23/2024 7:30:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:10 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:10 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:30:10 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Deposit event\n\n[2/23/2024 7:30:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:10 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:30:10 PM] Event fetcher workflow completed.\n\n    4) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (169ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (147ms)\n\n    ✔ should fetch RPC URL (234ms)\n\n    ✔ should fetch Alt RPC URL (170ms)\n\n    ✔ should fetch Events Fetch Page Size (153ms)\n\n    ✔ should fetch NewEventsQueueURL (185ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (218ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (343ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1304ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (475ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (728ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (46ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    5) should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    6) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    7) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    8) should report on Deposit event\n\n    9) should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  29 passing (10s)\n  9 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Config Service Test\n       should get ContracInfoPSP by address:\n     AssertionError: expected { …(22) } to deeply equal undefined\n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/unit/ConfigService.test.ts:77:40\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:75:29)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  8) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  9) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   77.73 |    42.48 |   83.09 |   77.95 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   83.01 |    48.37 |   86.48 |   84.57 |                   \n\n  EventFactory.ts                      |   80.46 |    48.61 |   77.27 |   83.19 | ...65,186-192,213 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      88 |    47.05 |     100 |   87.75 | 6,24,38-41,96     \n\n ...src/onchain_events/leverage_events |   79.18 |    38.83 |   88.52 |   78.81 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   67.18 |    29.23 |   76.92 |   66.66 | ...,75-91,114-142 \n\n  ...ainEventLeveragePositionOpened.ts |   64.28 |    29.57 |   71.42 |   63.76 | ...76-100,125-156 \n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n\n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    46.44 |   96.15 |   89.83 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   93.97 |    47.36 |      92 |      95 | 6,24,39,125       \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":54},"start":{"column":38,"line":53}}},{"id":"300","mutatorName":"ConditionalExpression","replacement":"true","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:26887) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:08 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:09 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:09 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:09 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (322ms)\n\n[2/23/2024 7:30:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:09 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:09 PM] Event fetcher workflow completed.\n\n    2) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:09 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (301ms)\n\n\n  PSP Events\n\n[2/23/2024 7:30:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:10 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:10 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:10 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Deposit event\n\n[2/23/2024 7:30:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:10 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:10 PM] Event fetcher workflow completed.\n\n    4) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (145ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (150ms)\n\n    ✔ should fetch RPC URL (397ms)\n\n    ✔ should fetch Alt RPC URL (162ms)\n\n    ✔ should fetch Events Fetch Page Size (182ms)\n\n    ✔ should fetch NewEventsQueueURL (153ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (215ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (381ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1273ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (393ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (737ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    5) should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    6) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    7) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    8) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (9s)\n\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Config Service Test\n       should get ContracInfoPSP by address:\n\n      AssertionError: expected { …(22) } to deeply equal { …(22) }\n      + expected - actual\n\n       {\n      -  \"adapterAddress\": \"0xb42Ca27d844a4106d3D5e64Ac971Bd66814aB08f\"\n      +  \"adapterAddress\": \"0x1EBCfd933661f7d4096983CAddFC8d6F55A258E0\"\n         \"adapterType\": 1\n      -  \"adjustInThreshold\": 15000000\n      -  \"adjustOutThreshold\": 7\n      +  \"adjustInThreshold\": 1000000000000000000\n      +  \"adjustOutThreshold\": 35\n         \"adjustOutUnderlyingSlippage\": 0.05\n      -  \"basePoolAddress\": \"0xDcEF968d416a41Cdac0ED8702fAC8128A64241A2\"\n      -  \"basePoolLpTokenAddress\": \"0x3175Df0976dFA876431C2E9eE6Bc45b65d3473CC\"\n      -  \"basePoolTokensLength\": 2\n      -  \"curvePoolABIVersion\": \"v2\"\n      +  \"basePoolAddress\": \"\"\n      +  \"basePoolLpTokenAddress\": \"\"\n      +  \"basePoolTokensLength\": 0\n      +  \"curvePoolABIVersion\": \"v1\"\n         \"doHardWorkThreshold\": 1000\n         \"extraRewardsTokens\": []\n      -  \"haveZapper\": true\n      +  \"haveZapper\": false\n         \"hoursNeedsPassSinceLastAdjustIn\": 24\n         \"hoursNeedsPassSinceLastAdjustOut\": 24\n         \"isVolatile\": false\n         \"lpSlippage\": 0.5\n         \"maxSlippage\": 0.02\n         \"maxVolatilityPercentage\": 10\n         \"maximumPoolOwnershipRatio\": 30\n         \"minVolatilityPercentage\": 3\n      -  \"strategyAddress\": \"0xD078a331A8A00AB5391ba9f3AfC910225a78e6A1\"\n      -  \"strategyName\": \"Convex FRAXBP/ALUSD Single Pool\"\n      +  \"strategyAddress\": \"0xF326Cd46A1A189B305AFF7500b02C5C26b405266\"\n      +  \"strategyName\": \"Convex ETH+/ETH Single Pool\"\n       }\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/unit/ConfigService.test.ts:77:40\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:75:29)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected 'Convex ETH+/ETH Single Pool' to equal 'Convex FRAXBP/msUSD Single Pool'\n      + expected - actual\n\n      -Convex ETH+/ETH Single Pool\n      +Convex FRAXBP/msUSD Single Pool\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:211:42)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected 'Convex ETH+/ETH Single Pool' to equal 'Convex FRAXBP/msUSD Single Pool'\n      + expected - actual\n\n      -Convex ETH+/ETH Single Pool\n      +Convex FRAXBP/msUSD Single Pool\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:211:42)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n  8) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected 'Convex ETH+/ETH Single Pool' to equal 'Convex FRAXBP/msUSD Single Pool'\n      + expected - actual\n\n      -Convex ETH+/ETH Single Pool\n      +Convex FRAXBP/msUSD Single Pool\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:109:42)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:66:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.49 |     48.4 |   97.18 |   89.76 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   87.73 |    50.97 |   86.48 |   89.55 |                   \n\n  EventFactory.ts                      |    87.5 |    51.85 |   77.27 |   90.75 | ...41,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      90 |    49.01 |     100 |   89.79 | 6,24,38-41        \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   90.04 |    47.94 |   98.07 |   90.25 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   95.18 |    51.57 |      96 |   96.25 | 6,24,39           \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":54},"start":{"column":7,"line":54}}},{"id":"301","mutatorName":"ConditionalExpression","replacement":"false","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:26965) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:10 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:10 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:10 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (261ms)\n\n[2/23/2024 7:30:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:10 PM] Event fetcher workflow completed.\n\n    2) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:11 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:11 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:11 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (493ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:11 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:11 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:30:11 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Deposit event\n\n[2/23/2024 7:30:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:11 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:30:12 PM] Event fetcher workflow completed.\n\n    4) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (204ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (165ms)\n\n    ✔ should fetch RPC URL (146ms)\n\n    ✔ should fetch Alt RPC URL (151ms)\n\n    ✔ should fetch Events Fetch Page Size (186ms)\n\n    ✔ should fetch NewEventsQueueURL (149ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (276ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (415ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1133ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (575ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (744ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (50ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    5) should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    6) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    7) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    8) should report on Deposit event\n\n    9) should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  29 passing (10s)\n  9 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Config Service Test\n       should get ContracInfoPSP by address:\n     AssertionError: expected { …(22) } to deeply equal undefined\n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/unit/ConfigService.test.ts:77:40\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:75:29)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:59:33)\n\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at testEventGeneration (test/unit/EventFactoryLeverage.test.ts:183:37)\n      at async Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:118:33)\n\n\n  8) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:52:37)\n\n\n  9) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected +0 to equal 1\n      + expected - actual\n\n      -0\n      +1\n      \n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:85:37)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   77.73 |    42.56 |   83.09 |   78.04 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   83.01 |    48.37 |   86.48 |   84.57 |                   \n  EventFactory.ts                      |   80.46 |    48.61 |   77.27 |   83.19 | ...65,186-192,213 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      88 |    47.05 |     100 |   87.75 | 6,24,38-41,96     \n\n ...src/onchain_events/leverage_events |   79.18 |    38.83 |   88.52 |   78.81 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   67.18 |    29.23 |   76.92 |   66.66 | ...,75-91,114-142 \n\n  ...ainEventLeveragePositionOpened.ts |   64.28 |    29.57 |   71.42 |   63.76 | ...76-100,125-156 \n ...8464/src/onchain_events/psp_events |   23.25 |     16.8 |   21.42 |    23.8 |                   \n\n  OnChainEventPSP.ts                   |   21.27 |    17.94 |      20 |   21.73 | 6,16-46,54-89     \n\n  OnChainEventPSPDeposit.ts            |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n  OnChainEventPSPWithdraw.ts           |   24.39 |    16.27 |   22.22 |      25 | 6,16-46,56-83     \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    46.81 |   96.15 |   90.25 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   93.97 |    48.42 |      92 |   96.25 | 6,24,39           \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":54},"start":{"column":7,"line":54}}},{"id":"302","mutatorName":"EqualityOperator","replacement":"contract.strategyAddress !== strategyAddress","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:26997) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:10 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:10 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:10 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:10 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (259ms)\n\n[2/23/2024 7:30:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:11 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:11 PM] Event fetcher workflow completed.\n\n    2) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:11 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:11 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (285ms)\n\n\n  PSP Events\n\n[2/23/2024 7:30:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:11 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:11 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:11 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Deposit event\n\n[2/23/2024 7:30:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:11 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex FRAXBP/ALUSD Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:12 PM] Event fetcher workflow completed.\n\n    4) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (219ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (184ms)\n\n    ✔ should fetch RPC URL (144ms)\n\n    ✔ should fetch Alt RPC URL (152ms)\n\n    ✔ should fetch Events Fetch Page Size (171ms)\n\n    ✔ should fetch NewEventsQueueURL (150ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (296ms)\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (385ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1691ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (378ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (854ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    5) should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    6) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    7) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    8) should report on Deposit event\n\n    9) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  29 passing (10s)\n  9 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:157:22)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Config Service Test\n       should get ContracInfoPSP by address:\n\n      AssertionError: expected { …(22) } to deeply equal { …(22) }\n      + expected - actual\n\n       {\n      -  \"adapterAddress\": \"0x1EBCfd933661f7d4096983CAddFC8d6F55A258E0\"\n      +  \"adapterAddress\": \"0xb42Ca27d844a4106d3D5e64Ac971Bd66814aB08f\"\n         \"adapterType\": 1\n      -  \"adjustInThreshold\": 1000000000000000000\n      -  \"adjustOutThreshold\": 35\n      +  \"adjustInThreshold\": 15000000\n      +  \"adjustOutThreshold\": 7\n         \"adjustOutUnderlyingSlippage\": 0.05\n      -  \"basePoolAddress\": \"\"\n      -  \"basePoolLpTokenAddress\": \"\"\n      -  \"basePoolTokensLength\": 0\n      -  \"curvePoolABIVersion\": \"v1\"\n      +  \"basePoolAddress\": \"0xDcEF968d416a41Cdac0ED8702fAC8128A64241A2\"\n      +  \"basePoolLpTokenAddress\": \"0x3175Df0976dFA876431C2E9eE6Bc45b65d3473CC\"\n      +  \"basePoolTokensLength\": 2\n      +  \"curvePoolABIVersion\": \"v2\"\n         \"doHardWorkThreshold\": 1000\n         \"extraRewardsTokens\": []\n      -  \"haveZapper\": false\n      +  \"haveZapper\": true\n         \"hoursNeedsPassSinceLastAdjustIn\": 24\n         \"hoursNeedsPassSinceLastAdjustOut\": 24\n         \"isVolatile\": false\n         \"lpSlippage\": 0.5\n         \"maxSlippage\": 0.02\n         \"maxVolatilityPercentage\": 10\n         \"maximumPoolOwnershipRatio\": 30\n         \"minVolatilityPercentage\": 3\n      -  \"strategyAddress\": \"0xF326Cd46A1A189B305AFF7500b02C5C26b405266\"\n      -  \"strategyName\": \"Convex ETH+/ETH Single Pool\"\n      +  \"strategyAddress\": \"0xD078a331A8A00AB5391ba9f3AfC910225a78e6A1\"\n      +  \"strategyName\": \"Convex FRAXBP/ALUSD Single Pool\"\n       }\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/unit/ConfigService.test.ts:77:40\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/unit/ConfigService.test.ts:75:29)\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n\n      AssertionError: expected 'Convex ETH+/ETH Single Pool' to equal 'Convex FRAXBP/msUSD Single Pool'\n      + expected - actual\n\n      -Convex ETH+/ETH Single Pool\n      +Convex FRAXBP/msUSD Single Pool\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:211:42)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n  7) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n\n      AssertionError: expected 'Convex ETH+/ETH Single Pool' to equal 'Convex FRAXBP/msUSD Single Pool'\n      + expected - actual\n\n      -Convex ETH+/ETH Single Pool\n      +Convex FRAXBP/msUSD Single Pool\n      \n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:211:42)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n  8) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected 'Convex ETH+/ETH Single Pool' to equal 'Convex FRAXBP/msUSD Single Pool'\n      + expected - actual\n\n      -Convex ETH+/ETH Single Pool\n      +Convex FRAXBP/msUSD Single Pool\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:109:42)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:66:5)\n\n  9) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected 'Convex FRAXBP/ALUSD Single Pool' to equal 'Convex ETH+/ETH Single Pool'\n      + expected - actual\n\n      -Convex FRAXBP/ALUSD Single Pool\n      +Convex ETH+/ETH Single Pool\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:109:42)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |    89.4 |    48.24 |   96.71 |   89.76 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   87.73 |    50.97 |   86.48 |   89.55 |                   \n\n  EventFactory.ts                      |    87.5 |    51.85 |   77.27 |   90.75 | ...41,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      90 |    49.01 |     100 |   89.79 | 6,24,38-41        \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   89.62 |    47.19 |   96.15 |   90.25 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   93.97 |    49.47 |      92 |   96.25 | 6,24,39           \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":51,"line":54},"start":{"column":7,"line":54}}},{"id":"303","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:27054) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:14 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:14 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (322ms)\n\n[2/23/2024 7:30:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:14 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:14 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (344ms)\n\n[2/23/2024 7:30:14 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:14 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:14 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:15 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (323ms)\n\n[2/23/2024 7:30:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:15 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:15 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (311ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:15 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:15 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:15 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (335ms)\n\n[2/23/2024 7:30:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:15 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:15 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (321ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (171ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (201ms)\n\n    ✔ should fetch RPC URL (209ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (222ms)\n\n    ✔ should fetch NewEventsQueueURL (170ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    1) should get the correct PSP contract addresses from AWS\n\n    ✔ should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (393ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (949ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (329ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (652ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (10s)\n\n  1 failing\n\n\n\n  1) Config Service Test\n       should get the correct PSP contract addresses from AWS:\n     AssertionError: expected undefined to equal 7\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:53:30)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.86 |    47.92 |   96.71 |    89.2 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    47.19 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    49.47 |      92 |   93.75 | 6,24,39,132-133   \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":60},"start":{"column":40,"line":58}}},{"id":"304","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:27109) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:15 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:15 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:15 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:16 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:30:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:16 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:16 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:16 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:17 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:30:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:17 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:17 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (143ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (321ms)\n\n    ✔ should fetch RPC URL (169ms)\n\n    ✔ should fetch Alt RPC URL (148ms)\n\n    ✔ should fetch Events Fetch Page Size (165ms)\n\n    ✔ should fetch NewEventsQueueURL (151ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (224ms)\n\n    7) should retrieve last block scanned from AWS\n\n    8) should set last block scanned\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (823ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (361ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (703ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (10s)\n\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Config Service Test\n       should retrieve last block scanned from AWS:\n     AssertionError: expected undefined to be a number or a date\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n  8) Config Service Test\n       should set last block scanned:\n     AssertionError: expected undefined not to be undefined\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:91:38)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |    86.8 |     46.8 |   96.24 |   87.08 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   72.78 |    39.05 |   94.44 |   72.02 |                   \n  EventProcessorService.ts             |   65.62 |    35.38 |    90.9 |   64.89 | ...18-157,176-180 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    47.19 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    49.47 |      92 |   93.75 | 6,24,39,140-141   \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":64},"start":{"column":40,"line":62}}},{"id":"306","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:27278) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:30:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:20 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:20 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:30:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:21 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\nError: Error fetching configuration for LeverageContractInfo: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nError: Nock: No match for request {\n  \"method\": \"GET\",\n  \"url\": \"https://wbtc-engine-events-store.s3.us-east-1.amazonaws.com/last-block-number?x-id=GetObject\",\n  \"headers\": {\n    \"host\": \"wbtc-engine-events-store.s3.us-east-1.amazonaws.com\",\n    \"x-amz-user-agent\": \"aws-sdk-js/3.490.0\",\n    \"user-agent\": \"aws-sdk-js/3.490.0 ua/2.0 os/darwin#23.2.0 lang/js md/nodejs#21.2.0 api/s3#3.490.0\",\n    \"amz-sdk-invocation-id\": \"dfa067aa-1d92-47a8-9c45-3c30aff144b0\",\n    \"amz-sdk-request\": \"attempt=1; max=3\",\n    \"x-amz-date\": \"20240224T003021Z\",\n    \"x-amz-content-sha256\": \"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\n    \"authorization\": \"AWS4-HMAC-SHA256 Credential=AKIATQF26W6HECG356FO/20240224/us-east-1/s3/aws4_request, SignedHeaders=amz-sdk-invocation-id;amz-sdk-request;host;x-amz-content-sha256;x-amz-date;x-amz-user-agent, Signature=5e45944f2eff22c4ab2032ca9f096e68ab6fad91f0461fd623bb7e57e6a5d5f8\"\n  }\n}\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:30:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:21 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (141ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (183ms)\n\n    ✔ should fetch RPC URL (229ms)\n\n    ✔ should fetch Alt RPC URL (155ms)\n\n    ✔ should fetch Events Fetch Page Size (159ms)\n\n    ✔ should fetch NewEventsQueueURL (163ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (243ms)\n\n    7) should retrieve last block scanned from AWS\n\n    8) should set last block scanned\n\n    9) should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (904ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (388ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (690ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  29 passing (8s)\n\n  9 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected NaN to be at least 6000000\n      + expected - actual\n\n      -NaN\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n  8) Config Service Test\n       should set last block scanned:\n\n      AssertionError: expected NaN to equal NaN\n      + expected - actual\n\n\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:93:35)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  9) Config Service Test\n       should get main and alt RPC URL from AWS:\n     TypeError: Cannot read properties of undefined (reading 'startsWith')\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:104:22)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   86.89 |    45.28 |   95.77 |   87.26 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   69.38 |    26.03 |   88.88 |   69.23 |                   \n\n  EventProcessorService.ts             |   57.29 |    16.92 |   81.81 |   57.44 | ...13-157,173-183 \n\n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   87.64 |    46.66 |     100 |   87.35 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |    87.5 |    44.44 |     100 |   87.23 | 6,24,38-41,83     \n\n sandbox7748464/src/services/config    |    91.7 |    48.68 |   96.15 |   92.37 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   91.56 |    49.47 |      92 |   93.75 | 6,24,39,156-157   \n\n  ConfigServiceAWS.ts                  |   95.14 |    50.44 |     100 |   95.09 | 6,24,38-41        \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":72},"start":{"column":41,"line":70}}},{"id":"305","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:27171) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:20 PM] RPC: undefined\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:20 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:20 PM] RPC: undefined\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:20 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:30:20 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:20 PM] RPC: undefined\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:20 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:20 PM] RPC: undefined\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:20 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:20 PM] RPC: undefined\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:21 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:30:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:21 PM] RPC: undefined\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:21 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (227ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (158ms)\n\n    ✔ should fetch RPC URL (141ms)\n\n    ✔ should fetch Alt RPC URL (183ms)\n\n    ✔ should fetch Events Fetch Page Size (197ms)\n\n    ✔ should fetch NewEventsQueueURL (166ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (432ms)\n\n    7) should retrieve last block scanned from AWS\n\n    8) should set last block scanned\n\n    9) should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1294ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (334ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (661ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  29 passing (9s)\n  9 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected NaN to be at least 6000000\n      + expected - actual\n\n      -NaN\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n  8) Config Service Test\n       should set last block scanned:\n\n      AssertionError: expected NaN to equal NaN\n      + expected - actual\n\n\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:93:35)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  9) Config Service Test\n       should get main and alt RPC URL from AWS:\n     TypeError: Cannot read properties of undefined (reading 'startsWith')\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:101:23)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.07 |    45.44 |   95.77 |   87.45 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   69.38 |    26.03 |   88.88 |   69.23 |                   \n\n  EventProcessorService.ts             |   57.29 |    16.92 |   81.81 |   57.44 | ...13-157,173-183 \n\n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   87.64 |    46.66 |     100 |   87.35 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |    87.5 |    44.44 |     100 |   87.23 | 6,24,38-41,83     \n\n sandbox7748464/src/services/config    |   92.53 |    49.43 |   96.15 |   93.22 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   93.97 |    51.57 |      92 |   96.25 | 6,24,39           \n\n  ConfigServiceAWS.ts                  |   95.14 |    50.44 |     100 |   95.09 | 6,24,38-41        \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":68},"start":{"column":34,"line":66}}},{"id":"307","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:27279) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:20 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:20 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:20 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (337ms)\n\n[2/23/2024 7:30:20 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:20 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:20 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:21 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (278ms)\n\n[2/23/2024 7:30:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:21 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:21 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (370ms)\n\n[2/23/2024 7:30:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:21 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:21 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (256ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:22 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:22 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:22 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (549ms)\n\n[2/23/2024 7:30:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:22 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:22 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (279ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (162ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (246ms)\n\n    ✔ should fetch RPC URL (238ms)\n\n    ✔ should fetch Alt RPC URL (166ms)\n\n    ✔ should fetch Events Fetch Page Size (196ms)\n\n    ✔ should fetch NewEventsQueueURL (446ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (244ms)\n\n    1) should retrieve last block scanned from AWS\n\n    2) should set last block scanned\n\n    ✔ should get main and alt RPC URL from AWS\n\n    3) should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (910ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (1071ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1035ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (46ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (79ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event (50ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    4) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (11s)\n  4 failing\n\n\n  1) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected NaN to be at least 6000000\n      + expected - actual\n\n      -NaN\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n  2) Config Service Test\n       should set last block scanned:\n\n      AssertionError: expected NaN to equal NaN\n      + expected - actual\n\n\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:93:35)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Config Service Test\n       should retrieve page size from AWS:\n     AssertionError: expected undefined to be a number or a date\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:109:28)\n\n\n  4) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     AssertionError: expected undefined to equal 'LeveragedPositionClosed'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.86 |    47.92 |   96.71 |    89.2 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.79 |    47.19 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    49.47 |      92 |   93.75 | 6,24,39,164-165   \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":76},"start":{"column":43,"line":74}}},{"id":"308","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:27337) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\nError: Error fetching configuration for LastBlockScannedS3FileURL: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: undefined\n\n                        Env: Demo\n\n[2/23/2024 7:30:22 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (320ms)\n\n[2/23/2024 7:30:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: undefined\n\n                        Env: Demo\n\n[2/23/2024 7:30:22 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (307ms)\n\n[2/23/2024 7:30:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: undefined\n\n                        Env: Demo\n\n[2/23/2024 7:30:22 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (340ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: undefined\n\n                        Env: Demo\n\n[2/23/2024 7:30:23 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:23 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:23 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (275ms)\n\n[2/23/2024 7:30:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: undefined\n\n                        Env: Demo\n\n[2/23/2024 7:30:23 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:23 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (288ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (188ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (163ms)\n\n    ✔ should fetch RPC URL (172ms)\n\n    ✔ should fetch Alt RPC URL (153ms)\n\n    ✔ should fetch Events Fetch Page Size (265ms)\n\n    ✔ should fetch NewEventsQueueURL (138ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (253ms)\n\n    2) should retrieve last block scanned from AWS\n\n    3) should set last block scanned\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    4) should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1245ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (367ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1072ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (77ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (41ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n\n  4 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected NaN to be at least 6000000\n      + expected - actual\n\n      -NaN\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n  3) Config Service Test\n       should set last block scanned:\n\n      AssertionError: expected NaN to equal NaN\n      + expected - actual\n\n\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:93:35)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Config Service Test\n       should retrieve event queue URL from AWS:\n     TypeError: Cannot read properties of undefined (reading 'startsWith')\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:114:16)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.58 |     48.4 |   96.71 |   89.94 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   90.47 |    48.52 |     100 |    90.2 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   90.87 |    48.68 |   96.15 |   91.52 |                   \n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n  ConfigService.ts                     |   93.97 |    51.57 |      92 |   96.25 | 6,24,39           \n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":80},"start":{"column":37,"line":78}}},{"id":"309","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:27391) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:22 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:22 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:23 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:30:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:23 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:23 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:30:24 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:24 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:30:24 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:24 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:24 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (159ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (138ms)\n\n    ✔ should fetch RPC URL (173ms)\n\n    ✔ should fetch Alt RPC URL (168ms)\n\n    ✔ should fetch Events Fetch Page Size (190ms)\n\n    ✔ should fetch NewEventsQueueURL (157ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (282ms)\n\n    7) should retrieve last block scanned from AWS\n\n    8) should set last block scanned\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (712ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (283ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (926ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    9) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  29 passing (10s)\n\n  9 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected NaN to be at least 6000000\n      + expected - actual\n\n      -NaN\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n  8) Config Service Test\n       should set last block scanned:\n\n      AssertionError: expected NaN to equal NaN\n      + expected - actual\n\n\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:93:35)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  9) PSP Events Logging\n       should report on Withdraw event:\n     AssertionError: expected undefined to equal 'Withdraw'\n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   90.12 |     49.2 |   96.71 |   90.49 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   93.19 |    50.29 |     100 |      93 |                   \n  EventProcessorService.ts             |   93.75 |    48.46 |     100 |   93.61 | 6,24,38-41,183    \n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |    91.7 |    51.31 |   96.15 |   92.37 |                   \n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   93.97 |    54.73 |      92 |   96.25 | 6,24,39           \n\n  ConfigServiceAWS.ts                  |    93.2 |    52.21 |     100 |   93.13 | 6,24,39,93-98     \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":84},"start":{"column":50,"line":82}}}],"source":"import {ContractInfoPSP} from '../../types/ContractInfoPSP';\n\nexport interface LeverageContractAddresses {\n  positionOpenerAddress: string;\n  positionLiquidatorAddress: string;\n  positionCloserAddress: string;\n  positionExpiratorAddress: string;\n}\n\nexport abstract class ConfigService {\n  protected environment: string = '';\n  protected leverageContractAddresses!: LeverageContractAddresses;\n  protected pspContractInfo: ContractInfoPSP[] = [];\n  protected lastBlockScanned: number = 0;\n  protected MainRPCURL: string = '';\n  protected AltRPCURL: string = '';\n  protected EventFetchPageSize: number = 0;\n  protected EventQueueURL: string = '';\n  protected MaxNumberOfBlocksToProess: number = 1000;\n\n  abstract refreshConfig(): Promise<"+"void>;\n  abstract setLastScannedBlock(blockNumber: number): Promise<"+"void>;\n\n  public getEnvironment(): string {\n    return this.environment;\n  }\n\n  public getLeveragePositionOpenerAddress(): string {\n    return this.leverageContractAddresses.positionOpenerAddress;\n  }\n\n  public getLeveragePositionLiquidatorAddress(): string {\n    return this.leverageContractAddresses.positionLiquidatorAddress;\n  }\n\n  public getLeveragePositionCloserAddress(): string {\n    return this.leverageContractAddresses.positionCloserAddress;\n  }\n\n  public getLeveragePositionExpiratorAddress(): string {\n    return this.leverageContractAddresses.positionExpiratorAddress;\n  }\n\n  public getPSPContractAddressByStrategyName(strategyName: string): string {\n    const contract = this.pspContractInfo.find((contract: { strategyName: string; }) =>\n      contract.strategyName === strategyName,\n    );\n\n    return contract?.strategyAddress || '';\n  }\n\n  public getPSPStrategyInfoByAddress(strategyAddress: string): ContractInfoPSP | undefined {\n    return this.pspContractInfo.find((contract: { strategyAddress: string; }) =>\n      contract.strategyAddress === strategyAddress,\n    );\n  }\n\n  public getPSPStrategyCount(): number {\n    return this.pspContractInfo.length;\n  }\n\n  public getLastBlockScanned(): number {\n    return this.lastBlockScanned;\n  }\n\n  public getMainRPCURL(): string {\n    return this.MainRPCURL;\n  }\n\n  public getAlternativeRPCURL(): string {\n    return this.AltRPCURL;\n  }\n\n  public getEventsFetchPageSize(): number {\n    return this.EventFetchPageSize;\n  }\n\n  public getEventQueueURL(): string {\n    return this.EventQueueURL;\n  }\n\n  public getMaxNumberOfBlocksToProcess(): number {\n    return this.MaxNumberOfBlocksToProess;\n  }\n}\n"},"src/services/config/ConfigServiceAWS.ts":{"language":"typescript","mutants":[{"id":"310","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:27447) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:25 PM] RPC: \n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:30:25 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:25 PM] RPC: \n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:30:25 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:30:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:25 PM] RPC: \n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:30:25 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:25 PM] RPC: \n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:30:25 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:25 PM] RPC: \n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:30:25 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:30:25 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:25 PM] RPC: \n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:30:25 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (204ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (152ms)\n\n    ✔ should fetch RPC URL (155ms)\n\n    ✔ should fetch Alt RPC URL (190ms)\n\n    ✔ should fetch Events Fetch Page Size (281ms)\n\n    ✔ should fetch NewEventsQueueURL (156ms)\n\n\n\n  Config Service Test\n\n    7) should get the correct leverage contract addresses from AWS\n\n    8) should get the correct PSP contract addresses from AWS\n\n    9) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (669ms)\n\n    10) should get main and alt RPC URL from AWS\n\n    11) should retrieve page size from AWS\n\n    12) should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1653ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (339ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (1017ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (57ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  26 passing (6s)\n  12 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  7) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n     TypeError: Cannot read properties of undefined (reading 'positionOpenerAddress')\n      at ConfigServiceAWS.getLeveragePositionOpenerAddress (src/services/config/ConfigService.ts:3:4231)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:27:35)\n\n\n  8) Config Service Test\n       should get the correct PSP contract addresses from AWS:\n\n      AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal ''\n      + expected - actual\n\n      -0xF326Cd46A1A189B305AFF7500b02C5C26b405266\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:49:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:47:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  9) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n  10) Config Service Test\n       should get main and alt RPC URL from AWS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:101:48)\n\n\n  11) Config Service Test\n       should retrieve page size from AWS:\n\n      AssertionError: expected +0 to be at least 100\n      + expected - actual\n\n      -0\n      +100\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:109:28)\n\n\n  12) Config Service Test\n       should retrieve event queue URL from AWS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:114:45)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   90.12 |    49.12 |   96.71 |   90.49 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   93.19 |    50.29 |     100 |      93 |                   \n\n  EventProcessorService.ts             |   93.75 |    48.46 |     100 |   93.61 | 6,24,38-41,183    \n\n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |    91.7 |    50.93 |   96.15 |   92.37 |                   \n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n  ConfigService.ts                     |   93.97 |    53.68 |      92 |   96.25 | 6,24,39           \n  ConfigServiceAWS.ts                  |    93.2 |    52.21 |     100 |   93.13 | 6,24,39,93-98     \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":26},"start":{"column":47,"line":17}}},{"id":"311","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:27504) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:26 PM] RPC: \n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:30:26 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:26 PM] RPC: \n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:30:26 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:30:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:26 PM] RPC: \n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:30:26 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:26 PM] RPC: \n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:30:26 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:26 PM] RPC: \n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:30:26 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:30:26 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:26 PM] RPC: \n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:30:26 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (892ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (151ms)\n\n    ✔ should fetch RPC URL (172ms)\n\n    ✔ should fetch Alt RPC URL (191ms)\n\n    ✔ should fetch Events Fetch Page Size (175ms)\n\n    ✔ should fetch NewEventsQueueURL (166ms)\n\n\n\n  Config Service Test\n\n    7) should get the correct leverage contract addresses from AWS\n\n    8) should get the correct PSP contract addresses from AWS\n\n    9) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (621ms)\n\n    10) should get main and alt RPC URL from AWS\n\n    11) should retrieve page size from AWS\n\n    12) should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (915ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (320ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (819ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (55ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  26 passing (6s)\n  12 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n     TypeError: Cannot read properties of undefined (reading 'positionOpenerAddress')\n      at ConfigServiceAWS.getLeveragePositionOpenerAddress (src/services/config/ConfigService.ts:3:4231)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:27:35)\n\n\n  8) Config Service Test\n       should get the correct PSP contract addresses from AWS:\n\n      AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal ''\n      + expected - actual\n\n      -0xF326Cd46A1A189B305AFF7500b02C5C26b405266\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:49:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:47:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  9) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n  10) Config Service Test\n       should get main and alt RPC URL from AWS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:101:48)\n\n\n  11) Config Service Test\n       should retrieve page size from AWS:\n\n      AssertionError: expected +0 to be at least 100\n      + expected - actual\n\n      -0\n      +100\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:109:28)\n\n\n  12) Config Service Test\n       should retrieve event queue URL from AWS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:114:45)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   80.87 |    41.92 |   91.07 |   81.08 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   67.34 |    24.85 |   88.88 |   67.13 |                   \n  EventProcessorService.ts             |   57.29 |    16.92 |   81.81 |   57.44 | ...13-157,173-183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   87.64 |    46.66 |     100 |   87.35 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |    87.5 |    44.44 |     100 |   87.23 | 6,24,38-41,83     \n sandbox7748464/src/services/config    |   65.14 |     33.7 |   76.92 |   65.25 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   87.95 |    47.36 |      88 |      90 | ...,38-41,129-133 \n\n  ConfigServiceAWS.ts                  |   38.83 |    18.58 |      50 |   38.23 | 6,24,39,80-202    \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":25},"start":{"column":23,"line":18}}},{"id":"312","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:27562) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:30 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:30 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:31 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (355ms)\n\n[2/23/2024 7:30:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:31 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n[2/23/2024 7:30:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (262ms)\n\n[2/23/2024 7:30:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:31 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (263ms)\n\n[2/23/2024 7:30:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:31 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:31 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (222ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:32 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:32 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n[2/23/2024 7:30:32 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (230ms)\n\n[2/23/2024 7:30:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:32 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:32 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (241ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (140ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (147ms)\n\n    ✔ should fetch RPC URL (162ms)\n\n    ✔ should fetch Alt RPC URL (166ms)\n\n    ✔ should fetch Events Fetch Page Size (152ms)\n\n    ✔ should fetch NewEventsQueueURL (140ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (264ms)\n\n    1) should retrieve last block scanned from AWS\n\n    2) should set last block scanned\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (842ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (303ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (628ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (8s)\n  2 failing\n\n\n\n  1) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n  2) Config Service Test\n       should set last block scanned:\n\n      AssertionError: expected +0 to equal -1\n      + expected - actual\n\n      -0\n      +-1\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:93:35)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.68 |    47.68 |   96.71 |   89.02 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   87.96 |    46.06 |   96.15 |   88.55 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   89.32 |    48.67 |     100 |   89.21 | ...39,73-76,93-98 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":32},"start":{"column":72,"line":28}}},{"id":"313","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:27616) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:30:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:31 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:31 PM] Error in event fetcher workflow: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\nError in event fetcher workflow: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.setLastScannedBlock (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:4063)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:348)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\n    ✔ should process PositionOpened event and push messages to SQS (421ms)\n\n[2/23/2024 7:30:31 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:31 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:31 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:31 PM] Error in event fetcher workflow: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\nError in event fetcher workflow: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.setLastScannedBlock (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:4063)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:348)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\n    ✔ should process PositionClosed event and push messages to SQS (207ms)\n\n[2/23/2024 7:30:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:32 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:32 PM] Error in event fetcher workflow: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\nError in event fetcher workflow: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.setLastScannedBlock (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:4063)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:348)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:94:5)\n\n    ✔ should process PositionLiquidated event and push messages to SQS (233ms)\n\n[2/23/2024 7:30:32 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:32 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:32 PM] Error in event fetcher workflow: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\nError in event fetcher workflow: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.setLastScannedBlock (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:4063)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:348)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\n    ✔ should process PositionExpired event and push messages to SQS (208ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:32 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:32 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:32 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:32 PM] Error in event fetcher workflow: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\nError in event fetcher workflow: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.setLastScannedBlock (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:4063)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:348)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\n    ✔ should catch and report on Deposit event (212ms)\n\n[2/23/2024 7:30:32 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:32 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:32 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:32 PM] Error in event fetcher workflow: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\nError in event fetcher workflow: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.setLastScannedBlock (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:4063)\n    at async EventProcessorService.execute (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/EventProcessorService.ts:5:348)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:4041)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\n    ✔ should catch and report on Withdraw event (240ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (156ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (136ms)\n\n    ✔ should fetch RPC URL (154ms)\n\n    ✔ should fetch Alt RPC URL (150ms)\n\n    ✔ should fetch Events Fetch Page Size (144ms)\n\n    ✔ should fetch NewEventsQueueURL (184ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (260ms)\n\n    1) should retrieve last block scanned from AWS\n\n    2) should set last block scanned\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1127ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (388ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (661ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (8s)\n  2 failing\n\n\n\n  1) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n  2) Config Service Test\n       should set last block scanned:\n     Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async ConfigServiceAWS.setLastScannedBlock (src/services/config/ConfigServiceAWS.ts:3:4063)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:88:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.49 |    48.24 |   96.71 |   89.85 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   91.15 |    49.11 |     100 |    90.9 |                   \n\n  EventProcessorService.ts             |   93.75 |    48.46 |     100 |   93.61 | 6,24,38-41,183    \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   90.04 |    47.56 |   96.15 |   90.67 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    50.44 |     100 |   91.17 | ...39,75-76,93-98 \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":103,"line":29},"start":{"column":76,"line":29}}},{"id":"315","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:27751) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:33 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:34 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:34 PM] Error in event fetcher workflow: Error: No value provided for input HTTP label: Key.\n\nError in event fetcher workflow: Error: No value provided for input HTTP label: Key.\n    at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n    at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n    ✔ should process PositionOpened event and push messages to SQS (346ms)\n\n[2/23/2024 7:30:34 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:34 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:34 PM] Error in event fetcher workflow: Error: No value provided for input HTTP label: Key.\n\nError in event fetcher workflow: Error: No value provided for input HTTP label: Key.\n    at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n    at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n    ✔ should process PositionClosed event and push messages to SQS (301ms)\n\n[2/23/2024 7:30:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:34 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:34 PM] Error in event fetcher workflow: Error: No value provided for input HTTP label: Key.\nError in event fetcher workflow: Error: No value provided for input HTTP label: Key.\n    at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n    at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n    ✔ should process PositionLiquidated event and push messages to SQS (284ms)\n\n[2/23/2024 7:30:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:34 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:35 PM] Error in event fetcher workflow: Error: No value provided for input HTTP label: Key.\n\nError in event fetcher workflow: Error: No value provided for input HTTP label: Key.\n    at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n    at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n    ✔ should process PositionExpired event and push messages to SQS (357ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:35 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:35 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:35 PM] Error in event fetcher workflow: Error: No value provided for input HTTP label: Key.\n\nError in event fetcher workflow: Error: No value provided for input HTTP label: Key.\n    at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n    at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n    ✔ should catch and report on Deposit event (351ms)\n\n[2/23/2024 7:30:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:35 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:35 PM] Error in event fetcher workflow: Error: No value provided for input HTTP label: Key.\n\nError in event fetcher workflow: Error: No value provided for input HTTP label: Key.\n    at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n    at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n    ✔ should catch and report on Withdraw event (317ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (172ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (155ms)\n\n    ✔ should fetch RPC URL (161ms)\n\n    ✔ should fetch Alt RPC URL (162ms)\n\n    ✔ should fetch Events Fetch Page Size (163ms)\n\n    ✔ should fetch NewEventsQueueURL (214ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (224ms)\n\n    1) should retrieve last block scanned from AWS\n\n    2) should set last block scanned\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (697ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (420ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (701ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n  2) Config Service Test\n       should set last block scanned:\n     Error: No value provided for input HTTP label: Key.\n      at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n      at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n      at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.22 |    48.08 |   96.71 |   89.57 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   90.47 |    48.52 |     100 |    90.2 |                   \n\n  EventProcessorService.ts             |    92.7 |    47.69 |     100 |   92.55 | 6,24,38-41,92,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   89.21 |    47.19 |   96.15 |   89.83 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   92.23 |    51.32 |     100 |   92.15 | 6,24,39,76,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":30},"start":{"column":55,"line":30}}},{"id":"314","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:27750) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:33 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:33 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:34 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:34 PM] Error in event fetcher workflow: Error: No value provided for input HTTP label: Bucket.\n\nError in event fetcher workflow: Error: No value provided for input HTTP label: Bucket.\n    at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n    at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n    ✔ should process PositionOpened event and push messages to SQS (371ms)\n\n[2/23/2024 7:30:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:34 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:34 PM] Error in event fetcher workflow: Error: No value provided for input HTTP label: Bucket.\n\nError in event fetcher workflow: Error: No value provided for input HTTP label: Bucket.\n    at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n    at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n    ✔ should process PositionClosed event and push messages to SQS (305ms)\n\n[2/23/2024 7:30:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:34 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:34 PM] Error in event fetcher workflow: Error: No value provided for input HTTP label: Bucket.\n\nError in event fetcher workflow: Error: No value provided for input HTTP label: Bucket.\n    at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n    at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n    ✔ should process PositionLiquidated event and push messages to SQS (270ms)\n\n[2/23/2024 7:30:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:34 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:34 PM] Error in event fetcher workflow: Error: No value provided for input HTTP label: Bucket.\n\nError in event fetcher workflow: Error: No value provided for input HTTP label: Bucket.\n    at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n    at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n    ✔ should process PositionExpired event and push messages to SQS (290ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:35 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:35 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:35 PM] Error in event fetcher workflow: Error: No value provided for input HTTP label: Bucket.\n\nError in event fetcher workflow: Error: No value provided for input HTTP label: Bucket.\n    at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n    at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:30:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:35 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:35 PM] Error in event fetcher workflow: Error: No value provided for input HTTP label: Bucket.\n\nError in event fetcher workflow: Error: No value provided for input HTTP label: Bucket.\n    at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n    at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n    at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (439ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (144ms)\n\n    ✔ should fetch RPC URL (187ms)\n\n    ✔ should fetch Alt RPC URL (167ms)\n\n    ✔ should fetch Events Fetch Page Size (247ms)\n\n    ✔ should fetch NewEventsQueueURL (154ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (300ms)\n\n    3) should retrieve last block scanned from AWS\n\n    4) should set last block scanned\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (721ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (472ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (701ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (9s)\n\n  4 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n  4) Config Service Test\n       should set last block scanned:\n     Error: No value provided for input HTTP label: Bucket.\n      at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n      at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n      at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.22 |    48.24 |   96.71 |   89.57 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   90.47 |    48.52 |     100 |    90.2 |                   \n\n  EventProcessorService.ts             |    92.7 |    47.69 |     100 |   92.55 | 6,24,38-41,92,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.21 |    47.94 |   96.15 |   89.83 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   92.23 |    53.09 |     100 |   92.15 | 6,24,39,76,93-98  \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":48,"line":30},"start":{"column":40,"line":30}}},{"id":"316","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:27806) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:34 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:34 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:30:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:35 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:35 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:35 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:30:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:36 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (167ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (163ms)\n\n    ✔ should fetch RPC URL (167ms)\n\n    ✔ should fetch Alt RPC URL (207ms)\n\n    ✔ should fetch Events Fetch Page Size (184ms)\n\n    ✔ should fetch NewEventsQueueURL (164ms)\n\n\n\n  Config Service Test\n\n    7) should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (387ms)\n\n    8) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (355ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1076ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (370ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (816ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (43ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event (58ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (10s)\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n     TypeError: Cannot read properties of undefined (reading 'positionOpenerAddress')\n      at ConfigServiceAWS.getLeveragePositionOpenerAddress (src/services/config/ConfigService.ts:3:4231)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:27:35)\n\n\n  8) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   85.63 |    46.08 |    95.3 |   85.88 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   85.71 |    46.74 |     100 |   85.31 |                   \n  EventProcessorService.ts             |   85.41 |    45.38 |     100 |    85.1 | ...45,153-157,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   75.51 |    38.95 |   90.38 |   75.84 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   60.19 |    31.85 |   83.33 |    59.8 | 6,24,39,83-156    \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":42},"start":{"column":66,"line":34}}},{"id":"317","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:27839) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:34 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:34 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:34 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:35 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:30:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:35 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:35 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:36 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:30:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:36 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (160ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (237ms)\n\n    ✔ should fetch RPC URL (157ms)\n\n    ✔ should fetch Alt RPC URL (179ms)\n\n    ✔ should fetch Events Fetch Page Size (149ms)\n\n    ✔ should fetch NewEventsQueueURL (152ms)\n\n\n\n  Config Service Test\n\n    7) should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (253ms)\n\n    8) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (416ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1176ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (359ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (735ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (105ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (10s)\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n     TypeError: Cannot read properties of undefined (reading 'positionOpenerAddress')\n      at ConfigServiceAWS.getLeveragePositionOpenerAddress (src/services/config/ConfigService.ts:3:4231)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:27:35)\n\n\n  8) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |    85.9 |    46.24 |    95.3 |   86.16 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   85.71 |    46.74 |     100 |   85.31 |                   \n  EventProcessorService.ts             |   85.41 |    45.38 |     100 |    85.1 | ...45,153-157,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   76.76 |     39.7 |   90.38 |   77.11 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |    63.1 |    33.62 |   83.33 |   62.74 | 6,24,39,88-156    \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":38},"start":{"column":9,"line":35}}},{"id":"318","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:27893) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:35 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:35 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (369ms)\n\n[2/23/2024 7:30:35 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:35 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:35 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:35 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (331ms)\n\n[2/23/2024 7:30:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:36 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:36 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (754ms)\n\n[2/23/2024 7:30:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:36 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:36 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (293ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:36 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:36 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:36 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:36 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:36 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (370ms)\n\n[2/23/2024 7:30:37 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:37 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:37 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:37 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (310ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (158ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (194ms)\n\n    ✔ should fetch RPC URL (145ms)\n\n    ✔ should fetch Alt RPC URL (208ms)\n\n    ✔ should fetch Events Fetch Page Size (153ms)\n\n    ✔ should fetch NewEventsQueueURL (156ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (233ms)\n\n    1) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (317ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (735ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (416ms)\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (758ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (46ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event (53ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (10s)\n  1 failing\n\n\n  1) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.16 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    47.94 |   96.15 |   90.25 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |    93.2 |    53.09 |     100 |   93.13 | 6,24,39,93-98     \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":41},"start":{"column":21,"line":38}}},{"id":"320","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:28011) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nFailed to refresh leverage contract addresses: TypeError: Cannot read properties of undefined (reading 'forEach')\n    at ConfigServiceAWS.extractLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:7183)\n    at ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5192)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\nError: Cannot read properties of undefined (reading 'forEach')\n\n    1) should process PositionOpened event and push messages to SQS\n\nFailed to refresh leverage contract addresses: TypeError: Cannot read properties of undefined (reading 'forEach')\n    at ConfigServiceAWS.extractLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:7183)\n    at ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5192)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\nError: Cannot read properties of undefined (reading 'forEach')\n\n    2) should process PositionClosed event and push messages to SQS\n\nFailed to refresh leverage contract addresses: TypeError: Cannot read properties of undefined (reading 'forEach')\n    at ConfigServiceAWS.extractLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:7183)\n    at ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5192)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:94:5)\n\nError: Cannot read properties of undefined (reading 'forEach')\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nFailed to refresh leverage contract addresses: TypeError: Cannot read properties of undefined (reading 'forEach')\n    at ConfigServiceAWS.extractLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:7183)\n    at ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5192)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\nError: Cannot read properties of undefined (reading 'forEach')\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\nFailed to refresh leverage contract addresses: TypeError: Cannot read properties of undefined (reading 'forEach')\n    at ConfigServiceAWS.extractLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:7183)\n    at ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5192)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\nError: Cannot read properties of undefined (reading 'forEach')\n\n    5) should catch and report on Deposit event\n\nFailed to refresh leverage contract addresses: TypeError: Cannot read properties of undefined (reading 'forEach')\n    at ConfigServiceAWS.extractLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:7183)\n    at ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5192)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\nError: Cannot read properties of undefined (reading 'forEach')\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (318ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (193ms)\n\n    ✔ should fetch RPC URL (148ms)\n\n    ✔ should fetch Alt RPC URL (144ms)\n\n    ✔ should fetch Events Fetch Page Size (207ms)\n\n    ✔ should fetch NewEventsQueueURL (176ms)\n\n\n\n  Config Service Test\n\nFailed to refresh leverage contract addresses: TypeError: Cannot read properties of undefined (reading 'forEach')\n    at ConfigServiceAWS.extractLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:7183)\n    at ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5192)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async initalizeObjectUnderTest (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n    7) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (811ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (534ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (969ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (39ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (55ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  25 passing (4s)\n  7 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n\n  7) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     TypeError: Cannot read properties of undefined (reading 'forEach')\n      at ConfigServiceAWS.extractLeverageContractAddresses (src/services/config/ConfigServiceAWS.ts:3:7183)\n      at ConfigServiceAWS.refreshLeverageContractAddresses (src/services/config/ConfigServiceAWS.ts:3:5192)\n      at async Promise.all (index 0)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   78.27 |    41.76 |   87.79 |    78.5 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n sandbox7748464/src/services/config    |   70.95 |    38.57 |   78.84 |   71.18 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n  ConfigServiceAWS.ts                  |    69.9 |    37.16 |   88.88 |    69.6 | ...07-109,124-156 \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":47},"start":{"column":78,"line":44}}},{"id":"321","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n  Leverage Events\n\n(node:28116) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:33:5)\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    1) should process PositionOpened event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    2) should process PositionClosed event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:94:5)\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    3) should process PositionLiquidated event and push messages to SQS\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:124:5)\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:33:5)\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    5) should catch and report on Deposit event\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/PSPEvents.test.ts:55:5)\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (283ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (167ms)\n\n    ✔ should fetch RPC URL (181ms)\n\n    ✔ should fetch Alt RPC URL (156ms)\n\n    ✔ should fetch Events Fetch Page Size (174ms)\n\n    ✔ should fetch NewEventsQueueURL (162ms)\n\n\n\n  Config Service Test\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async initalizeObjectUnderTest (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n    7) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (717ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (272ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (639ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    8) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  24 passing (3s)\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n\n\n  7) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async ConfigServiceAWS.fetchLeverageContractInfo (src/services/config/ConfigServiceAWS.ts:3:5924)\n      at async ConfigServiceAWS.refreshLeverageContractAddresses (src/services/config/ConfigServiceAWS.ts:3:5092)\n      at async Promise.all (index 0)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   78.27 |    41.52 |   87.32 |    78.5 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n\n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n sandbox7748464/src/services/config    |   70.95 |    37.45 |   76.92 |   71.18 |                   \n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n  ConfigServiceAWS.ts                  |   66.99 |    32.74 |   83.33 |   66.66 | ...-76,90,109-156 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":96,"line":45},"start":{"column":74,"line":45}}},{"id":"319","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:27953) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:41 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:41 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (326ms)\n\n[2/23/2024 7:30:41 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:41 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:41 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:41 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (707ms)\n\n[2/23/2024 7:30:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:42 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:42 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (268ms)\n\n[2/23/2024 7:30:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:42 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:42 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (257ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:42 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:42 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:42 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:42 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:42 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (383ms)\n\n[2/23/2024 7:30:43 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:43 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:43 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:43 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (405ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (140ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (168ms)\n\n    ✔ should fetch RPC URL (155ms)\n\n    ✔ should fetch Alt RPC URL (149ms)\n\n    ✔ should fetch Events Fetch Page Size (160ms)\n\n    ✔ should fetch NewEventsQueueURL (162ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (262ms)\n\n    1) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (390ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (834ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (315ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (652ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n  1 failing\n\n\n  1) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.86 |    47.68 |   96.71 |    89.2 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.79 |    46.06 |   96.15 |    89.4 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   91.26 |    48.67 |     100 |   91.17 | 6,24,38-41,93-98  \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":69,"line":39},"start":{"column":21,"line":39}}},{"id":"322","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:28121) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:45 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:45 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:45 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:46 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:30:46 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:46 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:46 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:46 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:46 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:47 PM] Event fetcher workflow completed.\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:30:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:47 PM] Event fetcher workflow completed.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (181ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (174ms)\n\n    ✔ should fetch RPC URL (178ms)\n\n    ✔ should fetch Alt RPC URL (208ms)\n\n    ✔ should fetch Events Fetch Page Size (198ms)\n\n    ✔ should fetch NewEventsQueueURL (186ms)\n\n\n\n  Config Service Test\n\n    7) should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (261ms)\n\n    8) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (404ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (920ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (349ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (652ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  30 passing (10s)\n  8 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  7) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n     TypeError: Cannot read properties of undefined (reading 'positionOpenerAddress')\n      at ConfigServiceAWS.getLeveragePositionOpenerAddress (src/services/config/ConfigService.ts:3:4231)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:27:35)\n\n\n  8) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   86.62 |     46.4 |   96.24 |    86.9 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   85.71 |    46.74 |     100 |   85.31 |                   \n\n  EventProcessorService.ts             |   85.41 |    45.38 |     100 |    85.1 | ...45,153-157,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   80.08 |    40.44 |   94.23 |    80.5 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   70.87 |    35.39 |   94.44 |   70.58 | ...,93-98,116-156 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":75},"start":{"column":106,"line":49}}},{"id":"323","mutatorName":"ObjectLiteral","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:28230) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:46 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:46 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (390ms)\n\n[2/23/2024 7:30:46 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:46 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:47 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (305ms)\n\n[2/23/2024 7:30:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:47 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:47 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (316ms)\n\n[2/23/2024 7:30:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:47 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:47 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (329ms)\n\n\n  PSP Events\n\n[2/23/2024 7:30:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:47 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:47 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:47 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (283ms)\n\n[2/23/2024 7:30:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:48 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:48 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (281ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (149ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (227ms)\n\n    ✔ should fetch RPC URL (166ms)\n\n    ✔ should fetch Alt RPC URL (164ms)\n\n    ✔ should fetch Events Fetch Page Size (194ms)\n\n    ✔ should fetch NewEventsQueueURL (146ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (335ms)\n\n    1) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (405ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (861ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (315ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (724ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (9s)\n\n  1 failing\n\n\n\n  1) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected -1 to be at least 6000000\n      + expected - actual\n\n      --1\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    47.76 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    46.06 |   96.15 |   90.25 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |    93.2 |    48.67 |     100 |   93.13 | 6,24,39,93-98     \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":55},"start":{"column":50,"line":50}}},{"id":"324","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:28234) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:46 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:46 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:46 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:46 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (399ms)\n\n[2/23/2024 7:30:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:47 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:47 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (272ms)\n\n[2/23/2024 7:30:47 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:47 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:47 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (298ms)\n\n[2/23/2024 7:30:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:47 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:47 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (307ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:48 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:48 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:48 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (264ms)\n\n[2/23/2024 7:30:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:48 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:48 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (276ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (169ms)\n\n    ✔ should fetch RPC URL (428ms)\n\n    ✔ should fetch Alt RPC URL (152ms)\n\n    ✔ should fetch Events Fetch Page Size (173ms)\n\n    ✔ should fetch NewEventsQueueURL (161ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (298ms)\n\n    2) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (501ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (769ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (266ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (680ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (50ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (9s)\n  2 failing\n\n\n  1) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    47.19 |   96.15 |   90.25 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |    93.2 |    51.32 |     100 |   93.13 | 6,24,39,93-98     \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":51},"start":{"column":30,"line":51}}},{"id":"325","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:28292) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:47 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:47 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (351ms)\n\n[2/23/2024 7:30:47 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:47 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:47 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (366ms)\n\n[2/23/2024 7:30:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:48 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:48 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (300ms)\n\n[2/23/2024 7:30:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:48 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:48 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (280ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:48 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:48 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:48 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (356ms)\n\n[2/23/2024 7:30:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:49 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:49 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (364ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (171ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (159ms)\n\n    ✔ should fetch RPC URL (161ms)\n\n    ✔ should fetch Alt RPC URL (156ms)\n\n    ✔ should fetch Events Fetch Page Size (185ms)\n\n    ✔ should fetch NewEventsQueueURL (208ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (243ms)\n\n    1) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (329ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (743ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (487ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (693ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (45ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  37 passing (10s)\n  1 failing\n\n\n\n  1) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    47.19 |   96.15 |   90.25 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |    93.2 |    51.32 |     100 |   93.13 | 6,24,39,93-98     \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":36,"line":52},"start":{"column":34,"line":52}}},{"id":"326","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:28346) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:47 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:47 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:47 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:48 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (375ms)\n\n[2/23/2024 7:30:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:48 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:48 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (285ms)\n\n[2/23/2024 7:30:48 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:48 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:48 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:48 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (329ms)\n\n[2/23/2024 7:30:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:49 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:49 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (462ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:49 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:49 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:49 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (274ms)\n\n[2/23/2024 7:30:49 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:49 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:49 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:49 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (255ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (219ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (157ms)\n\n    ✔ should fetch RPC URL (167ms)\n\n    ✔ should fetch Alt RPC URL (221ms)\n\n    ✔ should fetch Events Fetch Page Size (187ms)\n\n    ✔ should fetch NewEventsQueueURL (189ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (363ms)\n\n    1) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (432ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1009ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (431ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (863ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n  37 passing (10s)\n  1 failing\n\n\n  1) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.04 |    47.92 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    47.19 |   96.15 |   90.25 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |    93.2 |    51.32 |     100 |   93.13 | 6,24,39,93-98     \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":32,"line":53},"start":{"column":30,"line":53}}},{"id":"327","mutatorName":"StringLiteral","replacement":"\"Stryker was here!\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:28401) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:50 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:50 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:50 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:50 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (381ms)\n\nFailed to refresh leverage contract addresses: Error: Error fetching configuration for LeverageContractInfo: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n    at AppConfigClient.fetchConfigRawString (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/AppConfigClient.ts:3:4217)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async ConfigServiceAWS.fetchLeverageContractInfo (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5924)\n    at async ConfigServiceAWS.refreshLeverageContractAddresses (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:5092)\n    at async Promise.all (index 0)\n    at async ConfigServiceAWS.refreshConfig (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/services/config/ConfigServiceAWS.ts:3:3482)\n    at async handler (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/src/lambda-handler.ts:3:3855)\n    at async Context.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/acceptance/LeverageEvents.test.ts:65:5)\n\nError: Error fetching configuration for LeverageContractInfo: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n\n    1) should process PositionClosed event and push messages to SQS\n\nError: Nock: No match for request {\n  \"method\": \"GET\",\n  \"url\": \"https://wbtc-engine-events-store.s3.us-east-1.amazonaws.com/last-block-number?x-id=GetObject\",\n  \"headers\": {\n    \"host\": \"wbtc-engine-events-store.s3.us-east-1.amazonaws.com\",\n    \"x-amz-user-agent\": \"aws-sdk-js/3.490.0\",\n    \"user-agent\": \"aws-sdk-js/3.490.0 ua/2.0 os/darwin#23.2.0 lang/js md/nodejs#21.2.0 api/s3#3.490.0\",\n    \"amz-sdk-invocation-id\": \"98148cab-bd6d-4e27-94be-eae4c81f79e7\",\n    \"amz-sdk-request\": \"attempt=1; max=3\",\n    \"x-amz-date\": \"20240224T003050Z\",\n    \"x-amz-content-sha256\": \"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\",\n    \"authorization\": \"AWS4-HMAC-SHA256 Credential=AKIATQF26W6HECG356FO/20240224/us-east-1/s3/aws4_request, SignedHeaders=amz-sdk-invocation-id;amz-sdk-request;host;x-amz-content-sha256;x-amz-date;x-amz-user-agent, Signature=5383affbe67e4bc4948cf31efd943806c1f0dfac4ed8183e444375025c7948d5\"\n  }\n}\n\n    2) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:51 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:51 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (338ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:51 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:51 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:51 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:51 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (318ms)\n\n[2/23/2024 7:30:51 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:51 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:51 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:51 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (295ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (251ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (216ms)\n\n    ✔ should fetch RPC URL (153ms)\n\n    ✔ should fetch Alt RPC URL (165ms)\n\n    ✔ should fetch Events Fetch Page Size (162ms)\n\n    ✔ should fetch NewEventsQueueURL (222ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (244ms)\n\n    3) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (410ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (688ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (256ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (783ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (9s)\n\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.94 |     48.4 |   96.71 |   90.31 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   90.47 |    48.52 |     100 |    90.2 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   92.53 |    48.68 |   96.15 |   93.22 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   97.08 |    53.09 |     100 |   97.05 | 6,24,39           \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":35,"line":54},"start":{"column":33,"line":54}}},{"id":"328","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:28458) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:52 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:30:52 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:52 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:30:52 PM] Event fetcher workflow completed.\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:30:52 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:52 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:52 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:30:52 PM] Event fetcher workflow completed.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:30:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:53 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:30:53 PM] Event fetcher workflow completed.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:53 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:53 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:53 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (324ms)\n\n[2/23/2024 7:30:53 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:53 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:53 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:53 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (300ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (202ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (165ms)\n\n    ✔ should fetch RPC URL (178ms)\n\n    ✔ should fetch Alt RPC URL (165ms)\n\n    ✔ should fetch Events Fetch Page Size (183ms)\n\n    ✔ should fetch NewEventsQueueURL (150ms)\n\n\n\n  Config Service Test\n\n    5) should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (262ms)\n\n    6) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (336ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (811ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (301ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (705ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  32 passing (9s)\n  6 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:28:43)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   87.43 |    46.96 |   96.71 |   87.73 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   82.15 |    42.69 |   96.15 |   82.62 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   75.72 |     40.7 |     100 |   75.49 | ...,93-98,127-151 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":72},"start":{"column":37,"line":57}}},{"id":"329","mutatorName":"ConditionalExpression","replacement":"case 'PositionOpener':","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:28516) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:57 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:30:57 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:57 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:57 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:57 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (400ms)\n\n[2/23/2024 7:30:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:58 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (306ms)\n\n[2/23/2024 7:30:58 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:58 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (295ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:58 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:58 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:58 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Deposit event\n\n[2/23/2024 7:30:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:59 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:59 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (159ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (185ms)\n\n    ✔ should fetch RPC URL (171ms)\n\n    ✔ should fetch Alt RPC URL (149ms)\n\n    ✔ should fetch Events Fetch Page Size (174ms)\n\n    ✔ should fetch NewEventsQueueURL (143ms)\n\n\n\n  Config Service Test\n\n    4) should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (276ms)\n\n    5) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (373ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (932ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (325ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (639ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  33 passing (9s)\n  5 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:28:43)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.92 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.38 |    47.19 |   96.15 |   88.98 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   90.29 |    51.32 |     100 |   90.19 | ...,93-98,131-133 \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":61},"start":{"column":9,"line":59}}},{"id":"331","mutatorName":"ConditionalExpression","replacement":"case 'PositionLiquidator':","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:28627) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:58 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (335ms)\n\n[2/23/2024 7:30:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:58 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:30:59 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:30:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:59 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:59 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (316ms)\n\n[2/23/2024 7:30:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:59 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:59 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (273ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:30:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:59 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:59 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:59 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (304ms)\n\n[2/23/2024 7:31:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:00 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:00 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (297ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (174ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (159ms)\n\n    ✔ should fetch RPC URL (479ms)\n\n    ✔ should fetch Alt RPC URL (248ms)\n\n    ✔ should fetch Events Fetch Page Size (150ms)\n\n    ✔ should fetch NewEventsQueueURL (153ms)\n\n\n\n  Config Service Test\n\n    2) should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (249ms)\n\n    3) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (352ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (994ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (297ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (706ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (9s)\n\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:32:43)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.92 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   88.38 |    47.19 |   96.15 |   88.98 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   90.29 |    51.32 |     100 |   90.19 | ...,93-98,137-139 \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":64},"start":{"column":9,"line":62}}},{"id":"330","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:28595) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:58 PM] Unknown event topic, 0x80feb7c33cd39a42e347b6b7577a63af2c7a96c236e85c200c8f39e11be679dd\n\n[2/23/2024 7:30:58 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:30:58 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:58 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (297ms)\n\n[2/23/2024 7:30:58 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:58 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:58 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:30:58 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (277ms)\n\n[2/23/2024 7:30:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:59 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:30:59 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (357ms)\n\n\n  PSP Events\n\n[2/23/2024 7:30:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:59 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:30:59 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:30:59 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (517ms)\n\n[2/23/2024 7:31:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:00 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:00 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (305ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (150ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (172ms)\n\n    ✔ should fetch RPC URL (539ms)\n\n    ✔ should fetch Alt RPC URL (231ms)\n\n    ✔ should fetch Events Fetch Page Size (147ms)\n\n    ✔ should fetch NewEventsQueueURL (156ms)\n\n\n\n  Config Service Test\n\n    2) should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (239ms)\n\n    3) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (352ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1200ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (407ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (693ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:28:43)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   89.04 |    48.08 |   96.71 |   89.39 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   89.62 |    47.94 |   96.15 |   90.25 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |    93.2 |    53.09 |     100 |   93.13 | 6,24,39,93-98     \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":59},"start":{"column":14,"line":59}}},{"id":"332","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n(node:28683) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:30:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:59 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:59 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (404ms)\n\n[2/23/2024 7:30:59 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:30:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:59 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:30:59 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (285ms)\n\n[2/23/2024 7:30:59 PM] Executing the event fetcher workflow...\n[2/23/2024 7:30:59 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:30:59 PM] Unknown event topic, 0x5564304997c5a4b15399de434a73fbc4339eae8f1b5b2875d0feac2826ce33d2\n\n[2/23/2024 7:31:00 PM] Event fetcher workflow completed.\n\n    1) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:31:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:00 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (286ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:31:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:00 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:31:00 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:31:00 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (284ms)\n\n[2/23/2024 7:31:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:01 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:01 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (677ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (150ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (145ms)\n\n    ✔ should fetch RPC URL (158ms)\n\n    ✔ should fetch Alt RPC URL (168ms)\n\n    ✔ should fetch Events Fetch Page Size (160ms)\n\n    ✔ should fetch NewEventsQueueURL (147ms)\n\n\n  Config Service Test\n\n    2) should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (288ms)\n\n    3) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (453ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (929ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (505ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (796ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event (41ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n  3 failing\n\n\n\n  1) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:32:43)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected -1 to be at least 6000000\n      + expected - actual\n\n      --1\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\nError: ENOENT: no such file or directory, open '/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/.nyc_output/processinfo/f8e609f1-0f5e-41eb-97de-d8239e74026c.json'\n    at Object.openSync (node:fs:581:18)\n    at Object.writeFileSync (node:fs:2345:35)\n    at ProcessInfo.saveSync (/Users/tomermayara/github/EventFetcherService/node_modules/istanbul-lib-processinfo/index.js:75:8)\n    at NYC.writeCoverageFile (/Users/tomermayara/github/EventFetcherService/node_modules/nyc/index.js:422:22)\n    at EventEmitter.onExit.alwaysLast (/Users/tomermayara/github/EventFetcherService/node_modules/nyc/index.js:372:14)\n    at EventEmitter.emit (node:events:519:28)\n    at EventEmitter.emit (node:domain:488:12)\n    at emit (/Users/tomermayara/github/EventFetcherService/node_modules/signal-exit/index.js:105:13)\n    at processEmit (/Users/tomermayara/github/EventFetcherService/node_modules/signal-exit/index.js:195:7)\n    at process.emit (/Users/tomermayara/github/EventFetcherService/node_modules/source-map-support/source-map-support.js:465:21) {\n  errno: -2,\n  code: 'ENOENT',\n  syscall: 'open',\n  path: '/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/.nyc_output/processinfo/f8e609f1-0f5e-41eb-97de-d8239e74026c.json'\n}\n\nENOENT: no such file or directory, scandir '/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/.nyc_output/processinfo'\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":34,"line":62},"start":{"column":14,"line":62}}},{"id":"333","mutatorName":"ConditionalExpression","replacement":"case 'PositionCloser':","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:28738) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:31:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:00 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:31:00 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (345ms)\n\n[2/23/2024 7:31:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:00 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:31:00 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:31:00 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:00 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:01 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:31:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (460ms)\n\n[2/23/2024 7:31:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:01 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (354ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:31:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:01 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:31:01 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:31:01 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (308ms)\n\n[2/23/2024 7:31:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:01 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:01 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (184ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (160ms)\n\n    ✔ should fetch RPC URL (137ms)\n\n    ✔ should fetch Alt RPC URL (180ms)\n\n    ✔ should fetch Events Fetch Page Size (194ms)\n\n    ✔ should fetch NewEventsQueueURL (154ms)\n\n\n\n  Config Service Test\n\n    3) should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (276ms)\n\n    4) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (401ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (968ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (315ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (728ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (10s)\n\n  4 failing\n\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:36:43)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n\nError: ENOENT: no such file or directory, open '/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/.nyc_output/processinfo/4b40f464-fb30-4fa2-820b-3196a879612d.json'\n    at Object.openSync (node:fs:581:18)\n    at Object.writeFileSync (node:fs:2345:35)\n    at ProcessInfo.saveSync (/Users/tomermayara/github/EventFetcherService/node_modules/istanbul-lib-processinfo/index.js:75:8)\n    at NYC.writeCoverageFile (/Users/tomermayara/github/EventFetcherService/node_modules/nyc/index.js:422:22)\n    at EventEmitter.onExit.alwaysLast (/Users/tomermayara/github/EventFetcherService/node_modules/nyc/index.js:372:14)\n    at EventEmitter.emit (node:events:519:28)\n    at EventEmitter.emit (node:domain:488:12)\n    at emit (/Users/tomermayara/github/EventFetcherService/node_modules/signal-exit/index.js:105:13)\n    at processEmit (/Users/tomermayara/github/EventFetcherService/node_modules/signal-exit/index.js:195:7)\n    at process.emit (/Users/tomermayara/github/EventFetcherService/node_modules/source-map-support/source-map-support.js:465:21) {\n  errno: -2,\n  code: 'ENOENT',\n  syscall: 'open',\n  path: '/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/.nyc_output/processinfo/4b40f464-fb30-4fa2-820b-3196a879612d.json'\n}\n\nENOENT: no such file or directory, scandir '/Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/.nyc_output/processinfo'\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":67},"start":{"column":9,"line":65}}},{"id":"334","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:28793) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:31:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:01 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:31:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (397ms)\n\n[2/23/2024 7:31:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:01 PM] Unknown event topic, 0x3120c845c5d2c39308641201562a412527c1e7aff294f09c0c936f1c60a1b067\n\n[2/23/2024 7:31:01 PM] Event fetcher workflow completed.\n\n    1) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:31:01 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:01 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:01 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:31:01 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (267ms)\n\n[2/23/2024 7:31:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:02 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:02 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (309ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:31:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:02 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:31:02 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:31:02 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (257ms)\n\n[2/23/2024 7:31:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:02 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:02 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:02 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (332ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (161ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (215ms)\n\n    ✔ should fetch RPC URL (160ms)\n\n    ✔ should fetch Alt RPC URL (170ms)\n\n    ✔ should fetch Events Fetch Page Size (192ms)\n\n    ✔ should fetch NewEventsQueueURL (194ms)\n\n\n\n  Config Service Test\n\n    2) should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (264ms)\n\n    3) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (429ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (853ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (361ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (750ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (10s)\n  3 failing\n\n\n  1) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       should get the correct leverage contract addresses from AWS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:36:43)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.68 |    47.76 |   96.71 |   89.02 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   87.96 |    46.44 |   96.15 |   88.55 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   89.32 |    49.55 |     100 |   89.21 | ...,93-98,142-145 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":30,"line":65},"start":{"column":14,"line":65}}},{"id":"335","mutatorName":"ConditionalExpression","replacement":"case 'positionExpirator':","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:28857) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:31:02 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:03 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:31:03 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (375ms)\n\n[2/23/2024 7:31:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:03 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:31:03 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (306ms)\n\n[2/23/2024 7:31:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:03 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:31:03 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (275ms)\n\n[2/23/2024 7:31:03 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:03 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:03 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:31:04 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\n[2/23/2024 7:31:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:04 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:31:04 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:31:04 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (301ms)\n\n[2/23/2024 7:31:04 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:04 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:04 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:04 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (330ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (224ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (163ms)\n\n    ✔ should fetch RPC URL (207ms)\n\n    ✔ should fetch Alt RPC URL (204ms)\n\n    ✔ should fetch Events Fetch Page Size (247ms)\n\n    ✔ should fetch NewEventsQueueURL (271ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (264ms)\n\n    2) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (325ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1135ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (443ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (673ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  36 passing (10s)\n  2 failing\n\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.77 |    47.92 |   96.71 |   89.11 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   88.38 |    47.19 |   96.15 |   88.98 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   90.29 |    51.32 |     100 |   90.19 | ...,93-98,149-151 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":17,"line":70},"start":{"column":9,"line":68}}},{"id":"338","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:29029) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    1) should process PositionOpened event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    2) should process PositionClosed event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    3) should process PositionLiquidated event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    5) should catch and report on Deposit event\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    ✔ should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (315ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (189ms)\n\n    ✔ should fetch RPC URL (173ms)\n\n    ✔ should fetch Alt RPC URL (143ms)\n\n    ✔ should fetch Events Fetch Page Size (140ms)\n\n    ✔ should fetch NewEventsQueueURL (146ms)\n\n\n\n  Config Service Test\n\n    6) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1038ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (377ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (660ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  26 passing (4s)\n\n  6 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n\n\n  6) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async ConfigServiceAWS.refreshPSPContractInfo (src/services/config/ConfigServiceAWS.ts:3:9414)\n      at async Promise.all (index 1)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   80.16 |    42.88 |   88.26 |   80.44 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n\n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n\n sandbox7748464/src/services/config    |   79.66 |    43.82 |   80.76 |   80.08 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n\n  ConfigServiceAWS.ts                  |   87.37 |    47.78 |   94.44 |   87.25 | ...0-76,93-98,165 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":82,"line":78},"start":{"column":65,"line":78}}},{"id":"340","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:29140) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    1) should process PositionOpened event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    2) should process PositionClosed event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    5) should catch and report on Deposit event\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (340ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (157ms)\n\n    ✔ should fetch RPC URL (336ms)\n\n    ✔ should fetch Alt RPC URL (155ms)\n\n    ✔ should fetch Events Fetch Page Size (148ms)\n\n    ✔ should fetch NewEventsQueueURL (160ms)\n\n\n\n  Config Service Test\n\n    7) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1230ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (350ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (654ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  25 passing (4s)\n\n  7 failing\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n\n\n  7) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async ConfigServiceAWS.refreshLastScannedBlock (src/services/config/ConfigServiceAWS.ts:3:9914)\n      at async Promise.all (index 2)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   80.07 |    42.72 |   88.26 |   80.35 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n\n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n\n sandbox7748464/src/services/config    |   79.25 |    43.07 |   80.76 |   79.66 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n\n  ConfigServiceAWS.ts                  |    86.4 |    46.01 |   94.44 |   86.27 | ...,93-98,174-175 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":103,"line":83},"start":{"column":76,"line":83}}},{"id":"336","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:28917) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:31:08 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:08 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:08 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:31:08 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (506ms)\n\n[2/23/2024 7:31:09 PM] Executing the event fetcher workflow...\n[2/23/2024 7:31:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:09 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:31:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (332ms)\n\n[2/23/2024 7:31:09 PM] Executing the event fetcher workflow...\n[2/23/2024 7:31:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:09 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:31:09 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (270ms)\n\n[2/23/2024 7:31:09 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:09 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:09 PM] Unknown event topic, 0x412514176d888af8c5fdb2ccf226830116c0cc86036a8f50a8ae8fb12d348d78\n\n[2/23/2024 7:31:09 PM] Event fetcher workflow completed.\n\n    1) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:31:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:10 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:31:10 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:31:10 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (294ms)\n\n[2/23/2024 7:31:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:10 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:10 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (317ms)\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (348ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (198ms)\n\n    ✔ should fetch RPC URL (152ms)\n\n    ✔ should fetch Alt RPC URL (152ms)\n\n    ✔ should fetch Events Fetch Page Size (152ms)\n\n    ✔ should fetch NewEventsQueueURL (165ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (235ms)\n\n    2) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (348ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    3) \"before each\" hook for \"should retrieve page size from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (936ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (406ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (678ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  34 passing (8s)\n  3 failing\n\n\n  1) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n  3) Config Service Test\n       \"before each\" hook for \"should retrieve page size from AWS\":\n     Error: Error fetching configuration for PSPStrategyInfo: Error: getaddrinfo ENOTFOUND appconfig.us-east-1.amazonaws.com\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n      at async ConfigServiceAWS.refreshPSPContractInfo (src/services/config/ConfigServiceAWS.ts:3:9414)\n      at async Promise.all (index 1)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   88.95 |    47.92 |   96.71 |   89.29 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.33 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.15 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   89.21 |    47.19 |   96.15 |   89.83 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |   89.32 |    49.55 |     100 |   89.21 | ...,93-98,148-151 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":33,"line":68},"start":{"column":14,"line":68}}},{"id":"341","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:29195) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nError: No value provided for input HTTP label: Bucket.\n\n    1) should process PositionOpened event and push messages to SQS\n\nError: No value provided for input HTTP label: Bucket.\n\n    2) should process PositionClosed event and push messages to SQS\n\nError: No value provided for input HTTP label: Bucket.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nError: No value provided for input HTTP label: Bucket.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nError: No value provided for input HTTP label: Bucket.\n\n    5) should catch and report on Deposit event\n\nError: No value provided for input HTTP label: Bucket.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (145ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (175ms)\n\n    ✔ should fetch RPC URL (189ms)\n\n    ✔ should fetch Alt RPC URL (198ms)\n\n    ✔ should fetch Events Fetch Page Size (164ms)\n\n    ✔ should fetch NewEventsQueueURL (168ms)\n\n\n\n  Config Service Test\n\n    7) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (810ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (355ms)\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (684ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  25 passing (5s)\n  7 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: No value provided for input HTTP label: Bucket.\n      at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n      at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n      at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   79.89 |    42.72 |   88.26 |   80.16 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n\n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n sandbox7748464/src/services/config    |   78.42 |    43.07 |   80.76 |   78.81 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n\n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n\n  ConfigServiceAWS.ts                  |   87.37 |    47.78 |   94.44 |   87.25 | ...0-76,93-98,175 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":68,"line":84},"start":{"column":60,"line":84}}},{"id":"339","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:29084) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:31:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:11 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:31:11 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (327ms)\n\n[2/23/2024 7:31:11 PM] Executing the event fetcher workflow...\n[2/23/2024 7:31:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:11 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:31:11 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (298ms)\n\n[2/23/2024 7:31:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:12 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:31:12 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (372ms)\n\n[2/23/2024 7:31:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:12 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:12 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (254ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:31:12 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:12 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:31:12 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:31:12 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Deposit event (269ms)\n\n[2/23/2024 7:31:12 PM] Executing the event fetcher workflow...\n[2/23/2024 7:31:12 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:12 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:12 PM] Event fetcher workflow completed.\n\n    ✔ should catch and report on Withdraw event (268ms)\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (207ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (148ms)\n\n    ✔ should fetch RPC URL (164ms)\n\n    ✔ should fetch Alt RPC URL (229ms)\n\n    ✔ should fetch Events Fetch Page Size (165ms)\n\n    ✔ should fetch NewEventsQueueURL (184ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (250ms)\n\n    1) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (507ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (857ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (321ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (742ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event (77ms)\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    2) should report on PositionLiqiuidated event\n\n    3) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  35 passing (8s)\n  3 failing\n\n\n\n  1) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n  2) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     AssertionError: expected undefined to equal 'LeveragedPositionLiquidated'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n  3) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\nAll files                              |   88.68 |    46.96 |   96.71 |   89.02 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   88.43 |    42.01 |     100 |   88.11 |                   \n  EventProcessorService.ts             |   89.58 |    39.23 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   87.96 |    46.06 |   96.15 |   88.55 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n  ConfigServiceAWS.ts                  |   89.32 |    48.67 |     100 |   89.21 | ...,93-98,172-175 \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":86},"start":{"column":58,"line":82}}},{"id":"337","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n  Leverage Events\n\n(node:28996) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n[2/23/2024 7:31:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:10 PM] Event fetcher workflow completed.\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:31:10 PM] Executing the event fetcher workflow...\n[2/23/2024 7:31:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:10 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:31:10 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (441ms)\n\n[2/23/2024 7:31:10 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:10 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:11 PM] Event fetcher workflow completed.\n\n    2) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:31:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:11 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:11 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (287ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:31:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:11 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n[2/23/2024 7:31:11 PM] Unknown event topic, 0xdcbc1c05240f31ff3ad067ef1ee35ce4997762752e3a095284754544f4c709d7\n\n[2/23/2024 7:31:11 PM] Event fetcher workflow completed.\n\n    3) should catch and report on Deposit event\n\n[2/23/2024 7:31:11 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:11 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:11 PM] Unknown event topic, 0xfbde797d201c681b91056529119e0b02407c7bb96a4a2c75c01fc9667232c8db\n\n[2/23/2024 7:31:12 PM] Event fetcher workflow completed.\n\n    4) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (170ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (472ms)\n\n    ✔ should fetch RPC URL (151ms)\n\n    ✔ should fetch Alt RPC URL (150ms)\n\n    ✔ should fetch Events Fetch Page Size (195ms)\n\n    ✔ should fetch NewEventsQueueURL (166ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    5) should get the correct PSP contract addresses from AWS\n\n    6) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (336ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (917ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (380ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (843ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    7) should report on Deposit event\n\n    8) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n  30 passing (10s)\n  8 failing\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  3) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  4) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) Config Service Test\n       should get the correct PSP contract addresses from AWS:\n\n      AssertionError: expected '0xF326Cd46A1A189B305AFF7500b02C5C26b4…' to equal ''\n      + expected - actual\n\n      -0xF326Cd46A1A189B305AFF7500b02C5C26b405266\n      \n      at /Users/tomermayara/github/EventFetcherService/.stryker-tmp/sandbox7748464/test/interface/ConfigServiceAWSInterface.test.ts:49:34\n      at Array.forEach (<"+"anonymous>)\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:47:29)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n  7) PSP Events Logging\n       should report on Deposit event:\n\n      AssertionError: expected 'LeveragedPositionOpened' to equal 'Deposit'\n      + expected - actual\n\n      -LeveragedPositionOpened\n      +Deposit\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:66:5)\n\n\n  8) PSP Events Logging\n       should report on Withdraw event:\n\n      AssertionError: expected 'LeveragedPositionClosed' to equal 'Withdraw'\n      + expected - actual\n\n      -LeveragedPositionClosed\n      +Withdraw\n      \n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.31 |    48.56 |   96.71 |   89.66 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   88.43 |    47.92 |     100 |   88.11 |                   \n\n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n\n  lambda-handler.ts                    |   86.27 |    51.28 |     100 |   85.71 | 24,38-41,72-76    \n\n sandbox7748464/src/onchain_events     |   87.26 |    50.97 |   86.48 |   89.05 |                   \n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      90 |    49.01 |     100 |   89.79 | 6,24,38-41        \n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    48.68 |   96.15 |   90.25 |                   \n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    48.42 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |    93.2 |    53.09 |     100 |   93.13 | 6,24,39,93-98     \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":80},"start":{"column":57,"line":77}}},{"id":"342","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:29250) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nError: No value provided for input HTTP label: Key.\n\n    1) should process PositionOpened event and push messages to SQS\n\nError: No value provided for input HTTP label: Key.\n    2) should process PositionClosed event and push messages to SQS\n\nError: No value provided for input HTTP label: Key.\n\n    3) should process PositionLiquidated event and push messages to SQS\n\nError: No value provided for input HTTP label: Key.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nError: No value provided for input HTTP label: Key.\n\n    5) should catch and report on Deposit event\n\nError: No value provided for input HTTP label: Key.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (161ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (193ms)\n\n    ✔ should fetch RPC URL (186ms)\n\n    ✔ should fetch Alt RPC URL (154ms)\n\n    ✔ should fetch Events Fetch Page Size (174ms)\n\n    ✔ should fetch NewEventsQueueURL (169ms)\n\n\n\n  Config Service Test\n\n    7) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (963ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (351ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (875ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  25 passing (5s)\n  7 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: No value provided for input HTTP label: Key.\n      at resolvedPath (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/smithy-client/dist-cjs/index.js:1125:11)\n      at /Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:392:57\n      at _RequestBuilder.build (/Users/tomermayara/github/EventFetcherService/node_modules/@smithy/core/dist-cjs/index.js:358:7)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.58 |     48.8 |   96.71 |   89.94 |                   \n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n sandbox7748464/src                    |   90.47 |    49.11 |     100 |    90.2 |                   \n  EventProcessorService.ts             |   89.58 |    46.92 |     100 |   89.36 | ...-41,95-100,183 \n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n sandbox7748464/src/onchain_events     |   87.26 |    50.97 |   86.48 |   89.05 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      90 |    49.01 |     100 |   89.79 | 6,24,38-41        \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n sandbox7748464/src/services/config    |   89.62 |    49.06 |   96.15 |   90.25 |                   \n\n  AppConfigClient.ts                   |      80 |    40.67 |     100 |   79.62 | ...,78-82,107-111 \n  ConfigService.ts                     |   91.56 |    48.42 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |    93.2 |    53.98 |     100 |   93.13 | 6,24,39,93-98     \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":80,"line":84},"start":{"column":75,"line":84}}},{"id":"345","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n  Leverage Events\n\n(node:29420) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    1) should process PositionOpened event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    2) should process PositionClosed event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    3) should process PositionLiquidated event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    5) should catch and report on Deposit event\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    6) should catch and report on Withdraw event\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (254ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (259ms)\n\n    ✔ should fetch RPC URL (163ms)\n\n    ✔ should fetch Alt RPC URL (150ms)\n\n    ✔ should fetch Events Fetch Page Size (196ms)\n\n    ✔ should fetch NewEventsQueueURL (173ms)\n\n\n\n  Config Service Test\n\n    7) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1149ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (457ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (661ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event (40ms)\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    8) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  24 passing (4s)\n\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n\n\n  7) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Promise.all (index 0)\n      at async ConfigServiceAWS.refreshRPCURL (src/services/config/ConfigServiceAWS.ts:3:10749)\n      at async Promise.all (index 3)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     AssertionError: expected undefined to equal 'LeveragedPositionLiquidated'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   80.07 |    42.88 |   88.26 |   80.35 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n\n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n\n sandbox7748464/src/services/config    |   79.25 |    43.82 |   80.76 |   79.66 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n\n  ConfigServiceAWS.ts                  |    86.4 |    47.78 |   94.44 |   86.27 | ...,93-98,184-185 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":57,"line":90},"start":{"column":49,"line":90}}},{"id":"346","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:29475) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    1) should process PositionOpened event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    2) should process PositionClosed event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    3) should process PositionLiquidated event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    5) should catch and report on Deposit event\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (241ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (153ms)\n\n    ✔ should fetch RPC URL (179ms)\n\n    ✔ should fetch Alt RPC URL (165ms)\n\n    ✔ should fetch Events Fetch Page Size (143ms)\n\n    ✔ should fetch NewEventsQueueURL (145ms)\n\n\n\n  Config Service Test\n\n    7) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1103ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (338ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (698ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    8) should report on PositionOpened event\n\n    9) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  23 passing (4s)\n\n  9 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n\n\n  7) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async Promise.all (index 1)\n      at async ConfigServiceAWS.refreshRPCURL (src/services/config/ConfigServiceAWS.ts:3:10749)\n      at async Promise.all (index 3)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 'LeveragedPositionOpened'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     AssertionError: expected undefined to equal 'LeveragedPositionClosed'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   80.07 |    43.04 |   88.26 |   80.35 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n\n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n\n sandbox7748464/src/services/config    |   79.25 |    44.56 |   80.76 |   79.66 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n\n  ConfigServiceAWS.ts                  |    86.4 |    49.55 |   94.44 |   86.27 | ...,93-98,184-185 \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":60,"line":91},"start":{"column":49,"line":91}}},{"id":"348","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:29641) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    1) should process PositionOpened event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    2) should process PositionClosed event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    3) should process PositionLiquidated event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    5) should catch and report on Deposit event\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (279ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (167ms)\n\n    ✔ should fetch RPC URL (159ms)\n\n    ✔ should fetch Alt RPC URL (149ms)\n\n    ✔ should fetch Events Fetch Page Size (146ms)\n\n    ✔ should fetch NewEventsQueueURL (393ms)\n\n\n\n  Config Service Test\n\n    7) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (657ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (262ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (712ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    8) should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  24 passing (4s)\n\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n\n\n  7) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async ConfigServiceAWS.refreshEventFetchPageSize (src/services/config/ConfigServiceAWS.ts:3:11556)\n      at async Promise.all (index 4)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n  8) Leverage Events Logging & Queuing\n       should report on PositionExpired event:\n     AssertionError: expected undefined to equal 'LeveragedPositionExpired'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:146:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   80.16 |    42.88 |   88.26 |   80.44 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   40.13 |    17.15 |      50 |   39.86 |                   \n\n  EventProcessorService.ts             |   14.58 |     5.38 |   18.18 |   14.89 | 6,16-46,63-183    \n\n  lambda-handler.ts                    |   88.23 |    56.41 |     100 |   87.75 | 24,38-41,67-68    \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n ...box7748464/src/services/blockchain |   84.26 |    44.44 |   94.11 |    83.9 |                   \n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n  EventFetcherRPC.ts                   |   81.25 |       40 |      90 |   80.85 | 6,24,38-41,78-83  \n sandbox7748464/src/services/config    |   79.66 |    43.82 |   80.76 |   80.08 |                   \n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n  ConfigService.ts                     |   66.26 |    38.94 |      64 |    67.5 | ...29-165,177-181 \n  ConfigServiceAWS.ts                  |   87.37 |    47.78 |   94.44 |   87.25 | ...0-76,93-98,194 \n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":86,"line":99},"start":{"column":65,"line":99}}},{"id":"343","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:29305) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:31:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:16 PM] RPC: \n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:16 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:31:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:16 PM] RPC: \n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:16 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:31:16 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:16 PM] RPC: \n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:16 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:31:16 PM] Executing the event fetcher workflow...\n[2/23/2024 7:31:16 PM] RPC: \n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:16 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:31:17 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:17 PM] RPC: \n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:17 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:31:17 PM] Executing the event fetcher workflow...\n[2/23/2024 7:31:17 PM] RPC: \n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:17 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (159ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (158ms)\n\n    ✔ should fetch RPC URL (160ms)\n\n    ✔ should fetch Alt RPC URL (158ms)\n\n    ✔ should fetch Events Fetch Page Size (151ms)\n\n    ✔ should fetch NewEventsQueueURL (153ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (365ms)\n\n    7) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (576ms)\n\n    8) should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (1647ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (380ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (692ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    9) should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  29 passing (10s)\n\n  9 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n  8) Config Service Test\n       should get main and alt RPC URL from AWS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:101:48)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 'LeveragedPositionOpened'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   86.71 |    45.28 |   95.77 |   87.08 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   69.38 |    26.03 |   88.88 |   69.23 |                   \n\n  EventProcessorService.ts             |   57.29 |    16.92 |   81.81 |   57.44 | ...13-157,173-183 \n\n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   87.64 |    46.66 |     100 |   87.35 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |    87.5 |    44.44 |     100 |   87.23 | 6,24,38-41,83     \n\n sandbox7748464/src/services/config    |   90.87 |    48.68 |   96.15 |   91.52 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |    93.2 |    53.09 |     100 |   93.13 | 6,24,39,93-98     \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":96},"start":{"column":48,"line":88}}},{"id":"344","mutatorName":"ArrayDeclaration","replacement":"[]","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:29365) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:31:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:18 PM] RPC: undefined\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:18 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    1) should process PositionOpened event and push messages to SQS\n\n[2/23/2024 7:31:18 PM] Executing the event fetcher workflow...\n[2/23/2024 7:31:18 PM] RPC: undefined\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:18 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    2) should process PositionClosed event and push messages to SQS\n\n[2/23/2024 7:31:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:18 PM] RPC: undefined\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:18 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    3) should process PositionLiquidated event and push messages to SQS\n\n[2/23/2024 7:31:18 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:18 PM] RPC: undefined\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:18 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n  PSP Events\n\n[2/23/2024 7:31:19 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:19 PM] RPC: undefined\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:19 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    5) should catch and report on Deposit event\n\n[2/23/2024 7:31:19 PM] Executing the event fetcher workflow...\n[2/23/2024 7:31:19 PM] RPC: undefined\n\n                        SQS queue: https://sqs.us-east-1.amazonaws.com/240910251918/wbtc_engine_events_queue_demo\n\n                        Env: Demo\n\n[2/23/2024 7:31:19 PM] Error in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n\nError in event fetcher workflow: Error: could not detect network (event=\"noNetwork\", code=NETWORK_ERROR, version=providers/5.7.2)\n    at Logger.makeError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:269:28)\n    at Logger.throwError (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/logger/src.ts/index.ts:281:20)\n    at JsonRpcProvider.<"+"anonymous> (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:483:23)\n    at step (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\n    at Object.throw (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\n    at rejected (/Users/tomermayara/github/EventFetcherService/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:21:65)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5) {\n  reason: 'could not detect network',\n  code: 'NETWORK_ERROR',\n  event: 'noNetwork'\n}\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (168ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (273ms)\n\n    ✔ should fetch RPC URL (154ms)\n\n    ✔ should fetch Alt RPC URL (192ms)\n\n    ✔ should fetch Events Fetch Page Size (208ms)\n\n    ✔ should fetch NewEventsQueueURL (149ms)\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (240ms)\n\n    7) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (588ms)\n\n    8) should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    ✔ should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (631ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (301ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (659ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    9) should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  29 passing (8s)\n\n  9 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:38:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n     AssertionError: expected null not to be null\n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:60:32)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  7) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n  8) Config Service Test\n       should get main and alt RPC URL from AWS:\n     TypeError: Cannot read properties of undefined (reading 'startsWith')\n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:101:23)\n\n\n  9) Leverage Events Logging & Queuing\n       should report on PositionLiqiuidated event:\n     AssertionError: expected undefined to equal 'LeveragedPositionLiquidated'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:119:5)\n\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   86.71 |    45.36 |   95.77 |   87.08 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   69.38 |    26.03 |   88.88 |   69.23 |                   \n\n  EventProcessorService.ts             |   57.29 |    16.92 |   81.81 |   57.44 | ...13-157,173-183 \n\n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   87.64 |    46.66 |     100 |   87.35 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |    87.5 |    44.44 |     100 |   87.23 | 6,24,38-41,83     \n\n sandbox7748464/src/services/config    |   90.87 |    49.06 |   96.15 |   91.52 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |    93.2 |    53.98 |     100 |   93.13 | 6,24,39,93-98     \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":6,"line":92},"start":{"column":55,"line":89}}},{"id":"350","mutatorName":"StringLiteral","replacement":"\"\"","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n\n(node:29697) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    1) should process PositionOpened event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    2) should process PositionClosed event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n    3) should process PositionLiquidated event and push messages to SQS\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    4) should process PositionExpired event and push messages to SQS\n\n\n\n  PSP Events\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    5) should catch and report on Deposit event\n\nError: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n\n    6) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (247ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (163ms)\n\n    ✔ should fetch RPC URL (154ms)\n\n    ✔ should fetch Alt RPC URL (182ms)\n\n    ✔ should fetch Events Fetch Page Size (146ms)\n\n    ✔ should fetch NewEventsQueueURL (144ms)\n\n\n\n  Config Service Test\n\n    7) \"before each\" hook for \"should get the correct leverage contract addresses from AWS\"\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (692ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (337ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (643ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    ✔ should report on PositionOpened event\n\n    ✔ should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    8) should report on Deposit event\n\n    ✔ should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  24 passing (3s)\n\n  8 failing\n\n\n\n  1) Leverage Events\n       should process PositionOpened event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:38:5)\n\n\n  2) Leverage Events\n       should process PositionClosed event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:70:5)\n\n\n  3) Leverage Events\n       should process PositionLiquidated event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:99:5)\n\n\n  4) Leverage Events\n       should process PositionExpired event and push messages to SQS:\n     SyntaxError: \"undefined\" is not valid JSON\n      at JSON.parse (<"+"anonymous>)\n      at validateSQSMessage (test/acceptance/LeverageEvents.test.ts:153:32)\n      at Context.<"+"anonymous> (test/acceptance/LeverageEvents.test.ts:129:5)\n\n\n  5) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n\n\n  6) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n\n\n  7) Config Service Test\n       \"before each\" hook for \"should get the correct leverage contract addresses from AWS\":\n     Error: Error fetching configuration for : Error: Empty value provided for input HTTP label: Configuration.\n      at AppConfigClient.fetchConfigRawString (src/services/config/AppConfigClient.ts:3:4217)\n      at async ConfigServiceAWS.refreshEventQueueURL (src/services/config/ConfigServiceAWS.ts:3:12062)\n      at async Promise.all (index 5)\n      at async ConfigServiceAWS.refreshConfig (src/services/config/ConfigServiceAWS.ts:3:3482)\n      at async initalizeObjectUnderTest (test/interface/ConfigServiceAWSInterface.test.ts:21:5)\n      at async Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:16:5)\n\n\n  8) PSP Events Logging\n       should report on Deposit event:\n     AssertionError: expected undefined to equal 'Deposit'\n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:66:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   86.71 |    45.44 |   95.77 |   87.08 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   69.38 |    26.03 |   88.88 |   69.23 |                   \n\n  EventProcessorService.ts             |   57.29 |    16.92 |   81.81 |   57.44 | ...13-157,173-183 \n\n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   87.64 |    46.66 |     100 |   87.35 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |    87.5 |    44.44 |     100 |   87.23 | 6,24,38-41,83     \n\n sandbox7748464/src/services/config    |   90.87 |    49.43 |   96.15 |   91.52 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |    93.2 |    54.86 |     100 |   93.13 | 6,24,39,93-98     \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":93,"line":104},"start":{"column":74,"line":104}}},{"id":"349","mutatorName":"BlockStatement","replacement":"{}","statusReason":"\n> event-fetcher-backend@1.0.0 test\n> npx nyc --reporter=lcov --reporter=text hardhat test\n\n\nWARNING: You are currently using Node.js v21.2.0, which is not supported by Hardhat. This can lead to unexpected behavior. See https://hardhat.org/nodejs-versions\n\n\n\n\n\n\n\n\n(node:29642) NOTE: We are formalizing our plans to enter AWS SDK for JavaScript (v2) into maintenance mode in 2023.\n\nPlease migrate your code to use AWS SDK for JavaScript (v3).\nFor more information, check the migration guide at https://a.co/7PzMCcy\n(Use `node --trace-warnings ...` to show where the warning was created)\n\n  Leverage Events\n\n[2/23/2024 7:31:21 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:21 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:31:21 PM] {\"event\":\"LeveragedPositionOpened\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:31:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionOpened event and push messages to SQS (401ms)\n\n[2/23/2024 7:31:22 PM] Executing the event fetcher workflow...\n[2/23/2024 7:31:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:31:22 PM] {\"event\":\"LeveragedPositionClosed\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\",\"borrowedAmount\":\"2\"}\n\n[2/23/2024 7:31:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionClosed event and push messages to SQS (281ms)\n\n[2/23/2024 7:31:22 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:22 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:31:22 PM] {\"event\":\"LeveragedPositionLiquidated\",\"user\":\"0\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"2\",\"borrowedAmount\":\"3\"}\n\n[2/23/2024 7:31:22 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionLiquidated event and push messages to SQS (267ms)\n\n[2/23/2024 7:31:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:31:23 PM] {\"event\":\"LeveragedPositionExpired\",\"user\":\"0x925cc02EC7b77d4432e82e7bCaf3B89a67a555F2\",\"strategy\":\"\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:23 PM] Event fetcher workflow completed.\n\n    ✔ should process PositionExpired event and push messages to SQS (568ms)\n\n\n\n  PSP Events\n\n[2/23/2024 7:31:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:31:23 PM] Unknown event topic, 0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\n\n[2/23/2024 7:31:23 PM] {\"event\":\"Deposit\",\"user\":\"0x93B435e55881Ea20cBBAaE00eaEdAf7Ce366BeF2\",\"strategy\":\"Convex FRAXBP/msUSD Single Pool\",\"depositAmount\":\"5000000\"}\n\n[2/23/2024 7:31:23 PM] Event fetcher workflow completed.\n\n    1) should catch and report on Deposit event\n\n[2/23/2024 7:31:23 PM] Executing the event fetcher workflow...\n\n[2/23/2024 7:31:23 PM] RPC: http://ec2-52-4-114-208.compute-1.amazonaws.com:8545\n\n                        SQS queue: \n\n                        Env: Demo\n\n[2/23/2024 7:31:23 PM] {\"event\":\"Withdraw\",\"user\":\"0x2222222222222222222222222222222222222222\",\"strategy\":\"Convex ETH+/ETH Single Pool\",\"depositAmount\":\"1\"}\n\n[2/23/2024 7:31:23 PM] Event fetcher workflow completed.\n\n    2) should catch and report on Withdraw event\n\n\n\n  Config Service - Demo Environment\n\n    ✔ should fetch PSP strategies via AWS AppConfig (173ms)\n\n    ✔ should fetch Leverage addresses via AWS AppConfig (165ms)\n\n    ✔ should fetch RPC URL (140ms)\n\n    ✔ should fetch Alt RPC URL (142ms)\n\n    ✔ should fetch Events Fetch Page Size (155ms)\n\n    ✔ should fetch NewEventsQueueURL (159ms)\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses from AWS\n\n    ✔ should get the correct PSP contract addresses from AWS (257ms)\n\n    3) should retrieve last block scanned from AWS\n\n    ✔ should set last block scanned (337ms)\n\n    ✔ should get main and alt RPC URL from AWS\n\n    ✔ should retrieve page size from AWS\n\n    4) should retrieve event queue URL from AWS\n\n\n\n  Fetch on-chain events from blockchain\n\n    ✔ should fetch on-chain events from RPC provider (632ms)\n\n    ✔ should fetch deposit event of crvUSD/USDT strategy (274ms)\n\n\n\n  Validating Topic hash calculation for leverage events\n\n    ✔ should have the expected topic[0] for PositionOpened event (636ms)\n\n    ✔ should have the expected topic[0] for PositionClosed event\n\n    ✔ should have the expected topic[0] for PositionLiquidated event\n\n    ✔ should have the expected topic[0] for PositionExpired event\n\n\n\n  Config Service Test\n\n    ✔ should get the correct leverage contract addresses when run locally\n\n    ✔ should get the correct PSP contract addresses when run locally\n\n    ✔ should get ContracInfoPSP by address\n\n\n\n  Leverage Events Logging & Queuing\n\n    5) should report on PositionOpened event\n\n    6) should report on PositionClosed event\n\n    ✔ should report on PositionLiqiuidated event\n\n    ✔ should report on PositionExpired event\n\n\n\n  PSP Events Logging\n\n    ✔ should report on Deposit event\n\n    7) should report on Withdraw event\n\n\n\n  Inner logic functions\n\n    ✔ should return an empty array for no logs\n\n    ✔ should return the same logs if all are unique\n\n    ✔ should handle a mix of unique and duplicate logs correctly and remove duplicate logs\n\n    ✔ should return a single log when all logs are duplicates\n\n\n\n\n\n  31 passing (8s)\n\n  7 failing\n\n\n\n  1) PSP Events\n       should catch and report on Deposit event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:40:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  2) PSP Events\n       should catch and report on Withdraw event:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/acceptance/PSPEvents.test.ts:62:22)\n      at processTicksAndRejections (node:internal/process/task_queues:95:5)\n\n\n  3) Config Service Test\n       should retrieve last block scanned from AWS:\n\n      AssertionError: expected +0 to be at least 6000000\n      + expected - actual\n\n      -0\n      +6000000\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:82:36)\n\n\n  4) Config Service Test\n       should retrieve event queue URL from AWS:\n\n      AssertionError: expected false to be true\n      + expected - actual\n\n      -false\n      +true\n      \n      at Context.<"+"anonymous> (test/interface/ConfigServiceAWSInterface.test.ts:114:45)\n\n\n  5) Leverage Events Logging & Queuing\n       should report on PositionOpened event:\n     AssertionError: expected undefined to equal 'LeveragedPositionOpened'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:60:5)\n\n\n  6) Leverage Events Logging & Queuing\n       should report on PositionClosed event:\n     AssertionError: expected undefined to equal 'LeveragedPositionClosed'\n      at validateLogMessage (test/unit/EventFactoryLeverage.test.ts:209:39)\n      at testEventProcessing (test/unit/EventFactoryLeverage.test.ts:199:5)\n      at Context.<"+"anonymous> (test/unit/EventFactoryLeverage.test.ts:89:5)\n\n  7) PSP Events Logging\n       should report on Withdraw event:\n     AssertionError: expected undefined to equal 'Withdraw'\n      at validateLogMessage (test/unit/EventFactoryPSP.test.ts:107:39)\n      at Context.<"+"anonymous> (test/unit/EventFactoryPSP.test.ts:99:5)\n\n\n\n\n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nFile                                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n\nAll files                              |   89.94 |    48.88 |   96.71 |   90.31 |                   \n\n sandbox7748464                        |     100 |      100 |     100 |     100 |                   \n\n  hardhat.config.ts                    |     100 |      100 |     100 |     100 |                   \n\n sandbox7748464/src                    |   93.19 |    50.29 |     100 |      93 |                   \n\n  EventProcessorService.ts             |   93.75 |    48.46 |     100 |   93.61 | 6,24,38-41,183    \n\n  lambda-handler.ts                    |   92.15 |    56.41 |     100 |   91.83 | 24,38-41          \n\n sandbox7748464/src/onchain_events     |   85.84 |       50 |   86.48 |   87.56 |                   \n\n  EventFactory.ts                      |   86.71 |    51.85 |   77.27 |   89.91 | ...27,165,186-192 \n\n  EventTopic.ts                        |   85.29 |    48.78 |     100 |   84.84 | 7,25,39-42        \n\n  OnChainEvent.ts                      |      84 |    43.13 |     100 |   83.67 | 6,24,38-41,89-93  \n\n ...src/onchain_events/leverage_events |   91.46 |    47.42 |     100 |   91.31 |                   \n\n  OnChainEventLeverage.ts              |   86.84 |    45.16 |     100 |   86.48 | 6,24,38-41        \n\n  ...ainEventLeveragePositionClosed.ts |    91.8 |    47.61 |     100 |   91.66 | 6,24,38-41        \n\n  ...inEventLeveragePositionExpired.ts |   91.66 |    47.54 |     100 |   91.52 | 6,24,38-41        \n\n  ...ventLeveragePositionLiquidated.ts |   92.18 |    47.69 |     100 |   92.06 | 6,24,38-41        \n\n  ...ainEventLeveragePositionOpened.ts |   92.85 |    47.88 |     100 |   92.75 | 6,24,38-41        \n\n ...8464/src/onchain_events/psp_events |   88.37 |     46.4 |     100 |   88.09 |                   \n\n  OnChainEventPSP.ts                   |   89.36 |    46.15 |     100 |   89.13 | 6,24,38-41        \n\n  OnChainEventPSPDeposit.ts            |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n  OnChainEventPSPWithdraw.ts           |    87.8 |    46.51 |     100 |    87.5 | 6,24,38-41        \n\n ...box7748464/src/services/blockchain |   88.76 |    47.77 |     100 |    88.5 |                   \n\n  EventFetcher.ts                      |    87.8 |    48.88 |     100 |    87.5 | 6,24,38-41        \n\n  EventFetcherRPC.ts                   |   89.58 |    46.66 |     100 |   89.36 | 6,24,38-41        \n\n sandbox7748464/src/services/config    |   90.87 |    49.81 |   96.15 |   91.52 |                   \n\n  AppConfigClient.ts                   |   85.45 |    44.06 |     100 |   85.18 | ...,38-41,107-111 \n\n  ConfigService.ts                     |   91.56 |    46.31 |      92 |   93.75 | 6,24,38-41        \n\n  ConfigServiceAWS.ts                  |    93.2 |    55.75 |     100 |   93.13 | 6,24,39,93-98     \n\n---------------------------------------|---------|----------|---------|---------|-------------------\n","status":"Killed","testsCompleted":1,"killedBy":["0"],"location":{"end":{"column":4,"line":105},"start":{"column":55,"line":103}}},{"id":"347","mutatorName":"BlockStatement","replacement":"{}","status":"Timeout","location":{"end":{"column":4,"line":101},"start":{"column":60,"line":98}}}],"source":"import {ContractInfoLeverage} from '../../types/ContractInfoLeverage';\nimport {ContractInfoPSP} from '../../types/ContractInfoPSP';\nimport {ConfigService, LeverageContractAddresses} from './ConfigService';\nimport {AppConfigClient} from './AppConfigClient';\nimport {S3Service} from '@thisisarchimedes/backend-sdk';\n\nexport class ConfigServiceAWS extends ConfigService {\n  private readonly appConfigClient: AppConfigClient;\n  private readonly s3Service: S3Service = new S3Service();\n\n  constructor(environment: string, region: string) {\n    super();\n    this.environment = environment;\n    this.appConfigClient = new AppConfigClient(environment, region);\n  }\n\n  public async refreshConfig(): Promise<"+"void> {\n    await Promise.all([\n      this.refreshLeverageContractAddresses(),\n      this.refreshPSPContractInfo(),\n      this.refreshLastScannedBlock(),\n      this.refreshRPCURL(),\n      this.refreshEventFetchPageSize(),\n      this.refreshEventQueueURL(),\n    ]);\n  }\n\n  public async setLastScannedBlock(blockNumber: number): Promise<"+"void> {\n    const res = JSON.parse(await this.appConfigClient.fetchConfigRawString('LastBlockScannedS3FileURL'));\n    await this.s3Service.putObject(res['bucket'], res['key'], blockNumber.toString());\n    this.lastBlockScanned = blockNumber;\n  }\n\n  public async refreshLeverageContractAddresses(): Promise<"+"void> {\n    try {\n      const leverageContractInfo = await this.fetchLeverageContractInfo();\n      this.leverageContractAddresses = this.extractLeverageContractAddresses(leverageContractInfo);\n    } catch (error) {\n      console.error('Failed to refresh leverage contract addresses:', error);\n      throw error;\n    }\n  }\n\n  private async fetchLeverageContractInfo(): Promise<"+"ContractInfoLeverage[]> {\n    const configString = await this.appConfigClient.fetchConfigRawString('LeverageContractInfo');\n    return JSON.parse(configString);\n  }\n\n  private extractLeverageContractAddresses(contracts: ContractInfoLeverage[]): LeverageContractAddresses {\n    const addresses: LeverageContractAddresses = {\n      positionOpenerAddress: '',\n      positionLiquidatorAddress: '',\n      positionCloserAddress: '',\n      positionExpiratorAddress: '',\n    };\n\n    contracts.forEach((contract) => {\n      switch (contract.name) {\n        case 'PositionOpener':\n          addresses.positionOpenerAddress = contract.address;\n          break;\n        case 'PositionLiquidator':\n          addresses.positionLiquidatorAddress = contract.address;\n          break;\n        case 'PositionCloser':\n          addresses.positionCloserAddress = contract.address;\n          break;\n        case 'positionExpirator':\n          addresses.positionExpiratorAddress = contract.address;\n          break;\n      }\n    });\n\n    return addresses;\n  }\n\n  private async refreshPSPContractInfo(): Promise<"+"void> {\n    const res = await this.appConfigClient.fetchConfigRawString('PSPStrategyInfo');\n    this.pspContractInfo = JSON.parse(res) as unknown as ContractInfoPSP[];\n  }\n\n  private async refreshLastScannedBlock(): Promise<"+"void> {\n    const res = JSON.parse(await this.appConfigClient.fetchConfigRawString('LastBlockScannedS3FileURL'));\n    const blockNumber = await this.s3Service.getObject(res['bucket'], res['key']);\n    this.lastBlockScanned = parseInt(blockNumber, 10);\n  }\n\n  private async refreshRPCURL(): Promise<"+"void> {\n    const [mainRPCURL, altRPCURL] = await Promise.all([\n      this.appConfigClient.fetchConfigRawString('RpcUrl'),\n      this.appConfigClient.fetchConfigRawString('AltRpcUrl'),\n    ]);\n\n    this.MainRPCURL = mainRPCURL;\n    this.AltRPCURL = altRPCURL;\n  }\n\n  private async refreshEventFetchPageSize(): Promise<"+"void> {\n    const res = await this.appConfigClient.fetchConfigRawString('EventsFetchPageSize');\n    this.EventFetchPageSize = parseInt(res, 10);\n  }\n\n  private async refreshEventQueueURL(): Promise<"+"void> {\n    this.EventQueueURL = await this.appConfigClient.fetchConfigRawString('NewEventsQueueURL');\n  }\n}\n"}},"schemaVersion":"1.0","thresholds":{"high":80,"low":60,"break":null},"testFiles":{"":{"tests":[{"id":"0","name":"All tests"}]}},"projectRoot":"/Users/tomermayara/github/EventFetcherService","config":{"allowConsoleColors":true,"checkers":[],"checkerNodeArgs":[],"commandRunner":{"command":"npm test"},"coverageAnalysis":"perTest","clearTextReporter":{"allowColor":true,"allowEmojis":false,"logTests":true,"maxTestsToLog":3,"reportTests":true,"reportMutants":true,"reportScoreTable":true},"dashboard":{"baseUrl":"https://dashboard.stryker-mutator.io/api/reports","reportType":"full"},"dryRunOnly":false,"eventReporter":{"baseDir":"reports/mutation/events"},"ignorePatterns":[],"ignoreStatic":false,"incremental":false,"incrementalFile":"reports/stryker-incremental.json","force":false,"fileLogLevel":"off","inPlace":false,"logLevel":"info","maxConcurrentTestRunners":9007199254740991,"maxTestRunnerReuse":0,"mutate":["{src,lib}/**/!(*.+(s|S)pec|*.+(t|T)est).+(cjs|mjs|js|ts|jsx|tsx|html|vue|svelte)","!{src,lib}/**/__tests__/**/*.+(cjs|mjs|js|ts|jsx|tsx|html|vue|svelte)"],"mutator":{"plugins":null,"excludedMutations":[]},"plugins":["@stryker-mutator/*"],"appendPlugins":[],"reporters":["clear-text","progress","html"],"htmlReporter":{"fileName":"reports/mutation/mutation.html"},"jsonReporter":{"fileName":"reports/mutation/mutation.json"},"disableTypeChecks":true,"symlinkNodeModules":true,"tempDirName":".stryker-tmp","cleanTempDir":true,"testRunner":"command","testRunnerNodeArgs":[],"thresholds":{"high":80,"low":60,"break":null},"timeoutFactor":1.5,"timeoutMS":5000,"dryRunTimeoutMinutes":5,"tsconfigFile":"tsconfig.json","warnings":true,"disableBail":false,"allowEmpty":false,"ignorers":[],"mochaOptions":{}},"framework":{"name":"StrykerJS","version":"8.0.0","branding":{"homepageUrl":"https://stryker-mutator.io","imageUrl":"data:image/svg+xml;utf8,%3Csvg viewBox='0 0 1458 1458' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' clip-rule='evenodd' stroke-linejoin='round' stroke-miterlimit='2'%3E%3Cpath fill='none' d='M0 0h1458v1458H0z'/%3E%3CclipPath id='a'%3E%3Cpath d='M0 0h1458v1458H0z'/%3E%3C/clipPath%3E%3Cg clip-path='url(%23a)'%3E%3Cpath d='M1458 729c0 402.655-326.345 729-729 729S0 1131.655 0 729C0 326.445 326.345 0 729 0s729 326.345 729 729' fill='%23e74c3c' fill-rule='nonzero'/%3E%3Cpath d='M778.349 1456.15L576.6 1254.401l233-105 85-78.668v-64.332l-257-257-44-187-50-208 251.806-82.793L1076.6 389.401l380.14 379.15c-19.681 367.728-311.914 663.049-678.391 687.599z' fill-opacity='.3'/%3E%3Cpath d='M753.4 329.503c41.79 0 74.579 7.83 97.925 25.444 23.571 18.015 41.69 43.956 55.167 77.097l11.662 28.679 165.733-58.183-14.137-32.13c-26.688-60.655-64.896-108.61-114.191-144.011-49.329-35.423-117.458-54.302-204.859-54.302-50.78 0-95.646 7.376-134.767 21.542-40.093 14.671-74.09 34.79-102.239 60.259-28.84 26.207-50.646 57.06-65.496 92.701-14.718 35.052-22.101 72.538-22.101 112.401 0 72.536 20.667 133.294 61.165 182.704 38.624 47.255 98.346 88.037 179.861 121.291 42.257 17.475 78.715 33.125 109.227 46.994 27.193 12.361 49.294 26.124 66.157 41.751 15.309 14.186 26.497 30.584 33.63 49.258 7.721 20.214 11.16 45.69 11.16 76.402 0 28.021-4.251 51.787-13.591 71.219-8.832 18.374-20.171 33.178-34.523 44.219-14.787 11.374-31.193 19.591-49.393 24.466-19.68 5.359-39.14 7.993-58.69 7.993-29.359 0-54.387-3.407-75.182-10.747-20.112-7.013-37.144-16.144-51.259-27.486-13.618-11.009-24.971-23.766-33.744-38.279-9.64-15.8-17.272-31.924-23.032-48.408l-10.965-31.376-161.669 60.585 10.734 30.124c10.191 28.601 24.197 56.228 42.059 82.748 18.208 27.144 41.322 51.369 69.525 72.745 27.695 21.075 60.904 38.218 99.481 51.041 37.777 12.664 82.004 19.159 132.552 19.159 49.998 0 95.818-8.321 137.611-24.622 42.228-16.471 78.436-38.992 108.835-67.291 30.719-28.597 54.631-62.103 71.834-100.642 17.263-38.56 25.923-79.392 25.923-122.248 0-54.339-8.368-100.37-24.208-138.32-16.29-38.759-38.252-71.661-65.948-98.797-26.965-26.418-58.269-48.835-93.858-67.175-33.655-17.241-69.196-33.11-106.593-47.533-35.934-13.429-65.822-26.601-89.948-39.525-22.153-11.868-40.009-24.21-53.547-37.309-11.429-11.13-19.83-23.678-24.718-37.664-5.413-15.49-7.98-33.423-7.98-53.577 0-40.883 11.293-71.522 37.086-90.539 28.443-20.825 64.985-30.658 109.311-30.658z' fill='%23f1c40f' fill-rule='nonzero'/%3E%3Cpath d='M720 0h18v113h-18zM1458 738v-18h-113v18h113zM720 1345h18v113h-18zM113 738v-18H0v18h113z'/%3E%3C/g%3E%3C/svg%3E"},"dependencies":{"@stryker-mutator/mocha-runner":"8.0.0","mocha":"10.2.0","typescript":"5.3.3"}}};
      function updateTheme() {
        document.body.style.backgroundColor = app.themeBackgroundColor;
      }
      app.addEventListener('theme-changed', updateTheme);
      updateTheme();
    </script>
  </body>
  </html>